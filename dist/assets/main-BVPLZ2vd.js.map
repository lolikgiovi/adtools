{"version":3,"file":"main-BVPLZ2vd.js","sources":["../../src/features/splunk/splunk.template.js","../../src/features/splunk/splunk.service.js","../../src/features/splunk/splunk.ui.js","../../src/features/splunk/main.js"],"sourcesContent":["export const splunkTemplate = `\n    <div class=\"tool-container splunk-container\">\n      <div class=\"splunk-controls button-group\">\n        <button id=\"formatButton\">Format</button>\n        <button id=\"minifyButton\">Minify</button>\n        <button id=\"copyButton\">Copy</button>\n        <button id=\"pasteButton\">Paste</button>\n        <button id=\"clearButton\">Clear</button>\n        <button id=\"toggleHighlightButton\">Highlight</button>\n        <button id=\"removeSpacesButton\">Remove Spaces After =</button>\n      </div>\n      <div class=\"splunk-content\">\n        <div id=\"splunkEditor\" class=\"splunk-content-area\"></div>\n      </div>\n    </div>\n  `;","export class SplunkService {\n  formatText(text, shouldMinify) {\n    if (shouldMinify) {\n      return text.replace(/\\s*\\n\\s*/g, \"\");\n    } else {\n      return text\n        .split(\"|\").map((part) => part.trim())\n        .join(\"|\\n\");\n    }\n  }\n\n  removeSpacesAfterEquals(text) {\n    return text.replace(/\\s*=\\s*/g, \"=\");\n  }\n\n  defineSplunkMode(CodeMirror) {\n    CodeMirror.defineMode(\"splunk\", () => ({\n      token: function (stream, state) {\n        if (stream.match(/^[^=|]+=/)) {\n          state.fieldName = stream.string.slice(stream.start, stream.pos - 1);\n          state.expectValue = true;\n          return \"key\";\n        }\n        if (state.expectValue) {\n          if (stream.match(/^\\s+/)) {\n            state.hasSpaceAfterEquals = true;\n            return \"error\";\n          }\n          if (stream.match(/^\\$!{date\\.convertDate\\(/)) {\n            state.inVTLFormat = true;\n            return \"vtl-format\";\n          }\n          if (stream.match(/^\\$!{context\\.[^}]+}/)) {\n            return \"context\";\n          }\n          if (state.inVTLFormat) {\n            if (stream.match(/^\\$!{context\\.[^}]+}/)) {\n              return \"vtl-value\";\n            }\n            if (stream.match(/^'[^']+'/)) {\n              return \"vtl-parameter\";\n            }\n            if (stream.match(/^\\)/)) {\n              state.inVTLFormat = false;\n              return \"vtl-format\";\n            }\n          }\n          if (stream.match(/^\\$!{[^}]+}/)) {\n            return state.hasSpaceAfterEquals ? \"variable-error\" : \"context\";\n          }\n          if (stream.match(/'[^']+'/)) {\n            return \"string\";\n          }\n          if (stream.match(/^[^|]+/)) {\n            return \"hardcoded\";\n          }\n        }\n        if (stream.match(/\\|/)) {\n          state.expectValue = false;\n          state.hasSpaceAfterEquals = false;\n          state.inVTLFormat = false;\n          return \"delimiter\";\n        }\n        stream.next();\n        return null;\n      },\n      startState: function () {\n        return {\n          expectValue: false,\n          hasSpaceAfterEquals: false,\n          fieldName: \"\",\n          inVTLFormat: false,\n        };\n      },\n    }));\n  }\n}","import { copyToClipboard, pasteFromClipboard } from \"../../utils/buttons.js\";\nimport { DependencyLoader } from \"../../utils/dependencyLoader.js\";\nimport { splunkTemplate } from \"./splunk.template.js\";\nimport { SplunkService } from \"./splunk.service.js\";\n\nexport class SplunkUI {\n  constructor(container) {\n    this.container = container;\n    this.splunkService = new SplunkService();\n    this.editor = null;\n    this.highlightingEnabled = true;\n    this.init();\n  }\n\n  async init() {\n    await this.initializeUi();\n    this.bindElements();\n    await this.loadDependencies();\n  }\n\n  async initializeUi() {\n    return new Promise((resolve) => {\n      this.container.innerHTML = splunkTemplate;\n      requestAnimationFrame(() => {\n        resolve();\n      });\n    });\n  }\n\n  bindElements() {\n    this.elements = {\n      formatButton: document.getElementById(\"formatButton\"),\n      minifyButton: document.getElementById(\"minifyButton\"),\n      copyButton: document.getElementById(\"copyButton\"),\n      pasteButton: document.getElementById(\"pasteButton\"),\n      clearButton: document.getElementById(\"clearButton\"),\n      toggleHighlightButton: document.getElementById(\"toggleHighlightButton\"),\n      removeSpacesButton: document.getElementById(\"removeSpacesButton\"),\n    };\n\n    // Set initial button states\n    this.elements.toggleHighlightButton.textContent = \"Disable Highlight\";\n  }\n\n  async loadDependencies() {\n    await DependencyLoader.load(\"codemirror\");\n    this.initializeEditor();\n    this.setupEventListeners();\n  }\n\n  initializeEditor() {\n    this.splunkService.defineSplunkMode(CodeMirror);\n\n    this.editor = CodeMirror(document.getElementById(\"splunkEditor\"), {\n      mode: \"splunk\",\n      lineNumbers: true,\n      theme: \"default\",\n      lineWrapping: true,\n      styleSelectedText: true,\n      value: `eventType=[EVENT_NAME]|\ndescription=|\nchannelCode=EVE|\nchannelName=EVE|\ncifNo= $!{context.cifNo}|\nmobilePhone= $!{context.mobilePhone}|\namount=$!{context.amount}|\ntransactionDate=$!{date.convertDate($!{context.transactionDate},'yyyy-MM-dd HH:mm:ss')}`,\n    });\n  }\n\n  setupEventListeners() {\n    const { formatButton, minifyButton, copyButton, pasteButton, clearButton, toggleHighlightButton, removeSpacesButton } = this.elements;\n\n    formatButton.addEventListener(\"click\", () => {\n      const formattedText = this.splunkService.formatText(this.editor.getValue(), false);\n      this.editor.setValue(formattedText);\n    });\n\n    minifyButton.addEventListener(\"click\", () => {\n      const minifiedText = this.splunkService.formatText(this.editor.getValue(), true);\n      this.editor.setValue(minifiedText);\n    });\n\n    copyButton.addEventListener(\"click\", () => copyToClipboard(this.editor.getValue(), copyButton));\n\n    pasteButton.addEventListener(\"click\", () => pasteFromClipboard((text) => this.editor.setValue(text)));\n    clearButton.addEventListener(\"click\", () => this.editor.setValue(\"\"));\n    toggleHighlightButton.addEventListener(\"click\", () => this.toggleHighlighting());\n\n    removeSpacesButton.addEventListener(\"click\", () => {\n      const currentText = this.editor.getValue();\n      const textWithoutSpaces = this.splunkService.removeSpacesAfterEquals(currentText);\n      this.editor.setValue(textWithoutSpaces);\n    });\n  }\n\n  toggleHighlighting() {\n    this.highlightingEnabled = !this.highlightingEnabled;\n    if (this.highlightingEnabled) {\n      this.splunkService.defineSplunkMode(CodeMirror);\n      this.editor.setOption(\"mode\", \"splunk\");\n    } else {\n      this.editor.setOption(\"mode\", null);\n    }\n    this.elements.toggleHighlightButton.textContent = this.highlightingEnabled ? \"Disable Highlight\" : \"Enable Highlight\";\n  }\n\n  async handlePaste() {\n    try {\n      const text = await navigator.clipboard.readText();\n      this.editor.setValue(text);\n    } catch (err) {\n      console.error(\"Failed to read clipboard contents: \", err);\n    }\n  }\n}\n","import { SplunkUI } from \"./splunk.ui.js\";\n\nexport function initSplunkTemplate(container) {\n  return new SplunkUI(container);\n}"],"names":["splunkTemplate","SplunkService","text","shouldMinify","part","CodeMirror","stream","state","SplunkUI","container","resolve","DependencyLoader","formatButton","minifyButton","copyButton","pasteButton","clearButton","toggleHighlightButton","removeSpacesButton","formattedText","minifiedText","copyToClipboard","pasteFromClipboard","currentText","textWithoutSpaces","err","initSplunkTemplate"],"mappings":"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"}