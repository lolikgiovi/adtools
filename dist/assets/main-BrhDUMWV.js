import{p as o}from"./utils-P83EfEoD.js";import"./vendor-ItrcfzAD.js";const s=`
  <div class="tool-container">
    <h3 id="sectionText">Generate Documentation Template for Config Deployment</h3>
    <textarea id="inputList" placeholder="Enter table name, one table per line"></textarea>
    <div class="button-group">
      <button id="generateButton">Generate Document</button>
      <button id="clearButton">Clear</button>
      <button id="pasteButton">Paste</button>
    </div>
  </div>
`;class c{async loadDocxLibrary(){return new Promise((t,e)=>{const n=document.createElement("script");n.src="https://unpkg.com/docx@7.1.0/build/index.js",n.onload=()=>t(window.docx),n.onerror=e,document.head.appendChild(n)})}getFormattedDate(){const t=new Date,e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),i=t.getFullYear();return`${e}_${n}_${i}`}toUpperCase(t){return t.toUpperCase()}async generateDocument(t){try{const e=await this.loadDocxLibrary(),n=t.split(`
`).filter(a=>a.trim()!=="").map(a=>this.toUpperCase(a.trim())),i=new e.Document({sections:[{properties:{},children:[new e.Paragraph({text:`Deployment (Config) - ${new Date().toLocaleDateString("en-US",{day:"numeric",month:"long",year:"numeric"})}`,heading:e.HeadingLevel.HEADING_1}),...n.flatMap(a=>[new e.Paragraph({text:a,heading:e.HeadingLevel.HEADING_2}),new e.Paragraph("Before"),new e.Paragraph(""),new e.Paragraph(""),new e.Paragraph("Execution"),new e.Paragraph(""),new e.Paragraph(""),new e.Paragraph("Commit"),new e.Paragraph(""),new e.Paragraph(""),new e.Paragraph("")])]}],styles:{paragraphStyles:[{id:"Heading1",name:"Heading 1",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:32,font:"Calibri",color:"2F5496"},paragraph:{spacing:{after:240}}},{id:"Heading2",name:"Heading 2",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:24,font:"Calibri",color:"2F5496"},paragraph:{spacing:{after:0}}}],default:{document:{run:{font:"Calibri",size:20}}}}});return e.Packer.toBlob(i)}catch(e){throw console.error("Error generating document:",e),new Error("Failed to generate document. Please try again.")}}}class l{constructor(t){this.container=t,this.screenshotService=new c,this.init()}async init(){await this.initializeUi(),this.bindElements(),this.setupEventListeners(),this.adjustTextareaHeight(this.elements.inputList)}async initializeUi(){return new Promise(t=>{this.container.innerHTML=s,requestAnimationFrame(()=>{t()})})}bindElements(){this.elements={inputList:document.getElementById("inputList"),generateButton:document.getElementById("generateButton"),clearButton:document.getElementById("clearButton"),pasteButton:document.getElementById("pasteButton")}}setupEventListeners(){this.elements.generateButton.addEventListener("click",()=>this.generateDocument()),this.elements.clearButton.addEventListener("click",()=>this.handleClear()),this.elements.pasteButton.addEventListener("click",()=>this.handlePaste()),this.elements.inputList.addEventListener("input",()=>this.adjustTextareaHeight(this.elements.inputList))}adjustTextareaHeight(t){t.style.height="auto",t.style.height=t.scrollHeight+"px"}async generateDocument(){try{const t=await this.screenshotService.generateDocument(this.elements.inputList.value),e=window.URL.createObjectURL(t),n=document.createElement("a");n.href=e,n.download=`deploy_config_${this.screenshotService.getFormattedDate()}.docx`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(e)}catch(t){console.error("Error generating document:",t),alert(t.message)}}handleClear(){this.elements.inputList.value="",this.adjustTextareaHeight(this.elements.inputList)}async handlePaste(){await o(this.elements.inputList),this.adjustTextareaHeight(this.elements.inputList)}}function h(r){return new l(r)}export{h as initScreenshotTemplate};
//# sourceMappingURL=main-BrhDUMWV.js.map
