import{A as a,R as c,U as l,a as d,b as u,T as h}from"./core-CjBKUKra.js";import{D as p,M as f,T as g,R as w}from"./utils-P83EfEoD.js";import"./vendor-ItrcfzAD.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function o(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(t){if(t.ep)return;t.ep=!0;const r=o(t);fetch(t.href,r)}})();class m{constructor(){this.state=new a,this.router=new c(this),this.ui=new l(this),this.resources=new d(this.state),this.analytics=new u,this.loadTool=this.loadTool.bind(this),this.handleError=this.handleError.bind(this),this.setupErrorHandling()}async init(){try{this.state.setState({isLoading:!0}),this.ui.setupNavigation(),await this.router.initializeRouting(),this.state.setState({isLoading:!1})}catch(e){this.handleError("Initialization failed",e)}}async loadTool(e){if(!h[e])throw new Error(`Unknown tool: ${e}`);try{this.state.setState({isLoading:!0,error:null}),this.ui.showLoadingState();const o=await this.resources.loadToolModule(e),i=this.ui.clearContent();await o(i),this.state.setState({currentTool:e,isLoading:!1}),this.ui.updateActiveButton(e),this.analytics.scheduleTracking(e)}catch(o){this.handleError(`Failed to load tool ${e}`,o)}}setupErrorHandling(){window.onerror=(e,o,i,t,r)=>{this.handleError("An unexpected error occurred",r)},window.onunhandledrejection=e=>{this.handleError("An unexpected error occurred",e.reason)}}handleError(e,o){const i=`${e}: ${o.message}`;console.error(i,o),this.state.setState({error:i,isLoading:!1}),this.ui.showError(i)}}document.addEventListener("DOMContentLoaded",async()=>{try{await p.loadAll(),window.app=new m,await window.app.init(),new f,new g,new w().checkReload()}catch(s){console.error("Failed to initialize app:",s),y()}});function y(){const s=document.createElement("div");s.className="error-message",s.innerHTML=`
    <h2>Failed to initialize application</h2>
    <p>Please refresh the page or contact me if the problem persists.</p>
    <button onclick="window.location.reload()">Refresh Page</button>
  `,document.body.appendChild(s)}const O=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{O as m};
//# sourceMappingURL=main-DmL8H2By.js.map
