var Oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Age(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Bv={exports:{}},oj=Bv.exports,KO;function Hge(){return KO||(KO=1,function(t,e){(function(r,n){t.exports=n()})(oj,function(){var r=navigator.userAgent,n=navigator.platform,i=/gecko\/\d/i.test(r),s=/MSIE \d/.test(r),a=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(r),u=/Edge\/(\d+)/.exec(r),h=s||a||u,c=h&&(s?document.documentMode||6:+(u||a)[1]),m=!u&&/WebKit\//.test(r),p=m&&/Qt\/\d+\.\d+/.test(r),v=!u&&/Chrome\/(\d+)/.exec(r),y=v&&+v[1],C=/Opera\//.test(r),R=/Apple Computer/.test(navigator.vendor),_=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(r),x=/PhantomJS/.test(r),I=R&&(/Mobile\/\w+/.test(r)||navigator.maxTouchPoints>2),k=/Android/.test(r),W=I||k||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(r),B=I||/Mac/.test(n),z=/\bCrOS\b/.test(r),U=/win/i.test(n),J=C&&r.match(/Version\/(\d*\.\d*)/);J&&(J=Number(J[1])),J&&J>=15&&(C=!1,m=!0);var se=B&&(p||C&&(J==null||J<12.11)),ne=i||h&&c>=9;function fe(o){return new RegExp("(^|\\s)"+o+"(?:$|\\s)\\s*")}var j=function(o,l){var f=o.className,d=fe(l).exec(f);if(d){var g=f.slice(d.index+d[0].length);o.className=f.slice(0,d.index)+(g?d[1]+g:"")}};function ae(o){for(var l=o.childNodes.length;l>0;--l)o.removeChild(o.firstChild);return o}function P(o,l){return ae(o).appendChild(l)}function ie(o,l,f,d){var g=document.createElement(o);if(f&&(g.className=f),d&&(g.style.cssText=d),typeof l=="string")g.appendChild(document.createTextNode(l));else if(l)for(var w=0;w<l.length;++w)g.appendChild(l[w]);return g}function Le(o,l,f,d){var g=ie(o,l,f,d);return g.setAttribute("role","presentation"),g}var me;document.createRange?me=function(o,l,f,d){var g=document.createRange();return g.setEnd(d||o,f),g.setStart(o,l),g}:me=function(o,l,f){var d=document.body.createTextRange();try{d.moveToElementText(o.parentNode)}catch{return d}return d.collapse(!0),d.moveEnd("character",f),d.moveStart("character",l),d};function Ae(o,l){if(l.nodeType==3&&(l=l.parentNode),o.contains)return o.contains(l);do if(l.nodeType==11&&(l=l.host),l==o)return!0;while(l=l.parentNode)}function ve(o){var l=o.ownerDocument||o,f;try{f=o.activeElement}catch{f=l.body||null}for(;f&&f.shadowRoot&&f.shadowRoot.activeElement;)f=f.shadowRoot.activeElement;return f}function Be(o,l){var f=o.className;fe(l).test(f)||(o.className+=(f?" ":"")+l)}function E(o,l){for(var f=o.split(" "),d=0;d<f.length;d++)f[d]&&!fe(f[d]).test(l)&&(l+=" "+f[d]);return l}var M=function(o){o.select()};I?M=function(o){o.selectionStart=0,o.selectionEnd=o.value.length}:h&&(M=function(o){try{o.select()}catch{}});function D(o){return o.display.wrapper.ownerDocument}function $(o){return X(o.display.wrapper)}function X(o){return o.getRootNode?o.getRootNode():o.ownerDocument}function ce(o){return D(o).defaultView}function we(o){var l=Array.prototype.slice.call(arguments,1);return function(){return o.apply(null,l)}}function ge(o,l,f){l||(l={});for(var d in o)o.hasOwnProperty(d)&&(f!==!1||!l.hasOwnProperty(d))&&(l[d]=o[d]);return l}function Se(o,l,f,d,g){l==null&&(l=o.search(/[^\s\u00a0]/),l==-1&&(l=o.length));for(var w=d||0,b=g||0;;){var T=o.indexOf("	",w);if(T<0||T>=l)return b+(l-w);b+=T-w,b+=f-b%f,w=T+1}}var L=function(){this.id=null,this.f=null,this.time=0,this.handler=we(this.onTimeout,this)};L.prototype.onTimeout=function(o){o.id=0,o.time<=+new Date?o.f():setTimeout(o.handler,o.time-+new Date)},L.prototype.set=function(o,l){this.f=l;var f=+new Date+o;(!this.id||f<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,o),this.time=f)};function F(o,l){for(var f=0;f<o.length;++f)if(o[f]==l)return f;return-1}var Z=50,le={toString:function(){return"CodeMirror.Pass"}},S={scroll:!1},Y={origin:"*mouse"},K={origin:"+move"};function H(o,l,f){for(var d=0,g=0;;){var w=o.indexOf("	",d);w==-1&&(w=o.length);var b=w-d;if(w==o.length||g+b>=l)return d+Math.min(b,l-g);if(g+=w-d,g+=f-g%f,d=w+1,g>=l)return d}}var A=[""];function V(o){for(;A.length<=o;)A.push(G(A)+" ");return A[o]}function G(o){return o[o.length-1]}function ee(o,l){for(var f=[],d=0;d<o.length;d++)f[d]=l(o[d],d);return f}function re(o,l,f){for(var d=0,g=f(l);d<o.length&&f(o[d])<=g;)d++;o.splice(d,0,l)}function de(){}function be(o,l){var f;return Object.create?f=Object.create(o):(de.prototype=o,f=new de),l&&ge(l,f),f}var ye=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Ie(o){return/\w/.test(o)||o>""&&(o.toUpperCase()!=o.toLowerCase()||ye.test(o))}function Ne(o,l){return l?l.source.indexOf("\\w")>-1&&Ie(o)?!0:l.test(o):Ie(o)}function ke(o){for(var l in o)if(o.hasOwnProperty(l)&&o[l])return!1;return!0}var Rt=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Br(o){return o.charCodeAt(0)>=768&&Rt.test(o)}function pr(o,l,f){for(;(f<0?l>0:l<o.length)&&Br(o.charAt(l));)l+=f;return l}function zt(o,l,f){for(var d=l>f?-1:1;;){if(l==f)return l;var g=(l+f)/2,w=d<0?Math.ceil(g):Math.floor(g);if(w==l)return o(w)?l:f;o(w)?f=w:l=w+d}}function ht(o,l,f,d){if(!o)return d(l,f,"ltr",0);for(var g=!1,w=0;w<o.length;++w){var b=o[w];(b.from<f&&b.to>l||l==f&&b.to==l)&&(d(Math.max(b.from,l),Math.min(b.to,f),b.level==1?"rtl":"ltr",w),g=!0)}g||d(l,f,"ltr")}var Ht=null;function Mt(o,l,f){var d;Ht=null;for(var g=0;g<o.length;++g){var w=o[g];if(w.from<l&&w.to>l)return g;w.to==l&&(w.from!=w.to&&f=="before"?d=g:Ht=g),w.from==l&&(w.from!=w.to&&f!="before"?d=g:Ht=g)}return d??Ht}var ft=function(){var o="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",l="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function f(N){return N<=247?o.charAt(N):1424<=N&&N<=1524?"R":1536<=N&&N<=1785?l.charAt(N-1536):1774<=N&&N<=2220?"r":8192<=N&&N<=8203?"w":N==8204?"b":"L"}var d=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,g=/[stwN]/,w=/[LRr]/,b=/[Lb1n]/,T=/[1n]/;function O(N,q,Q){this.level=N,this.from=q,this.to=Q}return function(N,q){var Q=q=="ltr"?"L":"R";if(N.length==0||q=="ltr"&&!d.test(N))return!1;for(var he=N.length,oe=[],pe=0;pe<he;++pe)oe.push(f(N.charCodeAt(pe)));for(var Ce=0,Te=Q;Ce<he;++Ce){var Oe=oe[Ce];Oe=="m"?oe[Ce]=Te:Te=Oe}for(var De=0,Pe=Q;De<he;++De){var Ve=oe[De];Ve=="1"&&Pe=="r"?oe[De]="n":w.test(Ve)&&(Pe=Ve,Ve=="r"&&(oe[De]="R"))}for(var et=1,Qe=oe[0];et<he-1;++et){var gt=oe[et];gt=="+"&&Qe=="1"&&oe[et+1]=="1"?oe[et]="1":gt==","&&Qe==oe[et+1]&&(Qe=="1"||Qe=="n")&&(oe[et]=Qe),Qe=gt}for(var Qt=0;Qt<he;++Qt){var nn=oe[Qt];if(nn==",")oe[Qt]="N";else if(nn=="%"){var vr=void 0;for(vr=Qt+1;vr<he&&oe[vr]=="%";++vr);for(var ai=Qt&&oe[Qt-1]=="!"||vr<he&&oe[vr]=="1"?"1":"N",jn=Qt;jn<vr;++jn)oe[jn]=ai;Qt=vr-1}}for(var $r=0,Yn=Q;$r<he;++$r){var mn=oe[$r];Yn=="L"&&mn=="1"?oe[$r]="L":w.test(mn)&&(Yn=mn)}for(var Kr=0;Kr<he;++Kr)if(g.test(oe[Kr])){var Vr=void 0;for(Vr=Kr+1;Vr<he&&g.test(oe[Vr]);++Vr);for(var Cr=(Kr?oe[Kr-1]:Q)=="L",Gn=(Vr<he?oe[Vr]:Q)=="L",Fh=Cr==Gn?Cr?"L":"R":Q,Ya=Kr;Ya<Vr;++Ya)oe[Ya]=Fh;Kr=Vr-1}for(var En=[],Xs,sn=0;sn<he;)if(b.test(oe[sn])){var nb=sn;for(++sn;sn<he&&b.test(oe[sn]);++sn);En.push(new O(0,nb,sn))}else{var Uo=sn,Xl=En.length,Zl=q=="rtl"?1:0;for(++sn;sn<he&&oe[sn]!="L";++sn);for(var On=Uo;On<sn;)if(T.test(oe[On])){Uo<On&&(En.splice(Xl,0,new O(1,Uo,On)),Xl+=Zl);var Wh=On;for(++On;On<sn&&T.test(oe[On]);++On);En.splice(Xl,0,new O(2,Wh,On)),Xl+=Zl,Uo=On}else++On;Uo<sn&&En.splice(Xl,0,new O(1,Uo,sn))}return q=="ltr"&&(En[0].level==1&&(Xs=N.match(/^\s+/))&&(En[0].from=Xs[0].length,En.unshift(new O(0,0,Xs[0].length))),G(En).level==1&&(Xs=N.match(/\s+$/))&&(G(En).to-=Xs[0].length,En.push(new O(0,he-Xs[0].length,he)))),q=="rtl"?En.reverse():En}}();function st(o,l){var f=o.order;return f==null&&(f=o.order=ft(o.text,l)),f}var Fo=[],qe=function(o,l,f){if(o.addEventListener)o.addEventListener(l,f,!1);else if(o.attachEvent)o.attachEvent("on"+l,f);else{var d=o._handlers||(o._handlers={});d[l]=(d[l]||Fo).concat(f)}};function Us(o,l){return o._handlers&&o._handlers[l]||Fo}function dn(o,l,f){if(o.removeEventListener)o.removeEventListener(l,f,!1);else if(o.detachEvent)o.detachEvent("on"+l,f);else{var d=o._handlers,g=d&&d[l];if(g){var w=F(g,f);w>-1&&(d[l]=g.slice(0,w).concat(g.slice(w+1)))}}}function Nt(o,l){var f=Us(o,l);if(f.length)for(var d=Array.prototype.slice.call(arguments,2),g=0;g<f.length;++g)f[g].apply(null,d)}function or(o,l,f){return typeof l=="string"&&(l={type:l,preventDefault:function(){this.defaultPrevented=!0}}),Nt(o,f||l.type,o,l),Bl(l)||l.codemirrorIgnore}function Sm(o){var l=o._handlers&&o._handlers.cursorActivity;if(l)for(var f=o.curOp.cursorActivityHandlers||(o.curOp.cursorActivityHandlers=[]),d=0;d<l.length;++d)F(f,l[d])==-1&&f.push(l[d])}function Ft(o,l){return Us(o,l).length>0}function Ri(o){o.prototype.on=function(l,f){qe(this,l,f)},o.prototype.off=function(l,f){dn(this,l,f)}}function Sn(o){o.preventDefault?o.preventDefault():o.returnValue=!1}function pd(o){o.stopPropagation?o.stopPropagation():o.cancelBubble=!0}function Bl(o){return o.defaultPrevented!=null?o.defaultPrevented:o.returnValue==!1}function ka(o){Sn(o),pd(o)}function mh(o){return o.target||o.srcElement}function Rm(o){var l=o.which;return l==null&&(o.button&1?l=1:o.button&2?l=3:o.button&4&&(l=2)),B&&o.ctrlKey&&l==1&&(l=3),l}var Fi=function(){if(h&&c<9)return!1;var o=ie("div");return"draggable"in o||"dragDrop"in o}(),Da;function Em(o){if(Da==null){var l=ie("span","​");P(o,ie("span",[l,document.createTextNode("x")])),o.firstChild.offsetHeight!=0&&(Da=l.offsetWidth<=1&&l.offsetHeight>2&&!(h&&c<8))}var f=Da?ie("span","​"):ie("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return f.setAttribute("cm-text",""),f}var ph;function vd(o){if(ph!=null)return ph;var l=P(o,document.createTextNode("AخA")),f=me(l,0,1).getBoundingClientRect(),d=me(l,1,2).getBoundingClientRect();return ae(o),!f||f.left==f.right?!1:ph=d.right-f.right<3}var vh=`

b`.split(/\n/).length!=3?function(o){for(var l=0,f=[],d=o.length;l<=d;){var g=o.indexOf(`
`,l);g==-1&&(g=o.length);var w=o.slice(l,o.charAt(g-1)=="\r"?g-1:g),b=w.indexOf("\r");b!=-1?(f.push(w.slice(0,b)),l+=b+1):(f.push(w),l=g+1)}return f}:function(o){return o.split(/\r\n?|\n/)},us=window.getSelection?function(o){try{return o.selectionStart!=o.selectionEnd}catch{return!1}}:function(o){var l;try{l=o.ownerDocument.selection.createRange()}catch{}return!l||l.parentElement()!=o?!1:l.compareEndPoints("StartToEnd",l)!=0},_m=function(){var o=ie("div");return"oncopy"in o?!0:(o.setAttribute("oncopy","return;"),typeof o.oncopy=="function")}(),wh=null;function Tm(o){if(wh!=null)return wh;var l=P(o,ie("span","x")),f=l.getBoundingClientRect(),d=me(l,0,1).getBoundingClientRect();return wh=Math.abs(f.left-d.left)>1}var yh={},La={};function Je(o,l){arguments.length>2&&(l.dependencies=Array.prototype.slice.call(arguments,2)),yh[o]=l}function ue(o,l){La[o]=l}function xe(o){if(typeof o=="string"&&La.hasOwnProperty(o))o=La[o];else if(o&&typeof o.name=="string"&&La.hasOwnProperty(o.name)){var l=La[o.name];typeof l=="string"&&(l={name:l}),o=be(l,o),o.name=l.name}else{if(typeof o=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(o))return xe("application/xml");if(typeof o=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(o))return xe("application/json")}return typeof o=="string"?{name:o}:o||{name:"null"}}function Ge(o,l){l=xe(l);var f=yh[l.name];if(!f)return Ge(o,"text/plain");var d=f(o,l);if(Wt.hasOwnProperty(l.name)){var g=Wt[l.name];for(var w in g)g.hasOwnProperty(w)&&(d.hasOwnProperty(w)&&(d["_"+w]=d[w]),d[w]=g[w])}if(d.name=l.name,l.helperType&&(d.helperType=l.helperType),l.modeProps)for(var b in l.modeProps)d[b]=l.modeProps[b];return d}var Wt={};function fn(o,l){var f=Wt.hasOwnProperty(o)?Wt[o]:Wt[o]={};ge(l,f)}function lr(o,l){if(l===!0)return l;if(o.copyState)return o.copyState(l);var f={};for(var d in l){var g=l[d];g instanceof Array&&(g=g.concat([])),f[d]=g}return f}function gn(o,l){for(var f;o.innerMode&&(f=o.innerMode(l),!(!f||f.mode==o));)l=f.state,o=f.mode;return f||{mode:o,state:l}}function Ei(o,l,f){return o.startState?o.startState(l,f):!0}var rr=function(o,l,f){this.pos=this.start=0,this.string=o,this.tabSize=l||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=f};rr.prototype.eol=function(){return this.pos>=this.string.length},rr.prototype.sol=function(){return this.pos==this.lineStart},rr.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},rr.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},rr.prototype.eat=function(o){var l=this.string.charAt(this.pos),f;if(typeof o=="string"?f=l==o:f=l&&(o.test?o.test(l):o(l)),f)return++this.pos,l},rr.prototype.eatWhile=function(o){for(var l=this.pos;this.eat(o););return this.pos>l},rr.prototype.eatSpace=function(){for(var o=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>o},rr.prototype.skipToEnd=function(){this.pos=this.string.length},rr.prototype.skipTo=function(o){var l=this.string.indexOf(o,this.pos);if(l>-1)return this.pos=l,!0},rr.prototype.backUp=function(o){this.pos-=o},rr.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Se(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Se(this.string,this.lineStart,this.tabSize):0)},rr.prototype.indentation=function(){return Se(this.string,null,this.tabSize)-(this.lineStart?Se(this.string,this.lineStart,this.tabSize):0)},rr.prototype.match=function(o,l,f){if(typeof o=="string"){var d=function(b){return f?b.toLowerCase():b},g=this.string.substr(this.pos,o.length);if(d(g)==d(o))return l!==!1&&(this.pos+=o.length),!0}else{var w=this.string.slice(this.pos).match(o);return w&&w.index>0?null:(w&&l!==!1&&(this.pos+=w[0].length),w)}},rr.prototype.current=function(){return this.string.slice(this.start,this.pos)},rr.prototype.hideFirstChars=function(o,l){this.lineStart+=o;try{return l()}finally{this.lineStart-=o}},rr.prototype.lookAhead=function(o){var l=this.lineOracle;return l&&l.lookAhead(o)},rr.prototype.baseToken=function(){var o=this.lineOracle;return o&&o.baseToken(this.pos)};function Fe(o,l){if(l-=o.first,l<0||l>=o.size)throw new Error("There is no line "+(l+o.first)+" in the document.");for(var f=o;!f.lines;)for(var d=0;;++d){var g=f.children[d],w=g.chunkSize();if(l<w){f=g;break}l-=w}return f.lines[l]}function js(o,l,f){var d=[],g=l.line;return o.iter(l.line,f.line+1,function(w){var b=w.text;g==f.line&&(b=b.slice(0,f.ch)),g==l.line&&(b=b.slice(l.ch)),d.push(b),++g}),d}function Ch(o,l,f){var d=[];return o.iter(l,f,function(g){d.push(g.text)}),d}function Ys(o,l){var f=l-o.height;if(f)for(var d=o;d;d=d.parent)d.height+=f}function Ut(o){if(o.parent==null)return null;for(var l=o.parent,f=F(l.lines,o),d=l.parent;d;l=d,d=d.parent)for(var g=0;d.children[g]!=l;++g)f+=d.children[g].chunkSize();return f+l.first}function $l(o,l){var f=o.first;e:do{for(var d=0;d<o.children.length;++d){var g=o.children[d],w=g.height;if(l<w){o=g;continue e}l-=w,f+=g.chunkSize()}return f}while(!o.lines);for(var b=0;b<o.lines.length;++b){var T=o.lines[b],O=T.height;if(l<O)break;l-=O}return f+b}function wd(o,l){return l>=o.first&&l<o.first+o.size}function uC(o,l){return String(o.lineNumberFormatter(l+o.firstLineNumber))}function _e(o,l,f){if(f===void 0&&(f=null),!(this instanceof _e))return new _e(o,l,f);this.line=o,this.ch=l,this.sticky=f}function ot(o,l){return o.line-l.line||o.ch-l.ch}function hC(o,l){return o.sticky==l.sticky&&ot(o,l)==0}function cC(o){return _e(o.line,o.ch)}function xm(o,l){return ot(o,l)<0?l:o}function Mm(o,l){return ot(o,l)<0?o:l}function XM(o,l){return Math.max(o.first,Math.min(l,o.first+o.size-1))}function at(o,l){if(l.line<o.first)return _e(o.first,0);var f=o.first+o.size-1;return l.line>f?_e(f,Fe(o,f).text.length):az(l,Fe(o,l.line).text.length)}function az(o,l){var f=o.ch;return f==null||f>l?_e(o.line,l):f<0?_e(o.line,0):o}function ZM(o,l){for(var f=[],d=0;d<l.length;d++)f[d]=at(o,l[d]);return f}var Im=function(o,l){this.state=o,this.lookAhead=l},Gs=function(o,l,f,d){this.state=l,this.doc=o,this.line=f,this.maxLookAhead=d||0,this.baseTokens=null,this.baseTokenPos=1};Gs.prototype.lookAhead=function(o){var l=this.doc.getLine(this.line+o);return l!=null&&o>this.maxLookAhead&&(this.maxLookAhead=o),l},Gs.prototype.baseToken=function(o){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=o;)this.baseTokenPos+=2;var l=this.baseTokens[this.baseTokenPos+1];return{type:l&&l.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-o}},Gs.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},Gs.fromSaved=function(o,l,f){return l instanceof Im?new Gs(o,lr(o.mode,l.state),f,l.lookAhead):new Gs(o,lr(o.mode,l),f)},Gs.prototype.save=function(o){var l=o!==!1?lr(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new Im(l,this.maxLookAhead):l};function QM(o,l,f,d){var g=[o.state.modeGen],w={};iI(o,l.text,o.doc.mode,f,function(N,q){return g.push(N,q)},w,d);for(var b=f.state,T=function(N){f.baseTokens=g;var q=o.state.overlays[N],Q=1,he=0;f.state=!0,iI(o,l.text,q.mode,f,function(oe,pe){for(var Ce=Q;he<oe;){var Te=g[Q];Te>oe&&g.splice(Q,1,oe,g[Q+1],Te),Q+=2,he=Math.min(oe,Te)}if(pe)if(q.opaque)g.splice(Ce,Q-Ce,oe,"overlay "+pe),Q=Ce+2;else for(;Ce<Q;Ce+=2){var Oe=g[Ce+1];g[Ce+1]=(Oe?Oe+" ":"")+"overlay "+pe}},w),f.state=b,f.baseTokens=null,f.baseTokenPos=1},O=0;O<o.state.overlays.length;++O)T(O);return{styles:g,classes:w.bgClass||w.textClass?w:null}}function JM(o,l,f){if(!l.styles||l.styles[0]!=o.state.modeGen){var d=yd(o,Ut(l)),g=l.text.length>o.options.maxHighlightLength&&lr(o.doc.mode,d.state),w=QM(o,l,d);g&&(d.state=g),l.stateAfter=d.save(!g),l.styles=w.styles,w.classes?l.styleClasses=w.classes:l.styleClasses&&(l.styleClasses=null),f===o.doc.highlightFrontier&&(o.doc.modeFrontier=Math.max(o.doc.modeFrontier,++o.doc.highlightFrontier))}return l.styles}function yd(o,l,f){var d=o.doc,g=o.display;if(!d.mode.startState)return new Gs(d,!0,l);var w=lz(o,l,f),b=w>d.first&&Fe(d,w-1).stateAfter,T=b?Gs.fromSaved(d,b,w):new Gs(d,Ei(d.mode),w);return d.iter(w,l,function(O){dC(o,O.text,T);var N=T.line;O.stateAfter=N==l-1||N%5==0||N>=g.viewFrom&&N<g.viewTo?T.save():null,T.nextLine()}),f&&(d.modeFrontier=T.line),T}function dC(o,l,f,d){var g=o.doc.mode,w=new rr(l,o.options.tabSize,f);for(w.start=w.pos=d||0,l==""&&eI(g,f.state);!w.eol();)fC(g,w,f.state),w.start=w.pos}function eI(o,l){if(o.blankLine)return o.blankLine(l);if(o.innerMode){var f=gn(o,l);if(f.mode.blankLine)return f.mode.blankLine(f.state)}}function fC(o,l,f,d){for(var g=0;g<10;g++){d&&(d[0]=gn(o,f).mode);var w=o.token(l,f);if(l.pos>l.start)return w}throw new Error("Mode "+o.name+" failed to advance stream.")}var tI=function(o,l,f){this.start=o.start,this.end=o.pos,this.string=o.current(),this.type=l||null,this.state=f};function rI(o,l,f,d){var g=o.doc,w=g.mode,b;l=at(g,l);var T=Fe(g,l.line),O=yd(o,l.line,f),N=new rr(T.text,o.options.tabSize,O),q;for(d&&(q=[]);(d||N.pos<l.ch)&&!N.eol();)N.start=N.pos,b=fC(w,N,O.state),d&&q.push(new tI(N,b,lr(g.mode,O.state)));return d?q:new tI(N,b,O.state)}function nI(o,l){if(o)for(;;){var f=o.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!f)break;o=o.slice(0,f.index)+o.slice(f.index+f[0].length);var d=f[1]?"bgClass":"textClass";l[d]==null?l[d]=f[2]:new RegExp("(?:^|\\s)"+f[2]+"(?:$|\\s)").test(l[d])||(l[d]+=" "+f[2])}return o}function iI(o,l,f,d,g,w,b){var T=f.flattenSpans;T==null&&(T=o.options.flattenSpans);var O=0,N=null,q=new rr(l,o.options.tabSize,d),Q,he=o.options.addModeClass&&[null];for(l==""&&nI(eI(f,d.state),w);!q.eol();){if(q.pos>o.options.maxHighlightLength?(T=!1,b&&dC(o,l,d,q.pos),q.pos=l.length,Q=null):Q=nI(fC(f,q,d.state,he),w),he){var oe=he[0].name;oe&&(Q="m-"+(Q?oe+" "+Q:oe))}if(!T||N!=Q){for(;O<q.start;)O=Math.min(q.start,O+5e3),g(O,N);N=Q}q.start=q.pos}for(;O<q.pos;){var pe=Math.min(q.pos,O+5e3);g(pe,N),O=pe}}function lz(o,l,f){for(var d,g,w=o.doc,b=f?-1:l-(o.doc.mode.innerMode?1e3:100),T=l;T>b;--T){if(T<=w.first)return w.first;var O=Fe(w,T-1),N=O.stateAfter;if(N&&(!f||T+(N instanceof Im?N.lookAhead:0)<=w.modeFrontier))return T;var q=Se(O.text,null,o.options.tabSize);(g==null||d>q)&&(g=T-1,d=q)}return g}function uz(o,l){if(o.modeFrontier=Math.min(o.modeFrontier,l),!(o.highlightFrontier<l-10)){for(var f=o.first,d=l-1;d>f;d--){var g=Fe(o,d).stateAfter;if(g&&(!(g instanceof Im)||d+g.lookAhead<l)){f=d+1;break}}o.highlightFrontier=Math.min(o.highlightFrontier,f)}}var sI=!1,Wo=!1;function hz(){sI=!0}function cz(){Wo=!0}function Om(o,l,f){this.marker=o,this.from=l,this.to=f}function Cd(o,l){if(o)for(var f=0;f<o.length;++f){var d=o[f];if(d.marker==l)return d}}function dz(o,l){for(var f,d=0;d<o.length;++d)o[d]!=l&&(f||(f=[])).push(o[d]);return f}function fz(o,l,f){var d=f&&window.WeakSet&&(f.markedSpans||(f.markedSpans=new WeakSet));d&&o.markedSpans&&d.has(o.markedSpans)?o.markedSpans.push(l):(o.markedSpans=o.markedSpans?o.markedSpans.concat([l]):[l],d&&d.add(o.markedSpans)),l.marker.attachLine(o)}function gz(o,l,f){var d;if(o)for(var g=0;g<o.length;++g){var w=o[g],b=w.marker,T=w.from==null||(b.inclusiveLeft?w.from<=l:w.from<l);if(T||w.from==l&&b.type=="bookmark"&&(!f||!w.marker.insertLeft)){var O=w.to==null||(b.inclusiveRight?w.to>=l:w.to>l);(d||(d=[])).push(new Om(b,w.from,O?null:w.to))}}return d}function mz(o,l,f){var d;if(o)for(var g=0;g<o.length;++g){var w=o[g],b=w.marker,T=w.to==null||(b.inclusiveRight?w.to>=l:w.to>l);if(T||w.from==l&&b.type=="bookmark"&&(!f||w.marker.insertLeft)){var O=w.from==null||(b.inclusiveLeft?w.from<=l:w.from<l);(d||(d=[])).push(new Om(b,O?null:w.from-l,w.to==null?null:w.to-l))}}return d}function gC(o,l){if(l.full)return null;var f=wd(o,l.from.line)&&Fe(o,l.from.line).markedSpans,d=wd(o,l.to.line)&&Fe(o,l.to.line).markedSpans;if(!f&&!d)return null;var g=l.from.ch,w=l.to.ch,b=ot(l.from,l.to)==0,T=gz(f,g,b),O=mz(d,w,b),N=l.text.length==1,q=G(l.text).length+(N?g:0);if(T)for(var Q=0;Q<T.length;++Q){var he=T[Q];if(he.to==null){var oe=Cd(O,he.marker);oe?N&&(he.to=oe.to==null?null:oe.to+q):he.to=g}}if(O)for(var pe=0;pe<O.length;++pe){var Ce=O[pe];if(Ce.to!=null&&(Ce.to+=q),Ce.from==null){var Te=Cd(T,Ce.marker);Te||(Ce.from=q,N&&(T||(T=[])).push(Ce))}else Ce.from+=q,N&&(T||(T=[])).push(Ce)}T&&(T=oI(T)),O&&O!=T&&(O=oI(O));var Oe=[T];if(!N){var De=l.text.length-2,Pe;if(De>0&&T)for(var Ve=0;Ve<T.length;++Ve)T[Ve].to==null&&(Pe||(Pe=[])).push(new Om(T[Ve].marker,null,null));for(var et=0;et<De;++et)Oe.push(Pe);Oe.push(O)}return Oe}function oI(o){for(var l=0;l<o.length;++l){var f=o[l];f.from!=null&&f.from==f.to&&f.marker.clearWhenEmpty!==!1&&o.splice(l--,1)}return o.length?o:null}function pz(o,l,f){var d=null;if(o.iter(l.line,f.line+1,function(oe){if(oe.markedSpans)for(var pe=0;pe<oe.markedSpans.length;++pe){var Ce=oe.markedSpans[pe].marker;Ce.readOnly&&(!d||F(d,Ce)==-1)&&(d||(d=[])).push(Ce)}}),!d)return null;for(var g=[{from:l,to:f}],w=0;w<d.length;++w)for(var b=d[w],T=b.find(0),O=0;O<g.length;++O){var N=g[O];if(!(ot(N.to,T.from)<0||ot(N.from,T.to)>0)){var q=[O,1],Q=ot(N.from,T.from),he=ot(N.to,T.to);(Q<0||!b.inclusiveLeft&&!Q)&&q.push({from:N.from,to:T.from}),(he>0||!b.inclusiveRight&&!he)&&q.push({from:T.to,to:N.to}),g.splice.apply(g,q),O+=q.length-3}}return g}function aI(o){var l=o.markedSpans;if(l){for(var f=0;f<l.length;++f)l[f].marker.detachLine(o);o.markedSpans=null}}function lI(o,l){if(l){for(var f=0;f<l.length;++f)l[f].marker.attachLine(o);o.markedSpans=l}}function Pm(o){return o.inclusiveLeft?-1:0}function Am(o){return o.inclusiveRight?1:0}function mC(o,l){var f=o.lines.length-l.lines.length;if(f!=0)return f;var d=o.find(),g=l.find(),w=ot(d.from,g.from)||Pm(o)-Pm(l);if(w)return-w;var b=ot(d.to,g.to)||Am(o)-Am(l);return b||l.id-o.id}function uI(o,l){var f=Wo&&o.markedSpans,d;if(f)for(var g=void 0,w=0;w<f.length;++w)g=f[w],g.marker.collapsed&&(l?g.from:g.to)==null&&(!d||mC(d,g.marker)<0)&&(d=g.marker);return d}function hI(o){return uI(o,!0)}function Hm(o){return uI(o,!1)}function vz(o,l){var f=Wo&&o.markedSpans,d;if(f)for(var g=0;g<f.length;++g){var w=f[g];w.marker.collapsed&&(w.from==null||w.from<l)&&(w.to==null||w.to>l)&&(!d||mC(d,w.marker)<0)&&(d=w.marker)}return d}function cI(o,l,f,d,g){var w=Fe(o,l),b=Wo&&w.markedSpans;if(b)for(var T=0;T<b.length;++T){var O=b[T];if(O.marker.collapsed){var N=O.marker.find(0),q=ot(N.from,f)||Pm(O.marker)-Pm(g),Q=ot(N.to,d)||Am(O.marker)-Am(g);if(!(q>=0&&Q<=0||q<=0&&Q>=0)&&(q<=0&&(O.marker.inclusiveRight&&g.inclusiveLeft?ot(N.to,f)>=0:ot(N.to,f)>0)||q>=0&&(O.marker.inclusiveRight&&g.inclusiveLeft?ot(N.from,d)<=0:ot(N.from,d)<0)))return!0}}}function hs(o){for(var l;l=hI(o);)o=l.find(-1,!0).line;return o}function wz(o){for(var l;l=Hm(o);)o=l.find(1,!0).line;return o}function yz(o){for(var l,f;l=Hm(o);)o=l.find(1,!0).line,(f||(f=[])).push(o);return f}function pC(o,l){var f=Fe(o,l),d=hs(f);return f==d?l:Ut(d)}function dI(o,l){if(l>o.lastLine())return l;var f=Fe(o,l),d;if(!Fa(o,f))return l;for(;d=Hm(f);)f=d.find(1,!0).line;return Ut(f)+1}function Fa(o,l){var f=Wo&&l.markedSpans;if(f){for(var d=void 0,g=0;g<f.length;++g)if(d=f[g],!!d.marker.collapsed){if(d.from==null)return!0;if(!d.marker.widgetNode&&d.from==0&&d.marker.inclusiveLeft&&vC(o,l,d))return!0}}}function vC(o,l,f){if(f.to==null){var d=f.marker.find(1,!0);return vC(o,d.line,Cd(d.line.markedSpans,f.marker))}if(f.marker.inclusiveRight&&f.to==l.text.length)return!0;for(var g=void 0,w=0;w<l.markedSpans.length;++w)if(g=l.markedSpans[w],g.marker.collapsed&&!g.marker.widgetNode&&g.from==f.to&&(g.to==null||g.to!=f.from)&&(g.marker.inclusiveLeft||f.marker.inclusiveRight)&&vC(o,l,g))return!0}function Bo(o){o=hs(o);for(var l=0,f=o.parent,d=0;d<f.lines.length;++d){var g=f.lines[d];if(g==o)break;l+=g.height}for(var w=f.parent;w;f=w,w=f.parent)for(var b=0;b<w.children.length;++b){var T=w.children[b];if(T==f)break;l+=T.height}return l}function Nm(o){if(o.height==0)return 0;for(var l=o.text.length,f,d=o;f=hI(d);){var g=f.find(0,!0);d=g.from.line,l+=g.from.ch-g.to.ch}for(d=o;f=Hm(d);){var w=f.find(0,!0);l-=d.text.length-w.from.ch,d=w.to.line,l+=d.text.length-w.to.ch}return l}function wC(o){var l=o.display,f=o.doc;l.maxLine=Fe(f,f.first),l.maxLineLength=Nm(l.maxLine),l.maxLineChanged=!0,f.iter(function(d){var g=Nm(d);g>l.maxLineLength&&(l.maxLineLength=g,l.maxLine=d)})}var bh=function(o,l,f){this.text=o,lI(this,l),this.height=f?f(this):1};bh.prototype.lineNo=function(){return Ut(this)},Ri(bh);function Cz(o,l,f,d){o.text=l,o.stateAfter&&(o.stateAfter=null),o.styles&&(o.styles=null),o.order!=null&&(o.order=null),aI(o),lI(o,f);var g=d?d(o):1;g!=o.height&&Ys(o,g)}function bz(o){o.parent=null,aI(o)}var Sz={},Rz={};function fI(o,l){if(!o||/^\s*$/.test(o))return null;var f=l.addModeClass?Rz:Sz;return f[o]||(f[o]=o.replace(/\S+/g,"cm-$&"))}function gI(o,l){var f=Le("span",null,null,m?"padding-right: .1px":null),d={pre:Le("pre",[f],"CodeMirror-line"),content:f,col:0,pos:0,cm:o,trailingSpace:!1,splitSpaces:o.getOption("lineWrapping")};l.measure={};for(var g=0;g<=(l.rest?l.rest.length:0);g++){var w=g?l.rest[g-1]:l.line,b=void 0;d.pos=0,d.addToken=_z,vd(o.display.measure)&&(b=st(w,o.doc.direction))&&(d.addToken=xz(d.addToken,b)),d.map=[];var T=l!=o.display.externalMeasured&&Ut(w);Mz(w,d,JM(o,w,T)),w.styleClasses&&(w.styleClasses.bgClass&&(d.bgClass=E(w.styleClasses.bgClass,d.bgClass||"")),w.styleClasses.textClass&&(d.textClass=E(w.styleClasses.textClass,d.textClass||""))),d.map.length==0&&d.map.push(0,0,d.content.appendChild(Em(o.display.measure))),g==0?(l.measure.map=d.map,l.measure.cache={}):((l.measure.maps||(l.measure.maps=[])).push(d.map),(l.measure.caches||(l.measure.caches=[])).push({}))}if(m){var O=d.content.lastChild;(/\bcm-tab\b/.test(O.className)||O.querySelector&&O.querySelector(".cm-tab"))&&(d.content.className="cm-tab-wrap-hack")}return Nt(o,"renderLine",o,l.line,d.pre),d.pre.className&&(d.textClass=E(d.pre.className,d.textClass||"")),d}function Ez(o){var l=ie("span","•","cm-invalidchar");return l.title="\\u"+o.charCodeAt(0).toString(16),l.setAttribute("aria-label",l.title),l}function _z(o,l,f,d,g,w,b){if(l){var T=o.splitSpaces?Tz(l,o.trailingSpace):l,O=o.cm.state.specialChars,N=!1,q;if(!O.test(l))o.col+=l.length,q=document.createTextNode(T),o.map.push(o.pos,o.pos+l.length,q),h&&c<9&&(N=!0),o.pos+=l.length;else{q=document.createDocumentFragment();for(var Q=0;;){O.lastIndex=Q;var he=O.exec(l),oe=he?he.index-Q:l.length-Q;if(oe){var pe=document.createTextNode(T.slice(Q,Q+oe));h&&c<9?q.appendChild(ie("span",[pe])):q.appendChild(pe),o.map.push(o.pos,o.pos+oe,pe),o.col+=oe,o.pos+=oe}if(!he)break;Q+=oe+1;var Ce=void 0;if(he[0]=="	"){var Te=o.cm.options.tabSize,Oe=Te-o.col%Te;Ce=q.appendChild(ie("span",V(Oe),"cm-tab")),Ce.setAttribute("role","presentation"),Ce.setAttribute("cm-text","	"),o.col+=Oe}else he[0]=="\r"||he[0]==`
`?(Ce=q.appendChild(ie("span",he[0]=="\r"?"␍":"␤","cm-invalidchar")),Ce.setAttribute("cm-text",he[0]),o.col+=1):(Ce=o.cm.options.specialCharPlaceholder(he[0]),Ce.setAttribute("cm-text",he[0]),h&&c<9?q.appendChild(ie("span",[Ce])):q.appendChild(Ce),o.col+=1);o.map.push(o.pos,o.pos+1,Ce),o.pos++}}if(o.trailingSpace=T.charCodeAt(l.length-1)==32,f||d||g||N||w||b){var De=f||"";d&&(De+=d),g&&(De+=g);var Pe=ie("span",[q],De,w);if(b)for(var Ve in b)b.hasOwnProperty(Ve)&&Ve!="style"&&Ve!="class"&&Pe.setAttribute(Ve,b[Ve]);return o.content.appendChild(Pe)}o.content.appendChild(q)}}function Tz(o,l){if(o.length>1&&!/  /.test(o))return o;for(var f=l,d="",g=0;g<o.length;g++){var w=o.charAt(g);w==" "&&f&&(g==o.length-1||o.charCodeAt(g+1)==32)&&(w=" "),d+=w,f=w==" "}return d}function xz(o,l){return function(f,d,g,w,b,T,O){g=g?g+" cm-force-border":"cm-force-border";for(var N=f.pos,q=N+d.length;;){for(var Q=void 0,he=0;he<l.length&&(Q=l[he],!(Q.to>N&&Q.from<=N));he++);if(Q.to>=q)return o(f,d,g,w,b,T,O);o(f,d.slice(0,Q.to-N),g,w,null,T,O),w=null,d=d.slice(Q.to-N),N=Q.to}}}function mI(o,l,f,d){var g=!d&&f.widgetNode;g&&o.map.push(o.pos,o.pos+l,g),!d&&o.cm.display.input.needsContentAttribute&&(g||(g=o.content.appendChild(document.createElement("span"))),g.setAttribute("cm-marker",f.id)),g&&(o.cm.display.input.setUneditable(g),o.content.appendChild(g)),o.pos+=l,o.trailingSpace=!1}function Mz(o,l,f){var d=o.markedSpans,g=o.text,w=0;if(!d){for(var b=1;b<f.length;b+=2)l.addToken(l,g.slice(w,w=f[b]),fI(f[b+1],l.cm.options));return}for(var T=g.length,O=0,N=1,q="",Q,he,oe=0,pe,Ce,Te,Oe,De;;){if(oe==O){pe=Ce=Te=he="",De=null,Oe=null,oe=1/0;for(var Pe=[],Ve=void 0,et=0;et<d.length;++et){var Qe=d[et],gt=Qe.marker;if(gt.type=="bookmark"&&Qe.from==O&&gt.widgetNode)Pe.push(gt);else if(Qe.from<=O&&(Qe.to==null||Qe.to>O||gt.collapsed&&Qe.to==O&&Qe.from==O)){if(Qe.to!=null&&Qe.to!=O&&oe>Qe.to&&(oe=Qe.to,Ce=""),gt.className&&(pe+=" "+gt.className),gt.css&&(he=(he?he+";":"")+gt.css),gt.startStyle&&Qe.from==O&&(Te+=" "+gt.startStyle),gt.endStyle&&Qe.to==oe&&(Ve||(Ve=[])).push(gt.endStyle,Qe.to),gt.title&&((De||(De={})).title=gt.title),gt.attributes)for(var Qt in gt.attributes)(De||(De={}))[Qt]=gt.attributes[Qt];gt.collapsed&&(!Oe||mC(Oe.marker,gt)<0)&&(Oe=Qe)}else Qe.from>O&&oe>Qe.from&&(oe=Qe.from)}if(Ve)for(var nn=0;nn<Ve.length;nn+=2)Ve[nn+1]==oe&&(Ce+=" "+Ve[nn]);if(!Oe||Oe.from==O)for(var vr=0;vr<Pe.length;++vr)mI(l,0,Pe[vr]);if(Oe&&(Oe.from||0)==O){if(mI(l,(Oe.to==null?T+1:Oe.to)-O,Oe.marker,Oe.from==null),Oe.to==null)return;Oe.to==O&&(Oe=!1)}}if(O>=T)break;for(var ai=Math.min(T,oe);;){if(q){var jn=O+q.length;if(!Oe){var $r=jn>ai?q.slice(0,ai-O):q;l.addToken(l,$r,Q?Q+pe:pe,Te,O+$r.length==oe?Ce:"",he,De)}if(jn>=ai){q=q.slice(ai-O),O=ai;break}O=jn,Te=""}q=g.slice(w,w=f[N++]),Q=fI(f[N++],l.cm.options)}}}function pI(o,l,f){this.line=l,this.rest=yz(l),this.size=this.rest?Ut(G(this.rest))-f+1:1,this.node=this.text=null,this.hidden=Fa(o,l)}function km(o,l,f){for(var d=[],g,w=l;w<f;w=g){var b=new pI(o.doc,Fe(o.doc,w),w);g=w+b.size,d.push(b)}return d}var Sh=null;function Iz(o){Sh?Sh.ops.push(o):o.ownsGroup=Sh={ops:[o],delayedCallbacks:[]}}function Oz(o){var l=o.delayedCallbacks,f=0;do{for(;f<l.length;f++)l[f].call(null);for(var d=0;d<o.ops.length;d++){var g=o.ops[d];if(g.cursorActivityHandlers)for(;g.cursorActivityCalled<g.cursorActivityHandlers.length;)g.cursorActivityHandlers[g.cursorActivityCalled++].call(null,g.cm)}}while(f<l.length)}function Pz(o,l){var f=o.ownsGroup;if(f)try{Oz(f)}finally{Sh=null,l(f)}}var bd=null;function en(o,l){var f=Us(o,l);if(f.length){var d=Array.prototype.slice.call(arguments,2),g;Sh?g=Sh.delayedCallbacks:bd?g=bd:(g=bd=[],setTimeout(Az,0));for(var w=function(T){g.push(function(){return f[T].apply(null,d)})},b=0;b<f.length;++b)w(b)}}function Az(){var o=bd;bd=null;for(var l=0;l<o.length;++l)o[l]()}function vI(o,l,f,d){for(var g=0;g<l.changes.length;g++){var w=l.changes[g];w=="text"?Nz(o,l):w=="gutter"?yI(o,l,f,d):w=="class"?yC(o,l):w=="widget"&&kz(o,l,d)}l.changes=null}function Sd(o){return o.node==o.text&&(o.node=ie("div",null,null,"position: relative"),o.text.parentNode&&o.text.parentNode.replaceChild(o.node,o.text),o.node.appendChild(o.text),h&&c<8&&(o.node.style.zIndex=2)),o.node}function Hz(o,l){var f=l.bgClass?l.bgClass+" "+(l.line.bgClass||""):l.line.bgClass;if(f&&(f+=" CodeMirror-linebackground"),l.background)f?l.background.className=f:(l.background.parentNode.removeChild(l.background),l.background=null);else if(f){var d=Sd(l);l.background=d.insertBefore(ie("div",null,f),d.firstChild),o.display.input.setUneditable(l.background)}}function wI(o,l){var f=o.display.externalMeasured;return f&&f.line==l.line?(o.display.externalMeasured=null,l.measure=f.measure,f.built):gI(o,l)}function Nz(o,l){var f=l.text.className,d=wI(o,l);l.text==l.node&&(l.node=d.pre),l.text.parentNode.replaceChild(d.pre,l.text),l.text=d.pre,d.bgClass!=l.bgClass||d.textClass!=l.textClass?(l.bgClass=d.bgClass,l.textClass=d.textClass,yC(o,l)):f&&(l.text.className=f)}function yC(o,l){Hz(o,l),l.line.wrapClass?Sd(l).className=l.line.wrapClass:l.node!=l.text&&(l.node.className="");var f=l.textClass?l.textClass+" "+(l.line.textClass||""):l.line.textClass;l.text.className=f||""}function yI(o,l,f,d){if(l.gutter&&(l.node.removeChild(l.gutter),l.gutter=null),l.gutterBackground&&(l.node.removeChild(l.gutterBackground),l.gutterBackground=null),l.line.gutterClass){var g=Sd(l);l.gutterBackground=ie("div",null,"CodeMirror-gutter-background "+l.line.gutterClass,"left: "+(o.options.fixedGutter?d.fixedPos:-d.gutterTotalWidth)+"px; width: "+d.gutterTotalWidth+"px"),o.display.input.setUneditable(l.gutterBackground),g.insertBefore(l.gutterBackground,l.text)}var w=l.line.gutterMarkers;if(o.options.lineNumbers||w){var b=Sd(l),T=l.gutter=ie("div",null,"CodeMirror-gutter-wrapper","left: "+(o.options.fixedGutter?d.fixedPos:-d.gutterTotalWidth)+"px");if(T.setAttribute("aria-hidden","true"),o.display.input.setUneditable(T),b.insertBefore(T,l.text),l.line.gutterClass&&(T.className+=" "+l.line.gutterClass),o.options.lineNumbers&&(!w||!w["CodeMirror-linenumbers"])&&(l.lineNumber=T.appendChild(ie("div",uC(o.options,f),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+d.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+o.display.lineNumInnerWidth+"px"))),w)for(var O=0;O<o.display.gutterSpecs.length;++O){var N=o.display.gutterSpecs[O].className,q=w.hasOwnProperty(N)&&w[N];q&&T.appendChild(ie("div",[q],"CodeMirror-gutter-elt","left: "+d.gutterLeft[N]+"px; width: "+d.gutterWidth[N]+"px"))}}}function kz(o,l,f){l.alignable&&(l.alignable=null);for(var d=fe("CodeMirror-linewidget"),g=l.node.firstChild,w=void 0;g;g=w)w=g.nextSibling,d.test(g.className)&&l.node.removeChild(g);CI(o,l,f)}function Dz(o,l,f,d){var g=wI(o,l);return l.text=l.node=g.pre,g.bgClass&&(l.bgClass=g.bgClass),g.textClass&&(l.textClass=g.textClass),yC(o,l),yI(o,l,f,d),CI(o,l,d),l.node}function CI(o,l,f){if(bI(o,l.line,l,f,!0),l.rest)for(var d=0;d<l.rest.length;d++)bI(o,l.rest[d],l,f,!1)}function bI(o,l,f,d,g){if(l.widgets)for(var w=Sd(f),b=0,T=l.widgets;b<T.length;++b){var O=T[b],N=ie("div",[O.node],"CodeMirror-linewidget"+(O.className?" "+O.className:""));O.handleMouseEvents||N.setAttribute("cm-ignore-events","true"),Lz(O,N,f,d),o.display.input.setUneditable(N),g&&O.above?w.insertBefore(N,f.gutter||f.text):w.appendChild(N),en(O,"redraw")}}function Lz(o,l,f,d){if(o.noHScroll){(f.alignable||(f.alignable=[])).push(l);var g=d.wrapperWidth;l.style.left=d.fixedPos+"px",o.coverGutter||(g-=d.gutterTotalWidth,l.style.paddingLeft=d.gutterTotalWidth+"px"),l.style.width=g+"px"}o.coverGutter&&(l.style.zIndex=5,l.style.position="relative",o.noHScroll||(l.style.marginLeft=-d.gutterTotalWidth+"px"))}function Rd(o){if(o.height!=null)return o.height;var l=o.doc.cm;if(!l)return 0;if(!Ae(document.body,o.node)){var f="position: relative;";o.coverGutter&&(f+="margin-left: -"+l.display.gutters.offsetWidth+"px;"),o.noHScroll&&(f+="width: "+l.display.wrapper.clientWidth+"px;"),P(l.display.measure,ie("div",[o.node],null,f))}return o.height=o.node.parentNode.offsetHeight}function $o(o,l){for(var f=mh(l);f!=o.wrapper;f=f.parentNode)if(!f||f.nodeType==1&&f.getAttribute("cm-ignore-events")=="true"||f.parentNode==o.sizer&&f!=o.mover)return!0}function Dm(o){return o.lineSpace.offsetTop}function CC(o){return o.mover.offsetHeight-o.lineSpace.offsetHeight}function SI(o){if(o.cachedPaddingH)return o.cachedPaddingH;var l=P(o.measure,ie("pre","x","CodeMirror-line-like")),f=window.getComputedStyle?window.getComputedStyle(l):l.currentStyle,d={left:parseInt(f.paddingLeft),right:parseInt(f.paddingRight)};return!isNaN(d.left)&&!isNaN(d.right)&&(o.cachedPaddingH=d),d}function qs(o){return Z-o.display.nativeBarWidth}function Vl(o){return o.display.scroller.clientWidth-qs(o)-o.display.barWidth}function bC(o){return o.display.scroller.clientHeight-qs(o)-o.display.barHeight}function Fz(o,l,f){var d=o.options.lineWrapping,g=d&&Vl(o);if(!l.measure.heights||d&&l.measure.width!=g){var w=l.measure.heights=[];if(d){l.measure.width=g;for(var b=l.text.firstChild.getClientRects(),T=0;T<b.length-1;T++){var O=b[T],N=b[T+1];Math.abs(O.bottom-N.bottom)>2&&w.push((O.bottom+N.top)/2-f.top)}}w.push(f.bottom-f.top)}}function RI(o,l,f){if(o.line==l)return{map:o.measure.map,cache:o.measure.cache};if(o.rest){for(var d=0;d<o.rest.length;d++)if(o.rest[d]==l)return{map:o.measure.maps[d],cache:o.measure.caches[d]};for(var g=0;g<o.rest.length;g++)if(Ut(o.rest[g])>f)return{map:o.measure.maps[g],cache:o.measure.caches[g],before:!0}}}function Wz(o,l){l=hs(l);var f=Ut(l),d=o.display.externalMeasured=new pI(o.doc,l,f);d.lineN=f;var g=d.built=gI(o,d);return d.text=g.pre,P(o.display.lineMeasure,g.pre),d}function EI(o,l,f,d){return Ks(o,Rh(o,l),f,d)}function SC(o,l){if(l>=o.display.viewFrom&&l<o.display.viewTo)return o.display.view[jl(o,l)];var f=o.display.externalMeasured;if(f&&l>=f.lineN&&l<f.lineN+f.size)return f}function Rh(o,l){var f=Ut(l),d=SC(o,f);d&&!d.text?d=null:d&&d.changes&&(vI(o,d,f,xC(o)),o.curOp.forceUpdate=!0),d||(d=Wz(o,l));var g=RI(d,l,f);return{line:l,view:d,rect:null,map:g.map,cache:g.cache,before:g.before,hasHeights:!1}}function Ks(o,l,f,d,g){l.before&&(f=-1);var w=f+(d||""),b;return l.cache.hasOwnProperty(w)?b=l.cache[w]:(l.rect||(l.rect=l.view.text.getBoundingClientRect()),l.hasHeights||(Fz(o,l.view,l.rect),l.hasHeights=!0),b=$z(o,l,f,d),b.bogus||(l.cache[w]=b)),{left:b.left,right:b.right,top:g?b.rtop:b.top,bottom:g?b.rbottom:b.bottom}}var _I={left:0,right:0,top:0,bottom:0};function TI(o,l,f){for(var d,g,w,b,T,O,N=0;N<o.length;N+=3)if(T=o[N],O=o[N+1],l<T?(g=0,w=1,b="left"):l<O?(g=l-T,w=g+1):(N==o.length-3||l==O&&o[N+3]>l)&&(w=O-T,g=w-1,l>=O&&(b="right")),g!=null){if(d=o[N+2],T==O&&f==(d.insertLeft?"left":"right")&&(b=f),f=="left"&&g==0)for(;N&&o[N-2]==o[N-3]&&o[N-1].insertLeft;)d=o[(N-=3)+2],b="left";if(f=="right"&&g==O-T)for(;N<o.length-3&&o[N+3]==o[N+4]&&!o[N+5].insertLeft;)d=o[(N+=3)+2],b="right";break}return{node:d,start:g,end:w,collapse:b,coverStart:T,coverEnd:O}}function Bz(o,l){var f=_I;if(l=="left")for(var d=0;d<o.length&&(f=o[d]).left==f.right;d++);else for(var g=o.length-1;g>=0&&(f=o[g]).left==f.right;g--);return f}function $z(o,l,f,d){var g=TI(l.map,f,d),w=g.node,b=g.start,T=g.end,O=g.collapse,N;if(w.nodeType==3){for(var q=0;q<4;q++){for(;b&&Br(l.line.text.charAt(g.coverStart+b));)--b;for(;g.coverStart+T<g.coverEnd&&Br(l.line.text.charAt(g.coverStart+T));)++T;if(h&&c<9&&b==0&&T==g.coverEnd-g.coverStart?N=w.parentNode.getBoundingClientRect():N=Bz(me(w,b,T).getClientRects(),d),N.left||N.right||b==0)break;T=b,b=b-1,O="right"}h&&c<11&&(N=Vz(o.display.measure,N))}else{b>0&&(O=d="right");var Q;o.options.lineWrapping&&(Q=w.getClientRects()).length>1?N=Q[d=="right"?Q.length-1:0]:N=w.getBoundingClientRect()}if(h&&c<9&&!b&&(!N||!N.left&&!N.right)){var he=w.parentNode.getClientRects()[0];he?N={left:he.left,right:he.left+_h(o.display),top:he.top,bottom:he.bottom}:N=_I}for(var oe=N.top-l.rect.top,pe=N.bottom-l.rect.top,Ce=(oe+pe)/2,Te=l.view.measure.heights,Oe=0;Oe<Te.length-1&&!(Ce<Te[Oe]);Oe++);var De=Oe?Te[Oe-1]:0,Pe=Te[Oe],Ve={left:(O=="right"?N.right:N.left)-l.rect.left,right:(O=="left"?N.left:N.right)-l.rect.left,top:De,bottom:Pe};return!N.left&&!N.right&&(Ve.bogus=!0),o.options.singleCursorHeightPerLine||(Ve.rtop=oe,Ve.rbottom=pe),Ve}function Vz(o,l){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Tm(o))return l;var f=screen.logicalXDPI/screen.deviceXDPI,d=screen.logicalYDPI/screen.deviceYDPI;return{left:l.left*f,right:l.right*f,top:l.top*d,bottom:l.bottom*d}}function xI(o){if(o.measure&&(o.measure.cache={},o.measure.heights=null,o.rest))for(var l=0;l<o.rest.length;l++)o.measure.caches[l]={}}function MI(o){o.display.externalMeasure=null,ae(o.display.lineMeasure);for(var l=0;l<o.display.view.length;l++)xI(o.display.view[l])}function Ed(o){MI(o),o.display.cachedCharWidth=o.display.cachedTextHeight=o.display.cachedPaddingH=null,o.options.lineWrapping||(o.display.maxLineChanged=!0),o.display.lineNumChars=null}function II(o){return v&&k?-(o.body.getBoundingClientRect().left-parseInt(getComputedStyle(o.body).marginLeft)):o.defaultView.pageXOffset||(o.documentElement||o.body).scrollLeft}function OI(o){return v&&k?-(o.body.getBoundingClientRect().top-parseInt(getComputedStyle(o.body).marginTop)):o.defaultView.pageYOffset||(o.documentElement||o.body).scrollTop}function RC(o){var l=hs(o),f=l.widgets,d=0;if(f)for(var g=0;g<f.length;++g)f[g].above&&(d+=Rd(f[g]));return d}function Lm(o,l,f,d,g){if(!g){var w=RC(l);f.top+=w,f.bottom+=w}if(d=="line")return f;d||(d="local");var b=Bo(l);if(d=="local"?b+=Dm(o.display):b-=o.display.viewOffset,d=="page"||d=="window"){var T=o.display.lineSpace.getBoundingClientRect();b+=T.top+(d=="window"?0:OI(D(o)));var O=T.left+(d=="window"?0:II(D(o)));f.left+=O,f.right+=O}return f.top+=b,f.bottom+=b,f}function PI(o,l,f){if(f=="div")return l;var d=l.left,g=l.top;if(f=="page")d-=II(D(o)),g-=OI(D(o));else if(f=="local"||!f){var w=o.display.sizer.getBoundingClientRect();d+=w.left,g+=w.top}var b=o.display.lineSpace.getBoundingClientRect();return{left:d-b.left,top:g-b.top}}function Fm(o,l,f,d,g){return d||(d=Fe(o.doc,l.line)),Lm(o,d,EI(o,d,l.ch,g),f)}function cs(o,l,f,d,g,w){d=d||Fe(o.doc,l.line),g||(g=Rh(o,d));function b(pe,Ce){var Te=Ks(o,g,pe,Ce?"right":"left",w);return Ce?Te.left=Te.right:Te.right=Te.left,Lm(o,d,Te,f)}var T=st(d,o.doc.direction),O=l.ch,N=l.sticky;if(O>=d.text.length?(O=d.text.length,N="before"):O<=0&&(O=0,N="after"),!T)return b(N=="before"?O-1:O,N=="before");function q(pe,Ce,Te){var Oe=T[Ce],De=Oe.level==1;return b(Te?pe-1:pe,De!=Te)}var Q=Mt(T,O,N),he=Ht,oe=q(O,Q,N=="before");return he!=null&&(oe.other=q(O,he,N!="before")),oe}function AI(o,l){var f=0;l=at(o.doc,l),o.options.lineWrapping||(f=_h(o.display)*l.ch);var d=Fe(o.doc,l.line),g=Bo(d)+Dm(o.display);return{left:f,right:f,top:g,bottom:g+d.height}}function EC(o,l,f,d,g){var w=_e(o,l,f);return w.xRel=g,d&&(w.outside=d),w}function _C(o,l,f){var d=o.doc;if(f+=o.display.viewOffset,f<0)return EC(d.first,0,null,-1,-1);var g=$l(d,f),w=d.first+d.size-1;if(g>w)return EC(d.first+d.size-1,Fe(d,w).text.length,null,1,1);l<0&&(l=0);for(var b=Fe(d,g);;){var T=zz(o,b,g,l,f),O=vz(b,T.ch+(T.xRel>0||T.outside>0?1:0));if(!O)return T;var N=O.find(1);if(N.line==g)return N;b=Fe(d,g=N.line)}}function HI(o,l,f,d){d-=RC(l);var g=l.text.length,w=zt(function(b){return Ks(o,f,b-1).bottom<=d},g,0);return g=zt(function(b){return Ks(o,f,b).top>d},w,g),{begin:w,end:g}}function NI(o,l,f,d){f||(f=Rh(o,l));var g=Lm(o,l,Ks(o,f,d),"line").top;return HI(o,l,f,g)}function TC(o,l,f,d){return o.bottom<=f?!1:o.top>f?!0:(d?o.left:o.right)>l}function zz(o,l,f,d,g){g-=Bo(l);var w=Rh(o,l),b=RC(l),T=0,O=l.text.length,N=!0,q=st(l,o.doc.direction);if(q){var Q=(o.options.lineWrapping?jz:Uz)(o,l,f,w,q,d,g);N=Q.level!=1,T=N?Q.from:Q.to-1,O=N?Q.to:Q.from-1}var he=null,oe=null,pe=zt(function(et){var Qe=Ks(o,w,et);return Qe.top+=b,Qe.bottom+=b,TC(Qe,d,g,!1)?(Qe.top<=g&&Qe.left<=d&&(he=et,oe=Qe),!0):!1},T,O),Ce,Te,Oe=!1;if(oe){var De=d-oe.left<oe.right-d,Pe=De==N;pe=he+(Pe?0:1),Te=Pe?"after":"before",Ce=De?oe.left:oe.right}else{!N&&(pe==O||pe==T)&&pe++,Te=pe==0?"after":pe==l.text.length?"before":Ks(o,w,pe-(N?1:0)).bottom+b<=g==N?"after":"before";var Ve=cs(o,_e(f,pe,Te),"line",l,w);Ce=Ve.left,Oe=g<Ve.top?-1:g>=Ve.bottom?1:0}return pe=pr(l.text,pe,1),EC(f,pe,Te,Oe,d-Ce)}function Uz(o,l,f,d,g,w,b){var T=zt(function(Q){var he=g[Q],oe=he.level!=1;return TC(cs(o,_e(f,oe?he.to:he.from,oe?"before":"after"),"line",l,d),w,b,!0)},0,g.length-1),O=g[T];if(T>0){var N=O.level!=1,q=cs(o,_e(f,N?O.from:O.to,N?"after":"before"),"line",l,d);TC(q,w,b,!0)&&q.top>b&&(O=g[T-1])}return O}function jz(o,l,f,d,g,w,b){var T=HI(o,l,d,b),O=T.begin,N=T.end;/\s/.test(l.text.charAt(N-1))&&N--;for(var q=null,Q=null,he=0;he<g.length;he++){var oe=g[he];if(!(oe.from>=N||oe.to<=O)){var pe=oe.level!=1,Ce=Ks(o,d,pe?Math.min(N,oe.to)-1:Math.max(O,oe.from)).right,Te=Ce<w?w-Ce+1e9:Ce-w;(!q||Q>Te)&&(q=oe,Q=Te)}}return q||(q=g[g.length-1]),q.from<O&&(q={from:O,to:q.to,level:q.level}),q.to>N&&(q={from:q.from,to:N,level:q.level}),q}var zl;function Eh(o){if(o.cachedTextHeight!=null)return o.cachedTextHeight;if(zl==null){zl=ie("pre",null,"CodeMirror-line-like");for(var l=0;l<49;++l)zl.appendChild(document.createTextNode("x")),zl.appendChild(ie("br"));zl.appendChild(document.createTextNode("x"))}P(o.measure,zl);var f=zl.offsetHeight/50;return f>3&&(o.cachedTextHeight=f),ae(o.measure),f||1}function _h(o){if(o.cachedCharWidth!=null)return o.cachedCharWidth;var l=ie("span","xxxxxxxxxx"),f=ie("pre",[l],"CodeMirror-line-like");P(o.measure,f);var d=l.getBoundingClientRect(),g=(d.right-d.left)/10;return g>2&&(o.cachedCharWidth=g),g||10}function xC(o){for(var l=o.display,f={},d={},g=l.gutters.clientLeft,w=l.gutters.firstChild,b=0;w;w=w.nextSibling,++b){var T=o.display.gutterSpecs[b].className;f[T]=w.offsetLeft+w.clientLeft+g,d[T]=w.clientWidth}return{fixedPos:MC(l),gutterTotalWidth:l.gutters.offsetWidth,gutterLeft:f,gutterWidth:d,wrapperWidth:l.wrapper.clientWidth}}function MC(o){return o.scroller.getBoundingClientRect().left-o.sizer.getBoundingClientRect().left}function kI(o){var l=Eh(o.display),f=o.options.lineWrapping,d=f&&Math.max(5,o.display.scroller.clientWidth/_h(o.display)-3);return function(g){if(Fa(o.doc,g))return 0;var w=0;if(g.widgets)for(var b=0;b<g.widgets.length;b++)g.widgets[b].height&&(w+=g.widgets[b].height);return f?w+(Math.ceil(g.text.length/d)||1)*l:w+l}}function IC(o){var l=o.doc,f=kI(o);l.iter(function(d){var g=f(d);g!=d.height&&Ys(d,g)})}function Ul(o,l,f,d){var g=o.display;if(!f&&mh(l).getAttribute("cm-not-content")=="true")return null;var w,b,T=g.lineSpace.getBoundingClientRect();try{w=l.clientX-T.left,b=l.clientY-T.top}catch{return null}var O=_C(o,w,b),N;if(d&&O.xRel>0&&(N=Fe(o.doc,O.line).text).length==O.ch){var q=Se(N,N.length,o.options.tabSize)-N.length;O=_e(O.line,Math.max(0,Math.round((w-SI(o.display).left)/_h(o.display))-q))}return O}function jl(o,l){if(l>=o.display.viewTo||(l-=o.display.viewFrom,l<0))return null;for(var f=o.display.view,d=0;d<f.length;d++)if(l-=f[d].size,l<0)return d}function zn(o,l,f,d){l==null&&(l=o.doc.first),f==null&&(f=o.doc.first+o.doc.size),d||(d=0);var g=o.display;if(d&&f<g.viewTo&&(g.updateLineNumbers==null||g.updateLineNumbers>l)&&(g.updateLineNumbers=l),o.curOp.viewChanged=!0,l>=g.viewTo)Wo&&pC(o.doc,l)<g.viewTo&&Ba(o);else if(f<=g.viewFrom)Wo&&dI(o.doc,f+d)>g.viewFrom?Ba(o):(g.viewFrom+=d,g.viewTo+=d);else if(l<=g.viewFrom&&f>=g.viewTo)Ba(o);else if(l<=g.viewFrom){var w=Wm(o,f,f+d,1);w?(g.view=g.view.slice(w.index),g.viewFrom=w.lineN,g.viewTo+=d):Ba(o)}else if(f>=g.viewTo){var b=Wm(o,l,l,-1);b?(g.view=g.view.slice(0,b.index),g.viewTo=b.lineN):Ba(o)}else{var T=Wm(o,l,l,-1),O=Wm(o,f,f+d,1);T&&O?(g.view=g.view.slice(0,T.index).concat(km(o,T.lineN,O.lineN)).concat(g.view.slice(O.index)),g.viewTo+=d):Ba(o)}var N=g.externalMeasured;N&&(f<N.lineN?N.lineN+=d:l<N.lineN+N.size&&(g.externalMeasured=null))}function Wa(o,l,f){o.curOp.viewChanged=!0;var d=o.display,g=o.display.externalMeasured;if(g&&l>=g.lineN&&l<g.lineN+g.size&&(d.externalMeasured=null),!(l<d.viewFrom||l>=d.viewTo)){var w=d.view[jl(o,l)];if(w.node!=null){var b=w.changes||(w.changes=[]);F(b,f)==-1&&b.push(f)}}}function Ba(o){o.display.viewFrom=o.display.viewTo=o.doc.first,o.display.view=[],o.display.viewOffset=0}function Wm(o,l,f,d){var g=jl(o,l),w,b=o.display.view;if(!Wo||f==o.doc.first+o.doc.size)return{index:g,lineN:f};for(var T=o.display.viewFrom,O=0;O<g;O++)T+=b[O].size;if(T!=l){if(d>0){if(g==b.length-1)return null;w=T+b[g].size-l,g++}else w=T-l;l+=w,f+=w}for(;pC(o.doc,f)!=f;){if(g==(d<0?0:b.length-1))return null;f+=d*b[g-(d<0?1:0)].size,g+=d}return{index:g,lineN:f}}function Yz(o,l,f){var d=o.display,g=d.view;g.length==0||l>=d.viewTo||f<=d.viewFrom?(d.view=km(o,l,f),d.viewFrom=l):(d.viewFrom>l?d.view=km(o,l,d.viewFrom).concat(d.view):d.viewFrom<l&&(d.view=d.view.slice(jl(o,l))),d.viewFrom=l,d.viewTo<f?d.view=d.view.concat(km(o,d.viewTo,f)):d.viewTo>f&&(d.view=d.view.slice(0,jl(o,f)))),d.viewTo=f}function DI(o){for(var l=o.display.view,f=0,d=0;d<l.length;d++){var g=l[d];!g.hidden&&(!g.node||g.changes)&&++f}return f}function _d(o){o.display.input.showSelection(o.display.input.prepareSelection())}function LI(o,l){l===void 0&&(l=!0);var f=o.doc,d={},g=d.cursors=document.createDocumentFragment(),w=d.selection=document.createDocumentFragment(),b=o.options.$customCursor;b&&(l=!0);for(var T=0;T<f.sel.ranges.length;T++)if(!(!l&&T==f.sel.primIndex)){var O=f.sel.ranges[T];if(!(O.from().line>=o.display.viewTo||O.to().line<o.display.viewFrom)){var N=O.empty();if(b){var q=b(o,O);q&&OC(o,q,g)}else(N||o.options.showCursorWhenSelecting)&&OC(o,O.head,g);N||Gz(o,O,w)}}return d}function OC(o,l,f){var d=cs(o,l,"div",null,null,!o.options.singleCursorHeightPerLine),g=f.appendChild(ie("div"," ","CodeMirror-cursor"));if(g.style.left=d.left+"px",g.style.top=d.top+"px",g.style.height=Math.max(0,d.bottom-d.top)*o.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(o.getWrapperElement().className)){var w=Fm(o,l,"div",null,null),b=w.right-w.left;g.style.width=(b>0?b:o.defaultCharWidth())+"px"}if(d.other){var T=f.appendChild(ie("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));T.style.display="",T.style.left=d.other.left+"px",T.style.top=d.other.top+"px",T.style.height=(d.other.bottom-d.other.top)*.85+"px"}}function Bm(o,l){return o.top-l.top||o.left-l.left}function Gz(o,l,f){var d=o.display,g=o.doc,w=document.createDocumentFragment(),b=SI(o.display),T=b.left,O=Math.max(d.sizerWidth,Vl(o)-d.sizer.offsetLeft)-b.right,N=g.direction=="ltr";function q(Pe,Ve,et,Qe){Ve<0&&(Ve=0),Ve=Math.round(Ve),Qe=Math.round(Qe),w.appendChild(ie("div",null,"CodeMirror-selected","position: absolute; left: "+Pe+`px;
                             top: `+Ve+"px; width: "+(et??O-Pe)+`px;
                             height: `+(Qe-Ve)+"px"))}function Q(Pe,Ve,et){var Qe=Fe(g,Pe),gt=Qe.text.length,Qt,nn;function vr($r,Yn){return Fm(o,_e(Pe,$r),"div",Qe,Yn)}function ai($r,Yn,mn){var Kr=NI(o,Qe,null,$r),Vr=Yn=="ltr"==(mn=="after")?"left":"right",Cr=mn=="after"?Kr.begin:Kr.end-(/\s/.test(Qe.text.charAt(Kr.end-1))?2:1);return vr(Cr,Vr)[Vr]}var jn=st(Qe,g.direction);return ht(jn,Ve||0,et??gt,function($r,Yn,mn,Kr){var Vr=mn=="ltr",Cr=vr($r,Vr?"left":"right"),Gn=vr(Yn-1,Vr?"right":"left"),Fh=Ve==null&&$r==0,Ya=et==null&&Yn==gt,En=Kr==0,Xs=!jn||Kr==jn.length-1;if(Gn.top-Cr.top<=3){var sn=(N?Fh:Ya)&&En,nb=(N?Ya:Fh)&&Xs,Uo=sn?T:(Vr?Cr:Gn).left,Xl=nb?O:(Vr?Gn:Cr).right;q(Uo,Cr.top,Xl-Uo,Cr.bottom)}else{var Zl,On,Wh,ib;Vr?(Zl=N&&Fh&&En?T:Cr.left,On=N?O:ai($r,mn,"before"),Wh=N?T:ai(Yn,mn,"after"),ib=N&&Ya&&Xs?O:Gn.right):(Zl=N?ai($r,mn,"before"):T,On=!N&&Fh&&En?O:Cr.right,Wh=!N&&Ya&&Xs?T:Gn.left,ib=N?ai(Yn,mn,"after"):O),q(Zl,Cr.top,On-Zl,Cr.bottom),Cr.bottom<Gn.top&&q(T,Cr.bottom,null,Gn.top),q(Wh,Gn.top,ib-Wh,Gn.bottom)}(!Qt||Bm(Cr,Qt)<0)&&(Qt=Cr),Bm(Gn,Qt)<0&&(Qt=Gn),(!nn||Bm(Cr,nn)<0)&&(nn=Cr),Bm(Gn,nn)<0&&(nn=Gn)}),{start:Qt,end:nn}}var he=l.from(),oe=l.to();if(he.line==oe.line)Q(he.line,he.ch,oe.ch);else{var pe=Fe(g,he.line),Ce=Fe(g,oe.line),Te=hs(pe)==hs(Ce),Oe=Q(he.line,he.ch,Te?pe.text.length+1:null).end,De=Q(oe.line,Te?0:null,oe.ch).start;Te&&(Oe.top<De.top-2?(q(Oe.right,Oe.top,null,Oe.bottom),q(T,De.top,De.left,De.bottom)):q(Oe.right,Oe.top,De.left-Oe.right,Oe.bottom)),Oe.bottom<De.top&&q(T,Oe.bottom,null,De.top)}f.appendChild(w)}function PC(o){if(o.state.focused){var l=o.display;clearInterval(l.blinker);var f=!0;l.cursorDiv.style.visibility="",o.options.cursorBlinkRate>0?l.blinker=setInterval(function(){o.hasFocus()||Th(o),l.cursorDiv.style.visibility=(f=!f)?"":"hidden"},o.options.cursorBlinkRate):o.options.cursorBlinkRate<0&&(l.cursorDiv.style.visibility="hidden")}}function FI(o){o.hasFocus()||(o.display.input.focus(),o.state.focused||HC(o))}function AC(o){o.state.delayingBlurEvent=!0,setTimeout(function(){o.state.delayingBlurEvent&&(o.state.delayingBlurEvent=!1,o.state.focused&&Th(o))},100)}function HC(o,l){o.state.delayingBlurEvent&&!o.state.draggingText&&(o.state.delayingBlurEvent=!1),o.options.readOnly!="nocursor"&&(o.state.focused||(Nt(o,"focus",o,l),o.state.focused=!0,Be(o.display.wrapper,"CodeMirror-focused"),!o.curOp&&o.display.selForContextMenu!=o.doc.sel&&(o.display.input.reset(),m&&setTimeout(function(){return o.display.input.reset(!0)},20)),o.display.input.receivedFocus()),PC(o))}function Th(o,l){o.state.delayingBlurEvent||(o.state.focused&&(Nt(o,"blur",o,l),o.state.focused=!1,j(o.display.wrapper,"CodeMirror-focused")),clearInterval(o.display.blinker),setTimeout(function(){o.state.focused||(o.display.shift=!1)},150))}function $m(o){for(var l=o.display,f=l.lineDiv.offsetTop,d=Math.max(0,l.scroller.getBoundingClientRect().top),g=l.lineDiv.getBoundingClientRect().top,w=0,b=0;b<l.view.length;b++){var T=l.view[b],O=o.options.lineWrapping,N=void 0,q=0;if(!T.hidden){if(g+=T.line.height,h&&c<8){var Q=T.node.offsetTop+T.node.offsetHeight;N=Q-f,f=Q}else{var he=T.node.getBoundingClientRect();N=he.bottom-he.top,!O&&T.text.firstChild&&(q=T.text.firstChild.getBoundingClientRect().right-he.left-1)}var oe=T.line.height-N;if((oe>.005||oe<-.005)&&(g<d&&(w-=oe),Ys(T.line,N),WI(T.line),T.rest))for(var pe=0;pe<T.rest.length;pe++)WI(T.rest[pe]);if(q>o.display.sizerWidth){var Ce=Math.ceil(q/_h(o.display));Ce>o.display.maxLineLength&&(o.display.maxLineLength=Ce,o.display.maxLine=T.line,o.display.maxLineChanged=!0)}}}Math.abs(w)>2&&(l.scroller.scrollTop+=w)}function WI(o){if(o.widgets)for(var l=0;l<o.widgets.length;++l){var f=o.widgets[l],d=f.node.parentNode;d&&(f.height=d.offsetHeight)}}function Vm(o,l,f){var d=f&&f.top!=null?Math.max(0,f.top):o.scroller.scrollTop;d=Math.floor(d-Dm(o));var g=f&&f.bottom!=null?f.bottom:d+o.wrapper.clientHeight,w=$l(l,d),b=$l(l,g);if(f&&f.ensure){var T=f.ensure.from.line,O=f.ensure.to.line;T<w?(w=T,b=$l(l,Bo(Fe(l,T))+o.wrapper.clientHeight)):Math.min(O,l.lastLine())>=b&&(w=$l(l,Bo(Fe(l,O))-o.wrapper.clientHeight),b=O)}return{from:w,to:Math.max(b,w+1)}}function qz(o,l){if(!or(o,"scrollCursorIntoView")){var f=o.display,d=f.sizer.getBoundingClientRect(),g=null,w=f.wrapper.ownerDocument;if(l.top+d.top<0?g=!0:l.bottom+d.top>(w.defaultView.innerHeight||w.documentElement.clientHeight)&&(g=!1),g!=null&&!x){var b=ie("div","​",null,`position: absolute;
                         top: `+(l.top-f.viewOffset-Dm(o.display))+`px;
                         height: `+(l.bottom-l.top+qs(o)+f.barHeight)+`px;
                         left: `+l.left+"px; width: "+Math.max(2,l.right-l.left)+"px;");o.display.lineSpace.appendChild(b),b.scrollIntoView(g),o.display.lineSpace.removeChild(b)}}}function Kz(o,l,f,d){d==null&&(d=0);var g;!o.options.lineWrapping&&l==f&&(f=l.sticky=="before"?_e(l.line,l.ch+1,"before"):l,l=l.ch?_e(l.line,l.sticky=="before"?l.ch-1:l.ch,"after"):l);for(var w=0;w<5;w++){var b=!1,T=cs(o,l),O=!f||f==l?T:cs(o,f);g={left:Math.min(T.left,O.left),top:Math.min(T.top,O.top)-d,right:Math.max(T.left,O.left),bottom:Math.max(T.bottom,O.bottom)+d};var N=NC(o,g),q=o.doc.scrollTop,Q=o.doc.scrollLeft;if(N.scrollTop!=null&&(xd(o,N.scrollTop),Math.abs(o.doc.scrollTop-q)>1&&(b=!0)),N.scrollLeft!=null&&(Yl(o,N.scrollLeft),Math.abs(o.doc.scrollLeft-Q)>1&&(b=!0)),!b)break}return g}function Xz(o,l){var f=NC(o,l);f.scrollTop!=null&&xd(o,f.scrollTop),f.scrollLeft!=null&&Yl(o,f.scrollLeft)}function NC(o,l){var f=o.display,d=Eh(o.display);l.top<0&&(l.top=0);var g=o.curOp&&o.curOp.scrollTop!=null?o.curOp.scrollTop:f.scroller.scrollTop,w=bC(o),b={};l.bottom-l.top>w&&(l.bottom=l.top+w);var T=o.doc.height+CC(f),O=l.top<d,N=l.bottom>T-d;if(l.top<g)b.scrollTop=O?0:l.top;else if(l.bottom>g+w){var q=Math.min(l.top,(N?T:l.bottom)-w);q!=g&&(b.scrollTop=q)}var Q=o.options.fixedGutter?0:f.gutters.offsetWidth,he=o.curOp&&o.curOp.scrollLeft!=null?o.curOp.scrollLeft:f.scroller.scrollLeft-Q,oe=Vl(o)-f.gutters.offsetWidth,pe=l.right-l.left>oe;return pe&&(l.right=l.left+oe),l.left<10?b.scrollLeft=0:l.left<he?b.scrollLeft=Math.max(0,l.left+Q-(pe?0:10)):l.right>oe+he-3&&(b.scrollLeft=l.right+(pe?0:10)-oe),b}function kC(o,l){l!=null&&(zm(o),o.curOp.scrollTop=(o.curOp.scrollTop==null?o.doc.scrollTop:o.curOp.scrollTop)+l)}function xh(o){zm(o);var l=o.getCursor();o.curOp.scrollToPos={from:l,to:l,margin:o.options.cursorScrollMargin}}function Td(o,l,f){(l!=null||f!=null)&&zm(o),l!=null&&(o.curOp.scrollLeft=l),f!=null&&(o.curOp.scrollTop=f)}function Zz(o,l){zm(o),o.curOp.scrollToPos=l}function zm(o){var l=o.curOp.scrollToPos;if(l){o.curOp.scrollToPos=null;var f=AI(o,l.from),d=AI(o,l.to);BI(o,f,d,l.margin)}}function BI(o,l,f,d){var g=NC(o,{left:Math.min(l.left,f.left),top:Math.min(l.top,f.top)-d,right:Math.max(l.right,f.right),bottom:Math.max(l.bottom,f.bottom)+d});Td(o,g.scrollLeft,g.scrollTop)}function xd(o,l){Math.abs(o.doc.scrollTop-l)<2||(i||LC(o,{top:l}),$I(o,l,!0),i&&LC(o),Od(o,100))}function $I(o,l,f){l=Math.max(0,Math.min(o.display.scroller.scrollHeight-o.display.scroller.clientHeight,l)),!(o.display.scroller.scrollTop==l&&!f)&&(o.doc.scrollTop=l,o.display.scrollbars.setScrollTop(l),o.display.scroller.scrollTop!=l&&(o.display.scroller.scrollTop=l))}function Yl(o,l,f,d){l=Math.max(0,Math.min(l,o.display.scroller.scrollWidth-o.display.scroller.clientWidth)),!((f?l==o.doc.scrollLeft:Math.abs(o.doc.scrollLeft-l)<2)&&!d)&&(o.doc.scrollLeft=l,YI(o),o.display.scroller.scrollLeft!=l&&(o.display.scroller.scrollLeft=l),o.display.scrollbars.setScrollLeft(l))}function Md(o){var l=o.display,f=l.gutters.offsetWidth,d=Math.round(o.doc.height+CC(o.display));return{clientHeight:l.scroller.clientHeight,viewHeight:l.wrapper.clientHeight,scrollWidth:l.scroller.scrollWidth,clientWidth:l.scroller.clientWidth,viewWidth:l.wrapper.clientWidth,barLeft:o.options.fixedGutter?f:0,docHeight:d,scrollHeight:d+qs(o)+l.barHeight,nativeBarWidth:l.nativeBarWidth,gutterWidth:f}}var Gl=function(o,l,f){this.cm=f;var d=this.vert=ie("div",[ie("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),g=this.horiz=ie("div",[ie("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");d.tabIndex=g.tabIndex=-1,o(d),o(g),qe(d,"scroll",function(){d.clientHeight&&l(d.scrollTop,"vertical")}),qe(g,"scroll",function(){g.clientWidth&&l(g.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,h&&c<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Gl.prototype.update=function(o){var l=o.scrollWidth>o.clientWidth+1,f=o.scrollHeight>o.clientHeight+1,d=o.nativeBarWidth;if(f){this.vert.style.display="block",this.vert.style.bottom=l?d+"px":"0";var g=o.viewHeight-(l?d:0);this.vert.firstChild.style.height=Math.max(0,o.scrollHeight-o.clientHeight+g)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(l){this.horiz.style.display="block",this.horiz.style.right=f?d+"px":"0",this.horiz.style.left=o.barLeft+"px";var w=o.viewWidth-o.barLeft-(f?d:0);this.horiz.firstChild.style.width=Math.max(0,o.scrollWidth-o.clientWidth+w)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&o.clientHeight>0&&(d==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:f?d:0,bottom:l?d:0}},Gl.prototype.setScrollLeft=function(o){this.horiz.scrollLeft!=o&&(this.horiz.scrollLeft=o),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Gl.prototype.setScrollTop=function(o){this.vert.scrollTop!=o&&(this.vert.scrollTop=o),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Gl.prototype.zeroWidthHack=function(){var o=B&&!_?"12px":"18px";this.horiz.style.height=this.vert.style.width=o,this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new L,this.disableVert=new L},Gl.prototype.enableZeroWidthBar=function(o,l,f){o.style.visibility="";function d(){var g=o.getBoundingClientRect(),w=f=="vert"?document.elementFromPoint(g.right-1,(g.top+g.bottom)/2):document.elementFromPoint((g.right+g.left)/2,g.bottom-1);w!=o?o.style.visibility="hidden":l.set(1e3,d)}l.set(1e3,d)},Gl.prototype.clear=function(){var o=this.horiz.parentNode;o.removeChild(this.horiz),o.removeChild(this.vert)};var Id=function(){};Id.prototype.update=function(){return{bottom:0,right:0}},Id.prototype.setScrollLeft=function(){},Id.prototype.setScrollTop=function(){},Id.prototype.clear=function(){};function Mh(o,l){l||(l=Md(o));var f=o.display.barWidth,d=o.display.barHeight;VI(o,l);for(var g=0;g<4&&f!=o.display.barWidth||d!=o.display.barHeight;g++)f!=o.display.barWidth&&o.options.lineWrapping&&$m(o),VI(o,Md(o)),f=o.display.barWidth,d=o.display.barHeight}function VI(o,l){var f=o.display,d=f.scrollbars.update(l);f.sizer.style.paddingRight=(f.barWidth=d.right)+"px",f.sizer.style.paddingBottom=(f.barHeight=d.bottom)+"px",f.heightForcer.style.borderBottom=d.bottom+"px solid transparent",d.right&&d.bottom?(f.scrollbarFiller.style.display="block",f.scrollbarFiller.style.height=d.bottom+"px",f.scrollbarFiller.style.width=d.right+"px"):f.scrollbarFiller.style.display="",d.bottom&&o.options.coverGutterNextToScrollbar&&o.options.fixedGutter?(f.gutterFiller.style.display="block",f.gutterFiller.style.height=d.bottom+"px",f.gutterFiller.style.width=l.gutterWidth+"px"):f.gutterFiller.style.display=""}var zI={native:Gl,null:Id};function UI(o){o.display.scrollbars&&(o.display.scrollbars.clear(),o.display.scrollbars.addClass&&j(o.display.wrapper,o.display.scrollbars.addClass)),o.display.scrollbars=new zI[o.options.scrollbarStyle](function(l){o.display.wrapper.insertBefore(l,o.display.scrollbarFiller),qe(l,"mousedown",function(){o.state.focused&&setTimeout(function(){return o.display.input.focus()},0)}),l.setAttribute("cm-not-content","true")},function(l,f){f=="horizontal"?Yl(o,l):xd(o,l)},o),o.display.scrollbars.addClass&&Be(o.display.wrapper,o.display.scrollbars.addClass)}var Qz=0;function ql(o){o.curOp={cm:o,viewChanged:!1,startHeight:o.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Qz,markArrays:null},Iz(o.curOp)}function Kl(o){var l=o.curOp;l&&Pz(l,function(f){for(var d=0;d<f.ops.length;d++)f.ops[d].cm.curOp=null;Jz(f)})}function Jz(o){for(var l=o.ops,f=0;f<l.length;f++)eU(l[f]);for(var d=0;d<l.length;d++)tU(l[d]);for(var g=0;g<l.length;g++)rU(l[g]);for(var w=0;w<l.length;w++)nU(l[w]);for(var b=0;b<l.length;b++)iU(l[b])}function eU(o){var l=o.cm,f=l.display;oU(l),o.updateMaxLine&&wC(l),o.mustUpdate=o.viewChanged||o.forceUpdate||o.scrollTop!=null||o.scrollToPos&&(o.scrollToPos.from.line<f.viewFrom||o.scrollToPos.to.line>=f.viewTo)||f.maxLineChanged&&l.options.lineWrapping,o.update=o.mustUpdate&&new Um(l,o.mustUpdate&&{top:o.scrollTop,ensure:o.scrollToPos},o.forceUpdate)}function tU(o){o.updatedDisplay=o.mustUpdate&&DC(o.cm,o.update)}function rU(o){var l=o.cm,f=l.display;o.updatedDisplay&&$m(l),o.barMeasure=Md(l),f.maxLineChanged&&!l.options.lineWrapping&&(o.adjustWidthTo=EI(l,f.maxLine,f.maxLine.text.length).left+3,l.display.sizerWidth=o.adjustWidthTo,o.barMeasure.scrollWidth=Math.max(f.scroller.clientWidth,f.sizer.offsetLeft+o.adjustWidthTo+qs(l)+l.display.barWidth),o.maxScrollLeft=Math.max(0,f.sizer.offsetLeft+o.adjustWidthTo-Vl(l))),(o.updatedDisplay||o.selectionChanged)&&(o.preparedSelection=f.input.prepareSelection())}function nU(o){var l=o.cm;o.adjustWidthTo!=null&&(l.display.sizer.style.minWidth=o.adjustWidthTo+"px",o.maxScrollLeft<l.doc.scrollLeft&&Yl(l,Math.min(l.display.scroller.scrollLeft,o.maxScrollLeft),!0),l.display.maxLineChanged=!1);var f=o.focus&&o.focus==ve($(l));o.preparedSelection&&l.display.input.showSelection(o.preparedSelection,f),(o.updatedDisplay||o.startHeight!=l.doc.height)&&Mh(l,o.barMeasure),o.updatedDisplay&&WC(l,o.barMeasure),o.selectionChanged&&PC(l),l.state.focused&&o.updateInput&&l.display.input.reset(o.typing),f&&FI(o.cm)}function iU(o){var l=o.cm,f=l.display,d=l.doc;if(o.updatedDisplay&&jI(l,o.update),f.wheelStartX!=null&&(o.scrollTop!=null||o.scrollLeft!=null||o.scrollToPos)&&(f.wheelStartX=f.wheelStartY=null),o.scrollTop!=null&&$I(l,o.scrollTop,o.forceScroll),o.scrollLeft!=null&&Yl(l,o.scrollLeft,!0,!0),o.scrollToPos){var g=Kz(l,at(d,o.scrollToPos.from),at(d,o.scrollToPos.to),o.scrollToPos.margin);qz(l,g)}var w=o.maybeHiddenMarkers,b=o.maybeUnhiddenMarkers;if(w)for(var T=0;T<w.length;++T)w[T].lines.length||Nt(w[T],"hide");if(b)for(var O=0;O<b.length;++O)b[O].lines.length&&Nt(b[O],"unhide");f.wrapper.offsetHeight&&(d.scrollTop=l.display.scroller.scrollTop),o.changeObjs&&Nt(l,"changes",l,o.changeObjs),o.update&&o.update.finish()}function oi(o,l){if(o.curOp)return l();ql(o);try{return l()}finally{Kl(o)}}function tn(o,l){return function(){if(o.curOp)return l.apply(o,arguments);ql(o);try{return l.apply(o,arguments)}finally{Kl(o)}}}function In(o){return function(){if(this.curOp)return o.apply(this,arguments);ql(this);try{return o.apply(this,arguments)}finally{Kl(this)}}}function rn(o){return function(){var l=this.cm;if(!l||l.curOp)return o.apply(this,arguments);ql(l);try{return o.apply(this,arguments)}finally{Kl(l)}}}function Od(o,l){o.doc.highlightFrontier<o.display.viewTo&&o.state.highlight.set(l,we(sU,o))}function sU(o){var l=o.doc;if(!(l.highlightFrontier>=o.display.viewTo)){var f=+new Date+o.options.workTime,d=yd(o,l.highlightFrontier),g=[];l.iter(d.line,Math.min(l.first+l.size,o.display.viewTo+500),function(w){if(d.line>=o.display.viewFrom){var b=w.styles,T=w.text.length>o.options.maxHighlightLength?lr(l.mode,d.state):null,O=QM(o,w,d,!0);T&&(d.state=T),w.styles=O.styles;var N=w.styleClasses,q=O.classes;q?w.styleClasses=q:N&&(w.styleClasses=null);for(var Q=!b||b.length!=w.styles.length||N!=q&&(!N||!q||N.bgClass!=q.bgClass||N.textClass!=q.textClass),he=0;!Q&&he<b.length;++he)Q=b[he]!=w.styles[he];Q&&g.push(d.line),w.stateAfter=d.save(),d.nextLine()}else w.text.length<=o.options.maxHighlightLength&&dC(o,w.text,d),w.stateAfter=d.line%5==0?d.save():null,d.nextLine();if(+new Date>f)return Od(o,o.options.workDelay),!0}),l.highlightFrontier=d.line,l.modeFrontier=Math.max(l.modeFrontier,d.line),g.length&&oi(o,function(){for(var w=0;w<g.length;w++)Wa(o,g[w],"text")})}}var Um=function(o,l,f){var d=o.display;this.viewport=l,this.visible=Vm(d,o.doc,l),this.editorIsHidden=!d.wrapper.offsetWidth,this.wrapperHeight=d.wrapper.clientHeight,this.wrapperWidth=d.wrapper.clientWidth,this.oldDisplayWidth=Vl(o),this.force=f,this.dims=xC(o),this.events=[]};Um.prototype.signal=function(o,l){Ft(o,l)&&this.events.push(arguments)},Um.prototype.finish=function(){for(var o=0;o<this.events.length;o++)Nt.apply(null,this.events[o])};function oU(o){var l=o.display;!l.scrollbarsClipped&&l.scroller.offsetWidth&&(l.nativeBarWidth=l.scroller.offsetWidth-l.scroller.clientWidth,l.heightForcer.style.height=qs(o)+"px",l.sizer.style.marginBottom=-l.nativeBarWidth+"px",l.sizer.style.borderRightWidth=qs(o)+"px",l.scrollbarsClipped=!0)}function aU(o){if(o.hasFocus())return null;var l=ve($(o));if(!l||!Ae(o.display.lineDiv,l))return null;var f={activeElt:l};if(window.getSelection){var d=ce(o).getSelection();d.anchorNode&&d.extend&&Ae(o.display.lineDiv,d.anchorNode)&&(f.anchorNode=d.anchorNode,f.anchorOffset=d.anchorOffset,f.focusNode=d.focusNode,f.focusOffset=d.focusOffset)}return f}function lU(o){if(!(!o||!o.activeElt||o.activeElt==ve(X(o.activeElt)))&&(o.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(o.activeElt.nodeName)&&o.anchorNode&&Ae(document.body,o.anchorNode)&&Ae(document.body,o.focusNode))){var l=o.activeElt.ownerDocument,f=l.defaultView.getSelection(),d=l.createRange();d.setEnd(o.anchorNode,o.anchorOffset),d.collapse(!1),f.removeAllRanges(),f.addRange(d),f.extend(o.focusNode,o.focusOffset)}}function DC(o,l){var f=o.display,d=o.doc;if(l.editorIsHidden)return Ba(o),!1;if(!l.force&&l.visible.from>=f.viewFrom&&l.visible.to<=f.viewTo&&(f.updateLineNumbers==null||f.updateLineNumbers>=f.viewTo)&&f.renderedView==f.view&&DI(o)==0)return!1;GI(o)&&(Ba(o),l.dims=xC(o));var g=d.first+d.size,w=Math.max(l.visible.from-o.options.viewportMargin,d.first),b=Math.min(g,l.visible.to+o.options.viewportMargin);f.viewFrom<w&&w-f.viewFrom<20&&(w=Math.max(d.first,f.viewFrom)),f.viewTo>b&&f.viewTo-b<20&&(b=Math.min(g,f.viewTo)),Wo&&(w=pC(o.doc,w),b=dI(o.doc,b));var T=w!=f.viewFrom||b!=f.viewTo||f.lastWrapHeight!=l.wrapperHeight||f.lastWrapWidth!=l.wrapperWidth;Yz(o,w,b),f.viewOffset=Bo(Fe(o.doc,f.viewFrom)),o.display.mover.style.top=f.viewOffset+"px";var O=DI(o);if(!T&&O==0&&!l.force&&f.renderedView==f.view&&(f.updateLineNumbers==null||f.updateLineNumbers>=f.viewTo))return!1;var N=aU(o);return O>4&&(f.lineDiv.style.display="none"),uU(o,f.updateLineNumbers,l.dims),O>4&&(f.lineDiv.style.display=""),f.renderedView=f.view,lU(N),ae(f.cursorDiv),ae(f.selectionDiv),f.gutters.style.height=f.sizer.style.minHeight=0,T&&(f.lastWrapHeight=l.wrapperHeight,f.lastWrapWidth=l.wrapperWidth,Od(o,400)),f.updateLineNumbers=null,!0}function jI(o,l){for(var f=l.viewport,d=!0;;d=!1){if(!d||!o.options.lineWrapping||l.oldDisplayWidth==Vl(o)){if(f&&f.top!=null&&(f={top:Math.min(o.doc.height+CC(o.display)-bC(o),f.top)}),l.visible=Vm(o.display,o.doc,f),l.visible.from>=o.display.viewFrom&&l.visible.to<=o.display.viewTo)break}else d&&(l.visible=Vm(o.display,o.doc,f));if(!DC(o,l))break;$m(o);var g=Md(o);_d(o),Mh(o,g),WC(o,g),l.force=!1}l.signal(o,"update",o),(o.display.viewFrom!=o.display.reportedViewFrom||o.display.viewTo!=o.display.reportedViewTo)&&(l.signal(o,"viewportChange",o,o.display.viewFrom,o.display.viewTo),o.display.reportedViewFrom=o.display.viewFrom,o.display.reportedViewTo=o.display.viewTo)}function LC(o,l){var f=new Um(o,l);if(DC(o,f)){$m(o),jI(o,f);var d=Md(o);_d(o),Mh(o,d),WC(o,d),f.finish()}}function uU(o,l,f){var d=o.display,g=o.options.lineNumbers,w=d.lineDiv,b=w.firstChild;function T(pe){var Ce=pe.nextSibling;return m&&B&&o.display.currentWheelTarget==pe?pe.style.display="none":pe.parentNode.removeChild(pe),Ce}for(var O=d.view,N=d.viewFrom,q=0;q<O.length;q++){var Q=O[q];if(!Q.hidden)if(!Q.node||Q.node.parentNode!=w){var he=Dz(o,Q,N,f);w.insertBefore(he,b)}else{for(;b!=Q.node;)b=T(b);var oe=g&&l!=null&&l<=N&&Q.lineNumber;Q.changes&&(F(Q.changes,"gutter")>-1&&(oe=!1),vI(o,Q,N,f)),oe&&(ae(Q.lineNumber),Q.lineNumber.appendChild(document.createTextNode(uC(o.options,N)))),b=Q.node.nextSibling}N+=Q.size}for(;b;)b=T(b)}function FC(o){var l=o.gutters.offsetWidth;o.sizer.style.marginLeft=l+"px",en(o,"gutterChanged",o)}function WC(o,l){o.display.sizer.style.minHeight=l.docHeight+"px",o.display.heightForcer.style.top=l.docHeight+"px",o.display.gutters.style.height=l.docHeight+o.display.barHeight+qs(o)+"px"}function YI(o){var l=o.display,f=l.view;if(!(!l.alignWidgets&&(!l.gutters.firstChild||!o.options.fixedGutter))){for(var d=MC(l)-l.scroller.scrollLeft+o.doc.scrollLeft,g=l.gutters.offsetWidth,w=d+"px",b=0;b<f.length;b++)if(!f[b].hidden){o.options.fixedGutter&&(f[b].gutter&&(f[b].gutter.style.left=w),f[b].gutterBackground&&(f[b].gutterBackground.style.left=w));var T=f[b].alignable;if(T)for(var O=0;O<T.length;O++)T[O].style.left=w}o.options.fixedGutter&&(l.gutters.style.left=d+g+"px")}}function GI(o){if(!o.options.lineNumbers)return!1;var l=o.doc,f=uC(o.options,l.first+l.size-1),d=o.display;if(f.length!=d.lineNumChars){var g=d.measure.appendChild(ie("div",[ie("div",f)],"CodeMirror-linenumber CodeMirror-gutter-elt")),w=g.firstChild.offsetWidth,b=g.offsetWidth-w;return d.lineGutter.style.width="",d.lineNumInnerWidth=Math.max(w,d.lineGutter.offsetWidth-b)+1,d.lineNumWidth=d.lineNumInnerWidth+b,d.lineNumChars=d.lineNumInnerWidth?f.length:-1,d.lineGutter.style.width=d.lineNumWidth+"px",FC(o.display),!0}return!1}function BC(o,l){for(var f=[],d=!1,g=0;g<o.length;g++){var w=o[g],b=null;if(typeof w!="string"&&(b=w.style,w=w.className),w=="CodeMirror-linenumbers")if(l)d=!0;else continue;f.push({className:w,style:b})}return l&&!d&&f.push({className:"CodeMirror-linenumbers",style:null}),f}function qI(o){var l=o.gutters,f=o.gutterSpecs;ae(l),o.lineGutter=null;for(var d=0;d<f.length;++d){var g=f[d],w=g.className,b=g.style,T=l.appendChild(ie("div",null,"CodeMirror-gutter "+w));b&&(T.style.cssText=b),w=="CodeMirror-linenumbers"&&(o.lineGutter=T,T.style.width=(o.lineNumWidth||1)+"px")}l.style.display=f.length?"":"none",FC(o)}function Pd(o){qI(o.display),zn(o),YI(o)}function hU(o,l,f,d){var g=this;this.input=f,g.scrollbarFiller=ie("div",null,"CodeMirror-scrollbar-filler"),g.scrollbarFiller.setAttribute("cm-not-content","true"),g.gutterFiller=ie("div",null,"CodeMirror-gutter-filler"),g.gutterFiller.setAttribute("cm-not-content","true"),g.lineDiv=Le("div",null,"CodeMirror-code"),g.selectionDiv=ie("div",null,null,"position: relative; z-index: 1"),g.cursorDiv=ie("div",null,"CodeMirror-cursors"),g.measure=ie("div",null,"CodeMirror-measure"),g.lineMeasure=ie("div",null,"CodeMirror-measure"),g.lineSpace=Le("div",[g.measure,g.lineMeasure,g.selectionDiv,g.cursorDiv,g.lineDiv],null,"position: relative; outline: none");var w=Le("div",[g.lineSpace],"CodeMirror-lines");g.mover=ie("div",[w],null,"position: relative"),g.sizer=ie("div",[g.mover],"CodeMirror-sizer"),g.sizerWidth=null,g.heightForcer=ie("div",null,null,"position: absolute; height: "+Z+"px; width: 1px;"),g.gutters=ie("div",null,"CodeMirror-gutters"),g.lineGutter=null,g.scroller=ie("div",[g.sizer,g.heightForcer,g.gutters],"CodeMirror-scroll"),g.scroller.setAttribute("tabIndex","-1"),g.wrapper=ie("div",[g.scrollbarFiller,g.gutterFiller,g.scroller],"CodeMirror"),v&&y>=105&&(g.wrapper.style.clipPath="inset(0px)"),g.wrapper.setAttribute("translate","no"),h&&c<8&&(g.gutters.style.zIndex=-1,g.scroller.style.paddingRight=0),!m&&!(i&&W)&&(g.scroller.draggable=!0),o&&(o.appendChild?o.appendChild(g.wrapper):o(g.wrapper)),g.viewFrom=g.viewTo=l.first,g.reportedViewFrom=g.reportedViewTo=l.first,g.view=[],g.renderedView=null,g.externalMeasured=null,g.viewOffset=0,g.lastWrapHeight=g.lastWrapWidth=0,g.updateLineNumbers=null,g.nativeBarWidth=g.barHeight=g.barWidth=0,g.scrollbarsClipped=!1,g.lineNumWidth=g.lineNumInnerWidth=g.lineNumChars=null,g.alignWidgets=!1,g.cachedCharWidth=g.cachedTextHeight=g.cachedPaddingH=null,g.maxLine=null,g.maxLineLength=0,g.maxLineChanged=!1,g.wheelDX=g.wheelDY=g.wheelStartX=g.wheelStartY=null,g.shift=!1,g.selForContextMenu=null,g.activeTouch=null,g.gutterSpecs=BC(d.gutters,d.lineNumbers),qI(g),f.init(g)}var jm=0,Vo=null;h?Vo=-.53:i?Vo=15:v?Vo=-.7:R&&(Vo=-1/3);function KI(o){var l=o.wheelDeltaX,f=o.wheelDeltaY;return l==null&&o.detail&&o.axis==o.HORIZONTAL_AXIS&&(l=o.detail),f==null&&o.detail&&o.axis==o.VERTICAL_AXIS?f=o.detail:f==null&&(f=o.wheelDelta),{x:l,y:f}}function cU(o){var l=KI(o);return l.x*=Vo,l.y*=Vo,l}function XI(o,l){v&&y==102&&(o.display.chromeScrollHack==null?o.display.sizer.style.pointerEvents="none":clearTimeout(o.display.chromeScrollHack),o.display.chromeScrollHack=setTimeout(function(){o.display.chromeScrollHack=null,o.display.sizer.style.pointerEvents=""},100));var f=KI(l),d=f.x,g=f.y,w=Vo;l.deltaMode===0&&(d=l.deltaX,g=l.deltaY,w=1);var b=o.display,T=b.scroller,O=T.scrollWidth>T.clientWidth,N=T.scrollHeight>T.clientHeight;if(d&&O||g&&N){if(g&&B&&m){e:for(var q=l.target,Q=b.view;q!=T;q=q.parentNode)for(var he=0;he<Q.length;he++)if(Q[he].node==q){o.display.currentWheelTarget=q;break e}}if(d&&!i&&!C&&w!=null){g&&N&&xd(o,Math.max(0,T.scrollTop+g*w)),Yl(o,Math.max(0,T.scrollLeft+d*w)),(!g||g&&N)&&Sn(l),b.wheelStartX=null;return}if(g&&w!=null){var oe=g*w,pe=o.doc.scrollTop,Ce=pe+b.wrapper.clientHeight;oe<0?pe=Math.max(0,pe+oe-50):Ce=Math.min(o.doc.height,Ce+oe+50),LC(o,{top:pe,bottom:Ce})}jm<20&&l.deltaMode!==0&&(b.wheelStartX==null?(b.wheelStartX=T.scrollLeft,b.wheelStartY=T.scrollTop,b.wheelDX=d,b.wheelDY=g,setTimeout(function(){if(b.wheelStartX!=null){var Te=T.scrollLeft-b.wheelStartX,Oe=T.scrollTop-b.wheelStartY,De=Oe&&b.wheelDY&&Oe/b.wheelDY||Te&&b.wheelDX&&Te/b.wheelDX;b.wheelStartX=b.wheelStartY=null,De&&(Vo=(Vo*jm+De)/(jm+1),++jm)}},200)):(b.wheelDX+=d,b.wheelDY+=g))}}var _i=function(o,l){this.ranges=o,this.primIndex=l};_i.prototype.primary=function(){return this.ranges[this.primIndex]},_i.prototype.equals=function(o){if(o==this)return!0;if(o.primIndex!=this.primIndex||o.ranges.length!=this.ranges.length)return!1;for(var l=0;l<this.ranges.length;l++){var f=this.ranges[l],d=o.ranges[l];if(!hC(f.anchor,d.anchor)||!hC(f.head,d.head))return!1}return!0},_i.prototype.deepCopy=function(){for(var o=[],l=0;l<this.ranges.length;l++)o[l]=new kt(cC(this.ranges[l].anchor),cC(this.ranges[l].head));return new _i(o,this.primIndex)},_i.prototype.somethingSelected=function(){for(var o=0;o<this.ranges.length;o++)if(!this.ranges[o].empty())return!0;return!1},_i.prototype.contains=function(o,l){l||(l=o);for(var f=0;f<this.ranges.length;f++){var d=this.ranges[f];if(ot(l,d.from())>=0&&ot(o,d.to())<=0)return f}return-1};var kt=function(o,l){this.anchor=o,this.head=l};kt.prototype.from=function(){return Mm(this.anchor,this.head)},kt.prototype.to=function(){return xm(this.anchor,this.head)},kt.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function ds(o,l,f){var d=o&&o.options.selectionsMayTouch,g=l[f];l.sort(function(he,oe){return ot(he.from(),oe.from())}),f=F(l,g);for(var w=1;w<l.length;w++){var b=l[w],T=l[w-1],O=ot(T.to(),b.from());if(d&&!b.empty()?O>0:O>=0){var N=Mm(T.from(),b.from()),q=xm(T.to(),b.to()),Q=T.empty()?b.from()==b.head:T.from()==T.head;w<=f&&--f,l.splice(--w,2,new kt(Q?q:N,Q?N:q))}}return new _i(l,f)}function $a(o,l){return new _i([new kt(o,l||o)],0)}function Va(o){return o.text?_e(o.from.line+o.text.length-1,G(o.text).length+(o.text.length==1?o.from.ch:0)):o.to}function ZI(o,l){if(ot(o,l.from)<0)return o;if(ot(o,l.to)<=0)return Va(l);var f=o.line+l.text.length-(l.to.line-l.from.line)-1,d=o.ch;return o.line==l.to.line&&(d+=Va(l).ch-l.to.ch),_e(f,d)}function $C(o,l){for(var f=[],d=0;d<o.sel.ranges.length;d++){var g=o.sel.ranges[d];f.push(new kt(ZI(g.anchor,l),ZI(g.head,l)))}return ds(o.cm,f,o.sel.primIndex)}function QI(o,l,f){return o.line==l.line?_e(f.line,o.ch-l.ch+f.ch):_e(f.line+(o.line-l.line),o.ch)}function dU(o,l,f){for(var d=[],g=_e(o.first,0),w=g,b=0;b<l.length;b++){var T=l[b],O=QI(T.from,g,w),N=QI(Va(T),g,w);if(g=T.to,w=N,f=="around"){var q=o.sel.ranges[b],Q=ot(q.head,q.anchor)<0;d[b]=new kt(Q?N:O,Q?O:N)}else d[b]=new kt(O,O)}return new _i(d,o.sel.primIndex)}function VC(o){o.doc.mode=Ge(o.options,o.doc.modeOption),Ad(o)}function Ad(o){o.doc.iter(function(l){l.stateAfter&&(l.stateAfter=null),l.styles&&(l.styles=null)}),o.doc.modeFrontier=o.doc.highlightFrontier=o.doc.first,Od(o,100),o.state.modeGen++,o.curOp&&zn(o)}function JI(o,l){return l.from.ch==0&&l.to.ch==0&&G(l.text)==""&&(!o.cm||o.cm.options.wholeLineUpdateBefore)}function zC(o,l,f,d){function g(De){return f?f[De]:null}function w(De,Pe,Ve){Cz(De,Pe,Ve,d),en(De,"change",De,l)}function b(De,Pe){for(var Ve=[],et=De;et<Pe;++et)Ve.push(new bh(N[et],g(et),d));return Ve}var T=l.from,O=l.to,N=l.text,q=Fe(o,T.line),Q=Fe(o,O.line),he=G(N),oe=g(N.length-1),pe=O.line-T.line;if(l.full)o.insert(0,b(0,N.length)),o.remove(N.length,o.size-N.length);else if(JI(o,l)){var Ce=b(0,N.length-1);w(Q,Q.text,oe),pe&&o.remove(T.line,pe),Ce.length&&o.insert(T.line,Ce)}else if(q==Q)if(N.length==1)w(q,q.text.slice(0,T.ch)+he+q.text.slice(O.ch),oe);else{var Te=b(1,N.length-1);Te.push(new bh(he+q.text.slice(O.ch),oe,d)),w(q,q.text.slice(0,T.ch)+N[0],g(0)),o.insert(T.line+1,Te)}else if(N.length==1)w(q,q.text.slice(0,T.ch)+N[0]+Q.text.slice(O.ch),g(0)),o.remove(T.line+1,pe);else{w(q,q.text.slice(0,T.ch)+N[0],g(0)),w(Q,he+Q.text.slice(O.ch),oe);var Oe=b(1,N.length-1);pe>1&&o.remove(T.line+1,pe-1),o.insert(T.line+1,Oe)}en(o,"change",o,l)}function za(o,l,f){function d(g,w,b){if(g.linked)for(var T=0;T<g.linked.length;++T){var O=g.linked[T];if(O.doc!=w){var N=b&&O.sharedHist;f&&!N||(l(O.doc,N),d(O.doc,g,N))}}}d(o,null,!0)}function eO(o,l){if(l.cm)throw new Error("This document is already in use.");o.doc=l,l.cm=o,IC(o),VC(o),tO(o),o.options.direction=l.direction,o.options.lineWrapping||wC(o),o.options.mode=l.modeOption,zn(o)}function tO(o){(o.doc.direction=="rtl"?Be:j)(o.display.lineDiv,"CodeMirror-rtl")}function fU(o){oi(o,function(){tO(o),zn(o)})}function Ym(o){this.done=[],this.undone=[],this.undoDepth=o?o.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=o?o.maxGeneration:1}function UC(o,l){var f={from:cC(l.from),to:Va(l),text:js(o,l.from,l.to)};return iO(o,f,l.from.line,l.to.line+1),za(o,function(d){return iO(d,f,l.from.line,l.to.line+1)},!0),f}function rO(o){for(;o.length;){var l=G(o);if(l.ranges)o.pop();else break}}function gU(o,l){if(l)return rO(o.done),G(o.done);if(o.done.length&&!G(o.done).ranges)return G(o.done);if(o.done.length>1&&!o.done[o.done.length-2].ranges)return o.done.pop(),G(o.done)}function nO(o,l,f,d){var g=o.history;g.undone.length=0;var w=+new Date,b,T;if((g.lastOp==d||g.lastOrigin==l.origin&&l.origin&&(l.origin.charAt(0)=="+"&&g.lastModTime>w-(o.cm?o.cm.options.historyEventDelay:500)||l.origin.charAt(0)=="*"))&&(b=gU(g,g.lastOp==d)))T=G(b.changes),ot(l.from,l.to)==0&&ot(l.from,T.to)==0?T.to=Va(l):b.changes.push(UC(o,l));else{var O=G(g.done);for((!O||!O.ranges)&&Gm(o.sel,g.done),b={changes:[UC(o,l)],generation:g.generation},g.done.push(b);g.done.length>g.undoDepth;)g.done.shift(),g.done[0].ranges||g.done.shift()}g.done.push(f),g.generation=++g.maxGeneration,g.lastModTime=g.lastSelTime=w,g.lastOp=g.lastSelOp=d,g.lastOrigin=g.lastSelOrigin=l.origin,T||Nt(o,"historyAdded")}function mU(o,l,f,d){var g=l.charAt(0);return g=="*"||g=="+"&&f.ranges.length==d.ranges.length&&f.somethingSelected()==d.somethingSelected()&&new Date-o.history.lastSelTime<=(o.cm?o.cm.options.historyEventDelay:500)}function pU(o,l,f,d){var g=o.history,w=d&&d.origin;f==g.lastSelOp||w&&g.lastSelOrigin==w&&(g.lastModTime==g.lastSelTime&&g.lastOrigin==w||mU(o,w,G(g.done),l))?g.done[g.done.length-1]=l:Gm(l,g.done),g.lastSelTime=+new Date,g.lastSelOrigin=w,g.lastSelOp=f,d&&d.clearRedo!==!1&&rO(g.undone)}function Gm(o,l){var f=G(l);f&&f.ranges&&f.equals(o)||l.push(o)}function iO(o,l,f,d){var g=l["spans_"+o.id],w=0;o.iter(Math.max(o.first,f),Math.min(o.first+o.size,d),function(b){b.markedSpans&&((g||(g=l["spans_"+o.id]={}))[w]=b.markedSpans),++w})}function vU(o){if(!o)return null;for(var l,f=0;f<o.length;++f)o[f].marker.explicitlyCleared?l||(l=o.slice(0,f)):l&&l.push(o[f]);return l?l.length?l:null:o}function wU(o,l){var f=l["spans_"+o.id];if(!f)return null;for(var d=[],g=0;g<l.text.length;++g)d.push(vU(f[g]));return d}function sO(o,l){var f=wU(o,l),d=gC(o,l);if(!f)return d;if(!d)return f;for(var g=0;g<f.length;++g){var w=f[g],b=d[g];if(w&&b)e:for(var T=0;T<b.length;++T){for(var O=b[T],N=0;N<w.length;++N)if(w[N].marker==O.marker)continue e;w.push(O)}else b&&(f[g]=b)}return f}function Ih(o,l,f){for(var d=[],g=0;g<o.length;++g){var w=o[g];if(w.ranges){d.push(f?_i.prototype.deepCopy.call(w):w);continue}var b=w.changes,T=[];d.push({changes:T});for(var O=0;O<b.length;++O){var N=b[O],q=void 0;if(T.push({from:N.from,to:N.to,text:N.text}),l)for(var Q in N)(q=Q.match(/^spans_(\d+)$/))&&F(l,Number(q[1]))>-1&&(G(T)[Q]=N[Q],delete N[Q])}}return d}function jC(o,l,f,d){if(d){var g=o.anchor;if(f){var w=ot(l,g)<0;w!=ot(f,g)<0?(g=l,l=f):w!=ot(l,f)<0&&(l=f)}return new kt(g,l)}else return new kt(f||l,l)}function qm(o,l,f,d,g){g==null&&(g=o.cm&&(o.cm.display.shift||o.extend)),Rn(o,new _i([jC(o.sel.primary(),l,f,g)],0),d)}function oO(o,l,f){for(var d=[],g=o.cm&&(o.cm.display.shift||o.extend),w=0;w<o.sel.ranges.length;w++)d[w]=jC(o.sel.ranges[w],l[w],null,g);var b=ds(o.cm,d,o.sel.primIndex);Rn(o,b,f)}function YC(o,l,f,d){var g=o.sel.ranges.slice(0);g[l]=f,Rn(o,ds(o.cm,g,o.sel.primIndex),d)}function aO(o,l,f,d){Rn(o,$a(l,f),d)}function yU(o,l,f){var d={ranges:l.ranges,update:function(g){this.ranges=[];for(var w=0;w<g.length;w++)this.ranges[w]=new kt(at(o,g[w].anchor),at(o,g[w].head))},origin:f&&f.origin};return Nt(o,"beforeSelectionChange",o,d),o.cm&&Nt(o.cm,"beforeSelectionChange",o.cm,d),d.ranges!=l.ranges?ds(o.cm,d.ranges,d.ranges.length-1):l}function lO(o,l,f){var d=o.history.done,g=G(d);g&&g.ranges?(d[d.length-1]=l,Km(o,l,f)):Rn(o,l,f)}function Rn(o,l,f){Km(o,l,f),pU(o,o.sel,o.cm?o.cm.curOp.id:NaN,f)}function Km(o,l,f){(Ft(o,"beforeSelectionChange")||o.cm&&Ft(o.cm,"beforeSelectionChange"))&&(l=yU(o,l,f));var d=f&&f.bias||(ot(l.primary().head,o.sel.primary().head)<0?-1:1);uO(o,cO(o,l,d,!0)),!(f&&f.scroll===!1)&&o.cm&&o.cm.getOption("readOnly")!="nocursor"&&xh(o.cm)}function uO(o,l){l.equals(o.sel)||(o.sel=l,o.cm&&(o.cm.curOp.updateInput=1,o.cm.curOp.selectionChanged=!0,Sm(o.cm)),en(o,"cursorActivity",o))}function hO(o){uO(o,cO(o,o.sel,null,!1))}function cO(o,l,f,d){for(var g,w=0;w<l.ranges.length;w++){var b=l.ranges[w],T=l.ranges.length==o.sel.ranges.length&&o.sel.ranges[w],O=Xm(o,b.anchor,T&&T.anchor,f,d),N=b.head==b.anchor?O:Xm(o,b.head,T&&T.head,f,d);(g||O!=b.anchor||N!=b.head)&&(g||(g=l.ranges.slice(0,w)),g[w]=new kt(O,N))}return g?ds(o.cm,g,l.primIndex):l}function Oh(o,l,f,d,g){var w=Fe(o,l.line);if(w.markedSpans)for(var b=0;b<w.markedSpans.length;++b){var T=w.markedSpans[b],O=T.marker,N="selectLeft"in O?!O.selectLeft:O.inclusiveLeft,q="selectRight"in O?!O.selectRight:O.inclusiveRight;if((T.from==null||(N?T.from<=l.ch:T.from<l.ch))&&(T.to==null||(q?T.to>=l.ch:T.to>l.ch))){if(g&&(Nt(O,"beforeCursorEnter"),O.explicitlyCleared))if(w.markedSpans){--b;continue}else break;if(!O.atomic)continue;if(f){var Q=O.find(d<0?1:-1),he=void 0;if((d<0?q:N)&&(Q=dO(o,Q,-d,Q&&Q.line==l.line?w:null)),Q&&Q.line==l.line&&(he=ot(Q,f))&&(d<0?he<0:he>0))return Oh(o,Q,l,d,g)}var oe=O.find(d<0?-1:1);return(d<0?N:q)&&(oe=dO(o,oe,d,oe.line==l.line?w:null)),oe?Oh(o,oe,l,d,g):null}}return l}function Xm(o,l,f,d,g){var w=d||1,b=Oh(o,l,f,w,g)||!g&&Oh(o,l,f,w,!0)||Oh(o,l,f,-w,g)||!g&&Oh(o,l,f,-w,!0);return b||(o.cantEdit=!0,_e(o.first,0))}function dO(o,l,f,d){return f<0&&l.ch==0?l.line>o.first?at(o,_e(l.line-1)):null:f>0&&l.ch==(d||Fe(o,l.line)).text.length?l.line<o.first+o.size-1?_e(l.line+1,0):null:new _e(l.line,l.ch+f)}function fO(o){o.setSelection(_e(o.firstLine(),0),_e(o.lastLine()),S)}function gO(o,l,f){var d={canceled:!1,from:l.from,to:l.to,text:l.text,origin:l.origin,cancel:function(){return d.canceled=!0}};return f&&(d.update=function(g,w,b,T){g&&(d.from=at(o,g)),w&&(d.to=at(o,w)),b&&(d.text=b),T!==void 0&&(d.origin=T)}),Nt(o,"beforeChange",o,d),o.cm&&Nt(o.cm,"beforeChange",o.cm,d),d.canceled?(o.cm&&(o.cm.curOp.updateInput=2),null):{from:d.from,to:d.to,text:d.text,origin:d.origin}}function Ph(o,l,f){if(o.cm){if(!o.cm.curOp)return tn(o.cm,Ph)(o,l,f);if(o.cm.state.suppressEdits)return}if(!((Ft(o,"beforeChange")||o.cm&&Ft(o.cm,"beforeChange"))&&(l=gO(o,l,!0),!l))){var d=sI&&!f&&pz(o,l.from,l.to);if(d)for(var g=d.length-1;g>=0;--g)mO(o,{from:d[g].from,to:d[g].to,text:g?[""]:l.text,origin:l.origin});else mO(o,l)}}function mO(o,l){if(!(l.text.length==1&&l.text[0]==""&&ot(l.from,l.to)==0)){var f=$C(o,l);nO(o,l,f,o.cm?o.cm.curOp.id:NaN),Hd(o,l,f,gC(o,l));var d=[];za(o,function(g,w){!w&&F(d,g.history)==-1&&(yO(g.history,l),d.push(g.history)),Hd(g,l,null,gC(g,l))})}}function Zm(o,l,f){var d=o.cm&&o.cm.state.suppressEdits;if(!(d&&!f)){for(var g=o.history,w,b=o.sel,T=l=="undo"?g.done:g.undone,O=l=="undo"?g.undone:g.done,N=0;N<T.length&&(w=T[N],!(f?w.ranges&&!w.equals(o.sel):!w.ranges));N++);if(N!=T.length){for(g.lastOrigin=g.lastSelOrigin=null;;)if(w=T.pop(),w.ranges){if(Gm(w,O),f&&!w.equals(o.sel)){Rn(o,w,{clearRedo:!1});return}b=w}else if(d){T.push(w);return}else break;var q=[];Gm(b,O),O.push({changes:q,generation:g.generation}),g.generation=w.generation||++g.maxGeneration;for(var Q=Ft(o,"beforeChange")||o.cm&&Ft(o.cm,"beforeChange"),he=function(Ce){var Te=w.changes[Ce];if(Te.origin=l,Q&&!gO(o,Te,!1))return T.length=0,{};q.push(UC(o,Te));var Oe=Ce?$C(o,Te):G(T);Hd(o,Te,Oe,sO(o,Te)),!Ce&&o.cm&&o.cm.scrollIntoView({from:Te.from,to:Va(Te)});var De=[];za(o,function(Pe,Ve){!Ve&&F(De,Pe.history)==-1&&(yO(Pe.history,Te),De.push(Pe.history)),Hd(Pe,Te,null,sO(Pe,Te))})},oe=w.changes.length-1;oe>=0;--oe){var pe=he(oe);if(pe)return pe.v}}}}function pO(o,l){if(l!=0&&(o.first+=l,o.sel=new _i(ee(o.sel.ranges,function(g){return new kt(_e(g.anchor.line+l,g.anchor.ch),_e(g.head.line+l,g.head.ch))}),o.sel.primIndex),o.cm)){zn(o.cm,o.first,o.first-l,l);for(var f=o.cm.display,d=f.viewFrom;d<f.viewTo;d++)Wa(o.cm,d,"gutter")}}function Hd(o,l,f,d){if(o.cm&&!o.cm.curOp)return tn(o.cm,Hd)(o,l,f,d);if(l.to.line<o.first){pO(o,l.text.length-1-(l.to.line-l.from.line));return}if(!(l.from.line>o.lastLine())){if(l.from.line<o.first){var g=l.text.length-1-(o.first-l.from.line);pO(o,g),l={from:_e(o.first,0),to:_e(l.to.line+g,l.to.ch),text:[G(l.text)],origin:l.origin}}var w=o.lastLine();l.to.line>w&&(l={from:l.from,to:_e(w,Fe(o,w).text.length),text:[l.text[0]],origin:l.origin}),l.removed=js(o,l.from,l.to),f||(f=$C(o,l)),o.cm?CU(o.cm,l,d):zC(o,l,d),Km(o,f,S),o.cantEdit&&Xm(o,_e(o.firstLine(),0))&&(o.cantEdit=!1)}}function CU(o,l,f){var d=o.doc,g=o.display,w=l.from,b=l.to,T=!1,O=w.line;o.options.lineWrapping||(O=Ut(hs(Fe(d,w.line))),d.iter(O,b.line+1,function(oe){if(oe==g.maxLine)return T=!0,!0})),d.sel.contains(l.from,l.to)>-1&&Sm(o),zC(d,l,f,kI(o)),o.options.lineWrapping||(d.iter(O,w.line+l.text.length,function(oe){var pe=Nm(oe);pe>g.maxLineLength&&(g.maxLine=oe,g.maxLineLength=pe,g.maxLineChanged=!0,T=!1)}),T&&(o.curOp.updateMaxLine=!0)),uz(d,w.line),Od(o,400);var N=l.text.length-(b.line-w.line)-1;l.full?zn(o):w.line==b.line&&l.text.length==1&&!JI(o.doc,l)?Wa(o,w.line,"text"):zn(o,w.line,b.line+1,N);var q=Ft(o,"changes"),Q=Ft(o,"change");if(Q||q){var he={from:w,to:b,text:l.text,removed:l.removed,origin:l.origin};Q&&en(o,"change",o,he),q&&(o.curOp.changeObjs||(o.curOp.changeObjs=[])).push(he)}o.display.selForContextMenu=null}function Ah(o,l,f,d,g){var w;d||(d=f),ot(d,f)<0&&(w=[d,f],f=w[0],d=w[1]),typeof l=="string"&&(l=o.splitLines(l)),Ph(o,{from:f,to:d,text:l,origin:g})}function vO(o,l,f,d){f<o.line?o.line+=d:l<o.line&&(o.line=l,o.ch=0)}function wO(o,l,f,d){for(var g=0;g<o.length;++g){var w=o[g],b=!0;if(w.ranges){w.copied||(w=o[g]=w.deepCopy(),w.copied=!0);for(var T=0;T<w.ranges.length;T++)vO(w.ranges[T].anchor,l,f,d),vO(w.ranges[T].head,l,f,d);continue}for(var O=0;O<w.changes.length;++O){var N=w.changes[O];if(f<N.from.line)N.from=_e(N.from.line+d,N.from.ch),N.to=_e(N.to.line+d,N.to.ch);else if(l<=N.to.line){b=!1;break}}b||(o.splice(0,g+1),g=0)}}function yO(o,l){var f=l.from.line,d=l.to.line,g=l.text.length-(d-f)-1;wO(o.done,f,d,g),wO(o.undone,f,d,g)}function Nd(o,l,f,d){var g=l,w=l;return typeof l=="number"?w=Fe(o,XM(o,l)):g=Ut(l),g==null?null:(d(w,g)&&o.cm&&Wa(o.cm,g,f),w)}function kd(o){this.lines=o,this.parent=null;for(var l=0,f=0;f<o.length;++f)o[f].parent=this,l+=o[f].height;this.height=l}kd.prototype={chunkSize:function(){return this.lines.length},removeInner:function(o,l){for(var f=o,d=o+l;f<d;++f){var g=this.lines[f];this.height-=g.height,bz(g),en(g,"delete")}this.lines.splice(o,l)},collapse:function(o){o.push.apply(o,this.lines)},insertInner:function(o,l,f){this.height+=f,this.lines=this.lines.slice(0,o).concat(l).concat(this.lines.slice(o));for(var d=0;d<l.length;++d)l[d].parent=this},iterN:function(o,l,f){for(var d=o+l;o<d;++o)if(f(this.lines[o]))return!0}};function Dd(o){this.children=o;for(var l=0,f=0,d=0;d<o.length;++d){var g=o[d];l+=g.chunkSize(),f+=g.height,g.parent=this}this.size=l,this.height=f,this.parent=null}Dd.prototype={chunkSize:function(){return this.size},removeInner:function(o,l){this.size-=l;for(var f=0;f<this.children.length;++f){var d=this.children[f],g=d.chunkSize();if(o<g){var w=Math.min(l,g-o),b=d.height;if(d.removeInner(o,w),this.height-=b-d.height,g==w&&(this.children.splice(f--,1),d.parent=null),(l-=w)==0)break;o=0}else o-=g}if(this.size-l<25&&(this.children.length>1||!(this.children[0]instanceof kd))){var T=[];this.collapse(T),this.children=[new kd(T)],this.children[0].parent=this}},collapse:function(o){for(var l=0;l<this.children.length;++l)this.children[l].collapse(o)},insertInner:function(o,l,f){this.size+=l.length,this.height+=f;for(var d=0;d<this.children.length;++d){var g=this.children[d],w=g.chunkSize();if(o<=w){if(g.insertInner(o,l,f),g.lines&&g.lines.length>50){for(var b=g.lines.length%25+25,T=b;T<g.lines.length;){var O=new kd(g.lines.slice(T,T+=25));g.height-=O.height,this.children.splice(++d,0,O),O.parent=this}g.lines=g.lines.slice(0,b),this.maybeSpill()}break}o-=w}},maybeSpill:function(){if(!(this.children.length<=10)){var o=this;do{var l=o.children.splice(o.children.length-5,5),f=new Dd(l);if(o.parent){o.size-=f.size,o.height-=f.height;var g=F(o.parent.children,o);o.parent.children.splice(g+1,0,f)}else{var d=new Dd(o.children);d.parent=o,o.children=[d,f],o=d}f.parent=o.parent}while(o.children.length>10);o.parent.maybeSpill()}},iterN:function(o,l,f){for(var d=0;d<this.children.length;++d){var g=this.children[d],w=g.chunkSize();if(o<w){var b=Math.min(l,w-o);if(g.iterN(o,b,f))return!0;if((l-=b)==0)break;o=0}else o-=w}}};var Ld=function(o,l,f){if(f)for(var d in f)f.hasOwnProperty(d)&&(this[d]=f[d]);this.doc=o,this.node=l};Ld.prototype.clear=function(){var o=this.doc.cm,l=this.line.widgets,f=this.line,d=Ut(f);if(!(d==null||!l)){for(var g=0;g<l.length;++g)l[g]==this&&l.splice(g--,1);l.length||(f.widgets=null);var w=Rd(this);Ys(f,Math.max(0,f.height-w)),o&&(oi(o,function(){CO(o,f,-w),Wa(o,d,"widget")}),en(o,"lineWidgetCleared",o,this,d))}},Ld.prototype.changed=function(){var o=this,l=this.height,f=this.doc.cm,d=this.line;this.height=null;var g=Rd(this)-l;g&&(Fa(this.doc,d)||Ys(d,d.height+g),f&&oi(f,function(){f.curOp.forceUpdate=!0,CO(f,d,g),en(f,"lineWidgetChanged",f,o,Ut(d))}))},Ri(Ld);function CO(o,l,f){Bo(l)<(o.curOp&&o.curOp.scrollTop||o.doc.scrollTop)&&kC(o,f)}function bU(o,l,f,d){var g=new Ld(o,f,d),w=o.cm;return w&&g.noHScroll&&(w.display.alignWidgets=!0),Nd(o,l,"widget",function(b){var T=b.widgets||(b.widgets=[]);if(g.insertAt==null?T.push(g):T.splice(Math.min(T.length,Math.max(0,g.insertAt)),0,g),g.line=b,w&&!Fa(o,b)){var O=Bo(b)<o.scrollTop;Ys(b,b.height+Rd(g)),O&&kC(w,g.height),w.curOp.forceUpdate=!0}return!0}),w&&en(w,"lineWidgetAdded",w,g,typeof l=="number"?l:Ut(l)),g}var bO=0,Ua=function(o,l){this.lines=[],this.type=l,this.doc=o,this.id=++bO};Ua.prototype.clear=function(){if(!this.explicitlyCleared){var o=this.doc.cm,l=o&&!o.curOp;if(l&&ql(o),Ft(this,"clear")){var f=this.find();f&&en(this,"clear",f.from,f.to)}for(var d=null,g=null,w=0;w<this.lines.length;++w){var b=this.lines[w],T=Cd(b.markedSpans,this);o&&!this.collapsed?Wa(o,Ut(b),"text"):o&&(T.to!=null&&(g=Ut(b)),T.from!=null&&(d=Ut(b))),b.markedSpans=dz(b.markedSpans,T),T.from==null&&this.collapsed&&!Fa(this.doc,b)&&o&&Ys(b,Eh(o.display))}if(o&&this.collapsed&&!o.options.lineWrapping)for(var O=0;O<this.lines.length;++O){var N=hs(this.lines[O]),q=Nm(N);q>o.display.maxLineLength&&(o.display.maxLine=N,o.display.maxLineLength=q,o.display.maxLineChanged=!0)}d!=null&&o&&this.collapsed&&zn(o,d,g+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,o&&hO(o.doc)),o&&en(o,"markerCleared",o,this,d,g),l&&Kl(o),this.parent&&this.parent.clear()}},Ua.prototype.find=function(o,l){o==null&&this.type=="bookmark"&&(o=1);for(var f,d,g=0;g<this.lines.length;++g){var w=this.lines[g],b=Cd(w.markedSpans,this);if(b.from!=null&&(f=_e(l?w:Ut(w),b.from),o==-1))return f;if(b.to!=null&&(d=_e(l?w:Ut(w),b.to),o==1))return d}return f&&{from:f,to:d}},Ua.prototype.changed=function(){var o=this,l=this.find(-1,!0),f=this,d=this.doc.cm;!l||!d||oi(d,function(){var g=l.line,w=Ut(l.line),b=SC(d,w);if(b&&(xI(b),d.curOp.selectionChanged=d.curOp.forceUpdate=!0),d.curOp.updateMaxLine=!0,!Fa(f.doc,g)&&f.height!=null){var T=f.height;f.height=null;var O=Rd(f)-T;O&&Ys(g,g.height+O)}en(d,"markerChanged",d,o)})},Ua.prototype.attachLine=function(o){if(!this.lines.length&&this.doc.cm){var l=this.doc.cm.curOp;(!l.maybeHiddenMarkers||F(l.maybeHiddenMarkers,this)==-1)&&(l.maybeUnhiddenMarkers||(l.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(o)},Ua.prototype.detachLine=function(o){if(this.lines.splice(F(this.lines,o),1),!this.lines.length&&this.doc.cm){var l=this.doc.cm.curOp;(l.maybeHiddenMarkers||(l.maybeHiddenMarkers=[])).push(this)}},Ri(Ua);function Hh(o,l,f,d,g){if(d&&d.shared)return SU(o,l,f,d,g);if(o.cm&&!o.cm.curOp)return tn(o.cm,Hh)(o,l,f,d,g);var w=new Ua(o,g),b=ot(l,f);if(d&&ge(d,w,!1),b>0||b==0&&w.clearWhenEmpty!==!1)return w;if(w.replacedWith&&(w.collapsed=!0,w.widgetNode=Le("span",[w.replacedWith],"CodeMirror-widget"),d.handleMouseEvents||w.widgetNode.setAttribute("cm-ignore-events","true"),d.insertLeft&&(w.widgetNode.insertLeft=!0)),w.collapsed){if(cI(o,l.line,l,f,w)||l.line!=f.line&&cI(o,f.line,l,f,w))throw new Error("Inserting collapsed marker partially overlapping an existing one");cz()}w.addToHistory&&nO(o,{from:l,to:f,origin:"markText"},o.sel,NaN);var T=l.line,O=o.cm,N;if(o.iter(T,f.line+1,function(Q){O&&w.collapsed&&!O.options.lineWrapping&&hs(Q)==O.display.maxLine&&(N=!0),w.collapsed&&T!=l.line&&Ys(Q,0),fz(Q,new Om(w,T==l.line?l.ch:null,T==f.line?f.ch:null),o.cm&&o.cm.curOp),++T}),w.collapsed&&o.iter(l.line,f.line+1,function(Q){Fa(o,Q)&&Ys(Q,0)}),w.clearOnEnter&&qe(w,"beforeCursorEnter",function(){return w.clear()}),w.readOnly&&(hz(),(o.history.done.length||o.history.undone.length)&&o.clearHistory()),w.collapsed&&(w.id=++bO,w.atomic=!0),O){if(N&&(O.curOp.updateMaxLine=!0),w.collapsed)zn(O,l.line,f.line+1);else if(w.className||w.startStyle||w.endStyle||w.css||w.attributes||w.title)for(var q=l.line;q<=f.line;q++)Wa(O,q,"text");w.atomic&&hO(O.doc),en(O,"markerAdded",O,w)}return w}var Fd=function(o,l){this.markers=o,this.primary=l;for(var f=0;f<o.length;++f)o[f].parent=this};Fd.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var o=0;o<this.markers.length;++o)this.markers[o].clear();en(this,"clear")}},Fd.prototype.find=function(o,l){return this.primary.find(o,l)},Ri(Fd);function SU(o,l,f,d,g){d=ge(d),d.shared=!1;var w=[Hh(o,l,f,d,g)],b=w[0],T=d.widgetNode;return za(o,function(O){T&&(d.widgetNode=T.cloneNode(!0)),w.push(Hh(O,at(O,l),at(O,f),d,g));for(var N=0;N<O.linked.length;++N)if(O.linked[N].isParent)return;b=G(w)}),new Fd(w,b)}function SO(o){return o.findMarks(_e(o.first,0),o.clipPos(_e(o.lastLine())),function(l){return l.parent})}function RU(o,l){for(var f=0;f<l.length;f++){var d=l[f],g=d.find(),w=o.clipPos(g.from),b=o.clipPos(g.to);if(ot(w,b)){var T=Hh(o,w,b,d.primary,d.primary.type);d.markers.push(T),T.parent=d}}}function EU(o){for(var l=function(d){var g=o[d],w=[g.primary.doc];za(g.primary.doc,function(O){return w.push(O)});for(var b=0;b<g.markers.length;b++){var T=g.markers[b];F(w,T.doc)==-1&&(T.parent=null,g.markers.splice(b--,1))}},f=0;f<o.length;f++)l(f)}var _U=0,Un=function(o,l,f,d,g){if(!(this instanceof Un))return new Un(o,l,f,d,g);f==null&&(f=0),Dd.call(this,[new kd([new bh("",null)])]),this.first=f,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=f;var w=_e(f,0);this.sel=$a(w),this.history=new Ym(null),this.id=++_U,this.modeOption=l,this.lineSep=d,this.direction=g=="rtl"?"rtl":"ltr",this.extend=!1,typeof o=="string"&&(o=this.splitLines(o)),zC(this,{from:w,to:w,text:o}),Rn(this,$a(w),S)};Un.prototype=be(Dd.prototype,{constructor:Un,iter:function(o,l,f){f?this.iterN(o-this.first,l-o,f):this.iterN(this.first,this.first+this.size,o)},insert:function(o,l){for(var f=0,d=0;d<l.length;++d)f+=l[d].height;this.insertInner(o-this.first,l,f)},remove:function(o,l){this.removeInner(o-this.first,l)},getValue:function(o){var l=Ch(this,this.first,this.first+this.size);return o===!1?l:l.join(o||this.lineSeparator())},setValue:rn(function(o){var l=_e(this.first,0),f=this.first+this.size-1;Ph(this,{from:l,to:_e(f,Fe(this,f).text.length),text:this.splitLines(o),origin:"setValue",full:!0},!0),this.cm&&Td(this.cm,0,0),Rn(this,$a(l),S)}),replaceRange:function(o,l,f,d){l=at(this,l),f=f?at(this,f):l,Ah(this,o,l,f,d)},getRange:function(o,l,f){var d=js(this,at(this,o),at(this,l));return f===!1?d:f===""?d.join(""):d.join(f||this.lineSeparator())},getLine:function(o){var l=this.getLineHandle(o);return l&&l.text},getLineHandle:function(o){if(wd(this,o))return Fe(this,o)},getLineNumber:function(o){return Ut(o)},getLineHandleVisualStart:function(o){return typeof o=="number"&&(o=Fe(this,o)),hs(o)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(o){return at(this,o)},getCursor:function(o){var l=this.sel.primary(),f;return o==null||o=="head"?f=l.head:o=="anchor"?f=l.anchor:o=="end"||o=="to"||o===!1?f=l.to():f=l.from(),f},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:rn(function(o,l,f){aO(this,at(this,typeof o=="number"?_e(o,l||0):o),null,f)}),setSelection:rn(function(o,l,f){aO(this,at(this,o),at(this,l||o),f)}),extendSelection:rn(function(o,l,f){qm(this,at(this,o),l&&at(this,l),f)}),extendSelections:rn(function(o,l){oO(this,ZM(this,o),l)}),extendSelectionsBy:rn(function(o,l){var f=ee(this.sel.ranges,o);oO(this,ZM(this,f),l)}),setSelections:rn(function(o,l,f){if(o.length){for(var d=[],g=0;g<o.length;g++)d[g]=new kt(at(this,o[g].anchor),at(this,o[g].head||o[g].anchor));l==null&&(l=Math.min(o.length-1,this.sel.primIndex)),Rn(this,ds(this.cm,d,l),f)}}),addSelection:rn(function(o,l,f){var d=this.sel.ranges.slice(0);d.push(new kt(at(this,o),at(this,l||o))),Rn(this,ds(this.cm,d,d.length-1),f)}),getSelection:function(o){for(var l=this.sel.ranges,f,d=0;d<l.length;d++){var g=js(this,l[d].from(),l[d].to());f=f?f.concat(g):g}return o===!1?f:f.join(o||this.lineSeparator())},getSelections:function(o){for(var l=[],f=this.sel.ranges,d=0;d<f.length;d++){var g=js(this,f[d].from(),f[d].to());o!==!1&&(g=g.join(o||this.lineSeparator())),l[d]=g}return l},replaceSelection:function(o,l,f){for(var d=[],g=0;g<this.sel.ranges.length;g++)d[g]=o;this.replaceSelections(d,l,f||"+input")},replaceSelections:rn(function(o,l,f){for(var d=[],g=this.sel,w=0;w<g.ranges.length;w++){var b=g.ranges[w];d[w]={from:b.from(),to:b.to(),text:this.splitLines(o[w]),origin:f}}for(var T=l&&l!="end"&&dU(this,d,l),O=d.length-1;O>=0;O--)Ph(this,d[O]);T?lO(this,T):this.cm&&xh(this.cm)}),undo:rn(function(){Zm(this,"undo")}),redo:rn(function(){Zm(this,"redo")}),undoSelection:rn(function(){Zm(this,"undo",!0)}),redoSelection:rn(function(){Zm(this,"redo",!0)}),setExtending:function(o){this.extend=o},getExtending:function(){return this.extend},historySize:function(){for(var o=this.history,l=0,f=0,d=0;d<o.done.length;d++)o.done[d].ranges||++l;for(var g=0;g<o.undone.length;g++)o.undone[g].ranges||++f;return{undo:l,redo:f}},clearHistory:function(){var o=this;this.history=new Ym(this.history),za(this,function(l){return l.history=o.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(o){return o&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(o){return this.history.generation==(o||this.cleanGeneration)},getHistory:function(){return{done:Ih(this.history.done),undone:Ih(this.history.undone)}},setHistory:function(o){var l=this.history=new Ym(this.history);l.done=Ih(o.done.slice(0),null,!0),l.undone=Ih(o.undone.slice(0),null,!0)},setGutterMarker:rn(function(o,l,f){return Nd(this,o,"gutter",function(d){var g=d.gutterMarkers||(d.gutterMarkers={});return g[l]=f,!f&&ke(g)&&(d.gutterMarkers=null),!0})}),clearGutter:rn(function(o){var l=this;this.iter(function(f){f.gutterMarkers&&f.gutterMarkers[o]&&Nd(l,f,"gutter",function(){return f.gutterMarkers[o]=null,ke(f.gutterMarkers)&&(f.gutterMarkers=null),!0})})}),lineInfo:function(o){var l;if(typeof o=="number"){if(!wd(this,o)||(l=o,o=Fe(this,o),!o))return null}else if(l=Ut(o),l==null)return null;return{line:l,handle:o,text:o.text,gutterMarkers:o.gutterMarkers,textClass:o.textClass,bgClass:o.bgClass,wrapClass:o.wrapClass,widgets:o.widgets}},addLineClass:rn(function(o,l,f){return Nd(this,o,l=="gutter"?"gutter":"class",function(d){var g=l=="text"?"textClass":l=="background"?"bgClass":l=="gutter"?"gutterClass":"wrapClass";if(!d[g])d[g]=f;else{if(fe(f).test(d[g]))return!1;d[g]+=" "+f}return!0})}),removeLineClass:rn(function(o,l,f){return Nd(this,o,l=="gutter"?"gutter":"class",function(d){var g=l=="text"?"textClass":l=="background"?"bgClass":l=="gutter"?"gutterClass":"wrapClass",w=d[g];if(w)if(f==null)d[g]=null;else{var b=w.match(fe(f));if(!b)return!1;var T=b.index+b[0].length;d[g]=w.slice(0,b.index)+(!b.index||T==w.length?"":" ")+w.slice(T)||null}else return!1;return!0})}),addLineWidget:rn(function(o,l,f){return bU(this,o,l,f)}),removeLineWidget:function(o){o.clear()},markText:function(o,l,f){return Hh(this,at(this,o),at(this,l),f,f&&f.type||"range")},setBookmark:function(o,l){var f={replacedWith:l&&(l.nodeType==null?l.widget:l),insertLeft:l&&l.insertLeft,clearWhenEmpty:!1,shared:l&&l.shared,handleMouseEvents:l&&l.handleMouseEvents};return o=at(this,o),Hh(this,o,o,f,"bookmark")},findMarksAt:function(o){o=at(this,o);var l=[],f=Fe(this,o.line).markedSpans;if(f)for(var d=0;d<f.length;++d){var g=f[d];(g.from==null||g.from<=o.ch)&&(g.to==null||g.to>=o.ch)&&l.push(g.marker.parent||g.marker)}return l},findMarks:function(o,l,f){o=at(this,o),l=at(this,l);var d=[],g=o.line;return this.iter(o.line,l.line+1,function(w){var b=w.markedSpans;if(b)for(var T=0;T<b.length;T++){var O=b[T];!(O.to!=null&&g==o.line&&o.ch>=O.to||O.from==null&&g!=o.line||O.from!=null&&g==l.line&&O.from>=l.ch)&&(!f||f(O.marker))&&d.push(O.marker.parent||O.marker)}++g}),d},getAllMarks:function(){var o=[];return this.iter(function(l){var f=l.markedSpans;if(f)for(var d=0;d<f.length;++d)f[d].from!=null&&o.push(f[d].marker)}),o},posFromIndex:function(o){var l,f=this.first,d=this.lineSeparator().length;return this.iter(function(g){var w=g.text.length+d;if(w>o)return l=o,!0;o-=w,++f}),at(this,_e(f,l))},indexFromPos:function(o){o=at(this,o);var l=o.ch;if(o.line<this.first||o.ch<0)return 0;var f=this.lineSeparator().length;return this.iter(this.first,o.line,function(d){l+=d.text.length+f}),l},copy:function(o){var l=new Un(Ch(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return l.scrollTop=this.scrollTop,l.scrollLeft=this.scrollLeft,l.sel=this.sel,l.extend=!1,o&&(l.history.undoDepth=this.history.undoDepth,l.setHistory(this.getHistory())),l},linkedDoc:function(o){o||(o={});var l=this.first,f=this.first+this.size;o.from!=null&&o.from>l&&(l=o.from),o.to!=null&&o.to<f&&(f=o.to);var d=new Un(Ch(this,l,f),o.mode||this.modeOption,l,this.lineSep,this.direction);return o.sharedHist&&(d.history=this.history),(this.linked||(this.linked=[])).push({doc:d,sharedHist:o.sharedHist}),d.linked=[{doc:this,isParent:!0,sharedHist:o.sharedHist}],RU(d,SO(this)),d},unlinkDoc:function(o){if(o instanceof ur&&(o=o.doc),this.linked)for(var l=0;l<this.linked.length;++l){var f=this.linked[l];if(f.doc==o){this.linked.splice(l,1),o.unlinkDoc(this),EU(SO(this));break}}if(o.history==this.history){var d=[o.id];za(o,function(g){return d.push(g.id)},!0),o.history=new Ym(null),o.history.done=Ih(this.history.done,d),o.history.undone=Ih(this.history.undone,d)}},iterLinkedDocs:function(o){za(this,o)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(o){return this.lineSep?o.split(this.lineSep):vh(o)},lineSeparator:function(){return this.lineSep||`
`},setDirection:rn(function(o){o!="rtl"&&(o="ltr"),o!=this.direction&&(this.direction=o,this.iter(function(l){return l.order=null}),this.cm&&fU(this.cm))})}),Un.prototype.eachLine=Un.prototype.iter;var RO=0;function TU(o){var l=this;if(EO(l),!(or(l,o)||$o(l.display,o))){Sn(o),h&&(RO=+new Date);var f=Ul(l,o,!0),d=o.dataTransfer.files;if(!(!f||l.isReadOnly()))if(d&&d.length&&window.FileReader&&window.File)for(var g=d.length,w=Array(g),b=0,T=function(){++b==g&&tn(l,function(){f=at(l.doc,f);var oe={from:f,to:f,text:l.doc.splitLines(w.filter(function(pe){return pe!=null}).join(l.doc.lineSeparator())),origin:"paste"};Ph(l.doc,oe),lO(l.doc,$a(at(l.doc,f),at(l.doc,Va(oe))))})()},O=function(oe,pe){if(l.options.allowDropFileTypes&&F(l.options.allowDropFileTypes,oe.type)==-1){T();return}var Ce=new FileReader;Ce.onerror=function(){return T()},Ce.onload=function(){var Te=Ce.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(Te)){T();return}w[pe]=Te,T()},Ce.readAsText(oe)},N=0;N<d.length;N++)O(d[N],N);else{if(l.state.draggingText&&l.doc.sel.contains(f)>-1){l.state.draggingText(o),setTimeout(function(){return l.display.input.focus()},20);return}try{var q=o.dataTransfer.getData("Text");if(q){var Q;if(l.state.draggingText&&!l.state.draggingText.copy&&(Q=l.listSelections()),Km(l.doc,$a(f,f)),Q)for(var he=0;he<Q.length;++he)Ah(l.doc,"",Q[he].anchor,Q[he].head,"drag");l.replaceSelection(q,"around","paste"),l.display.input.focus()}}catch{}}}}function xU(o,l){if(h&&(!o.state.draggingText||+new Date-RO<100)){ka(l);return}if(!(or(o,l)||$o(o.display,l))&&(l.dataTransfer.setData("Text",o.getSelection()),l.dataTransfer.effectAllowed="copyMove",l.dataTransfer.setDragImage&&!R)){var f=ie("img",null,null,"position: fixed; left: 0; top: 0;");f.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",C&&(f.width=f.height=1,o.display.wrapper.appendChild(f),f._top=f.offsetTop),l.dataTransfer.setDragImage(f,0,0),C&&f.parentNode.removeChild(f)}}function MU(o,l){var f=Ul(o,l);if(f){var d=document.createDocumentFragment();OC(o,f,d),o.display.dragCursor||(o.display.dragCursor=ie("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),o.display.lineSpace.insertBefore(o.display.dragCursor,o.display.cursorDiv)),P(o.display.dragCursor,d)}}function EO(o){o.display.dragCursor&&(o.display.lineSpace.removeChild(o.display.dragCursor),o.display.dragCursor=null)}function _O(o){if(document.getElementsByClassName){for(var l=document.getElementsByClassName("CodeMirror"),f=[],d=0;d<l.length;d++){var g=l[d].CodeMirror;g&&f.push(g)}f.length&&f[0].operation(function(){for(var w=0;w<f.length;w++)o(f[w])})}}var TO=!1;function IU(){TO||(OU(),TO=!0)}function OU(){var o;qe(window,"resize",function(){o==null&&(o=setTimeout(function(){o=null,_O(PU)},100))}),qe(window,"blur",function(){return _O(Th)})}function PU(o){var l=o.display;l.cachedCharWidth=l.cachedTextHeight=l.cachedPaddingH=null,l.scrollbarsClipped=!1,o.setSize()}for(var ja={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Wd=0;Wd<10;Wd++)ja[Wd+48]=ja[Wd+96]=String(Wd);for(var Qm=65;Qm<=90;Qm++)ja[Qm]=String.fromCharCode(Qm);for(var Bd=1;Bd<=12;Bd++)ja[Bd+111]=ja[Bd+63235]="F"+Bd;var zo={};zo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},zo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},zo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},zo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},zo.default=B?zo.macDefault:zo.pcDefault;function AU(o){var l=o.split(/-(?!$)/);o=l[l.length-1];for(var f,d,g,w,b=0;b<l.length-1;b++){var T=l[b];if(/^(cmd|meta|m)$/i.test(T))w=!0;else if(/^a(lt)?$/i.test(T))f=!0;else if(/^(c|ctrl|control)$/i.test(T))d=!0;else if(/^s(hift)?$/i.test(T))g=!0;else throw new Error("Unrecognized modifier name: "+T)}return f&&(o="Alt-"+o),d&&(o="Ctrl-"+o),w&&(o="Cmd-"+o),g&&(o="Shift-"+o),o}function HU(o){var l={};for(var f in o)if(o.hasOwnProperty(f)){var d=o[f];if(/^(name|fallthrough|(de|at)tach)$/.test(f))continue;if(d=="..."){delete o[f];continue}for(var g=ee(f.split(" "),AU),w=0;w<g.length;w++){var b=void 0,T=void 0;w==g.length-1?(T=g.join(" "),b=d):(T=g.slice(0,w+1).join(" "),b="...");var O=l[T];if(!O)l[T]=b;else if(O!=b)throw new Error("Inconsistent bindings for "+T)}delete o[f]}for(var N in l)o[N]=l[N];return o}function Nh(o,l,f,d){l=Jm(l);var g=l.call?l.call(o,d):l[o];if(g===!1)return"nothing";if(g==="...")return"multi";if(g!=null&&f(g))return"handled";if(l.fallthrough){if(Object.prototype.toString.call(l.fallthrough)!="[object Array]")return Nh(o,l.fallthrough,f,d);for(var w=0;w<l.fallthrough.length;w++){var b=Nh(o,l.fallthrough[w],f,d);if(b)return b}}}function xO(o){var l=typeof o=="string"?o:ja[o.keyCode];return l=="Ctrl"||l=="Alt"||l=="Shift"||l=="Mod"}function MO(o,l,f){var d=o;return l.altKey&&d!="Alt"&&(o="Alt-"+o),(se?l.metaKey:l.ctrlKey)&&d!="Ctrl"&&(o="Ctrl-"+o),(se?l.ctrlKey:l.metaKey)&&d!="Mod"&&(o="Cmd-"+o),!f&&l.shiftKey&&d!="Shift"&&(o="Shift-"+o),o}function IO(o,l){if(C&&o.keyCode==34&&o.char)return!1;var f=ja[o.keyCode];return f==null||o.altGraphKey?!1:(o.keyCode==3&&o.code&&(f=o.code),MO(f,o,l))}function Jm(o){return typeof o=="string"?zo[o]:o}function kh(o,l){for(var f=o.doc.sel.ranges,d=[],g=0;g<f.length;g++){for(var w=l(f[g]);d.length&&ot(w.from,G(d).to)<=0;){var b=d.pop();if(ot(b.from,w.from)<0){w.from=b.from;break}}d.push(w)}oi(o,function(){for(var T=d.length-1;T>=0;T--)Ah(o.doc,"",d[T].from,d[T].to,"+delete");xh(o)})}function GC(o,l,f){var d=pr(o.text,l+f,f);return d<0||d>o.text.length?null:d}function qC(o,l,f){var d=GC(o,l.ch,f);return d==null?null:new _e(l.line,d,f<0?"after":"before")}function KC(o,l,f,d,g){if(o){l.doc.direction=="rtl"&&(g=-g);var w=st(f,l.doc.direction);if(w){var b=g<0?G(w):w[0],T=g<0==(b.level==1),O=T?"after":"before",N;if(b.level>0||l.doc.direction=="rtl"){var q=Rh(l,f);N=g<0?f.text.length-1:0;var Q=Ks(l,q,N).top;N=zt(function(he){return Ks(l,q,he).top==Q},g<0==(b.level==1)?b.from:b.to-1,N),O=="before"&&(N=GC(f,N,1))}else N=g<0?b.to:b.from;return new _e(d,N,O)}}return new _e(d,g<0?f.text.length:0,g<0?"before":"after")}function NU(o,l,f,d){var g=st(l,o.doc.direction);if(!g)return qC(l,f,d);f.ch>=l.text.length?(f.ch=l.text.length,f.sticky="before"):f.ch<=0&&(f.ch=0,f.sticky="after");var w=Mt(g,f.ch,f.sticky),b=g[w];if(o.doc.direction=="ltr"&&b.level%2==0&&(d>0?b.to>f.ch:b.from<f.ch))return qC(l,f,d);var T=function(Oe,De){return GC(l,Oe instanceof _e?Oe.ch:Oe,De)},O,N=function(Oe){return o.options.lineWrapping?(O=O||Rh(o,l),NI(o,l,O,Oe)):{begin:0,end:l.text.length}},q=N(f.sticky=="before"?T(f,-1):f.ch);if(o.doc.direction=="rtl"||b.level==1){var Q=b.level==1==d<0,he=T(f,Q?1:-1);if(he!=null&&(Q?he<=b.to&&he<=q.end:he>=b.from&&he>=q.begin)){var oe=Q?"before":"after";return new _e(f.line,he,oe)}}var pe=function(Oe,De,Pe){for(var Ve=function(Qt,nn){return nn?new _e(f.line,T(Qt,1),"before"):new _e(f.line,Qt,"after")};Oe>=0&&Oe<g.length;Oe+=De){var et=g[Oe],Qe=De>0==(et.level!=1),gt=Qe?Pe.begin:T(Pe.end,-1);if(et.from<=gt&&gt<et.to||(gt=Qe?et.from:T(et.to,-1),Pe.begin<=gt&&gt<Pe.end))return Ve(gt,Qe)}},Ce=pe(w+d,d,q);if(Ce)return Ce;var Te=d>0?q.end:T(q.begin,-1);return Te!=null&&!(d>0&&Te==l.text.length)&&(Ce=pe(d>0?0:g.length-1,d,N(Te)),Ce)?Ce:null}var $d={selectAll:fO,singleSelection:function(o){return o.setSelection(o.getCursor("anchor"),o.getCursor("head"),S)},killLine:function(o){return kh(o,function(l){if(l.empty()){var f=Fe(o.doc,l.head.line).text.length;return l.head.ch==f&&l.head.line<o.lastLine()?{from:l.head,to:_e(l.head.line+1,0)}:{from:l.head,to:_e(l.head.line,f)}}else return{from:l.from(),to:l.to()}})},deleteLine:function(o){return kh(o,function(l){return{from:_e(l.from().line,0),to:at(o.doc,_e(l.to().line+1,0))}})},delLineLeft:function(o){return kh(o,function(l){return{from:_e(l.from().line,0),to:l.from()}})},delWrappedLineLeft:function(o){return kh(o,function(l){var f=o.charCoords(l.head,"div").top+5,d=o.coordsChar({left:0,top:f},"div");return{from:d,to:l.from()}})},delWrappedLineRight:function(o){return kh(o,function(l){var f=o.charCoords(l.head,"div").top+5,d=o.coordsChar({left:o.display.lineDiv.offsetWidth+100,top:f},"div");return{from:l.from(),to:d}})},undo:function(o){return o.undo()},redo:function(o){return o.redo()},undoSelection:function(o){return o.undoSelection()},redoSelection:function(o){return o.redoSelection()},goDocStart:function(o){return o.extendSelection(_e(o.firstLine(),0))},goDocEnd:function(o){return o.extendSelection(_e(o.lastLine()))},goLineStart:function(o){return o.extendSelectionsBy(function(l){return OO(o,l.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(o){return o.extendSelectionsBy(function(l){return PO(o,l.head)},{origin:"+move",bias:1})},goLineEnd:function(o){return o.extendSelectionsBy(function(l){return kU(o,l.head.line)},{origin:"+move",bias:-1})},goLineRight:function(o){return o.extendSelectionsBy(function(l){var f=o.cursorCoords(l.head,"div").top+5;return o.coordsChar({left:o.display.lineDiv.offsetWidth+100,top:f},"div")},K)},goLineLeft:function(o){return o.extendSelectionsBy(function(l){var f=o.cursorCoords(l.head,"div").top+5;return o.coordsChar({left:0,top:f},"div")},K)},goLineLeftSmart:function(o){return o.extendSelectionsBy(function(l){var f=o.cursorCoords(l.head,"div").top+5,d=o.coordsChar({left:0,top:f},"div");return d.ch<o.getLine(d.line).search(/\S/)?PO(o,l.head):d},K)},goLineUp:function(o){return o.moveV(-1,"line")},goLineDown:function(o){return o.moveV(1,"line")},goPageUp:function(o){return o.moveV(-1,"page")},goPageDown:function(o){return o.moveV(1,"page")},goCharLeft:function(o){return o.moveH(-1,"char")},goCharRight:function(o){return o.moveH(1,"char")},goColumnLeft:function(o){return o.moveH(-1,"column")},goColumnRight:function(o){return o.moveH(1,"column")},goWordLeft:function(o){return o.moveH(-1,"word")},goGroupRight:function(o){return o.moveH(1,"group")},goGroupLeft:function(o){return o.moveH(-1,"group")},goWordRight:function(o){return o.moveH(1,"word")},delCharBefore:function(o){return o.deleteH(-1,"codepoint")},delCharAfter:function(o){return o.deleteH(1,"char")},delWordBefore:function(o){return o.deleteH(-1,"word")},delWordAfter:function(o){return o.deleteH(1,"word")},delGroupBefore:function(o){return o.deleteH(-1,"group")},delGroupAfter:function(o){return o.deleteH(1,"group")},indentAuto:function(o){return o.indentSelection("smart")},indentMore:function(o){return o.indentSelection("add")},indentLess:function(o){return o.indentSelection("subtract")},insertTab:function(o){return o.replaceSelection("	")},insertSoftTab:function(o){for(var l=[],f=o.listSelections(),d=o.options.tabSize,g=0;g<f.length;g++){var w=f[g].from(),b=Se(o.getLine(w.line),w.ch,d);l.push(V(d-b%d))}o.replaceSelections(l)},defaultTab:function(o){o.somethingSelected()?o.indentSelection("add"):o.execCommand("insertTab")},transposeChars:function(o){return oi(o,function(){for(var l=o.listSelections(),f=[],d=0;d<l.length;d++)if(l[d].empty()){var g=l[d].head,w=Fe(o.doc,g.line).text;if(w){if(g.ch==w.length&&(g=new _e(g.line,g.ch-1)),g.ch>0)g=new _e(g.line,g.ch+1),o.replaceRange(w.charAt(g.ch-1)+w.charAt(g.ch-2),_e(g.line,g.ch-2),g,"+transpose");else if(g.line>o.doc.first){var b=Fe(o.doc,g.line-1).text;b&&(g=new _e(g.line,1),o.replaceRange(w.charAt(0)+o.doc.lineSeparator()+b.charAt(b.length-1),_e(g.line-1,b.length-1),g,"+transpose"))}}f.push(new kt(g,g))}o.setSelections(f)})},newlineAndIndent:function(o){return oi(o,function(){for(var l=o.listSelections(),f=l.length-1;f>=0;f--)o.replaceRange(o.doc.lineSeparator(),l[f].anchor,l[f].head,"+input");l=o.listSelections();for(var d=0;d<l.length;d++)o.indentLine(l[d].from().line,null,!0);xh(o)})},openLine:function(o){return o.replaceSelection(`
`,"start")},toggleOverwrite:function(o){return o.toggleOverwrite()}};function OO(o,l){var f=Fe(o.doc,l),d=hs(f);return d!=f&&(l=Ut(d)),KC(!0,o,d,l,1)}function kU(o,l){var f=Fe(o.doc,l),d=wz(f);return d!=f&&(l=Ut(d)),KC(!0,o,f,l,-1)}function PO(o,l){var f=OO(o,l.line),d=Fe(o.doc,f.line),g=st(d,o.doc.direction);if(!g||g[0].level==0){var w=Math.max(f.ch,d.text.search(/\S/)),b=l.line==f.line&&l.ch<=w&&l.ch;return _e(f.line,b?0:w,f.sticky)}return f}function ep(o,l,f){if(typeof l=="string"&&(l=$d[l],!l))return!1;o.display.input.ensurePolled();var d=o.display.shift,g=!1;try{o.isReadOnly()&&(o.state.suppressEdits=!0),f&&(o.display.shift=!1),g=l(o)!=le}finally{o.display.shift=d,o.state.suppressEdits=!1}return g}function DU(o,l,f){for(var d=0;d<o.state.keyMaps.length;d++){var g=Nh(l,o.state.keyMaps[d],f,o);if(g)return g}return o.options.extraKeys&&Nh(l,o.options.extraKeys,f,o)||Nh(l,o.options.keyMap,f,o)}var LU=new L;function Vd(o,l,f,d){var g=o.state.keySeq;if(g){if(xO(l))return"handled";if(/\'$/.test(l)?o.state.keySeq=null:LU.set(50,function(){o.state.keySeq==g&&(o.state.keySeq=null,o.display.input.reset())}),AO(o,g+" "+l,f,d))return!0}return AO(o,l,f,d)}function AO(o,l,f,d){var g=DU(o,l,d);return g=="multi"&&(o.state.keySeq=l),g=="handled"&&en(o,"keyHandled",o,l,f),(g=="handled"||g=="multi")&&(Sn(f),PC(o)),!!g}function HO(o,l){var f=IO(l,!0);return f?l.shiftKey&&!o.state.keySeq?Vd(o,"Shift-"+f,l,function(d){return ep(o,d,!0)})||Vd(o,f,l,function(d){if(typeof d=="string"?/^go[A-Z]/.test(d):d.motion)return ep(o,d)}):Vd(o,f,l,function(d){return ep(o,d)}):!1}function FU(o,l,f){return Vd(o,"'"+f+"'",l,function(d){return ep(o,d,!0)})}var XC=null;function NO(o){var l=this;if(!(o.target&&o.target!=l.display.input.getField())&&(l.curOp.focus=ve($(l)),!or(l,o))){h&&c<11&&o.keyCode==27&&(o.returnValue=!1);var f=o.keyCode;l.display.shift=f==16||o.shiftKey;var d=HO(l,o);C&&(XC=d?f:null,!d&&f==88&&!_m&&(B?o.metaKey:o.ctrlKey)&&l.replaceSelection("",null,"cut")),i&&!B&&!d&&f==46&&o.shiftKey&&!o.ctrlKey&&document.execCommand&&document.execCommand("cut"),f==18&&!/\bCodeMirror-crosshair\b/.test(l.display.lineDiv.className)&&WU(l)}}function WU(o){var l=o.display.lineDiv;Be(l,"CodeMirror-crosshair");function f(d){(d.keyCode==18||!d.altKey)&&(j(l,"CodeMirror-crosshair"),dn(document,"keyup",f),dn(document,"mouseover",f))}qe(document,"keyup",f),qe(document,"mouseover",f)}function kO(o){o.keyCode==16&&(this.doc.sel.shift=!1),or(this,o)}function DO(o){var l=this;if(!(o.target&&o.target!=l.display.input.getField())&&!($o(l.display,o)||or(l,o)||o.ctrlKey&&!o.altKey||B&&o.metaKey)){var f=o.keyCode,d=o.charCode;if(C&&f==XC){XC=null,Sn(o);return}if(!(C&&(!o.which||o.which<10)&&HO(l,o))){var g=String.fromCharCode(d??f);g!="\b"&&(FU(l,o,g)||l.display.input.onKeyPress(o))}}}var BU=400,ZC=function(o,l,f){this.time=o,this.pos=l,this.button=f};ZC.prototype.compare=function(o,l,f){return this.time+BU>o&&ot(l,this.pos)==0&&f==this.button};var zd,Ud;function $U(o,l){var f=+new Date;return Ud&&Ud.compare(f,o,l)?(zd=Ud=null,"triple"):zd&&zd.compare(f,o,l)?(Ud=new ZC(f,o,l),zd=null,"double"):(zd=new ZC(f,o,l),Ud=null,"single")}function LO(o){var l=this,f=l.display;if(!(or(l,o)||f.activeTouch&&f.input.supportsTouch())){if(f.input.ensurePolled(),f.shift=o.shiftKey,$o(f,o)){m||(f.scroller.draggable=!1,setTimeout(function(){return f.scroller.draggable=!0},100));return}if(!QC(l,o)){var d=Ul(l,o),g=Rm(o),w=d?$U(d,g):"single";ce(l).focus(),g==1&&l.state.selectingText&&l.state.selectingText(o),!(d&&VU(l,g,d,w,o))&&(g==1?d?UU(l,d,w,o):mh(o)==f.scroller&&Sn(o):g==2?(d&&qm(l.doc,d),setTimeout(function(){return f.input.focus()},20)):g==3&&(ne?l.display.input.onContextMenu(o):AC(l)))}}}function VU(o,l,f,d,g){var w="Click";return d=="double"?w="Double"+w:d=="triple"&&(w="Triple"+w),w=(l==1?"Left":l==2?"Middle":"Right")+w,Vd(o,MO(w,g),g,function(b){if(typeof b=="string"&&(b=$d[b]),!b)return!1;var T=!1;try{o.isReadOnly()&&(o.state.suppressEdits=!0),T=b(o,f)!=le}finally{o.state.suppressEdits=!1}return T})}function zU(o,l,f){var d=o.getOption("configureMouse"),g=d?d(o,l,f):{};if(g.unit==null){var w=z?f.shiftKey&&f.metaKey:f.altKey;g.unit=w?"rectangle":l=="single"?"char":l=="double"?"word":"line"}return(g.extend==null||o.doc.extend)&&(g.extend=o.doc.extend||f.shiftKey),g.addNew==null&&(g.addNew=B?f.metaKey:f.ctrlKey),g.moveOnDrag==null&&(g.moveOnDrag=!(B?f.altKey:f.ctrlKey)),g}function UU(o,l,f,d){h?setTimeout(we(FI,o),0):o.curOp.focus=ve($(o));var g=zU(o,f,d),w=o.doc.sel,b;o.options.dragDrop&&Fi&&!o.isReadOnly()&&f=="single"&&(b=w.contains(l))>-1&&(ot((b=w.ranges[b]).from(),l)<0||l.xRel>0)&&(ot(b.to(),l)>0||l.xRel<0)?jU(o,d,l,g):YU(o,d,l,g)}function jU(o,l,f,d){var g=o.display,w=!1,b=tn(o,function(N){m&&(g.scroller.draggable=!1),o.state.draggingText=!1,o.state.delayingBlurEvent&&(o.hasFocus()?o.state.delayingBlurEvent=!1:AC(o)),dn(g.wrapper.ownerDocument,"mouseup",b),dn(g.wrapper.ownerDocument,"mousemove",T),dn(g.scroller,"dragstart",O),dn(g.scroller,"drop",b),w||(Sn(N),d.addNew||qm(o.doc,f,null,null,d.extend),m&&!R||h&&c==9?setTimeout(function(){g.wrapper.ownerDocument.body.focus({preventScroll:!0}),g.input.focus()},20):g.input.focus())}),T=function(N){w=w||Math.abs(l.clientX-N.clientX)+Math.abs(l.clientY-N.clientY)>=10},O=function(){return w=!0};m&&(g.scroller.draggable=!0),o.state.draggingText=b,b.copy=!d.moveOnDrag,qe(g.wrapper.ownerDocument,"mouseup",b),qe(g.wrapper.ownerDocument,"mousemove",T),qe(g.scroller,"dragstart",O),qe(g.scroller,"drop",b),o.state.delayingBlurEvent=!0,setTimeout(function(){return g.input.focus()},20),g.scroller.dragDrop&&g.scroller.dragDrop()}function FO(o,l,f){if(f=="char")return new kt(l,l);if(f=="word")return o.findWordAt(l);if(f=="line")return new kt(_e(l.line,0),at(o.doc,_e(l.line+1,0)));var d=f(o,l);return new kt(d.from,d.to)}function YU(o,l,f,d){h&&AC(o);var g=o.display,w=o.doc;Sn(l);var b,T,O=w.sel,N=O.ranges;if(d.addNew&&!d.extend?(T=w.sel.contains(f),T>-1?b=N[T]:b=new kt(f,f)):(b=w.sel.primary(),T=w.sel.primIndex),d.unit=="rectangle")d.addNew||(b=new kt(f,f)),f=Ul(o,l,!0,!0),T=-1;else{var q=FO(o,f,d.unit);d.extend?b=jC(b,q.anchor,q.head,d.extend):b=q}d.addNew?T==-1?(T=N.length,Rn(w,ds(o,N.concat([b]),T),{scroll:!1,origin:"*mouse"})):N.length>1&&N[T].empty()&&d.unit=="char"&&!d.extend?(Rn(w,ds(o,N.slice(0,T).concat(N.slice(T+1)),0),{scroll:!1,origin:"*mouse"}),O=w.sel):YC(w,T,b,Y):(T=0,Rn(w,new _i([b],0),Y),O=w.sel);var Q=f;function he(Pe){if(ot(Q,Pe)!=0)if(Q=Pe,d.unit=="rectangle"){for(var Ve=[],et=o.options.tabSize,Qe=Se(Fe(w,f.line).text,f.ch,et),gt=Se(Fe(w,Pe.line).text,Pe.ch,et),Qt=Math.min(Qe,gt),nn=Math.max(Qe,gt),vr=Math.min(f.line,Pe.line),ai=Math.min(o.lastLine(),Math.max(f.line,Pe.line));vr<=ai;vr++){var jn=Fe(w,vr).text,$r=H(jn,Qt,et);Qt==nn?Ve.push(new kt(_e(vr,$r),_e(vr,$r))):jn.length>$r&&Ve.push(new kt(_e(vr,$r),_e(vr,H(jn,nn,et))))}Ve.length||Ve.push(new kt(f,f)),Rn(w,ds(o,O.ranges.slice(0,T).concat(Ve),T),{origin:"*mouse",scroll:!1}),o.scrollIntoView(Pe)}else{var Yn=b,mn=FO(o,Pe,d.unit),Kr=Yn.anchor,Vr;ot(mn.anchor,Kr)>0?(Vr=mn.head,Kr=Mm(Yn.from(),mn.anchor)):(Vr=mn.anchor,Kr=xm(Yn.to(),mn.head));var Cr=O.ranges.slice(0);Cr[T]=GU(o,new kt(at(w,Kr),Vr)),Rn(w,ds(o,Cr,T),Y)}}var oe=g.wrapper.getBoundingClientRect(),pe=0;function Ce(Pe){var Ve=++pe,et=Ul(o,Pe,!0,d.unit=="rectangle");if(et)if(ot(et,Q)!=0){o.curOp.focus=ve($(o)),he(et);var Qe=Vm(g,w);(et.line>=Qe.to||et.line<Qe.from)&&setTimeout(tn(o,function(){pe==Ve&&Ce(Pe)}),150)}else{var gt=Pe.clientY<oe.top?-20:Pe.clientY>oe.bottom?20:0;gt&&setTimeout(tn(o,function(){pe==Ve&&(g.scroller.scrollTop+=gt,Ce(Pe))}),50)}}function Te(Pe){o.state.selectingText=!1,pe=1/0,Pe&&(Sn(Pe),g.input.focus()),dn(g.wrapper.ownerDocument,"mousemove",Oe),dn(g.wrapper.ownerDocument,"mouseup",De),w.history.lastSelOrigin=null}var Oe=tn(o,function(Pe){Pe.buttons===0||!Rm(Pe)?Te(Pe):Ce(Pe)}),De=tn(o,Te);o.state.selectingText=De,qe(g.wrapper.ownerDocument,"mousemove",Oe),qe(g.wrapper.ownerDocument,"mouseup",De)}function GU(o,l){var f=l.anchor,d=l.head,g=Fe(o.doc,f.line);if(ot(f,d)==0&&f.sticky==d.sticky)return l;var w=st(g);if(!w)return l;var b=Mt(w,f.ch,f.sticky),T=w[b];if(T.from!=f.ch&&T.to!=f.ch)return l;var O=b+(T.from==f.ch==(T.level!=1)?0:1);if(O==0||O==w.length)return l;var N;if(d.line!=f.line)N=(d.line-f.line)*(o.doc.direction=="ltr"?1:-1)>0;else{var q=Mt(w,d.ch,d.sticky),Q=q-b||(d.ch-f.ch)*(T.level==1?-1:1);q==O-1||q==O?N=Q<0:N=Q>0}var he=w[O+(N?-1:0)],oe=N==(he.level==1),pe=oe?he.from:he.to,Ce=oe?"after":"before";return f.ch==pe&&f.sticky==Ce?l:new kt(new _e(f.line,pe,Ce),d)}function WO(o,l,f,d){var g,w;if(l.touches)g=l.touches[0].clientX,w=l.touches[0].clientY;else try{g=l.clientX,w=l.clientY}catch{return!1}if(g>=Math.floor(o.display.gutters.getBoundingClientRect().right))return!1;d&&Sn(l);var b=o.display,T=b.lineDiv.getBoundingClientRect();if(w>T.bottom||!Ft(o,f))return Bl(l);w-=T.top-b.viewOffset;for(var O=0;O<o.display.gutterSpecs.length;++O){var N=b.gutters.childNodes[O];if(N&&N.getBoundingClientRect().right>=g){var q=$l(o.doc,w),Q=o.display.gutterSpecs[O];return Nt(o,f,o,q,Q.className,l),Bl(l)}}}function QC(o,l){return WO(o,l,"gutterClick",!0)}function BO(o,l){$o(o.display,l)||qU(o,l)||or(o,l,"contextmenu")||ne||o.display.input.onContextMenu(l)}function qU(o,l){return Ft(o,"gutterContextMenu")?WO(o,l,"gutterContextMenu",!1):!1}function $O(o){o.display.wrapper.className=o.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+o.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ed(o)}var Dh={toString:function(){return"CodeMirror.Init"}},VO={},tp={};function KU(o){var l=o.optionHandlers;function f(d,g,w,b){o.defaults[d]=g,w&&(l[d]=b?function(T,O,N){N!=Dh&&w(T,O,N)}:w)}o.defineOption=f,o.Init=Dh,f("value","",function(d,g){return d.setValue(g)},!0),f("mode",null,function(d,g){d.doc.modeOption=g,VC(d)},!0),f("indentUnit",2,VC,!0),f("indentWithTabs",!1),f("smartIndent",!0),f("tabSize",4,function(d){Ad(d),Ed(d),zn(d)},!0),f("lineSeparator",null,function(d,g){if(d.doc.lineSep=g,!!g){var w=[],b=d.doc.first;d.doc.iter(function(O){for(var N=0;;){var q=O.text.indexOf(g,N);if(q==-1)break;N=q+g.length,w.push(_e(b,q))}b++});for(var T=w.length-1;T>=0;T--)Ah(d.doc,g,w[T],_e(w[T].line,w[T].ch+g.length))}}),f("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,function(d,g,w){d.state.specialChars=new RegExp(g.source+(g.test("	")?"":"|	"),"g"),w!=Dh&&d.refresh()}),f("specialCharPlaceholder",Ez,function(d){return d.refresh()},!0),f("electricChars",!0),f("inputStyle",W?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),f("spellcheck",!1,function(d,g){return d.getInputField().spellcheck=g},!0),f("autocorrect",!1,function(d,g){return d.getInputField().autocorrect=g},!0),f("autocapitalize",!1,function(d,g){return d.getInputField().autocapitalize=g},!0),f("rtlMoveVisually",!U),f("wholeLineUpdateBefore",!0),f("theme","default",function(d){$O(d),Pd(d)},!0),f("keyMap","default",function(d,g,w){var b=Jm(g),T=w!=Dh&&Jm(w);T&&T.detach&&T.detach(d,b),b.attach&&b.attach(d,T||null)}),f("extraKeys",null),f("configureMouse",null),f("lineWrapping",!1,ZU,!0),f("gutters",[],function(d,g){d.display.gutterSpecs=BC(g,d.options.lineNumbers),Pd(d)},!0),f("fixedGutter",!0,function(d,g){d.display.gutters.style.left=g?MC(d.display)+"px":"0",d.refresh()},!0),f("coverGutterNextToScrollbar",!1,function(d){return Mh(d)},!0),f("scrollbarStyle","native",function(d){UI(d),Mh(d),d.display.scrollbars.setScrollTop(d.doc.scrollTop),d.display.scrollbars.setScrollLeft(d.doc.scrollLeft)},!0),f("lineNumbers",!1,function(d,g){d.display.gutterSpecs=BC(d.options.gutters,g),Pd(d)},!0),f("firstLineNumber",1,Pd,!0),f("lineNumberFormatter",function(d){return d},Pd,!0),f("showCursorWhenSelecting",!1,_d,!0),f("resetSelectionOnContextMenu",!0),f("lineWiseCopyCut",!0),f("pasteLinesPerSelection",!0),f("selectionsMayTouch",!1),f("readOnly",!1,function(d,g){g=="nocursor"&&(Th(d),d.display.input.blur()),d.display.input.readOnlyChanged(g)}),f("screenReaderLabel",null,function(d,g){g=g===""?null:g,d.display.input.screenReaderLabelChanged(g)}),f("disableInput",!1,function(d,g){g||d.display.input.reset()},!0),f("dragDrop",!0,XU),f("allowDropFileTypes",null),f("cursorBlinkRate",530),f("cursorScrollMargin",0),f("cursorHeight",1,_d,!0),f("singleCursorHeightPerLine",!0,_d,!0),f("workTime",100),f("workDelay",100),f("flattenSpans",!0,Ad,!0),f("addModeClass",!1,Ad,!0),f("pollInterval",100),f("undoDepth",200,function(d,g){return d.doc.history.undoDepth=g}),f("historyEventDelay",1250),f("viewportMargin",10,function(d){return d.refresh()},!0),f("maxHighlightLength",1e4,Ad,!0),f("moveInputWithCursor",!0,function(d,g){g||d.display.input.resetPosition()}),f("tabindex",null,function(d,g){return d.display.input.getField().tabIndex=g||""}),f("autofocus",null),f("direction","ltr",function(d,g){return d.doc.setDirection(g)},!0),f("phrases",null)}function XU(o,l,f){var d=f&&f!=Dh;if(!l!=!d){var g=o.display.dragFunctions,w=l?qe:dn;w(o.display.scroller,"dragstart",g.start),w(o.display.scroller,"dragenter",g.enter),w(o.display.scroller,"dragover",g.over),w(o.display.scroller,"dragleave",g.leave),w(o.display.scroller,"drop",g.drop)}}function ZU(o){o.options.lineWrapping?(Be(o.display.wrapper,"CodeMirror-wrap"),o.display.sizer.style.minWidth="",o.display.sizerWidth=null):(j(o.display.wrapper,"CodeMirror-wrap"),wC(o)),IC(o),zn(o),Ed(o),setTimeout(function(){return Mh(o)},100)}function ur(o,l){var f=this;if(!(this instanceof ur))return new ur(o,l);this.options=l=l?ge(l):{},ge(VO,l,!1);var d=l.value;typeof d=="string"?d=new Un(d,l.mode,null,l.lineSeparator,l.direction):l.mode&&(d.modeOption=l.mode),this.doc=d;var g=new ur.inputStyles[l.inputStyle](this),w=this.display=new hU(o,d,g,l);w.wrapper.CodeMirror=this,$O(this),l.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),UI(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new L,keySeq:null,specialChars:null},l.autofocus&&!W&&w.input.focus(),h&&c<11&&setTimeout(function(){return f.display.input.reset(!0)},20),QU(this),IU(),ql(this),this.curOp.forceUpdate=!0,eO(this,d),l.autofocus&&!W||this.hasFocus()?setTimeout(function(){f.hasFocus()&&!f.state.focused&&HC(f)},20):Th(this);for(var b in tp)tp.hasOwnProperty(b)&&tp[b](this,l[b],Dh);GI(this),l.finishInit&&l.finishInit(this);for(var T=0;T<JC.length;++T)JC[T](this);Kl(this),m&&l.lineWrapping&&getComputedStyle(w.lineDiv).textRendering=="optimizelegibility"&&(w.lineDiv.style.textRendering="auto")}ur.defaults=VO,ur.optionHandlers=tp;function QU(o){var l=o.display;qe(l.scroller,"mousedown",tn(o,LO)),h&&c<11?qe(l.scroller,"dblclick",tn(o,function(O){if(!or(o,O)){var N=Ul(o,O);if(!(!N||QC(o,O)||$o(o.display,O))){Sn(O);var q=o.findWordAt(N);qm(o.doc,q.anchor,q.head)}}})):qe(l.scroller,"dblclick",function(O){return or(o,O)||Sn(O)}),qe(l.scroller,"contextmenu",function(O){return BO(o,O)}),qe(l.input.getField(),"contextmenu",function(O){l.scroller.contains(O.target)||BO(o,O)});var f,d={end:0};function g(){l.activeTouch&&(f=setTimeout(function(){return l.activeTouch=null},1e3),d=l.activeTouch,d.end=+new Date)}function w(O){if(O.touches.length!=1)return!1;var N=O.touches[0];return N.radiusX<=1&&N.radiusY<=1}function b(O,N){if(N.left==null)return!0;var q=N.left-O.left,Q=N.top-O.top;return q*q+Q*Q>20*20}qe(l.scroller,"touchstart",function(O){if(!or(o,O)&&!w(O)&&!QC(o,O)){l.input.ensurePolled(),clearTimeout(f);var N=+new Date;l.activeTouch={start:N,moved:!1,prev:N-d.end<=300?d:null},O.touches.length==1&&(l.activeTouch.left=O.touches[0].pageX,l.activeTouch.top=O.touches[0].pageY)}}),qe(l.scroller,"touchmove",function(){l.activeTouch&&(l.activeTouch.moved=!0)}),qe(l.scroller,"touchend",function(O){var N=l.activeTouch;if(N&&!$o(l,O)&&N.left!=null&&!N.moved&&new Date-N.start<300){var q=o.coordsChar(l.activeTouch,"page"),Q;!N.prev||b(N,N.prev)?Q=new kt(q,q):!N.prev.prev||b(N,N.prev.prev)?Q=o.findWordAt(q):Q=new kt(_e(q.line,0),at(o.doc,_e(q.line+1,0))),o.setSelection(Q.anchor,Q.head),o.focus(),Sn(O)}g()}),qe(l.scroller,"touchcancel",g),qe(l.scroller,"scroll",function(){l.scroller.clientHeight&&(xd(o,l.scroller.scrollTop),Yl(o,l.scroller.scrollLeft,!0),Nt(o,"scroll",o))}),qe(l.scroller,"mousewheel",function(O){return XI(o,O)}),qe(l.scroller,"DOMMouseScroll",function(O){return XI(o,O)}),qe(l.wrapper,"scroll",function(){return l.wrapper.scrollTop=l.wrapper.scrollLeft=0}),l.dragFunctions={enter:function(O){or(o,O)||ka(O)},over:function(O){or(o,O)||(MU(o,O),ka(O))},start:function(O){return xU(o,O)},drop:tn(o,TU),leave:function(O){or(o,O)||EO(o)}};var T=l.input.getField();qe(T,"keyup",function(O){return kO.call(o,O)}),qe(T,"keydown",tn(o,NO)),qe(T,"keypress",tn(o,DO)),qe(T,"focus",function(O){return HC(o,O)}),qe(T,"blur",function(O){return Th(o,O)})}var JC=[];ur.defineInitHook=function(o){return JC.push(o)};function jd(o,l,f,d){var g=o.doc,w;f==null&&(f="add"),f=="smart"&&(g.mode.indent?w=yd(o,l).state:f="prev");var b=o.options.tabSize,T=Fe(g,l),O=Se(T.text,null,b);T.stateAfter&&(T.stateAfter=null);var N=T.text.match(/^\s*/)[0],q;if(!d&&!/\S/.test(T.text))q=0,f="not";else if(f=="smart"&&(q=g.mode.indent(w,T.text.slice(N.length),T.text),q==le||q>150)){if(!d)return;f="prev"}f=="prev"?l>g.first?q=Se(Fe(g,l-1).text,null,b):q=0:f=="add"?q=O+o.options.indentUnit:f=="subtract"?q=O-o.options.indentUnit:typeof f=="number"&&(q=O+f),q=Math.max(0,q);var Q="",he=0;if(o.options.indentWithTabs)for(var oe=Math.floor(q/b);oe;--oe)he+=b,Q+="	";if(he<q&&(Q+=V(q-he)),Q!=N)return Ah(g,Q,_e(l,0),_e(l,N.length),"+input"),T.stateAfter=null,!0;for(var pe=0;pe<g.sel.ranges.length;pe++){var Ce=g.sel.ranges[pe];if(Ce.head.line==l&&Ce.head.ch<N.length){var Te=_e(l,N.length);YC(g,pe,new kt(Te,Te));break}}}var fs=null;function rp(o){fs=o}function eb(o,l,f,d,g){var w=o.doc;o.display.shift=!1,d||(d=w.sel);var b=+new Date-200,T=g=="paste"||o.state.pasteIncoming>b,O=vh(l),N=null;if(T&&d.ranges.length>1)if(fs&&fs.text.join(`
`)==l){if(d.ranges.length%fs.text.length==0){N=[];for(var q=0;q<fs.text.length;q++)N.push(w.splitLines(fs.text[q]))}}else O.length==d.ranges.length&&o.options.pasteLinesPerSelection&&(N=ee(O,function(Oe){return[Oe]}));for(var Q=o.curOp.updateInput,he=d.ranges.length-1;he>=0;he--){var oe=d.ranges[he],pe=oe.from(),Ce=oe.to();oe.empty()&&(f&&f>0?pe=_e(pe.line,pe.ch-f):o.state.overwrite&&!T?Ce=_e(Ce.line,Math.min(Fe(w,Ce.line).text.length,Ce.ch+G(O).length)):T&&fs&&fs.lineWise&&fs.text.join(`
`)==O.join(`
`)&&(pe=Ce=_e(pe.line,0)));var Te={from:pe,to:Ce,text:N?N[he%N.length]:O,origin:g||(T?"paste":o.state.cutIncoming>b?"cut":"+input")};Ph(o.doc,Te),en(o,"inputRead",o,Te)}l&&!T&&UO(o,l),xh(o),o.curOp.updateInput<2&&(o.curOp.updateInput=Q),o.curOp.typing=!0,o.state.pasteIncoming=o.state.cutIncoming=-1}function zO(o,l){var f=o.clipboardData&&o.clipboardData.getData("Text");if(f)return o.preventDefault(),!l.isReadOnly()&&!l.options.disableInput&&l.hasFocus()&&oi(l,function(){return eb(l,f,0,null,"paste")}),!0}function UO(o,l){if(!(!o.options.electricChars||!o.options.smartIndent))for(var f=o.doc.sel,d=f.ranges.length-1;d>=0;d--){var g=f.ranges[d];if(!(g.head.ch>100||d&&f.ranges[d-1].head.line==g.head.line)){var w=o.getModeAt(g.head),b=!1;if(w.electricChars){for(var T=0;T<w.electricChars.length;T++)if(l.indexOf(w.electricChars.charAt(T))>-1){b=jd(o,g.head.line,"smart");break}}else w.electricInput&&w.electricInput.test(Fe(o.doc,g.head.line).text.slice(0,g.head.ch))&&(b=jd(o,g.head.line,"smart"));b&&en(o,"electricInput",o,g.head.line)}}}function jO(o){for(var l=[],f=[],d=0;d<o.doc.sel.ranges.length;d++){var g=o.doc.sel.ranges[d].head.line,w={anchor:_e(g,0),head:_e(g+1,0)};f.push(w),l.push(o.getRange(w.anchor,w.head))}return{text:l,ranges:f}}function tb(o,l,f,d){o.setAttribute("autocorrect",f?"on":"off"),o.setAttribute("autocapitalize",d?"on":"off"),o.setAttribute("spellcheck",!!l)}function YO(){var o=ie("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),l=ie("div",[o],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return m?o.style.width="1000px":o.setAttribute("wrap","off"),I&&(o.style.border="1px solid black"),l}function JU(o){var l=o.optionHandlers,f=o.helpers={};o.prototype={constructor:o,focus:function(){ce(this).focus(),this.display.input.focus()},setOption:function(d,g){var w=this.options,b=w[d];w[d]==g&&d!="mode"||(w[d]=g,l.hasOwnProperty(d)&&tn(this,l[d])(this,g,b),Nt(this,"optionChange",this,d))},getOption:function(d){return this.options[d]},getDoc:function(){return this.doc},addKeyMap:function(d,g){this.state.keyMaps[g?"push":"unshift"](Jm(d))},removeKeyMap:function(d){for(var g=this.state.keyMaps,w=0;w<g.length;++w)if(g[w]==d||g[w].name==d)return g.splice(w,1),!0},addOverlay:In(function(d,g){var w=d.token?d:o.getMode(this.options,d);if(w.startState)throw new Error("Overlays may not be stateful.");re(this.state.overlays,{mode:w,modeSpec:d,opaque:g&&g.opaque,priority:g&&g.priority||0},function(b){return b.priority}),this.state.modeGen++,zn(this)}),removeOverlay:In(function(d){for(var g=this.state.overlays,w=0;w<g.length;++w){var b=g[w].modeSpec;if(b==d||typeof d=="string"&&b.name==d){g.splice(w,1),this.state.modeGen++,zn(this);return}}}),indentLine:In(function(d,g,w){typeof g!="string"&&typeof g!="number"&&(g==null?g=this.options.smartIndent?"smart":"prev":g=g?"add":"subtract"),wd(this.doc,d)&&jd(this,d,g,w)}),indentSelection:In(function(d){for(var g=this.doc.sel.ranges,w=-1,b=0;b<g.length;b++){var T=g[b];if(T.empty())T.head.line>w&&(jd(this,T.head.line,d,!0),w=T.head.line,b==this.doc.sel.primIndex&&xh(this));else{var O=T.from(),N=T.to(),q=Math.max(w,O.line);w=Math.min(this.lastLine(),N.line-(N.ch?0:1))+1;for(var Q=q;Q<w;++Q)jd(this,Q,d);var he=this.doc.sel.ranges;O.ch==0&&g.length==he.length&&he[b].from().ch>0&&YC(this.doc,b,new kt(O,he[b].to()),S)}}}),getTokenAt:function(d,g){return rI(this,d,g)},getLineTokens:function(d,g){return rI(this,_e(d),g,!0)},getTokenTypeAt:function(d){d=at(this.doc,d);var g=JM(this,Fe(this.doc,d.line)),w=0,b=(g.length-1)/2,T=d.ch,O;if(T==0)O=g[2];else for(;;){var N=w+b>>1;if((N?g[N*2-1]:0)>=T)b=N;else if(g[N*2+1]<T)w=N+1;else{O=g[N*2+2];break}}var q=O?O.indexOf("overlay "):-1;return q<0?O:q==0?null:O.slice(0,q-1)},getModeAt:function(d){var g=this.doc.mode;return g.innerMode?o.innerMode(g,this.getTokenAt(d).state).mode:g},getHelper:function(d,g){return this.getHelpers(d,g)[0]},getHelpers:function(d,g){var w=[];if(!f.hasOwnProperty(g))return w;var b=f[g],T=this.getModeAt(d);if(typeof T[g]=="string")b[T[g]]&&w.push(b[T[g]]);else if(T[g])for(var O=0;O<T[g].length;O++){var N=b[T[g][O]];N&&w.push(N)}else T.helperType&&b[T.helperType]?w.push(b[T.helperType]):b[T.name]&&w.push(b[T.name]);for(var q=0;q<b._global.length;q++){var Q=b._global[q];Q.pred(T,this)&&F(w,Q.val)==-1&&w.push(Q.val)}return w},getStateAfter:function(d,g){var w=this.doc;return d=XM(w,d??w.first+w.size-1),yd(this,d+1,g).state},cursorCoords:function(d,g){var w,b=this.doc.sel.primary();return d==null?w=b.head:typeof d=="object"?w=at(this.doc,d):w=d?b.from():b.to(),cs(this,w,g||"page")},charCoords:function(d,g){return Fm(this,at(this.doc,d),g||"page")},coordsChar:function(d,g){return d=PI(this,d,g||"page"),_C(this,d.left,d.top)},lineAtHeight:function(d,g){return d=PI(this,{top:d,left:0},g||"page").top,$l(this.doc,d+this.display.viewOffset)},heightAtLine:function(d,g,w){var b=!1,T;if(typeof d=="number"){var O=this.doc.first+this.doc.size-1;d<this.doc.first?d=this.doc.first:d>O&&(d=O,b=!0),T=Fe(this.doc,d)}else T=d;return Lm(this,T,{top:0,left:0},g||"page",w||b).top+(b?this.doc.height-Bo(T):0)},defaultTextHeight:function(){return Eh(this.display)},defaultCharWidth:function(){return _h(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(d,g,w,b,T){var O=this.display;d=cs(this,at(this.doc,d));var N=d.bottom,q=d.left;if(g.style.position="absolute",g.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(g),O.sizer.appendChild(g),b=="over")N=d.top;else if(b=="above"||b=="near"){var Q=Math.max(O.wrapper.clientHeight,this.doc.height),he=Math.max(O.sizer.clientWidth,O.lineSpace.clientWidth);(b=="above"||d.bottom+g.offsetHeight>Q)&&d.top>g.offsetHeight?N=d.top-g.offsetHeight:d.bottom+g.offsetHeight<=Q&&(N=d.bottom),q+g.offsetWidth>he&&(q=he-g.offsetWidth)}g.style.top=N+"px",g.style.left=g.style.right="",T=="right"?(q=O.sizer.clientWidth-g.offsetWidth,g.style.right="0px"):(T=="left"?q=0:T=="middle"&&(q=(O.sizer.clientWidth-g.offsetWidth)/2),g.style.left=q+"px"),w&&Xz(this,{left:q,top:N,right:q+g.offsetWidth,bottom:N+g.offsetHeight})},triggerOnKeyDown:In(NO),triggerOnKeyPress:In(DO),triggerOnKeyUp:kO,triggerOnMouseDown:In(LO),execCommand:function(d){if($d.hasOwnProperty(d))return $d[d].call(null,this)},triggerElectric:In(function(d){UO(this,d)}),findPosH:function(d,g,w,b){var T=1;g<0&&(T=-1,g=-g);for(var O=at(this.doc,d),N=0;N<g&&(O=rb(this.doc,O,T,w,b),!O.hitSide);++N);return O},moveH:In(function(d,g){var w=this;this.extendSelectionsBy(function(b){return w.display.shift||w.doc.extend||b.empty()?rb(w.doc,b.head,d,g,w.options.rtlMoveVisually):d<0?b.from():b.to()},K)}),deleteH:In(function(d,g){var w=this.doc.sel,b=this.doc;w.somethingSelected()?b.replaceSelection("",null,"+delete"):kh(this,function(T){var O=rb(b,T.head,d,g,!1);return d<0?{from:O,to:T.head}:{from:T.head,to:O}})}),findPosV:function(d,g,w,b){var T=1,O=b;g<0&&(T=-1,g=-g);for(var N=at(this.doc,d),q=0;q<g;++q){var Q=cs(this,N,"div");if(O==null?O=Q.left:Q.left=O,N=GO(this,Q,T,w),N.hitSide)break}return N},moveV:In(function(d,g){var w=this,b=this.doc,T=[],O=!this.display.shift&&!b.extend&&b.sel.somethingSelected();if(b.extendSelectionsBy(function(q){if(O)return d<0?q.from():q.to();var Q=cs(w,q.head,"div");q.goalColumn!=null&&(Q.left=q.goalColumn),T.push(Q.left);var he=GO(w,Q,d,g);return g=="page"&&q==b.sel.primary()&&kC(w,Fm(w,he,"div").top-Q.top),he},K),T.length)for(var N=0;N<b.sel.ranges.length;N++)b.sel.ranges[N].goalColumn=T[N]}),findWordAt:function(d){var g=this.doc,w=Fe(g,d.line).text,b=d.ch,T=d.ch;if(w){var O=this.getHelper(d,"wordChars");(d.sticky=="before"||T==w.length)&&b?--b:++T;for(var N=w.charAt(b),q=Ne(N,O)?function(Q){return Ne(Q,O)}:/\s/.test(N)?function(Q){return/\s/.test(Q)}:function(Q){return!/\s/.test(Q)&&!Ne(Q)};b>0&&q(w.charAt(b-1));)--b;for(;T<w.length&&q(w.charAt(T));)++T}return new kt(_e(d.line,b),_e(d.line,T))},toggleOverwrite:function(d){d!=null&&d==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Be(this.display.cursorDiv,"CodeMirror-overwrite"):j(this.display.cursorDiv,"CodeMirror-overwrite"),Nt(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==ve($(this))},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:In(function(d,g){Td(this,d,g)}),getScrollInfo:function(){var d=this.display.scroller;return{left:d.scrollLeft,top:d.scrollTop,height:d.scrollHeight-qs(this)-this.display.barHeight,width:d.scrollWidth-qs(this)-this.display.barWidth,clientHeight:bC(this),clientWidth:Vl(this)}},scrollIntoView:In(function(d,g){d==null?(d={from:this.doc.sel.primary().head,to:null},g==null&&(g=this.options.cursorScrollMargin)):typeof d=="number"?d={from:_e(d,0),to:null}:d.from==null&&(d={from:d,to:null}),d.to||(d.to=d.from),d.margin=g||0,d.from.line!=null?Zz(this,d):BI(this,d.from,d.to,d.margin)}),setSize:In(function(d,g){var w=this,b=function(O){return typeof O=="number"||/^\d+$/.test(String(O))?O+"px":O};d!=null&&(this.display.wrapper.style.width=b(d)),g!=null&&(this.display.wrapper.style.height=b(g)),this.options.lineWrapping&&MI(this);var T=this.display.viewFrom;this.doc.iter(T,this.display.viewTo,function(O){if(O.widgets){for(var N=0;N<O.widgets.length;N++)if(O.widgets[N].noHScroll){Wa(w,T,"widget");break}}++T}),this.curOp.forceUpdate=!0,Nt(this,"refresh",this)}),operation:function(d){return oi(this,d)},startOperation:function(){return ql(this)},endOperation:function(){return Kl(this)},refresh:In(function(){var d=this.display.cachedTextHeight;zn(this),this.curOp.forceUpdate=!0,Ed(this),Td(this,this.doc.scrollLeft,this.doc.scrollTop),FC(this.display),(d==null||Math.abs(d-Eh(this.display))>.5||this.options.lineWrapping)&&IC(this),Nt(this,"refresh",this)}),swapDoc:In(function(d){var g=this.doc;return g.cm=null,this.state.selectingText&&this.state.selectingText(),eO(this,d),Ed(this),this.display.input.reset(),Td(this,d.scrollLeft,d.scrollTop),this.curOp.forceScroll=!0,en(this,"swapDoc",this,g),g}),phrase:function(d){var g=this.options.phrases;return g&&Object.prototype.hasOwnProperty.call(g,d)?g[d]:d},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ri(o),o.registerHelper=function(d,g,w){f.hasOwnProperty(d)||(f[d]=o[d]={_global:[]}),f[d][g]=w},o.registerGlobalHelper=function(d,g,w,b){o.registerHelper(d,g,b),f[d]._global.push({pred:w,val:b})}}function rb(o,l,f,d,g){var w=l,b=f,T=Fe(o,l.line),O=g&&o.direction=="rtl"?-f:f;function N(){var De=l.line+O;return De<o.first||De>=o.first+o.size?!1:(l=new _e(De,l.ch,l.sticky),T=Fe(o,De))}function q(De){var Pe;if(d=="codepoint"){var Ve=T.text.charCodeAt(l.ch+(f>0?0:-1));if(isNaN(Ve))Pe=null;else{var et=f>0?Ve>=55296&&Ve<56320:Ve>=56320&&Ve<57343;Pe=new _e(l.line,Math.max(0,Math.min(T.text.length,l.ch+f*(et?2:1))),-f)}}else g?Pe=NU(o.cm,T,l,f):Pe=qC(T,l,f);if(Pe==null)if(!De&&N())l=KC(g,o.cm,T,l.line,O);else return!1;else l=Pe;return!0}if(d=="char"||d=="codepoint")q();else if(d=="column")q(!0);else if(d=="word"||d=="group")for(var Q=null,he=d=="group",oe=o.cm&&o.cm.getHelper(l,"wordChars"),pe=!0;!(f<0&&!q(!pe));pe=!1){var Ce=T.text.charAt(l.ch)||`
`,Te=Ne(Ce,oe)?"w":he&&Ce==`
`?"n":!he||/\s/.test(Ce)?null:"p";if(he&&!pe&&!Te&&(Te="s"),Q&&Q!=Te){f<0&&(f=1,q(),l.sticky="after");break}if(Te&&(Q=Te),f>0&&!q(!pe))break}var Oe=Xm(o,l,w,b,!0);return hC(w,Oe)&&(Oe.hitSide=!0),Oe}function GO(o,l,f,d){var g=o.doc,w=l.left,b;if(d=="page"){var T=Math.min(o.display.wrapper.clientHeight,ce(o).innerHeight||g(o).documentElement.clientHeight),O=Math.max(T-.5*Eh(o.display),3);b=(f>0?l.bottom:l.top)+f*O}else d=="line"&&(b=f>0?l.bottom+3:l.top-3);for(var N;N=_C(o,w,b),!!N.outside;){if(f<0?b<=0:b>=g.height){N.hitSide=!0;break}b+=f*5}return N}var jt=function(o){this.cm=o,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new L,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};jt.prototype.init=function(o){var l=this,f=this,d=f.cm,g=f.div=o.lineDiv;g.contentEditable=!0,tb(g,d.options.spellcheck,d.options.autocorrect,d.options.autocapitalize);function w(T){for(var O=T.target;O;O=O.parentNode){if(O==g)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(O.className))break}return!1}qe(g,"paste",function(T){!w(T)||or(d,T)||zO(T,d)||c<=11&&setTimeout(tn(d,function(){return l.updateFromDOM()}),20)}),qe(g,"compositionstart",function(T){l.composing={data:T.data,done:!1}}),qe(g,"compositionupdate",function(T){l.composing||(l.composing={data:T.data,done:!1})}),qe(g,"compositionend",function(T){l.composing&&(T.data!=l.composing.data&&l.readFromDOMSoon(),l.composing.done=!0)}),qe(g,"touchstart",function(){return f.forceCompositionEnd()}),qe(g,"input",function(){l.composing||l.readFromDOMSoon()});function b(T){if(!(!w(T)||or(d,T))){if(d.somethingSelected())rp({lineWise:!1,text:d.getSelections()}),T.type=="cut"&&d.replaceSelection("",null,"cut");else if(d.options.lineWiseCopyCut){var O=jO(d);rp({lineWise:!0,text:O.text}),T.type=="cut"&&d.operation(function(){d.setSelections(O.ranges,0,S),d.replaceSelection("",null,"cut")})}else return;if(T.clipboardData){T.clipboardData.clearData();var N=fs.text.join(`
`);if(T.clipboardData.setData("Text",N),T.clipboardData.getData("Text")==N){T.preventDefault();return}}var q=YO(),Q=q.firstChild;tb(Q),d.display.lineSpace.insertBefore(q,d.display.lineSpace.firstChild),Q.value=fs.text.join(`
`);var he=ve(X(g));M(Q),setTimeout(function(){d.display.lineSpace.removeChild(q),he.focus(),he==g&&f.showPrimarySelection()},50)}}qe(g,"copy",b),qe(g,"cut",b)},jt.prototype.screenReaderLabelChanged=function(o){o?this.div.setAttribute("aria-label",o):this.div.removeAttribute("aria-label")},jt.prototype.prepareSelection=function(){var o=LI(this.cm,!1);return o.focus=ve(X(this.div))==this.div,o},jt.prototype.showSelection=function(o,l){!o||!this.cm.display.view.length||((o.focus||l)&&this.showPrimarySelection(),this.showMultipleSelections(o))},jt.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},jt.prototype.showPrimarySelection=function(){var o=this.getSelection(),l=this.cm,f=l.doc.sel.primary(),d=f.from(),g=f.to();if(l.display.viewTo==l.display.viewFrom||d.line>=l.display.viewTo||g.line<l.display.viewFrom){o.removeAllRanges();return}var w=np(l,o.anchorNode,o.anchorOffset),b=np(l,o.focusNode,o.focusOffset);if(!(w&&!w.bad&&b&&!b.bad&&ot(Mm(w,b),d)==0&&ot(xm(w,b),g)==0)){var T=l.display.view,O=d.line>=l.display.viewFrom&&qO(l,d)||{node:T[0].measure.map[2],offset:0},N=g.line<l.display.viewTo&&qO(l,g);if(!N){var q=T[T.length-1].measure,Q=q.maps?q.maps[q.maps.length-1]:q.map;N={node:Q[Q.length-1],offset:Q[Q.length-2]-Q[Q.length-3]}}if(!O||!N){o.removeAllRanges();return}var he=o.rangeCount&&o.getRangeAt(0),oe;try{oe=me(O.node,O.offset,N.offset,N.node)}catch{}oe&&(!i&&l.state.focused?(o.collapse(O.node,O.offset),oe.collapsed||(o.removeAllRanges(),o.addRange(oe))):(o.removeAllRanges(),o.addRange(oe)),he&&o.anchorNode==null?o.addRange(he):i&&this.startGracePeriod()),this.rememberSelection()}},jt.prototype.startGracePeriod=function(){var o=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){o.gracePeriod=!1,o.selectionChanged()&&o.cm.operation(function(){return o.cm.curOp.selectionChanged=!0})},20)},jt.prototype.showMultipleSelections=function(o){P(this.cm.display.cursorDiv,o.cursors),P(this.cm.display.selectionDiv,o.selection)},jt.prototype.rememberSelection=function(){var o=this.getSelection();this.lastAnchorNode=o.anchorNode,this.lastAnchorOffset=o.anchorOffset,this.lastFocusNode=o.focusNode,this.lastFocusOffset=o.focusOffset},jt.prototype.selectionInEditor=function(){var o=this.getSelection();if(!o.rangeCount)return!1;var l=o.getRangeAt(0).commonAncestorContainer;return Ae(this.div,l)},jt.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||ve(X(this.div))!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},jt.prototype.blur=function(){this.div.blur()},jt.prototype.getField=function(){return this.div},jt.prototype.supportsTouch=function(){return!0},jt.prototype.receivedFocus=function(){var o=this,l=this;this.selectionInEditor()?setTimeout(function(){return o.pollSelection()},20):oi(this.cm,function(){return l.cm.curOp.selectionChanged=!0});function f(){l.cm.state.focused&&(l.pollSelection(),l.polling.set(l.cm.options.pollInterval,f))}this.polling.set(this.cm.options.pollInterval,f)},jt.prototype.selectionChanged=function(){var o=this.getSelection();return o.anchorNode!=this.lastAnchorNode||o.anchorOffset!=this.lastAnchorOffset||o.focusNode!=this.lastFocusNode||o.focusOffset!=this.lastFocusOffset},jt.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var o=this.getSelection(),l=this.cm;if(k&&v&&this.cm.display.gutterSpecs.length&&ej(o.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var f=np(l,o.anchorNode,o.anchorOffset),d=np(l,o.focusNode,o.focusOffset);f&&d&&oi(l,function(){Rn(l.doc,$a(f,d),S),(f.bad||d.bad)&&(l.curOp.selectionChanged=!0)})}}},jt.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var o=this.cm,l=o.display,f=o.doc.sel.primary(),d=f.from(),g=f.to();if(d.ch==0&&d.line>o.firstLine()&&(d=_e(d.line-1,Fe(o.doc,d.line-1).length)),g.ch==Fe(o.doc,g.line).text.length&&g.line<o.lastLine()&&(g=_e(g.line+1,0)),d.line<l.viewFrom||g.line>l.viewTo-1)return!1;var w,b,T;d.line==l.viewFrom||(w=jl(o,d.line))==0?(b=Ut(l.view[0].line),T=l.view[0].node):(b=Ut(l.view[w].line),T=l.view[w-1].node.nextSibling);var O=jl(o,g.line),N,q;if(O==l.view.length-1?(N=l.viewTo-1,q=l.lineDiv.lastChild):(N=Ut(l.view[O+1].line)-1,q=l.view[O+1].node.previousSibling),!T)return!1;for(var Q=o.doc.splitLines(tj(o,T,q,b,N)),he=js(o.doc,_e(b,0),_e(N,Fe(o.doc,N).text.length));Q.length>1&&he.length>1;)if(G(Q)==G(he))Q.pop(),he.pop(),N--;else if(Q[0]==he[0])Q.shift(),he.shift(),b++;else break;for(var oe=0,pe=0,Ce=Q[0],Te=he[0],Oe=Math.min(Ce.length,Te.length);oe<Oe&&Ce.charCodeAt(oe)==Te.charCodeAt(oe);)++oe;for(var De=G(Q),Pe=G(he),Ve=Math.min(De.length-(Q.length==1?oe:0),Pe.length-(he.length==1?oe:0));pe<Ve&&De.charCodeAt(De.length-pe-1)==Pe.charCodeAt(Pe.length-pe-1);)++pe;if(Q.length==1&&he.length==1&&b==d.line)for(;oe&&oe>d.ch&&De.charCodeAt(De.length-pe-1)==Pe.charCodeAt(Pe.length-pe-1);)oe--,pe++;Q[Q.length-1]=De.slice(0,De.length-pe).replace(/^\u200b+/,""),Q[0]=Q[0].slice(oe).replace(/\u200b+$/,"");var et=_e(b,oe),Qe=_e(N,he.length?G(he).length-pe:0);if(Q.length>1||Q[0]||ot(et,Qe))return Ah(o.doc,Q,et,Qe,"+input"),!0},jt.prototype.ensurePolled=function(){this.forceCompositionEnd()},jt.prototype.reset=function(){this.forceCompositionEnd()},jt.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},jt.prototype.readFromDOMSoon=function(){var o=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(o.readDOMTimeout=null,o.composing)if(o.composing.done)o.composing=null;else return;o.updateFromDOM()},80))},jt.prototype.updateFromDOM=function(){var o=this;(this.cm.isReadOnly()||!this.pollContent())&&oi(this.cm,function(){return zn(o.cm)})},jt.prototype.setUneditable=function(o){o.contentEditable="false"},jt.prototype.onKeyPress=function(o){o.charCode==0||this.composing||(o.preventDefault(),this.cm.isReadOnly()||tn(this.cm,eb)(this.cm,String.fromCharCode(o.charCode==null?o.keyCode:o.charCode),0))},jt.prototype.readOnlyChanged=function(o){this.div.contentEditable=String(o!="nocursor")},jt.prototype.onContextMenu=function(){},jt.prototype.resetPosition=function(){},jt.prototype.needsContentAttribute=!0;function qO(o,l){var f=SC(o,l.line);if(!f||f.hidden)return null;var d=Fe(o.doc,l.line),g=RI(f,d,l.line),w=st(d,o.doc.direction),b="left";if(w){var T=Mt(w,l.ch);b=T%2?"right":"left"}var O=TI(g.map,l.ch,b);return O.offset=O.collapse=="right"?O.end:O.start,O}function ej(o){for(var l=o;l;l=l.parentNode)if(/CodeMirror-gutter-wrapper/.test(l.className))return!0;return!1}function Lh(o,l){return l&&(o.bad=!0),o}function tj(o,l,f,d,g){var w="",b=!1,T=o.doc.lineSeparator(),O=!1;function N(oe){return function(pe){return pe.id==oe}}function q(){b&&(w+=T,O&&(w+=T),b=O=!1)}function Q(oe){oe&&(q(),w+=oe)}function he(oe){if(oe.nodeType==1){var pe=oe.getAttribute("cm-text");if(pe){Q(pe);return}var Ce=oe.getAttribute("cm-marker"),Te;if(Ce){var Oe=o.findMarks(_e(d,0),_e(g+1,0),N(+Ce));Oe.length&&(Te=Oe[0].find(0))&&Q(js(o.doc,Te.from,Te.to).join(T));return}if(oe.getAttribute("contenteditable")=="false")return;var De=/^(pre|div|p|li|table|br)$/i.test(oe.nodeName);if(!/^br$/i.test(oe.nodeName)&&oe.textContent.length==0)return;De&&q();for(var Pe=0;Pe<oe.childNodes.length;Pe++)he(oe.childNodes[Pe]);/^(pre|p)$/i.test(oe.nodeName)&&(O=!0),De&&(b=!0)}else oe.nodeType==3&&Q(oe.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;he(l),l!=f;)l=l.nextSibling,O=!1;return w}function np(o,l,f){var d;if(l==o.display.lineDiv){if(d=o.display.lineDiv.childNodes[f],!d)return Lh(o.clipPos(_e(o.display.viewTo-1)),!0);l=null,f=0}else for(d=l;;d=d.parentNode){if(!d||d==o.display.lineDiv)return null;if(d.parentNode&&d.parentNode==o.display.lineDiv)break}for(var g=0;g<o.display.view.length;g++){var w=o.display.view[g];if(w.node==d)return rj(w,l,f)}}function rj(o,l,f){var d=o.text.firstChild,g=!1;if(!l||!Ae(d,l))return Lh(_e(Ut(o.line),0),!0);if(l==d&&(g=!0,l=d.childNodes[f],f=0,!l)){var w=o.rest?G(o.rest):o.line;return Lh(_e(Ut(w),w.text.length),g)}var b=l.nodeType==3?l:null,T=l;for(!b&&l.childNodes.length==1&&l.firstChild.nodeType==3&&(b=l.firstChild,f&&(f=b.nodeValue.length));T.parentNode!=d;)T=T.parentNode;var O=o.measure,N=O.maps;function q(Te,Oe,De){for(var Pe=-1;Pe<(N?N.length:0);Pe++)for(var Ve=Pe<0?O.map:N[Pe],et=0;et<Ve.length;et+=3){var Qe=Ve[et+2];if(Qe==Te||Qe==Oe){var gt=Ut(Pe<0?o.line:o.rest[Pe]),Qt=Ve[et]+De;return(De<0||Qe!=Te)&&(Qt=Ve[et+(De?1:0)]),_e(gt,Qt)}}}var Q=q(b,T,f);if(Q)return Lh(Q,g);for(var he=T.nextSibling,oe=b?b.nodeValue.length-f:0;he;he=he.nextSibling){if(Q=q(he,he.firstChild,0),Q)return Lh(_e(Q.line,Q.ch-oe),g);oe+=he.textContent.length}for(var pe=T.previousSibling,Ce=f;pe;pe=pe.previousSibling){if(Q=q(pe,pe.firstChild,-1),Q)return Lh(_e(Q.line,Q.ch+Ce),g);Ce+=pe.textContent.length}}var Ar=function(o){this.cm=o,this.prevInput="",this.pollingFast=!1,this.polling=new L,this.hasSelection=!1,this.composing=null,this.resetting=!1};Ar.prototype.init=function(o){var l=this,f=this,d=this.cm;this.createField(o);var g=this.textarea;o.wrapper.insertBefore(this.wrapper,o.wrapper.firstChild),I&&(g.style.width="0px"),qe(g,"input",function(){h&&c>=9&&l.hasSelection&&(l.hasSelection=null),f.poll()}),qe(g,"paste",function(b){or(d,b)||zO(b,d)||(d.state.pasteIncoming=+new Date,f.fastPoll())});function w(b){if(!or(d,b)){if(d.somethingSelected())rp({lineWise:!1,text:d.getSelections()});else if(d.options.lineWiseCopyCut){var T=jO(d);rp({lineWise:!0,text:T.text}),b.type=="cut"?d.setSelections(T.ranges,null,S):(f.prevInput="",g.value=T.text.join(`
`),M(g))}else return;b.type=="cut"&&(d.state.cutIncoming=+new Date)}}qe(g,"cut",w),qe(g,"copy",w),qe(o.scroller,"paste",function(b){if(!($o(o,b)||or(d,b))){if(!g.dispatchEvent){d.state.pasteIncoming=+new Date,f.focus();return}var T=new Event("paste");T.clipboardData=b.clipboardData,g.dispatchEvent(T)}}),qe(o.lineSpace,"selectstart",function(b){$o(o,b)||Sn(b)}),qe(g,"compositionstart",function(){var b=d.getCursor("from");f.composing&&f.composing.range.clear(),f.composing={start:b,range:d.markText(b,d.getCursor("to"),{className:"CodeMirror-composing"})}}),qe(g,"compositionend",function(){f.composing&&(f.poll(),f.composing.range.clear(),f.composing=null)})},Ar.prototype.createField=function(o){this.wrapper=YO(),this.textarea=this.wrapper.firstChild;var l=this.cm.options;tb(this.textarea,l.spellcheck,l.autocorrect,l.autocapitalize)},Ar.prototype.screenReaderLabelChanged=function(o){o?this.textarea.setAttribute("aria-label",o):this.textarea.removeAttribute("aria-label")},Ar.prototype.prepareSelection=function(){var o=this.cm,l=o.display,f=o.doc,d=LI(o);if(o.options.moveInputWithCursor){var g=cs(o,f.sel.primary().head,"div"),w=l.wrapper.getBoundingClientRect(),b=l.lineDiv.getBoundingClientRect();d.teTop=Math.max(0,Math.min(l.wrapper.clientHeight-10,g.top+b.top-w.top)),d.teLeft=Math.max(0,Math.min(l.wrapper.clientWidth-10,g.left+b.left-w.left))}return d},Ar.prototype.showSelection=function(o){var l=this.cm,f=l.display;P(f.cursorDiv,o.cursors),P(f.selectionDiv,o.selection),o.teTop!=null&&(this.wrapper.style.top=o.teTop+"px",this.wrapper.style.left=o.teLeft+"px")},Ar.prototype.reset=function(o){if(!(this.contextMenuPending||this.composing&&o)){var l=this.cm;if(this.resetting=!0,l.somethingSelected()){this.prevInput="";var f=l.getSelection();this.textarea.value=f,l.state.focused&&M(this.textarea),h&&c>=9&&(this.hasSelection=f)}else o||(this.prevInput=this.textarea.value="",h&&c>=9&&(this.hasSelection=null));this.resetting=!1}},Ar.prototype.getField=function(){return this.textarea},Ar.prototype.supportsTouch=function(){return!1},Ar.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!W||ve(X(this.textarea))!=this.textarea))try{this.textarea.focus()}catch{}},Ar.prototype.blur=function(){this.textarea.blur()},Ar.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Ar.prototype.receivedFocus=function(){this.slowPoll()},Ar.prototype.slowPoll=function(){var o=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){o.poll(),o.cm.state.focused&&o.slowPoll()})},Ar.prototype.fastPoll=function(){var o=!1,l=this;l.pollingFast=!0;function f(){var d=l.poll();!d&&!o?(o=!0,l.polling.set(60,f)):(l.pollingFast=!1,l.slowPoll())}l.polling.set(20,f)},Ar.prototype.poll=function(){var o=this,l=this.cm,f=this.textarea,d=this.prevInput;if(this.contextMenuPending||this.resetting||!l.state.focused||us(f)&&!d&&!this.composing||l.isReadOnly()||l.options.disableInput||l.state.keySeq)return!1;var g=f.value;if(g==d&&!l.somethingSelected())return!1;if(h&&c>=9&&this.hasSelection===g||B&&/[\uf700-\uf7ff]/.test(g))return l.display.input.reset(),!1;if(l.doc.sel==l.display.selForContextMenu){var w=g.charCodeAt(0);if(w==8203&&!d&&(d="​"),w==8666)return this.reset(),this.cm.execCommand("undo")}for(var b=0,T=Math.min(d.length,g.length);b<T&&d.charCodeAt(b)==g.charCodeAt(b);)++b;return oi(l,function(){eb(l,g.slice(b),d.length-b,null,o.composing?"*compose":null),g.length>1e3||g.indexOf(`
`)>-1?f.value=o.prevInput="":o.prevInput=g,o.composing&&(o.composing.range.clear(),o.composing.range=l.markText(o.composing.start,l.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Ar.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Ar.prototype.onKeyPress=function(){h&&c>=9&&(this.hasSelection=null),this.fastPoll()},Ar.prototype.onContextMenu=function(o){var l=this,f=l.cm,d=f.display,g=l.textarea;l.contextMenuPending&&l.contextMenuPending();var w=Ul(f,o),b=d.scroller.scrollTop;if(!w||C)return;var T=f.options.resetSelectionOnContextMenu;T&&f.doc.sel.contains(w)==-1&&tn(f,Rn)(f.doc,$a(w),S);var O=g.style.cssText,N=l.wrapper.style.cssText,q=l.wrapper.offsetParent.getBoundingClientRect();l.wrapper.style.cssText="position: static",g.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(o.clientY-q.top-5)+"px; left: "+(o.clientX-q.left-5)+`px;
      z-index: 1000; background: `+(h?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var Q;m&&(Q=g.ownerDocument.defaultView.scrollY),d.input.focus(),m&&g.ownerDocument.defaultView.scrollTo(null,Q),d.input.reset(),f.somethingSelected()||(g.value=l.prevInput=" "),l.contextMenuPending=oe,d.selForContextMenu=f.doc.sel,clearTimeout(d.detectingSelectAll);function he(){if(g.selectionStart!=null){var Ce=f.somethingSelected(),Te="​"+(Ce?g.value:"");g.value="⇚",g.value=Te,l.prevInput=Ce?"":"​",g.selectionStart=1,g.selectionEnd=Te.length,d.selForContextMenu=f.doc.sel}}function oe(){if(l.contextMenuPending==oe&&(l.contextMenuPending=!1,l.wrapper.style.cssText=N,g.style.cssText=O,h&&c<9&&d.scrollbars.setScrollTop(d.scroller.scrollTop=b),g.selectionStart!=null)){(!h||h&&c<9)&&he();var Ce=0,Te=function(){d.selForContextMenu==f.doc.sel&&g.selectionStart==0&&g.selectionEnd>0&&l.prevInput=="​"?tn(f,fO)(f):Ce++<10?d.detectingSelectAll=setTimeout(Te,500):(d.selForContextMenu=null,d.input.reset())};d.detectingSelectAll=setTimeout(Te,200)}}if(h&&c>=9&&he(),ne){ka(o);var pe=function(){dn(window,"mouseup",pe),setTimeout(oe,20)};qe(window,"mouseup",pe)}else setTimeout(oe,50)},Ar.prototype.readOnlyChanged=function(o){o||this.reset(),this.textarea.disabled=o=="nocursor",this.textarea.readOnly=!!o},Ar.prototype.setUneditable=function(){},Ar.prototype.needsContentAttribute=!1;function nj(o,l){if(l=l?ge(l):{},l.value=o.value,!l.tabindex&&o.tabIndex&&(l.tabindex=o.tabIndex),!l.placeholder&&o.placeholder&&(l.placeholder=o.placeholder),l.autofocus==null){var f=ve(X(o));l.autofocus=f==o||o.getAttribute("autofocus")!=null&&f==document.body}function d(){o.value=T.getValue()}var g;if(o.form&&(qe(o.form,"submit",d),!l.leaveSubmitMethodAlone)){var w=o.form;g=w.submit;try{var b=w.submit=function(){d(),w.submit=g,w.submit(),w.submit=b}}catch{}}l.finishInit=function(O){O.save=d,O.getTextArea=function(){return o},O.toTextArea=function(){O.toTextArea=isNaN,d(),o.parentNode.removeChild(O.getWrapperElement()),o.style.display="",o.form&&(dn(o.form,"submit",d),!l.leaveSubmitMethodAlone&&typeof o.form.submit=="function"&&(o.form.submit=g))}},o.style.display="none";var T=ur(function(O){return o.parentNode.insertBefore(O,o.nextSibling)},l);return T}function ij(o){o.off=dn,o.on=qe,o.wheelEventPixels=cU,o.Doc=Un,o.splitLines=vh,o.countColumn=Se,o.findColumn=H,o.isWordChar=Ie,o.Pass=le,o.signal=Nt,o.Line=bh,o.changeEnd=Va,o.scrollbarModel=zI,o.Pos=_e,o.cmpPos=ot,o.modes=yh,o.mimeModes=La,o.resolveMode=xe,o.getMode=Ge,o.modeExtensions=Wt,o.extendMode=fn,o.copyState=lr,o.startState=Ei,o.innerMode=gn,o.commands=$d,o.keyMap=zo,o.keyName=IO,o.isModifierKey=xO,o.lookupKey=Nh,o.normalizeKeyMap=HU,o.StringStream=rr,o.SharedTextMarker=Fd,o.TextMarker=Ua,o.LineWidget=Ld,o.e_preventDefault=Sn,o.e_stopPropagation=pd,o.e_stop=ka,o.addClass=Be,o.contains=Ae,o.rmClass=j,o.keyNames=ja}KU(ur),JU(ur);var sj="iter insert remove copy getEditor constructor".split(" ");for(var ip in Un.prototype)Un.prototype.hasOwnProperty(ip)&&F(sj,ip)<0&&(ur.prototype[ip]=function(o){return function(){return o.apply(this.doc,arguments)}}(Un.prototype[ip]));return Ri(Un),ur.inputStyles={textarea:Ar,contenteditable:jt},ur.defineMode=function(o){!ur.defaults.mode&&o!="null"&&(ur.defaults.mode=o),Je.apply(this,arguments)},ur.defineMIME=ue,ur.defineMode("null",function(){return{token:function(o){return o.skipToEnd()}}}),ur.defineMIME("text/plain","null"),ur.defineExtension=function(o,l){ur.prototype[o]=l},ur.defineDocExtension=function(o,l){Un.prototype[o]=l},ur.fromTextArea=nj,ij(ur),ur.version="5.65.18",ur})}(Bv)),Bv.exports}var XO={},Yd,ZO;function cn(){if(ZO)return Yd;ZO=1;var t=function(e){return e&&e.Math===Math&&e};return Yd=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof Oc=="object"&&Oc)||t(typeof Yd=="object"&&Yd)||function(){return this}()||Function("return this")(),Yd}var sb={},ob,QO;function xn(){return QO||(QO=1,ob=function(t){try{return!!t()}catch{return!0}}),ob}var ab,JO;function is(){if(JO)return ab;JO=1;var t=xn();return ab=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),ab}var lb,eP;function sy(){if(eP)return lb;eP=1;var t=xn();return lb=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),lb}var ub,tP;function Vn(){if(tP)return ub;tP=1;var t=sy(),e=Function.prototype.call;return ub=t?e.bind(e):function(){return e.apply(e,arguments)},ub}var hb={},rP;function aj(){if(rP)return hb;rP=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return hb.f=r?function(i){var s=e(this,i);return!!s&&s.enumerable}:t,hb}var cb,nP;function oy(){return nP||(nP=1,cb=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),cb}var db,iP;function Yr(){if(iP)return db;iP=1;var t=sy(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return db=t?n:function(i){return function(){return r.apply(i,arguments)}},db}var fb,sP;function sh(){if(sP)return fb;sP=1;var t=Yr(),e=t({}.toString),r=t("".slice);return fb=function(n){return r(e(n),8,-1)},fb}var gb,oP;function lj(){if(oP)return gb;oP=1;var t=Yr(),e=xn(),r=sh(),n=Object,i=t("".split);return gb=e(function(){return!n("z").propertyIsEnumerable(0)})?function(s){return r(s)==="String"?i(s,""):n(s)}:n,gb}var mb,aP;function ay(){return aP||(aP=1,mb=function(t){return t==null}),mb}var pb,lP;function Yg(){if(lP)return pb;lP=1;var t=ay(),e=TypeError;return pb=function(r){if(t(r))throw new e("Can't call method on "+r);return r},pb}var vb,uP;function Gg(){if(uP)return vb;uP=1;var t=lj(),e=Yg();return vb=function(r){return t(e(r))},vb}var wb,hP;function Qr(){if(hP)return wb;hP=1;var t=typeof document=="object"&&document.all;return wb=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},wb}var yb,cP;function Ws(){if(cP)return yb;cP=1;var t=Qr();return yb=function(e){return typeof e=="object"?e!==null:t(e)},yb}var Cb,dP;function Jc(){if(dP)return Cb;dP=1;var t=cn(),e=Qr(),r=function(n){return e(n)?n:void 0};return Cb=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},Cb}var bb,fP;function qg(){if(fP)return bb;fP=1;var t=Yr();return bb=t({}.isPrototypeOf),bb}var Sb,gP;function ly(){if(gP)return Sb;gP=1;var t=cn(),e=t.navigator,r=e&&e.userAgent;return Sb=r?String(r):"",Sb}var Rb,mP;function uj(){if(mP)return Rb;mP=1;var t=cn(),e=ly(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,s=i&&i.v8,a,u;return s&&(a=s.split("."),u=a[0]>0&&a[0]<4?1:+(a[0]+a[1])),!u&&e&&(a=e.match(/Edge\/(\d+)/),(!a||a[1]>=74)&&(a=e.match(/Chrome\/(\d+)/),a&&(u=+a[1]))),Rb=u,Rb}var Eb,pP;function iT(){if(pP)return Eb;pP=1;var t=uj(),e=xn(),r=cn(),n=r.String;return Eb=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Eb}var _b,vP;function TF(){if(vP)return _b;vP=1;var t=iT();return _b=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_b}var Tb,wP;function sT(){if(wP)return Tb;wP=1;var t=Jc(),e=Qr(),r=qg(),n=TF(),i=Object;return Tb=n?function(s){return typeof s=="symbol"}:function(s){var a=t("Symbol");return e(a)&&r(a.prototype,i(s))},Tb}var xb,yP;function uy(){if(yP)return xb;yP=1;var t=String;return xb=function(e){try{return t(e)}catch{return"Object"}},xb}var Mb,CP;function Si(){if(CP)return Mb;CP=1;var t=Qr(),e=uy(),r=TypeError;return Mb=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},Mb}var Ib,bP;function Kg(){if(bP)return Ib;bP=1;var t=Si(),e=ay();return Ib=function(r,n){var i=r[n];return e(i)?void 0:t(i)},Ib}var Ob,SP;function hj(){if(SP)return Ob;SP=1;var t=Vn(),e=Qr(),r=Ws(),n=TypeError;return Ob=function(i,s){var a,u;if(s==="string"&&e(a=i.toString)&&!r(u=t(a,i))||e(a=i.valueOf)&&!r(u=t(a,i))||s!=="string"&&e(a=i.toString)&&!r(u=t(a,i)))return u;throw new n("Can't convert object to primitive value")},Ob}var Pb={exports:{}},Ab,RP;function kl(){return RP||(RP=1,Ab=!1),Ab}var Hb,EP;function oT(){if(EP)return Hb;EP=1;var t=cn(),e=Object.defineProperty;return Hb=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},Hb}var _P;function aT(){if(_P)return Pb.exports;_P=1;var t=kl(),e=cn(),r=oT(),n="__core-js_shared__",i=Pb.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.40.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Pb.exports}var Nb,TP;function xF(){if(TP)return Nb;TP=1;var t=aT();return Nb=function(e,r){return t[e]||(t[e]=r||{})},Nb}var kb,xP;function ed(){if(xP)return kb;xP=1;var t=Yg(),e=Object;return kb=function(r){return e(t(r))},kb}var Db,MP;function ss(){if(MP)return Db;MP=1;var t=Yr(),e=ed(),r=t({}.hasOwnProperty);return Db=Object.hasOwn||function(i,s){return r(e(i),s)},Db}var Lb,IP;function MF(){if(IP)return Lb;IP=1;var t=Yr(),e=0,r=Math.random(),n=t(1 .toString);return Lb=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},Lb}var Fb,OP;function Bs(){if(OP)return Fb;OP=1;var t=cn(),e=xF(),r=ss(),n=MF(),i=iT(),s=TF(),a=t.Symbol,u=e("wks"),h=s?a.for||a:a&&a.withoutSetter||n;return Fb=function(c){return r(u,c)||(u[c]=i&&r(a,c)?a[c]:h("Symbol."+c)),u[c]},Fb}var Wb,PP;function cj(){if(PP)return Wb;PP=1;var t=Vn(),e=Ws(),r=sT(),n=Kg(),i=hj(),s=Bs(),a=TypeError,u=s("toPrimitive");return Wb=function(h,c){if(!e(h)||r(h))return h;var m=n(h,u),p;if(m){if(c===void 0&&(c="default"),p=t(m,h,c),!e(p)||r(p))return p;throw new a("Can't convert object to primitive value")}return c===void 0&&(c="number"),i(h,c)},Wb}var Bb,AP;function IF(){if(AP)return Bb;AP=1;var t=cj(),e=sT();return Bb=function(r){var n=t(r,"string");return e(n)?n:n+""},Bb}var $b,HP;function lT(){if(HP)return $b;HP=1;var t=cn(),e=Ws(),r=t.document,n=e(r)&&e(r.createElement);return $b=function(i){return n?r.createElement(i):{}},$b}var Vb,NP;function OF(){if(NP)return Vb;NP=1;var t=is(),e=xn(),r=lT();return Vb=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Vb}var kP;function PF(){if(kP)return sb;kP=1;var t=is(),e=Vn(),r=aj(),n=oy(),i=Gg(),s=IF(),a=ss(),u=OF(),h=Object.getOwnPropertyDescriptor;return sb.f=t?h:function(m,p){if(m=i(m),p=s(p),u)try{return h(m,p)}catch{}if(a(m,p))return n(!e(r.f,m,p),m[p])},sb}var zb={},Ub,DP;function AF(){if(DP)return Ub;DP=1;var t=is(),e=xn();return Ub=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Ub}var jb,LP;function Jr(){if(LP)return jb;LP=1;var t=Ws(),e=String,r=TypeError;return jb=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},jb}var FP;function Dl(){if(FP)return zb;FP=1;var t=is(),e=OF(),r=AF(),n=Jr(),i=IF(),s=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",c="configurable",m="writable";return zb.f=t?r?function(v,y,C){if(n(v),y=i(y),n(C),typeof v=="function"&&y==="prototype"&&"value"in C&&m in C&&!C[m]){var R=u(v,y);R&&R[m]&&(v[y]=C.value,C={configurable:c in C?C[c]:R[c],enumerable:h in C?C[h]:R[h],writable:!1})}return a(v,y,C)}:a:function(v,y,C){if(n(v),y=i(y),n(C),e)try{return a(v,y,C)}catch{}if("get"in C||"set"in C)throw new s("Accessors not supported");return"value"in C&&(v[y]=C.value),v},zb}var Yb,WP;function td(){if(WP)return Yb;WP=1;var t=is(),e=Dl(),r=oy();return Yb=t?function(n,i,s){return e.f(n,i,r(1,s))}:function(n,i,s){return n[i]=s,n},Yb}var Gb={exports:{}},qb,BP;function dj(){if(BP)return qb;BP=1;var t=is(),e=ss(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),s=i&&(function(){}).name==="something",a=i&&(!t||t&&n(r,"name").configurable);return qb={EXISTS:i,PROPER:s,CONFIGURABLE:a},qb}var Kb,$P;function fj(){if($P)return Kb;$P=1;var t=Yr(),e=Qr(),r=aT(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),Kb=r.inspectSource,Kb}var Xb,VP;function gj(){if(VP)return Xb;VP=1;var t=cn(),e=Qr(),r=t.WeakMap;return Xb=e(r)&&/native code/.test(String(r)),Xb}var Zb,zP;function uT(){if(zP)return Zb;zP=1;var t=xF(),e=MF(),r=t("keys");return Zb=function(n){return r[n]||(r[n]=e(n))},Zb}var Qb,UP;function hT(){return UP||(UP=1,Qb={}),Qb}var Jb,jP;function HF(){if(jP)return Jb;jP=1;var t=gj(),e=cn(),r=Ws(),n=td(),i=ss(),s=aT(),a=uT(),u=hT(),h="Object already initialized",c=e.TypeError,m=e.WeakMap,p,v,y,C=function(I){return y(I)?v(I):p(I,{})},R=function(I){return function(k){var W;if(!r(k)||(W=v(k)).type!==I)throw new c("Incompatible receiver, "+I+" required");return W}};if(t||s.state){var _=s.state||(s.state=new m);_.get=_.get,_.has=_.has,_.set=_.set,p=function(I,k){if(_.has(I))throw new c(h);return k.facade=I,_.set(I,k),k},v=function(I){return _.get(I)||{}},y=function(I){return _.has(I)}}else{var x=a("state");u[x]=!0,p=function(I,k){if(i(I,x))throw new c(h);return k.facade=I,n(I,x,k),k},v=function(I){return i(I,x)?I[x]:{}},y=function(I){return i(I,x)}}return Jb={set:p,get:v,has:y,enforce:C,getterFor:R},Jb}var YP;function NF(){if(YP)return Gb.exports;YP=1;var t=Yr(),e=xn(),r=Qr(),n=ss(),i=is(),s=dj().CONFIGURABLE,a=fj(),u=HF(),h=u.enforce,c=u.get,m=String,p=Object.defineProperty,v=t("".slice),y=t("".replace),C=t([].join),R=i&&!e(function(){return p(function(){},"length",{value:8}).length!==8}),_=String(String).split("String"),x=Gb.exports=function(I,k,W){v(m(k),0,7)==="Symbol("&&(k="["+y(m(k),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),W&&W.getter&&(k="get "+k),W&&W.setter&&(k="set "+k),(!n(I,"name")||s&&I.name!==k)&&(i?p(I,"name",{value:k,configurable:!0}):I.name=k),R&&W&&n(W,"arity")&&I.length!==W.arity&&p(I,"length",{value:W.arity});try{W&&n(W,"constructor")&&W.constructor?i&&p(I,"prototype",{writable:!1}):I.prototype&&(I.prototype=void 0)}catch{}var B=h(I);return n(B,"source")||(B.source=C(_,typeof k=="string"?k:"")),I};return Function.prototype.toString=x(function(){return r(this)&&c(this).source||a(this)},"toString"),Gb.exports}var eS,GP;function cT(){if(GP)return eS;GP=1;var t=Qr(),e=Dl(),r=NF(),n=oT();return eS=function(i,s,a,u){u||(u={});var h=u.enumerable,c=u.name!==void 0?u.name:s;if(t(a)&&r(a,c,u),u.global)h?i[s]=a:n(s,a);else{try{u.unsafe?i[s]&&(h=!0):delete i[s]}catch{}h?i[s]=a:e.f(i,s,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return i},eS}var tS={},rS,qP;function mj(){if(qP)return rS;qP=1;var t=Math.ceil,e=Math.floor;return rS=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},rS}var nS,KP;function Xg(){if(KP)return nS;KP=1;var t=mj();return nS=function(e){var r=+e;return r!==r||r===0?0:t(r)},nS}var iS,XP;function pj(){if(XP)return iS;XP=1;var t=Xg(),e=Math.max,r=Math.min;return iS=function(n,i){var s=t(n);return s<0?e(s+i,0):r(s,i)},iS}var sS,ZP;function vj(){if(ZP)return sS;ZP=1;var t=Xg(),e=Math.min;return sS=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},sS}var oS,QP;function rd(){if(QP)return oS;QP=1;var t=vj();return oS=function(e){return t(e.length)},oS}var aS,JP;function wj(){if(JP)return aS;JP=1;var t=Gg(),e=pj(),r=rd(),n=function(i){return function(s,a,u){var h=t(s),c=r(h);if(c===0)return!i&&-1;var m=e(u,c),p;if(i&&a!==a){for(;c>m;)if(p=h[m++],p!==p)return!0}else for(;c>m;m++)if((i||m in h)&&h[m]===a)return i||m||0;return!i&&-1}};return aS={includes:n(!0),indexOf:n(!1)},aS}var lS,eA;function kF(){if(eA)return lS;eA=1;var t=Yr(),e=ss(),r=Gg(),n=wj().indexOf,i=hT(),s=t([].push);return lS=function(a,u){var h=r(a),c=0,m=[],p;for(p in h)!e(i,p)&&e(h,p)&&s(m,p);for(;u.length>c;)e(h,p=u[c++])&&(~n(m,p)||s(m,p));return m},lS}var uS,tA;function dT(){return tA||(tA=1,uS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),uS}var rA;function yj(){if(rA)return tS;rA=1;var t=kF(),e=dT(),r=e.concat("length","prototype");return tS.f=Object.getOwnPropertyNames||function(i){return t(i,r)},tS}var hS={},nA;function Cj(){return nA||(nA=1,hS.f=Object.getOwnPropertySymbols),hS}var cS,iA;function bj(){if(iA)return cS;iA=1;var t=Jc(),e=Yr(),r=yj(),n=Cj(),i=Jr(),s=e([].concat);return cS=t("Reflect","ownKeys")||function(u){var h=r.f(i(u)),c=n.f;return c?s(h,c(u)):h},cS}var dS,sA;function DF(){if(sA)return dS;sA=1;var t=ss(),e=bj(),r=PF(),n=Dl();return dS=function(i,s,a){for(var u=e(s),h=n.f,c=r.f,m=0;m<u.length;m++){var p=u[m];!t(i,p)&&!(a&&t(a,p))&&h(i,p,c(s,p))}},dS}var fS,oA;function Sj(){if(oA)return fS;oA=1;var t=xn(),e=Qr(),r=/#|\.prototype\./,n=function(h,c){var m=s[i(h)];return m===u?!0:m===a?!1:e(c)?t(c):!!c},i=n.normalize=function(h){return String(h).replace(r,".").toLowerCase()},s=n.data={},a=n.NATIVE="N",u=n.POLYFILL="P";return fS=n,fS}var gS,aA;function sr(){if(aA)return gS;aA=1;var t=cn(),e=PF().f,r=td(),n=cT(),i=oT(),s=DF(),a=Sj();return gS=function(u,h){var c=u.target,m=u.global,p=u.stat,v,y,C,R,_,x;if(m?y=t:p?y=t[c]||i(c,{}):y=t[c]&&t[c].prototype,y)for(C in h){if(_=h[C],u.dontCallGetSet?(x=e(y,C),R=x&&x.value):R=y[C],v=a(m?C:c+(p?".":"#")+C,u.forced),!v&&R!==void 0){if(typeof _==typeof R)continue;s(_,R)}(u.sham||R&&R.sham)&&r(_,"sham",!0),n(y,C,_,u)}},gS}var mS,lA;function hy(){if(lA)return mS;lA=1;var t=sy(),e=Function.prototype,r=e.apply,n=e.call;return mS=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),mS}var pS,uA;function LF(){if(uA)return pS;uA=1;var t=Yr(),e=Si();return pS=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},pS}var vS,hA;function Rj(){if(hA)return vS;hA=1;var t=Ws();return vS=function(e){return t(e)||e===null},vS}var wS,cA;function Ej(){if(cA)return wS;cA=1;var t=Rj(),e=String,r=TypeError;return wS=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},wS}var yS,dA;function FF(){if(dA)return yS;dA=1;var t=LF(),e=Ws(),r=Yg(),n=Ej();return yS=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,s={},a;try{a=t(Object.prototype,"__proto__","set"),a(s,[]),i=s instanceof Array}catch{}return function(h,c){return r(h),n(c),e(h)&&(i?a(h,c):h.__proto__=c),h}}():void 0),yS}var CS,fA;function _j(){if(fA)return CS;fA=1;var t=Dl().f;return CS=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},CS}var bS,gA;function Tj(){if(gA)return bS;gA=1;var t=Qr(),e=Ws(),r=FF();return bS=function(n,i,s){var a,u;return r&&t(a=i.constructor)&&a!==s&&e(u=a.prototype)&&u!==s.prototype&&r(n,u),n},bS}var SS,mA;function xj(){if(mA)return SS;mA=1;var t=Bs(),e=t("toStringTag"),r={};return r[e]="z",SS=String(r)==="[object z]",SS}var RS,pA;function WF(){if(pA)return RS;pA=1;var t=xj(),e=Qr(),r=sh(),n=Bs(),i=n("toStringTag"),s=Object,a=r(function(){return arguments}())==="Arguments",u=function(h,c){try{return h[c]}catch{}};return RS=t?r:function(h){var c,m,p;return h===void 0?"Undefined":h===null?"Null":typeof(m=u(c=s(h),i))=="string"?m:a?r(c):(p=r(c))==="Object"&&e(c.callee)?"Arguments":p},RS}var ES,vA;function cy(){if(vA)return ES;vA=1;var t=WF(),e=String;return ES=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},ES}var _S,wA;function Mj(){if(wA)return _S;wA=1;var t=cy();return _S=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},_S}var TS,yA;function Ij(){if(yA)return TS;yA=1;var t=Ws(),e=td();return TS=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},TS}var xS,CA;function Oj(){if(CA)return xS;CA=1;var t=Yr(),e=Error,r=t("".replace),n=function(a){return String(new e(a).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,s=i.test(n);return xS=function(a,u){if(s&&typeof a=="string"&&!e.prepareStackTrace)for(;u--;)a=r(a,i,"");return a},xS}var MS,bA;function Pj(){if(bA)return MS;bA=1;var t=xn(),e=oy();return MS=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),MS}var IS,SA;function Aj(){if(SA)return IS;SA=1;var t=td(),e=Oj(),r=Pj(),n=Error.captureStackTrace;return IS=function(i,s,a,u){r&&(n?n(i,s):t(i,"stack",e(a,u)))},IS}var OS,RA;function Hj(){if(RA)return OS;RA=1;var t=Jc(),e=ss(),r=td(),n=qg(),i=FF(),s=DF(),a=_j(),u=Tj(),h=Mj(),c=Ij(),m=Aj(),p=is(),v=kl();return OS=function(y,C,R,_){var x="stackTraceLimit",I=_?2:1,k=y.split("."),W=k[k.length-1],B=t.apply(null,k);if(B){var z=B.prototype;if(!v&&e(z,"cause")&&delete z.cause,!R)return B;var U=t("Error"),J=C(function(se,ne){var fe=h(_?ne:se,void 0),j=_?new B(se):new B;return fe!==void 0&&r(j,"message",fe),m(j,J,j.stack,2),this&&n(z,this)&&u(j,this,J),arguments.length>I&&c(j,arguments[I]),j});if(J.prototype=z,W!=="Error"?i?i(J,U):s(J,U,{name:!0}):p&&x in B&&(a(J,B,x),a(J,B,"prepareStackTrace")),s(J,B),!v)try{z.name!==W&&r(z,"name",W),z.constructor=J}catch{}return J}},OS}var EA;function Nj(){if(EA)return XO;EA=1;var t=sr(),e=cn(),r=hy(),n=Hj(),i="WebAssembly",s=e[i],a=new Error("e",{cause:7}).cause!==7,u=function(c,m){var p={};p[c]=n(c,m,a),t({global:!0,constructor:!0,arity:1,forced:a},p)},h=function(c,m){if(s&&s[c]){var p={};p[c]=n(i+"."+c,m,a),t({target:i,stat:!0,constructor:!0,arity:1,forced:a},p)}};return u("Error",function(c){return function(p){return r(c,this,arguments)}}),u("EvalError",function(c){return function(p){return r(c,this,arguments)}}),u("RangeError",function(c){return function(p){return r(c,this,arguments)}}),u("ReferenceError",function(c){return function(p){return r(c,this,arguments)}}),u("SyntaxError",function(c){return function(p){return r(c,this,arguments)}}),u("TypeError",function(c){return function(p){return r(c,this,arguments)}}),u("URIError",function(c){return function(p){return r(c,this,arguments)}}),h("CompileError",function(c){return function(p){return r(c,this,arguments)}}),h("LinkError",function(c){return function(p){return r(c,this,arguments)}}),h("RuntimeError",function(c){return function(p){return r(c,this,arguments)}}),XO}Nj();var _A={},PS,TA;function BF(){if(TA)return PS;TA=1;var t=sh();return PS=Array.isArray||function(r){return t(r)==="Array"},PS}var AS,xA;function $F(){if(xA)return AS;xA=1;var t=is(),e=BF(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}();return AS=i?function(s,a){if(e(s)&&!n(s,"length").writable)throw new r("Cannot set read only .length");return s.length=a}:function(s,a){return s.length=a},AS}var HS,MA;function VF(){if(MA)return HS;MA=1;var t=TypeError,e=9007199254740991;return HS=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},HS}var IA;function kj(){if(IA)return _A;IA=1;var t=sr(),e=ed(),r=rd(),n=$F(),i=VF(),s=xn(),a=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(c){return c instanceof TypeError}},h=a||!u();return t({target:"Array",proto:!0,arity:1,forced:h},{push:function(m){var p=e(this),v=r(p),y=arguments.length;i(v+y);for(var C=0;C<y;C++)p[v]=arguments[C],v++;return n(p,v),v}}),_A}kj();var OA={},NS,PA;function Ao(){if(PA)return NS;PA=1;var t=Yr(),e=Set.prototype;return NS={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},NS}var kS,AA;function oh(){if(AA)return kS;AA=1;var t=Ao().has;return kS=function(e){return t(e),e},kS}var DS,HA;function ah(){if(HA)return DS;HA=1;var t=Vn();return DS=function(e,r,n){for(var i=n?e:e.iterator,s=e.next,a,u;!(a=t(s,i)).done;)if(u=r(a.value),u!==void 0)return u},DS}var LS,NA;function Zg(){if(NA)return LS;NA=1;var t=Yr(),e=ah(),r=Ao(),n=r.Set,i=r.proto,s=t(i.forEach),a=t(i.keys),u=a(new n).next;return LS=function(h,c,m){return m?e({iterator:a(h),next:u},c):s(h,c)},LS}var FS,kA;function fT(){if(kA)return FS;kA=1;var t=Ao(),e=Zg(),r=t.Set,n=t.add;return FS=function(i){var s=new r;return e(i,function(a){n(s,a)}),s},FS}var WS,DA;function Qg(){if(DA)return WS;DA=1;var t=LF(),e=Ao();return WS=t(e.proto,"size","get")||function(r){return r.size},WS}var BS,LA;function Ho(){return LA||(LA=1,BS=function(t){return{iterator:t,next:t.next,done:!1}}),BS}var $S,FA;function lh(){if(FA)return $S;FA=1;var t=Si(),e=Jr(),r=Vn(),n=Xg(),i=Ho(),s="Invalid size",a=RangeError,u=TypeError,h=Math.max,c=function(m,p){this.set=m,this.size=h(p,0),this.has=t(m.has),this.keys=t(m.keys)};return c.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(m){return r(this.has,this.set,m)}},$S=function(m){e(m);var p=+m.size;if(p!==p)throw new u(s);var v=n(p);if(v<0)throw new a(s);return new c(m,v)},$S}var VS,WA;function Dj(){if(WA)return VS;WA=1;var t=oh(),e=Ao(),r=fT(),n=Qg(),i=lh(),s=Zg(),a=ah(),u=e.has,h=e.remove;return VS=function(m){var p=t(this),v=i(m),y=r(p);return n(p)<=v.size?s(p,function(C){v.includes(C)&&h(y,C)}):a(v.getIterator(),function(C){u(p,C)&&h(y,C)}),y},VS}var zS,BA;function uh(){if(BA)return zS;BA=1;var t=Jc(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return zS=function(n,i){var s=t("Set");try{new s()[n](e(0));try{return new s()[n](e(-1)),!1}catch{if(!i)return!0;try{return new s()[n](r(-1/0)),!1}catch{var a=new s;return a.add(1),a.add(2),i(a[n](r(1/0)))}}}catch{return!1}},zS}var $A;function Lj(){if($A)return OA;$A=1;var t=sr(),e=Dj(),r=uh(),n=!r("difference",function(i){return i.size===0});return t({target:"Set",proto:!0,real:!0,forced:n},{difference:e}),OA}Lj();var VA={},US,zA;function Fj(){if(zA)return US;zA=1;var t=oh(),e=Ao(),r=Qg(),n=lh(),i=Zg(),s=ah(),a=e.Set,u=e.add,h=e.has;return US=function(m){var p=t(this),v=n(m),y=new a;return r(p)>v.size?s(v.getIterator(),function(C){h(p,C)&&u(y,C)}):i(p,function(C){v.includes(C)&&u(y,C)}),y},US}var UA;function Wj(){if(UA)return VA;UA=1;var t=sr(),e=xn(),r=Fj(),n=uh(),i=!n("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),VA}Wj();var jA={},jS,YA;function nd(){if(YA)return jS;YA=1;var t=Vn(),e=Jr(),r=Kg();return jS=function(n,i,s){var a,u;e(n);try{if(a=r(n,"return"),!a){if(i==="throw")throw s;return s}a=t(a,n)}catch(h){u=!0,a=h}if(i==="throw")throw s;if(u)throw a;return e(a),s},jS}var YS,GA;function Bj(){if(GA)return YS;GA=1;var t=oh(),e=Ao().has,r=Qg(),n=lh(),i=Zg(),s=ah(),a=nd();return YS=function(h){var c=t(this),m=n(h);if(r(c)<=m.size)return i(c,function(v){if(m.includes(v))return!1},!0)!==!1;var p=m.getIterator();return s(p,function(v){if(e(c,v))return a(p,"normal",!1)})!==!1},YS}var qA;function $j(){if(qA)return jA;qA=1;var t=sr(),e=Bj(),r=uh(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),jA}$j();var KA={},GS,XA;function Vj(){if(XA)return GS;XA=1;var t=oh(),e=Qg(),r=Zg(),n=lh();return GS=function(s){var a=t(this),u=n(s);return e(a)>u.size?!1:r(a,function(h){if(!u.includes(h))return!1},!0)!==!1},GS}var ZA;function zj(){if(ZA)return KA;ZA=1;var t=sr(),e=Vj(),r=uh(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),KA}zj();var QA={},qS,JA;function Uj(){if(JA)return qS;JA=1;var t=oh(),e=Ao().has,r=Qg(),n=lh(),i=ah(),s=nd();return qS=function(u){var h=t(this),c=n(u);if(r(h)<c.size)return!1;var m=c.getIterator();return i(m,function(p){if(!e(h,p))return s(m,"normal",!1)})!==!1},qS}var eH;function jj(){if(eH)return QA;eH=1;var t=sr(),e=Uj(),r=uh(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),QA}jj();var tH={},KS,rH;function Yj(){if(rH)return KS;rH=1;var t=oh(),e=Ao(),r=fT(),n=lh(),i=ah(),s=e.add,a=e.has,u=e.remove;return KS=function(c){var m=t(this),p=n(c).getIterator(),v=r(m);return i(p,function(y){a(m,y)?u(v,y):s(v,y)}),v},KS}var nH;function Gj(){if(nH)return tH;nH=1;var t=sr(),e=Yj(),r=uh();return t({target:"Set",proto:!0,real:!0,forced:!r("symmetricDifference")},{symmetricDifference:e}),tH}Gj();var iH={},XS,sH;function qj(){if(sH)return XS;sH=1;var t=oh(),e=Ao().add,r=fT(),n=lh(),i=ah();return XS=function(a){var u=t(this),h=n(a).getIterator(),c=r(u);return i(h,function(m){e(c,m)}),c},XS}var oH;function Kj(){if(oH)return iH;oH=1;var t=sr(),e=qj(),r=uh();return t({target:"Set",proto:!0,real:!0,forced:!r("union")},{union:e}),iH}Kj();var aH={},lH={},ZS,uH;function Xj(){if(uH)return ZS;uH=1;var t=qg(),e=TypeError;return ZS=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},ZS}var QS,hH;function Zj(){if(hH)return QS;hH=1;var t=xn();return QS=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),QS}var JS,cH;function zF(){if(cH)return JS;cH=1;var t=ss(),e=Qr(),r=ed(),n=uT(),i=Zj(),s=n("IE_PROTO"),a=Object,u=a.prototype;return JS=i?a.getPrototypeOf:function(h){var c=r(h);if(t(c,s))return c[s];var m=c.constructor;return e(m)&&c instanceof m?m.prototype:c instanceof a?u:null},JS}var e0,dH;function Qj(){if(dH)return e0;dH=1;var t=NF(),e=Dl();return e0=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},e0}var t0,fH;function UF(){if(fH)return t0;fH=1;var t=is(),e=Dl(),r=oy();return t0=function(n,i,s){t?e.f(n,i,r(0,s)):n[i]=s},t0}var r0={},n0,gH;function Jj(){if(gH)return n0;gH=1;var t=kF(),e=dT();return n0=Object.keys||function(n){return t(n,e)},n0}var mH;function eY(){if(mH)return r0;mH=1;var t=is(),e=AF(),r=Dl(),n=Jr(),i=Gg(),s=Jj();return r0.f=t&&!e?Object.defineProperties:function(u,h){n(u);for(var c=i(h),m=s(h),p=m.length,v=0,y;p>v;)r.f(u,y=m[v++],c[y]);return u},r0}var i0,pH;function jF(){if(pH)return i0;pH=1;var t=Jc();return i0=t("document","documentElement"),i0}var s0,vH;function gT(){if(vH)return s0;vH=1;var t=Jr(),e=eY(),r=dT(),n=hT(),i=jF(),s=lT(),a=uT(),u=">",h="<",c="prototype",m="script",p=a("IE_PROTO"),v=function(){},y=function(I){return h+m+u+I+h+"/"+m+u},C=function(I){I.write(y("")),I.close();var k=I.parentWindow.Object;return I=null,k},R=function(){var I=s("iframe"),k="java"+m+":",W;return I.style.display="none",i.appendChild(I),I.src=String(k),W=I.contentWindow.document,W.open(),W.write(y("document.F=Object")),W.close(),W.F},_,x=function(){try{_=new ActiveXObject("htmlfile")}catch{}x=typeof document<"u"?document.domain&&_?C(_):R():C(_);for(var I=r.length;I--;)delete x[c][r[I]];return x()};return n[p]=!0,s0=Object.create||function(k,W){var B;return k!==null?(v[c]=t(k),B=new v,v[c]=null,B[p]=k):B=x(),W===void 0?B:e.f(B,W)},s0}var o0,wH;function YF(){if(wH)return o0;wH=1;var t=xn(),e=Qr(),r=Ws(),n=gT(),i=zF(),s=cT(),a=Bs(),u=kl(),h=a("iterator"),c=!1,m,p,v;[].keys&&(v=[].keys(),"next"in v?(p=i(i(v)),p!==Object.prototype&&(m=p)):c=!0);var y=!r(m)||t(function(){var C={};return m[h].call(C)!==C});return y?m={}:u&&(m=n(m)),e(m[h])||s(m,h,function(){return this}),o0={IteratorPrototype:m,BUGGY_SAFARI_ITERATORS:c},o0}var yH;function tY(){if(yH)return lH;yH=1;var t=sr(),e=cn(),r=Xj(),n=Jr(),i=Qr(),s=zF(),a=Qj(),u=UF(),h=xn(),c=ss(),m=Bs(),p=YF().IteratorPrototype,v=is(),y=kl(),C="constructor",R="Iterator",_=m("toStringTag"),x=TypeError,I=e[R],k=y||!i(I)||I.prototype!==p||!h(function(){I({})}),W=function(){if(r(this,p),s(this)===p)throw new x("Abstract class Iterator not directly constructable")},B=function(z,U){v?a(p,z,{configurable:!0,get:function(){return U},set:function(J){if(n(this),this===p)throw new x("You can't redefine this property");c(this,z)?this[z]=J:u(this,z,J)}}):p[z]=U};return c(p,_)||B(_,R),(k||!c(p,C)||p[C]===Object)&&B(C,W),W.prototype=p,t({global:!0,constructor:!0,forced:k},{Iterator:W}),lH}var CH;function rY(){return CH||(CH=1,tY()),aH}rY();var bH={},SH={},a0,RH;function nY(){if(RH)return a0;RH=1;var t=cT();return a0=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},a0}var l0,EH;function iY(){return EH||(EH=1,l0=function(t,e){return{value:t,done:e}}),l0}var u0,_H;function mT(){if(_H)return u0;_H=1;var t=Vn(),e=gT(),r=td(),n=nY(),i=Bs(),s=HF(),a=Kg(),u=YF().IteratorPrototype,h=iY(),c=nd(),m=i("toStringTag"),p="IteratorHelper",v="WrapForValidIterator",y=s.set,C=function(x){var I=s.getterFor(x?v:p);return n(e(u),{next:function(){var W=I(this);if(x)return W.nextHandler();if(W.done)return h(void 0,!0);try{var B=W.nextHandler();return W.returnHandlerResult?B:h(B,W.done)}catch(z){throw W.done=!0,z}},return:function(){var k=I(this),W=k.iterator;if(k.done=!0,x){var B=a(W,"return");return B?t(B,W):h(void 0,!0)}if(k.inner)try{c(k.inner.iterator,"normal")}catch(z){return c(W,"throw",z)}return W&&c(W,"normal"),h(void 0,!0)}})},R=C(!0),_=C(!1);return r(_,m,"Iterator Helper"),u0=function(x,I,k){var W=function(z,U){U?(U.iterator=z.iterator,U.next=z.next):U=z,U.type=I?v:p,U.returnHandlerResult=!!k,U.nextHandler=x,U.counter=0,U.done=!1,y(this,U)};return W.prototype=I?R:_,W},u0}var h0,TH;function GF(){if(TH)return h0;TH=1;var t=Jr(),e=nd();return h0=function(r,n,i,s){try{return s?n(t(i)[0],i[1]):n(i)}catch(a){e(r,"throw",a)}},h0}var xH;function sY(){if(xH)return SH;xH=1;var t=sr(),e=Vn(),r=Si(),n=Jr(),i=Ho(),s=mT(),a=GF(),u=kl(),h=s(function(){for(var c=this.iterator,m=this.predicate,p=this.next,v,y,C;;){if(v=n(e(p,c)),y=this.done=!!v.done,y)return;if(C=v.value,a(c,m,[C,this.counter++],!0))return C}});return t({target:"Iterator",proto:!0,real:!0,forced:u},{filter:function(m){return n(this),r(m),new h(i(this),{predicate:m})}}),SH}var MH;function oY(){return MH||(MH=1,sY()),bH}oY();var IH={},OH={},c0,PH;function aY(){if(PH)return c0;PH=1;var t=sh(),e=Yr();return c0=function(r){if(t(r)==="Function")return e(r)},c0}var d0,AH;function qF(){if(AH)return d0;AH=1;var t=aY(),e=Si(),r=sy(),n=t(t.bind);return d0=function(i,s){return e(i),s===void 0?i:r?n(i,s):function(){return i.apply(s,arguments)}},d0}var f0,HH;function KF(){return HH||(HH=1,f0={}),f0}var g0,NH;function lY(){if(NH)return g0;NH=1;var t=Bs(),e=KF(),r=t("iterator"),n=Array.prototype;return g0=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},g0}var m0,kH;function pT(){if(kH)return m0;kH=1;var t=WF(),e=Kg(),r=ay(),n=KF(),i=Bs(),s=i("iterator");return m0=function(a){if(!r(a))return e(a,s)||e(a,"@@iterator")||n[t(a)]},m0}var p0,DH;function uY(){if(DH)return p0;DH=1;var t=Vn(),e=Si(),r=Jr(),n=uy(),i=pT(),s=TypeError;return p0=function(a,u){var h=arguments.length<2?i(a):u;if(e(h))return r(t(h,a));throw new s(n(a)+" is not iterable")},p0}var v0,LH;function id(){if(LH)return v0;LH=1;var t=qF(),e=Vn(),r=Jr(),n=uy(),i=lY(),s=rd(),a=qg(),u=uY(),h=pT(),c=nd(),m=TypeError,p=function(y,C){this.stopped=y,this.result=C},v=p.prototype;return v0=function(y,C,R){var _=R&&R.that,x=!!(R&&R.AS_ENTRIES),I=!!(R&&R.IS_RECORD),k=!!(R&&R.IS_ITERATOR),W=!!(R&&R.INTERRUPTED),B=t(C,_),z,U,J,se,ne,fe,j,ae=function(ie){return z&&c(z,"normal",ie),new p(!0,ie)},P=function(ie){return x?(r(ie),W?B(ie[0],ie[1],ae):B(ie[0],ie[1])):W?B(ie,ae):B(ie)};if(I)z=y.iterator;else if(k)z=y;else{if(U=h(y),!U)throw new m(n(y)+" is not iterable");if(i(U)){for(J=0,se=s(y);se>J;J++)if(ne=P(y[J]),ne&&a(v,ne))return ne;return new p(!1)}z=u(y,U)}for(fe=I?y.next:z.next;!(j=e(fe,z)).done;){try{ne=P(j.value)}catch(ie){c(z,"throw",ie)}if(typeof ne=="object"&&ne&&a(v,ne))return ne}return new p(!1)},v0}var FH;function hY(){if(FH)return OH;FH=1;var t=sr(),e=id(),r=Si(),n=Jr(),i=Ho();return t({target:"Iterator",proto:!0,real:!0},{forEach:function(a){n(this),r(a);var u=i(this),h=0;e(u,function(c){a(c,h++)},{IS_RECORD:!0})}}),OH}var WH;function cY(){return WH||(WH=1,hY()),IH}cY();var BH={},$H={},w0,VH;function dY(){if(VH)return w0;VH=1;var t=Vn(),e=Si(),r=Jr(),n=Ho(),i=mT(),s=GF(),a=i(function(){var u=this.iterator,h=r(t(this.next,u)),c=this.done=!!h.done;if(!c)return s(u,this.mapper,[h.value,this.counter++],!0)});return w0=function(h){return r(this),e(h),new a(n(this),{mapper:h})},w0}var zH;function fY(){if(zH)return $H;zH=1;var t=sr(),e=dY(),r=kl();return t({target:"Iterator",proto:!0,real:!0,forced:r},{map:e}),$H}var UH;function gY(){return UH||(UH=1,fY()),BH}gY();var jH={},YH={},y0,GH;function vT(){if(GH)return y0;GH=1;var t=Yr();return y0=t([].slice),y0}var C0,qH;function XF(){if(qH)return C0;qH=1;var t=TypeError;return C0=function(e,r){if(e<r)throw new t("Not enough arguments");return e},C0}var b0,KH;function mY(){if(KH)return b0;KH=1;var t=ly();return b0=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),b0}var S0,XH;function ZF(){if(XH)return S0;XH=1;var t=cn(),e=ly(),r=sh(),n=function(i){return e.slice(0,i.length)===i};return S0=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),S0}var R0,ZH;function pY(){if(ZH)return R0;ZH=1;var t=ZF();return R0=t==="NODE",R0}var E0,QH;function QF(){if(QH)return E0;QH=1;var t=cn(),e=hy(),r=qF(),n=Qr(),i=ss(),s=xn(),a=jF(),u=vT(),h=lT(),c=XF(),m=mY(),p=pY(),v=t.setImmediate,y=t.clearImmediate,C=t.process,R=t.Dispatch,_=t.Function,x=t.MessageChannel,I=t.String,k=0,W={},B="onreadystatechange",z,U,J,se;s(function(){z=t.location});var ne=function(P){if(i(W,P)){var ie=W[P];delete W[P],ie()}},fe=function(P){return function(){ne(P)}},j=function(P){ne(P.data)},ae=function(P){t.postMessage(I(P),z.protocol+"//"+z.host)};return(!v||!y)&&(v=function(ie){c(arguments.length,1);var Le=n(ie)?ie:_(ie),me=u(arguments,1);return W[++k]=function(){e(Le,void 0,me)},U(k),k},y=function(ie){delete W[ie]},p?U=function(P){C.nextTick(fe(P))}:R&&R.now?U=function(P){R.now(fe(P))}:x&&!m?(J=new x,se=J.port2,J.port1.onmessage=j,U=r(se.postMessage,se)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&z&&z.protocol!=="file:"&&!s(ae)?(U=ae,t.addEventListener("message",j,!1)):B in h("script")?U=function(P){a.appendChild(h("script"))[B]=function(){a.removeChild(this),ne(P)}}:U=function(P){setTimeout(fe(P),0)}),E0={set:v,clear:y},E0}var JH;function vY(){if(JH)return YH;JH=1;var t=sr(),e=cn(),r=QF().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),YH}var eN={},_0,tN;function wY(){if(tN)return _0;tN=1;var t=cn(),e=hy(),r=Qr(),n=ZF(),i=ly(),s=vT(),a=XF(),u=t.Function,h=/MSIE .\./.test(i)||n==="BUN"&&function(){var c=t.Bun.version.split(".");return c.length<3||c[0]==="0"&&(c[1]<3||c[1]==="3"&&c[2]==="0")}();return _0=function(c,m){var p=m?2:1;return h?function(v,y){var C=a(arguments.length,1)>p,R=r(v)?v:u(v),_=C?s(arguments,p):[],x=C?function(){e(R,this,_)}:R;return m?c(x,y):c(x)}:c},_0}var rN;function yY(){if(rN)return eN;rN=1;var t=sr(),e=cn(),r=QF().set,n=wY(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),eN}var nN;function CY(){return nN||(nN=1,vY(),yY()),jH}CY();/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:JF,setPrototypeOf:iN,isFrozen:bY,getPrototypeOf:SY,getOwnPropertyDescriptor:RY}=Object;let{freeze:ni,seal:rs,create:eW}=Object,{apply:QE,construct:JE}=typeof Reflect<"u"&&Reflect;ni||(ni=function(e){return e});rs||(rs=function(e){return e});QE||(QE=function(e,r,n){return e.apply(r,n)});JE||(JE=function(e,r){return new e(...r)});const sp=ii(Array.prototype.forEach),EY=ii(Array.prototype.lastIndexOf),sN=ii(Array.prototype.pop),Gd=ii(Array.prototype.push),_Y=ii(Array.prototype.splice),$v=ii(String.prototype.toLowerCase),T0=ii(String.prototype.toString),oN=ii(String.prototype.match),qd=ii(String.prototype.replace),TY=ii(String.prototype.indexOf),xY=ii(String.prototype.trim),Es=ii(Object.prototype.hasOwnProperty),qn=ii(RegExp.prototype.test),Kd=MY(TypeError);function ii(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return QE(t,e,n)}}function MY(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return JE(t,r)}}function Et(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$v;iN&&iN(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=r(i);s!==i&&(bY(e)||(e[n]=s),i=s)}t[i]=!0}return t}function IY(t){for(let e=0;e<t.length;e++)Es(t,e)||(t[e]=null);return t}function Du(t){const e=eW(null);for(const[r,n]of JF(t))Es(t,r)&&(Array.isArray(n)?e[r]=IY(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Du(n):e[r]=n);return e}function Xd(t,e){for(;t!==null;){const n=RY(t,e);if(n){if(n.get)return ii(n.get);if(typeof n.value=="function")return ii(n.value)}t=SY(t)}function r(){return null}return r}const aN=ni(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),x0=ni(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),M0=ni(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),OY=ni(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),I0=ni(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),PY=ni(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),lN=ni(["#text"]),uN=ni(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),O0=ni(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),hN=ni(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),op=ni(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),AY=rs(/\{\{[\w\W]*|[\w\W]*\}\}/gm),HY=rs(/<%[\w\W]*|[\w\W]*%>/gm),NY=rs(/\$\{[\w\W]*/gm),kY=rs(/^data-[\-\w.\u00B7-\uFFFF]+$/),DY=rs(/^aria-[\-\w]+$/),tW=rs(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),LY=rs(/^(?:\w+script|data):/i),FY=rs(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),rW=rs(/^html$/i),WY=rs(/^[a-z][.\w]*(-[.\w]+)+$/i);var cN=Object.freeze({__proto__:null,ARIA_ATTR:DY,ATTR_WHITESPACE:FY,CUSTOM_ELEMENT:WY,DATA_ATTR:kY,DOCTYPE_NAME:rW,ERB_EXPR:HY,IS_ALLOWED_URI:tW,IS_SCRIPT_OR_DATA:LY,MUSTACHE_EXPR:AY,TMPLIT_EXPR:NY});const Zd={element:1,text:3,progressingInstruction:7,comment:8,document:9},BY=function(){return typeof window>"u"?null:window},$Y=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},dN=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function nW(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:BY();const e=Je=>nW(Je);if(e.version="3.2.4",e.removed=[],!t||!t.document||t.document.nodeType!==Zd.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:u,Element:h,NodeFilter:c,NamedNodeMap:m=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:v,trustedTypes:y}=t,C=h.prototype,R=Xd(C,"cloneNode"),_=Xd(C,"remove"),x=Xd(C,"nextSibling"),I=Xd(C,"childNodes"),k=Xd(C,"parentNode");if(typeof a=="function"){const Je=r.createElement("template");Je.content&&Je.content.ownerDocument&&(r=Je.content.ownerDocument)}let W,B="";const{implementation:z,createNodeIterator:U,createDocumentFragment:J,getElementsByTagName:se}=r,{importNode:ne}=n;let fe=dN();e.isSupported=typeof JF=="function"&&typeof k=="function"&&z&&z.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:j,ERB_EXPR:ae,TMPLIT_EXPR:P,DATA_ATTR:ie,ARIA_ATTR:Le,IS_SCRIPT_OR_DATA:me,ATTR_WHITESPACE:Ae,CUSTOM_ELEMENT:ve}=cN;let{IS_ALLOWED_URI:Be}=cN,E=null;const M=Et({},[...aN,...x0,...M0,...I0,...lN]);let D=null;const $=Et({},[...uN,...O0,...hN,...op]);let X=Object.seal(eW(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ce=null,we=null,ge=!0,Se=!0,L=!1,F=!0,Z=!1,le=!0,S=!1,Y=!1,K=!1,H=!1,A=!1,V=!1,G=!0,ee=!1;const re="user-content-";let de=!0,be=!1,ye={},Ie=null;const Ne=Et({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ke=null;const Rt=Et({},["audio","video","img","source","image","track"]);let Br=null;const pr=Et({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),zt="http://www.w3.org/1998/Math/MathML",ht="http://www.w3.org/2000/svg",Ht="http://www.w3.org/1999/xhtml";let Mt=Ht,ft=!1,st=null;const Fo=Et({},[zt,ht,Ht],T0);let qe=Et({},["mi","mo","mn","ms","mtext"]),Us=Et({},["annotation-xml"]);const dn=Et({},["title","style","font","a","script"]);let Nt=null;const or=["application/xhtml+xml","text/html"],Sm="text/html";let Ft=null,Ri=null;const Sn=r.createElement("form"),pd=function(ue){return ue instanceof RegExp||ue instanceof Function},Bl=function(){let ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ri&&Ri===ue)){if((!ue||typeof ue!="object")&&(ue={}),ue=Du(ue),Nt=or.indexOf(ue.PARSER_MEDIA_TYPE)===-1?Sm:ue.PARSER_MEDIA_TYPE,Ft=Nt==="application/xhtml+xml"?T0:$v,E=Es(ue,"ALLOWED_TAGS")?Et({},ue.ALLOWED_TAGS,Ft):M,D=Es(ue,"ALLOWED_ATTR")?Et({},ue.ALLOWED_ATTR,Ft):$,st=Es(ue,"ALLOWED_NAMESPACES")?Et({},ue.ALLOWED_NAMESPACES,T0):Fo,Br=Es(ue,"ADD_URI_SAFE_ATTR")?Et(Du(pr),ue.ADD_URI_SAFE_ATTR,Ft):pr,ke=Es(ue,"ADD_DATA_URI_TAGS")?Et(Du(Rt),ue.ADD_DATA_URI_TAGS,Ft):Rt,Ie=Es(ue,"FORBID_CONTENTS")?Et({},ue.FORBID_CONTENTS,Ft):Ne,ce=Es(ue,"FORBID_TAGS")?Et({},ue.FORBID_TAGS,Ft):{},we=Es(ue,"FORBID_ATTR")?Et({},ue.FORBID_ATTR,Ft):{},ye=Es(ue,"USE_PROFILES")?ue.USE_PROFILES:!1,ge=ue.ALLOW_ARIA_ATTR!==!1,Se=ue.ALLOW_DATA_ATTR!==!1,L=ue.ALLOW_UNKNOWN_PROTOCOLS||!1,F=ue.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Z=ue.SAFE_FOR_TEMPLATES||!1,le=ue.SAFE_FOR_XML!==!1,S=ue.WHOLE_DOCUMENT||!1,H=ue.RETURN_DOM||!1,A=ue.RETURN_DOM_FRAGMENT||!1,V=ue.RETURN_TRUSTED_TYPE||!1,K=ue.FORCE_BODY||!1,G=ue.SANITIZE_DOM!==!1,ee=ue.SANITIZE_NAMED_PROPS||!1,de=ue.KEEP_CONTENT!==!1,be=ue.IN_PLACE||!1,Be=ue.ALLOWED_URI_REGEXP||tW,Mt=ue.NAMESPACE||Ht,qe=ue.MATHML_TEXT_INTEGRATION_POINTS||qe,Us=ue.HTML_INTEGRATION_POINTS||Us,X=ue.CUSTOM_ELEMENT_HANDLING||{},ue.CUSTOM_ELEMENT_HANDLING&&pd(ue.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(X.tagNameCheck=ue.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ue.CUSTOM_ELEMENT_HANDLING&&pd(ue.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(X.attributeNameCheck=ue.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ue.CUSTOM_ELEMENT_HANDLING&&typeof ue.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(X.allowCustomizedBuiltInElements=ue.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Z&&(Se=!1),A&&(H=!0),ye&&(E=Et({},lN),D=[],ye.html===!0&&(Et(E,aN),Et(D,uN)),ye.svg===!0&&(Et(E,x0),Et(D,O0),Et(D,op)),ye.svgFilters===!0&&(Et(E,M0),Et(D,O0),Et(D,op)),ye.mathMl===!0&&(Et(E,I0),Et(D,hN),Et(D,op))),ue.ADD_TAGS&&(E===M&&(E=Du(E)),Et(E,ue.ADD_TAGS,Ft)),ue.ADD_ATTR&&(D===$&&(D=Du(D)),Et(D,ue.ADD_ATTR,Ft)),ue.ADD_URI_SAFE_ATTR&&Et(Br,ue.ADD_URI_SAFE_ATTR,Ft),ue.FORBID_CONTENTS&&(Ie===Ne&&(Ie=Du(Ie)),Et(Ie,ue.FORBID_CONTENTS,Ft)),de&&(E["#text"]=!0),S&&Et(E,["html","head","body"]),E.table&&(Et(E,["tbody"]),delete ce.tbody),ue.TRUSTED_TYPES_POLICY){if(typeof ue.TRUSTED_TYPES_POLICY.createHTML!="function")throw Kd('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ue.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Kd('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');W=ue.TRUSTED_TYPES_POLICY,B=W.createHTML("")}else W===void 0&&(W=$Y(y,i)),W!==null&&typeof B=="string"&&(B=W.createHTML(""));ni&&ni(ue),Ri=ue}},ka=Et({},[...x0,...M0,...OY]),mh=Et({},[...I0,...PY]),Rm=function(ue){let xe=k(ue);(!xe||!xe.tagName)&&(xe={namespaceURI:Mt,tagName:"template"});const Ge=$v(ue.tagName),Wt=$v(xe.tagName);return st[ue.namespaceURI]?ue.namespaceURI===ht?xe.namespaceURI===Ht?Ge==="svg":xe.namespaceURI===zt?Ge==="svg"&&(Wt==="annotation-xml"||qe[Wt]):!!ka[Ge]:ue.namespaceURI===zt?xe.namespaceURI===Ht?Ge==="math":xe.namespaceURI===ht?Ge==="math"&&Us[Wt]:!!mh[Ge]:ue.namespaceURI===Ht?xe.namespaceURI===ht&&!Us[Wt]||xe.namespaceURI===zt&&!qe[Wt]?!1:!mh[Ge]&&(dn[Ge]||!ka[Ge]):!!(Nt==="application/xhtml+xml"&&st[ue.namespaceURI]):!1},Fi=function(ue){Gd(e.removed,{element:ue});try{k(ue).removeChild(ue)}catch{_(ue)}},Da=function(ue,xe){try{Gd(e.removed,{attribute:xe.getAttributeNode(ue),from:xe})}catch{Gd(e.removed,{attribute:null,from:xe})}if(xe.removeAttribute(ue),ue==="is")if(H||A)try{Fi(xe)}catch{}else try{xe.setAttribute(ue,"")}catch{}},Em=function(ue){let xe=null,Ge=null;if(K)ue="<remove></remove>"+ue;else{const lr=oN(ue,/^[\r\n\t ]+/);Ge=lr&&lr[0]}Nt==="application/xhtml+xml"&&Mt===Ht&&(ue='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ue+"</body></html>");const Wt=W?W.createHTML(ue):ue;if(Mt===Ht)try{xe=new v().parseFromString(Wt,Nt)}catch{}if(!xe||!xe.documentElement){xe=z.createDocument(Mt,"template",null);try{xe.documentElement.innerHTML=ft?B:Wt}catch{}}const fn=xe.body||xe.documentElement;return ue&&Ge&&fn.insertBefore(r.createTextNode(Ge),fn.childNodes[0]||null),Mt===Ht?se.call(xe,S?"html":"body")[0]:S?xe.documentElement:fn},ph=function(ue){return U.call(ue.ownerDocument||ue,ue,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},vd=function(ue){return ue instanceof p&&(typeof ue.nodeName!="string"||typeof ue.textContent!="string"||typeof ue.removeChild!="function"||!(ue.attributes instanceof m)||typeof ue.removeAttribute!="function"||typeof ue.setAttribute!="function"||typeof ue.namespaceURI!="string"||typeof ue.insertBefore!="function"||typeof ue.hasChildNodes!="function")},vh=function(ue){return typeof u=="function"&&ue instanceof u};function us(Je,ue,xe){sp(Je,Ge=>{Ge.call(e,ue,xe,Ri)})}const _m=function(ue){let xe=null;if(us(fe.beforeSanitizeElements,ue,null),vd(ue))return Fi(ue),!0;const Ge=Ft(ue.nodeName);if(us(fe.uponSanitizeElement,ue,{tagName:Ge,allowedTags:E}),ue.hasChildNodes()&&!vh(ue.firstElementChild)&&qn(/<[/\w]/g,ue.innerHTML)&&qn(/<[/\w]/g,ue.textContent)||ue.nodeType===Zd.progressingInstruction||le&&ue.nodeType===Zd.comment&&qn(/<[/\w]/g,ue.data))return Fi(ue),!0;if(!E[Ge]||ce[Ge]){if(!ce[Ge]&&Tm(Ge)&&(X.tagNameCheck instanceof RegExp&&qn(X.tagNameCheck,Ge)||X.tagNameCheck instanceof Function&&X.tagNameCheck(Ge)))return!1;if(de&&!Ie[Ge]){const Wt=k(ue)||ue.parentNode,fn=I(ue)||ue.childNodes;if(fn&&Wt){const lr=fn.length;for(let gn=lr-1;gn>=0;--gn){const Ei=R(fn[gn],!0);Ei.__removalCount=(ue.__removalCount||0)+1,Wt.insertBefore(Ei,x(ue))}}}return Fi(ue),!0}return ue instanceof h&&!Rm(ue)||(Ge==="noscript"||Ge==="noembed"||Ge==="noframes")&&qn(/<\/no(script|embed|frames)/i,ue.innerHTML)?(Fi(ue),!0):(Z&&ue.nodeType===Zd.text&&(xe=ue.textContent,sp([j,ae,P],Wt=>{xe=qd(xe,Wt," ")}),ue.textContent!==xe&&(Gd(e.removed,{element:ue.cloneNode()}),ue.textContent=xe)),us(fe.afterSanitizeElements,ue,null),!1)},wh=function(ue,xe,Ge){if(G&&(xe==="id"||xe==="name")&&(Ge in r||Ge in Sn))return!1;if(!(Se&&!we[xe]&&qn(ie,xe))){if(!(ge&&qn(Le,xe))){if(!D[xe]||we[xe]){if(!(Tm(ue)&&(X.tagNameCheck instanceof RegExp&&qn(X.tagNameCheck,ue)||X.tagNameCheck instanceof Function&&X.tagNameCheck(ue))&&(X.attributeNameCheck instanceof RegExp&&qn(X.attributeNameCheck,xe)||X.attributeNameCheck instanceof Function&&X.attributeNameCheck(xe))||xe==="is"&&X.allowCustomizedBuiltInElements&&(X.tagNameCheck instanceof RegExp&&qn(X.tagNameCheck,Ge)||X.tagNameCheck instanceof Function&&X.tagNameCheck(Ge))))return!1}else if(!Br[xe]){if(!qn(Be,qd(Ge,Ae,""))){if(!((xe==="src"||xe==="xlink:href"||xe==="href")&&ue!=="script"&&TY(Ge,"data:")===0&&ke[ue])){if(!(L&&!qn(me,qd(Ge,Ae,"")))){if(Ge)return!1}}}}}}return!0},Tm=function(ue){return ue!=="annotation-xml"&&oN(ue,ve)},yh=function(ue){us(fe.beforeSanitizeAttributes,ue,null);const{attributes:xe}=ue;if(!xe||vd(ue))return;const Ge={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:D,forceKeepAttr:void 0};let Wt=xe.length;for(;Wt--;){const fn=xe[Wt],{name:lr,namespaceURI:gn,value:Ei}=fn,rr=Ft(lr);let Fe=lr==="value"?Ei:xY(Ei);if(Ge.attrName=rr,Ge.attrValue=Fe,Ge.keepAttr=!0,Ge.forceKeepAttr=void 0,us(fe.uponSanitizeAttribute,ue,Ge),Fe=Ge.attrValue,ee&&(rr==="id"||rr==="name")&&(Da(lr,ue),Fe=re+Fe),le&&qn(/((--!?|])>)|<\/(style|title)/i,Fe)){Da(lr,ue);continue}if(Ge.forceKeepAttr||(Da(lr,ue),!Ge.keepAttr))continue;if(!F&&qn(/\/>/i,Fe)){Da(lr,ue);continue}Z&&sp([j,ae,P],Ch=>{Fe=qd(Fe,Ch," ")});const js=Ft(ue.nodeName);if(wh(js,rr,Fe)){if(W&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!gn)switch(y.getAttributeType(js,rr)){case"TrustedHTML":{Fe=W.createHTML(Fe);break}case"TrustedScriptURL":{Fe=W.createScriptURL(Fe);break}}try{gn?ue.setAttributeNS(gn,lr,Fe):ue.setAttribute(lr,Fe),vd(ue)?Fi(ue):sN(e.removed)}catch{}}}us(fe.afterSanitizeAttributes,ue,null)},La=function Je(ue){let xe=null;const Ge=ph(ue);for(us(fe.beforeSanitizeShadowDOM,ue,null);xe=Ge.nextNode();)us(fe.uponSanitizeShadowNode,xe,null),_m(xe),yh(xe),xe.content instanceof s&&Je(xe.content);us(fe.afterSanitizeShadowDOM,ue,null)};return e.sanitize=function(Je){let ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},xe=null,Ge=null,Wt=null,fn=null;if(ft=!Je,ft&&(Je="<!-->"),typeof Je!="string"&&!vh(Je))if(typeof Je.toString=="function"){if(Je=Je.toString(),typeof Je!="string")throw Kd("dirty is not a string, aborting")}else throw Kd("toString is not a function");if(!e.isSupported)return Je;if(Y||Bl(ue),e.removed=[],typeof Je=="string"&&(be=!1),be){if(Je.nodeName){const Ei=Ft(Je.nodeName);if(!E[Ei]||ce[Ei])throw Kd("root node is forbidden and cannot be sanitized in-place")}}else if(Je instanceof u)xe=Em("<!---->"),Ge=xe.ownerDocument.importNode(Je,!0),Ge.nodeType===Zd.element&&Ge.nodeName==="BODY"||Ge.nodeName==="HTML"?xe=Ge:xe.appendChild(Ge);else{if(!H&&!Z&&!S&&Je.indexOf("<")===-1)return W&&V?W.createHTML(Je):Je;if(xe=Em(Je),!xe)return H?null:V?B:""}xe&&K&&Fi(xe.firstChild);const lr=ph(be?Je:xe);for(;Wt=lr.nextNode();)_m(Wt),yh(Wt),Wt.content instanceof s&&La(Wt.content);if(be)return Je;if(H){if(A)for(fn=J.call(xe.ownerDocument);xe.firstChild;)fn.appendChild(xe.firstChild);else fn=xe;return(D.shadowroot||D.shadowrootmode)&&(fn=ne.call(n,fn,!0)),fn}let gn=S?xe.outerHTML:xe.innerHTML;return S&&E["!doctype"]&&xe.ownerDocument&&xe.ownerDocument.doctype&&xe.ownerDocument.doctype.name&&qn(rW,xe.ownerDocument.doctype.name)&&(gn="<!DOCTYPE "+xe.ownerDocument.doctype.name+`>
`+gn),Z&&sp([j,ae,P],Ei=>{gn=qd(gn,Ei," ")}),W&&V?W.createHTML(gn):gn},e.setConfig=function(){let Je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Bl(Je),Y=!0},e.clearConfig=function(){Ri=null,Y=!1},e.isValidAttribute=function(Je,ue,xe){Ri||Bl({});const Ge=Ft(Je),Wt=Ft(ue);return wh(Ge,Wt,xe)},e.addHook=function(Je,ue){typeof ue=="function"&&Gd(fe[Je],ue)},e.removeHook=function(Je,ue){if(ue!==void 0){const xe=EY(fe[Je],ue);return xe===-1?void 0:_Y(fe[Je],xe,1)[0]}return sN(fe[Je])},e.removeHooks=function(Je){fe[Je]=[]},e.removeAllHooks=function(){fe=dN()},e}var VY=nW();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var iW;function Ee(){return iW.apply(null,arguments)}function zY(t){iW=t}function ks(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ku(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Dt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function wT(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Dt(t,e))return!1;return!0}function gi(t){return t===void 0}function _a(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Jg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function sW(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function yl(t,e){for(var r in e)Dt(e,r)&&(t[r]=e[r]);return Dt(e,"toString")&&(t.toString=e.toString),Dt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function No(t,e,r,n){return MW(t,e,r,n,!0).utc()}function UY(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function mt(t){return t._pf==null&&(t._pf=UY()),t._pf}var e_;Array.prototype.some?e_=Array.prototype.some:e_=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function yT(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=mt(t),r=e_.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function dy(t){var e=No(NaN);return t!=null?yl(mt(e),t):mt(e).userInvalidated=!0,e}var fN=Ee.momentProperties=[],P0=!1;function CT(t,e){var r,n,i,s=fN.length;if(gi(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),gi(e._i)||(t._i=e._i),gi(e._f)||(t._f=e._f),gi(e._l)||(t._l=e._l),gi(e._strict)||(t._strict=e._strict),gi(e._tzm)||(t._tzm=e._tzm),gi(e._isUTC)||(t._isUTC=e._isUTC),gi(e._offset)||(t._offset=e._offset),gi(e._pf)||(t._pf=mt(e)),gi(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)n=fN[r],i=e[n],gi(i)||(t[n]=i);return t}function em(t){CT(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),P0===!1&&(P0=!0,Ee.updateOffset(this),P0=!1)}function Ds(t){return t instanceof em||t!=null&&t._isAMomentObject!=null}function oW(t){Ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function os(t,e){var r=!0;return yl(function(){if(Ee.deprecationHandler!=null&&Ee.deprecationHandler(null,t),r){var n=[],i,s,a,u=arguments.length;for(s=0;s<u;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(a in arguments[0])Dt(arguments[0],a)&&(i+=a+": "+arguments[0][a]+", ");i=i.slice(0,-2)}else i=arguments[s];n.push(i)}oW(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var gN={};function aW(t,e){Ee.deprecationHandler!=null&&Ee.deprecationHandler(t,e),gN[t]||(oW(e),gN[t]=!0)}Ee.suppressDeprecationWarnings=!1;Ee.deprecationHandler=null;function ko(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function jY(t){var e,r;for(r in t)Dt(t,r)&&(e=t[r],ko(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function t_(t,e){var r=yl({},t),n;for(n in e)Dt(e,n)&&(Ku(t[n])&&Ku(e[n])?(r[n]={},yl(r[n],t[n]),yl(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Dt(t,n)&&!Dt(e,n)&&Ku(t[n])&&(r[n]=yl({},r[n]));return r}function bT(t){t!=null&&this.set(t)}var r_;Object.keys?r_=Object.keys:r_=function(t){var e,r=[];for(e in t)Dt(t,e)&&r.push(e);return r};var YY={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function GY(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return ko(n)?n.call(e,r):n}function Po(t,e,r){var n=""+Math.abs(t),i=e-n.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var ST=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ap=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,A0={},Lc={};function rt(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Lc[t]=i),e&&(Lc[e[0]]=function(){return Po(i.apply(this,arguments),e[1],e[2])}),r&&(Lc[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function qY(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function KY(t){var e=t.match(ST),r,n;for(r=0,n=e.length;r<n;r++)Lc[e[r]]?e[r]=Lc[e[r]]:e[r]=qY(e[r]);return function(i){var s="",a;for(a=0;a<n;a++)s+=ko(e[a])?e[a].call(i,t):e[a];return s}}function Vv(t,e){return t.isValid()?(e=lW(e,t.localeData()),A0[e]=A0[e]||KY(e),A0[e](t)):t.localeData().invalidDate()}function lW(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(ap.lastIndex=0;r>=0&&ap.test(t);)t=t.replace(ap,n),ap.lastIndex=0,r-=1;return t}var XY={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ZY(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(ST).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var QY="Invalid date";function JY(){return this._invalidDate}var eG="%d",tG=/\d{1,2}/;function rG(t){return this._ordinal.replace("%d",t)}var nG={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function iG(t,e,r,n){var i=this._relativeTime[r];return ko(i)?i(t,e,r,n):i.replace(/%d/i,t)}function sG(t,e){var r=this._relativeTime[t>0?"future":"past"];return ko(r)?r(e):r.replace(/%s/i,e)}var mN={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function as(t){return typeof t=="string"?mN[t]||mN[t.toLowerCase()]:void 0}function RT(t){var e={},r,n;for(n in t)Dt(t,n)&&(r=as(n),r&&(e[r]=t[n]));return e}var oG={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function aG(t){var e=[],r;for(r in t)Dt(t,r)&&e.push({unit:r,priority:oG[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var uW=/\d/,Li=/\d\d/,hW=/\d{3}/,ET=/\d{4}/,fy=/[+-]?\d{6}/,mr=/\d\d?/,cW=/\d\d\d\d?/,dW=/\d\d\d\d\d\d?/,gy=/\d{1,3}/,_T=/\d{1,4}/,my=/[+-]?\d{1,6}/,sd=/\d+/,py=/[+-]?\d+/,lG=/Z|[+-]\d\d:?\d\d/gi,vy=/Z|[+-]\d\d(?::?\d\d)?/gi,uG=/[+-]?\d+(\.\d{1,3})?/,tm=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,od=/^[1-9]\d?/,TT=/^([1-9]\d|\d)/,uw;uw={};function je(t,e,r){uw[t]=ko(e)?e:function(n,i){return n&&r?r:e}}function hG(t,e){return Dt(uw,t)?uw[t](e._strict,e._locale):new RegExp(cG(t))}function cG(t){return Ra(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,s){return r||n||i||s}))}function Ra(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Qi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function xt(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Qi(e)),r}var n_={};function tr(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),_a(e)&&(n=function(s,a){a[e]=xt(s)}),i=t.length,r=0;r<i;r++)n_[t[r]]=n}function rm(t,e){tr(t,function(r,n,i,s){i._w=i._w||{},e(r,i._w,i,s)})}function dG(t,e,r){e!=null&&Dt(n_,t)&&n_[t](e,r._a,r,t)}function wy(t){return t%4===0&&t%100!==0||t%400===0}var Wn=0,pa=1,_o=2,hn=3,As=4,va=5,Vu=6,fG=7,gG=8;rt("Y",0,0,function(){var t=this.year();return t<=9999?Po(t,4):"+"+t});rt(0,["YY",2],0,function(){return this.year()%100});rt(0,["YYYY",4],0,"year");rt(0,["YYYYY",5],0,"year");rt(0,["YYYYYY",6,!0],0,"year");je("Y",py);je("YY",mr,Li);je("YYYY",_T,ET);je("YYYYY",my,fy);je("YYYYYY",my,fy);tr(["YYYYY","YYYYYY"],Wn);tr("YYYY",function(t,e){e[Wn]=t.length===2?Ee.parseTwoDigitYear(t):xt(t)});tr("YY",function(t,e){e[Wn]=Ee.parseTwoDigitYear(t)});tr("Y",function(t,e){e[Wn]=parseInt(t,10)});function ng(t){return wy(t)?366:365}Ee.parseTwoDigitYear=function(t){return xt(t)+(xt(t)>68?1900:2e3)};var fW=ad("FullYear",!0);function mG(){return wy(this.year())}function ad(t,e){return function(r){return r!=null?(gW(this,t,r),Ee.updateOffset(this,e),this):_g(this,t)}}function _g(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function gW(t,e,r){var n,i,s,a,u;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,a=t.month(),u=t.date(),u=u===29&&a===1&&!wy(s)?28:u,i?n.setUTCFullYear(s,a,u):n.setFullYear(s,a,u)}}function pG(t){return t=as(t),ko(this[t])?this[t]():this}function vG(t,e){if(typeof t=="object"){t=RT(t);var r=aG(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=as(t),ko(this[t]))return this[t](e);return this}function wG(t,e){return(t%e+e)%e}var zr;Array.prototype.indexOf?zr=Array.prototype.indexOf:zr=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function xT(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=wG(e,12);return t+=(e-r)/12,r===1?wy(t)?29:28:31-r%7%2}rt("M",["MM",2],"Mo",function(){return this.month()+1});rt("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});rt("MMMM",0,0,function(t){return this.localeData().months(this,t)});je("M",mr,od);je("MM",mr,Li);je("MMM",function(t,e){return e.monthsShortRegex(t)});je("MMMM",function(t,e){return e.monthsRegex(t)});tr(["M","MM"],function(t,e){e[pa]=xt(t)-1});tr(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[pa]=i:mt(r).invalidMonth=t});var yG="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),mW="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),pW=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,CG=tm,bG=tm;function SG(t,e){return t?ks(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||pW).test(e)?"format":"standalone"][t.month()]:ks(this._months)?this._months:this._months.standalone}function RG(t,e){return t?ks(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[pW.test(e)?"format":"standalone"][t.month()]:ks(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function EG(t,e,r){var n,i,s,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=No([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(i=zr.call(this._shortMonthsParse,a),i!==-1?i:null):(i=zr.call(this._longMonthsParse,a),i!==-1?i:null):e==="MMM"?(i=zr.call(this._shortMonthsParse,a),i!==-1?i:(i=zr.call(this._longMonthsParse,a),i!==-1?i:null)):(i=zr.call(this._longMonthsParse,a),i!==-1?i:(i=zr.call(this._shortMonthsParse,a),i!==-1?i:null))}function _G(t,e,r){var n,i,s;if(this._monthsParseExact)return EG.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=No([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function vW(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=xt(e);else if(e=t.localeData().monthsParse(e),!_a(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,xT(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function wW(t){return t!=null?(vW(this,t),Ee.updateOffset(this,!0),this):_g(this,"Month")}function TG(){return xT(this.year(),this.month())}function xG(t){return this._monthsParseExact?(Dt(this,"_monthsRegex")||yW.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Dt(this,"_monthsShortRegex")||(this._monthsShortRegex=CG),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function MG(t){return this._monthsParseExact?(Dt(this,"_monthsRegex")||yW.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Dt(this,"_monthsRegex")||(this._monthsRegex=bG),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function yW(){function t(h,c){return c.length-h.length}var e=[],r=[],n=[],i,s,a,u;for(i=0;i<12;i++)s=No([2e3,i]),a=Ra(this.monthsShort(s,"")),u=Ra(this.months(s,"")),e.push(a),r.push(u),n.push(u),n.push(a);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function IG(t,e,r,n,i,s,a){var u;return t<100&&t>=0?(u=new Date(t+400,e,r,n,i,s,a),isFinite(u.getFullYear())&&u.setFullYear(t)):u=new Date(t,e,r,n,i,s,a),u}function Tg(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function hw(t,e,r){var n=7+e-r,i=(7+Tg(t,0,n).getUTCDay()-e)%7;return-i+n-1}function CW(t,e,r,n,i){var s=(7+r-n)%7,a=hw(t,n,i),u=1+7*(e-1)+s+a,h,c;return u<=0?(h=t-1,c=ng(h)+u):u>ng(t)?(h=t+1,c=u-ng(t)):(h=t,c=u),{year:h,dayOfYear:c}}function xg(t,e,r){var n=hw(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,s,a;return i<1?(a=t.year()-1,s=i+Ea(a,e,r)):i>Ea(t.year(),e,r)?(s=i-Ea(t.year(),e,r),a=t.year()+1):(a=t.year(),s=i),{week:s,year:a}}function Ea(t,e,r){var n=hw(t,e,r),i=hw(t+1,e,r);return(ng(t)-n+i)/7}rt("w",["ww",2],"wo","week");rt("W",["WW",2],"Wo","isoWeek");je("w",mr,od);je("ww",mr,Li);je("W",mr,od);je("WW",mr,Li);rm(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=xt(t)});function OG(t){return xg(t,this._week.dow,this._week.doy).week}var PG={dow:0,doy:6};function AG(){return this._week.dow}function HG(){return this._week.doy}function NG(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function kG(t){var e=xg(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}rt("d",0,"do","day");rt("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});rt("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});rt("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});rt("e",0,0,"weekday");rt("E",0,0,"isoWeekday");je("d",mr);je("e",mr);je("E",mr);je("dd",function(t,e){return e.weekdaysMinRegex(t)});je("ddd",function(t,e){return e.weekdaysShortRegex(t)});je("dddd",function(t,e){return e.weekdaysRegex(t)});rm(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:mt(r).invalidWeekday=t});rm(["d","e","E"],function(t,e,r,n){e[n]=xt(t)});function DG(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function LG(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function MT(t,e){return t.slice(e,7).concat(t.slice(0,e))}var FG="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),bW="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),WG="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),BG=tm,$G=tm,VG=tm;function zG(t,e){var r=ks(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?MT(r,this._week.dow):t?r[t.day()]:r}function UG(t){return t===!0?MT(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function jG(t){return t===!0?MT(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function YG(t,e,r){var n,i,s,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=No([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(i=zr.call(this._weekdaysParse,a),i!==-1?i:null):e==="ddd"?(i=zr.call(this._shortWeekdaysParse,a),i!==-1?i:null):(i=zr.call(this._minWeekdaysParse,a),i!==-1?i:null):e==="dddd"?(i=zr.call(this._weekdaysParse,a),i!==-1||(i=zr.call(this._shortWeekdaysParse,a),i!==-1)?i:(i=zr.call(this._minWeekdaysParse,a),i!==-1?i:null)):e==="ddd"?(i=zr.call(this._shortWeekdaysParse,a),i!==-1||(i=zr.call(this._weekdaysParse,a),i!==-1)?i:(i=zr.call(this._minWeekdaysParse,a),i!==-1?i:null)):(i=zr.call(this._minWeekdaysParse,a),i!==-1||(i=zr.call(this._weekdaysParse,a),i!==-1)?i:(i=zr.call(this._shortWeekdaysParse,a),i!==-1?i:null))}function GG(t,e,r){var n,i,s;if(this._weekdaysParseExact)return YG.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=No([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function qG(t){if(!this.isValid())return t!=null?this:NaN;var e=_g(this,"Day");return t!=null?(t=DG(t,this.localeData()),this.add(t-e,"d")):e}function KG(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function XG(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=LG(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function ZG(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||IT.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Dt(this,"_weekdaysRegex")||(this._weekdaysRegex=BG),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function QG(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||IT.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Dt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=$G),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function JG(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||IT.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Dt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=VG),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function IT(){function t(m,p){return p.length-m.length}var e=[],r=[],n=[],i=[],s,a,u,h,c;for(s=0;s<7;s++)a=No([2e3,1]).day(s),u=Ra(this.weekdaysMin(a,"")),h=Ra(this.weekdaysShort(a,"")),c=Ra(this.weekdays(a,"")),e.push(u),r.push(h),n.push(c),i.push(u),i.push(h),i.push(c);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function OT(){return this.hours()%12||12}function e3(){return this.hours()||24}rt("H",["HH",2],0,"hour");rt("h",["hh",2],0,OT);rt("k",["kk",2],0,e3);rt("hmm",0,0,function(){return""+OT.apply(this)+Po(this.minutes(),2)});rt("hmmss",0,0,function(){return""+OT.apply(this)+Po(this.minutes(),2)+Po(this.seconds(),2)});rt("Hmm",0,0,function(){return""+this.hours()+Po(this.minutes(),2)});rt("Hmmss",0,0,function(){return""+this.hours()+Po(this.minutes(),2)+Po(this.seconds(),2)});function SW(t,e){rt(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}SW("a",!0);SW("A",!1);function RW(t,e){return e._meridiemParse}je("a",RW);je("A",RW);je("H",mr,TT);je("h",mr,od);je("k",mr,od);je("HH",mr,Li);je("hh",mr,Li);je("kk",mr,Li);je("hmm",cW);je("hmmss",dW);je("Hmm",cW);je("Hmmss",dW);tr(["H","HH"],hn);tr(["k","kk"],function(t,e,r){var n=xt(t);e[hn]=n===24?0:n});tr(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});tr(["h","hh"],function(t,e,r){e[hn]=xt(t),mt(r).bigHour=!0});tr("hmm",function(t,e,r){var n=t.length-2;e[hn]=xt(t.substr(0,n)),e[As]=xt(t.substr(n)),mt(r).bigHour=!0});tr("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[hn]=xt(t.substr(0,n)),e[As]=xt(t.substr(n,2)),e[va]=xt(t.substr(i)),mt(r).bigHour=!0});tr("Hmm",function(t,e,r){var n=t.length-2;e[hn]=xt(t.substr(0,n)),e[As]=xt(t.substr(n))});tr("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[hn]=xt(t.substr(0,n)),e[As]=xt(t.substr(n,2)),e[va]=xt(t.substr(i))});function t3(t){return(t+"").toLowerCase().charAt(0)==="p"}var r3=/[ap]\.?m?\.?/i,n3=ad("Hours",!0);function i3(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var EW={calendar:YY,longDateFormat:XY,invalidDate:QY,ordinal:eG,dayOfMonthOrdinalParse:tG,relativeTime:nG,months:yG,monthsShort:mW,week:PG,weekdays:FG,weekdaysMin:WG,weekdaysShort:bW,meridiemParse:r3},yr={},Qd={},Mg;function s3(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function pN(t){return t&&t.toLowerCase().replace("_","-")}function o3(t){for(var e=0,r,n,i,s;e<t.length;){for(s=pN(t[e]).split("-"),r=s.length,n=pN(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=yy(s.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&s3(s,n)>=r-1)break;r--}e++}return Mg}function a3(t){return!!(t&&t.match("^[^/\\\\]*$"))}function yy(t){var e=null,r;if(yr[t]===void 0&&typeof module<"u"&&module&&module.exports&&a3(t))try{e=Mg._abbr,r=require,r("./locale/"+t),_l(e)}catch{yr[t]=null}return yr[t]}function _l(t,e){var r;return t&&(gi(e)?r=Oa(t):r=PT(t,e),r?Mg=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Mg._abbr}function PT(t,e){if(e!==null){var r,n=EW;if(e.abbr=t,yr[t]!=null)aW("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=yr[t]._config;else if(e.parentLocale!=null)if(yr[e.parentLocale]!=null)n=yr[e.parentLocale]._config;else if(r=yy(e.parentLocale),r!=null)n=r._config;else return Qd[e.parentLocale]||(Qd[e.parentLocale]=[]),Qd[e.parentLocale].push({name:t,config:e}),null;return yr[t]=new bT(t_(n,e)),Qd[t]&&Qd[t].forEach(function(i){PT(i.name,i.config)}),_l(t),yr[t]}else return delete yr[t],null}function l3(t,e){if(e!=null){var r,n,i=EW;yr[t]!=null&&yr[t].parentLocale!=null?yr[t].set(t_(yr[t]._config,e)):(n=yy(t),n!=null&&(i=n._config),e=t_(i,e),n==null&&(e.abbr=t),r=new bT(e),r.parentLocale=yr[t],yr[t]=r),_l(t)}else yr[t]!=null&&(yr[t].parentLocale!=null?(yr[t]=yr[t].parentLocale,t===_l()&&_l(t)):yr[t]!=null&&delete yr[t]);return yr[t]}function Oa(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Mg;if(!ks(t)){if(e=yy(t),e)return e;t=[t]}return o3(t)}function u3(){return r_(yr)}function AT(t){var e,r=t._a;return r&&mt(t).overflow===-2&&(e=r[pa]<0||r[pa]>11?pa:r[_o]<1||r[_o]>xT(r[Wn],r[pa])?_o:r[hn]<0||r[hn]>24||r[hn]===24&&(r[As]!==0||r[va]!==0||r[Vu]!==0)?hn:r[As]<0||r[As]>59?As:r[va]<0||r[va]>59?va:r[Vu]<0||r[Vu]>999?Vu:-1,mt(t)._overflowDayOfYear&&(e<Wn||e>_o)&&(e=_o),mt(t)._overflowWeeks&&e===-1&&(e=fG),mt(t)._overflowWeekday&&e===-1&&(e=gG),mt(t).overflow=e),t}var h3=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,c3=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,d3=/Z|[+-]\d\d(?::?\d\d)?/,lp=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],H0=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],f3=/^\/?Date\((-?\d+)/i,g3=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,m3={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function _W(t){var e,r,n=t._i,i=h3.exec(n)||c3.exec(n),s,a,u,h,c=lp.length,m=H0.length;if(i){for(mt(t).iso=!0,e=0,r=c;e<r;e++)if(lp[e][1].exec(i[1])){a=lp[e][0],s=lp[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(i[3]){for(e=0,r=m;e<r;e++)if(H0[e][1].exec(i[3])){u=(i[2]||" ")+H0[e][0];break}if(u==null){t._isValid=!1;return}}if(!s&&u!=null){t._isValid=!1;return}if(i[4])if(d3.exec(i[4]))h="Z";else{t._isValid=!1;return}t._f=a+(u||"")+(h||""),NT(t)}else t._isValid=!1}function p3(t,e,r,n,i,s){var a=[v3(t),mW.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return s&&a.push(parseInt(s,10)),a}function v3(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function w3(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function y3(t,e,r){if(t){var n=bW.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return mt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function C3(t,e,r){if(t)return m3[t];if(e)return 0;var n=parseInt(r,10),i=n%100,s=(n-i)/100;return s*60+i}function TW(t){var e=g3.exec(w3(t._i)),r;if(e){if(r=p3(e[4],e[3],e[2],e[5],e[6],e[7]),!y3(e[1],r,t))return;t._a=r,t._tzm=C3(e[8],e[9],e[10]),t._d=Tg.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),mt(t).rfc2822=!0}else t._isValid=!1}function b3(t){var e=f3.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(_W(t),t._isValid===!1)delete t._isValid;else return;if(TW(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Ee.createFromInputFallback(t)}Ee.createFromInputFallback=os("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Sc(t,e,r){return t??e??r}function S3(t){var e=new Date(Ee.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function HT(t){var e,r,n=[],i,s,a;if(!t._d){for(i=S3(t),t._w&&t._a[_o]==null&&t._a[pa]==null&&R3(t),t._dayOfYear!=null&&(a=Sc(t._a[Wn],i[Wn]),(t._dayOfYear>ng(a)||t._dayOfYear===0)&&(mt(t)._overflowDayOfYear=!0),r=Tg(a,0,t._dayOfYear),t._a[pa]=r.getUTCMonth(),t._a[_o]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[hn]===24&&t._a[As]===0&&t._a[va]===0&&t._a[Vu]===0&&(t._nextDay=!0,t._a[hn]=0),t._d=(t._useUTC?Tg:IG).apply(null,n),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[hn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(mt(t).weekdayMismatch=!0)}}function R3(t){var e,r,n,i,s,a,u,h,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,a=4,r=Sc(e.GG,t._a[Wn],xg(gr(),1,4).year),n=Sc(e.W,1),i=Sc(e.E,1),(i<1||i>7)&&(h=!0)):(s=t._locale._week.dow,a=t._locale._week.doy,c=xg(gr(),s,a),r=Sc(e.gg,t._a[Wn],c.year),n=Sc(e.w,c.week),e.d!=null?(i=e.d,(i<0||i>6)&&(h=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(h=!0)):i=s),n<1||n>Ea(r,s,a)?mt(t)._overflowWeeks=!0:h!=null?mt(t)._overflowWeekday=!0:(u=CW(r,n,i,s,a),t._a[Wn]=u.year,t._dayOfYear=u.dayOfYear)}Ee.ISO_8601=function(){};Ee.RFC_2822=function(){};function NT(t){if(t._f===Ee.ISO_8601){_W(t);return}if(t._f===Ee.RFC_2822){TW(t);return}t._a=[],mt(t).empty=!0;var e=""+t._i,r,n,i,s,a,u=e.length,h=0,c,m;for(i=lW(t._f,t._locale).match(ST)||[],m=i.length,r=0;r<m;r++)s=i[r],n=(e.match(hG(s,t))||[])[0],n&&(a=e.substr(0,e.indexOf(n)),a.length>0&&mt(t).unusedInput.push(a),e=e.slice(e.indexOf(n)+n.length),h+=n.length),Lc[s]?(n?mt(t).empty=!1:mt(t).unusedTokens.push(s),dG(s,n,t)):t._strict&&!n&&mt(t).unusedTokens.push(s);mt(t).charsLeftOver=u-h,e.length>0&&mt(t).unusedInput.push(e),t._a[hn]<=12&&mt(t).bigHour===!0&&t._a[hn]>0&&(mt(t).bigHour=void 0),mt(t).parsedDateParts=t._a.slice(0),mt(t).meridiem=t._meridiem,t._a[hn]=E3(t._locale,t._a[hn],t._meridiem),c=mt(t).era,c!==null&&(t._a[Wn]=t._locale.erasConvertYear(c,t._a[Wn])),HT(t),AT(t)}function E3(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function _3(t){var e,r,n,i,s,a,u=!1,h=t._f.length;if(h===0){mt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<h;i++)s=0,a=!1,e=CT({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],NT(e),yT(e)&&(a=!0),s+=mt(e).charsLeftOver,s+=mt(e).unusedTokens.length*10,mt(e).score=s,u?s<n&&(n=s,r=e):(n==null||s<n||a)&&(n=s,r=e,a&&(u=!0));yl(t,r||e)}function T3(t){if(!t._d){var e=RT(t._i),r=e.day===void 0?e.date:e.day;t._a=sW([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),HT(t)}}function x3(t){var e=new em(AT(xW(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function xW(t){var e=t._i,r=t._f;return t._locale=t._locale||Oa(t._l),e===null||r===void 0&&e===""?dy({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Ds(e)?new em(AT(e)):(Jg(e)?t._d=e:ks(r)?_3(t):r?NT(t):M3(t),yT(t)||(t._d=null),t))}function M3(t){var e=t._i;gi(e)?t._d=new Date(Ee.now()):Jg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?b3(t):ks(e)?(t._a=sW(e.slice(0),function(r){return parseInt(r,10)}),HT(t)):Ku(e)?T3(t):_a(e)?t._d=new Date(e):Ee.createFromInputFallback(t)}function MW(t,e,r,n,i){var s={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ku(t)&&wT(t)||ks(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=t,s._f=e,s._strict=n,x3(s)}function gr(t,e,r,n){return MW(t,e,r,n,!1)}var I3=os("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=gr.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:dy()}),O3=os("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=gr.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:dy()});function IW(t,e){var r,n;if(e.length===1&&ks(e[0])&&(e=e[0]),!e.length)return gr();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function P3(){var t=[].slice.call(arguments,0);return IW("isBefore",t)}function A3(){var t=[].slice.call(arguments,0);return IW("isAfter",t)}var H3=function(){return Date.now?Date.now():+new Date},Jd=["year","quarter","month","week","day","hour","minute","second","millisecond"];function N3(t){var e,r=!1,n,i=Jd.length;for(e in t)if(Dt(t,e)&&!(zr.call(Jd,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Jd[n]]){if(r)return!1;parseFloat(t[Jd[n]])!==xt(t[Jd[n]])&&(r=!0)}return!0}function k3(){return this._isValid}function D3(){return $s(NaN)}function Cy(t){var e=RT(t),r=e.year||0,n=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,a=e.day||0,u=e.hour||0,h=e.minute||0,c=e.second||0,m=e.millisecond||0;this._isValid=N3(e),this._milliseconds=+m+c*1e3+h*6e4+u*1e3*60*60,this._days=+a+s*7,this._months=+i+n*3+r*12,this._data={},this._locale=Oa(),this._bubble()}function zv(t){return t instanceof Cy}function i_(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function L3(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,a;for(a=0;a<n;a++)xt(t[a])!==xt(e[a])&&s++;return s+i}function OW(t,e){rt(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Po(~~(r/60),2)+e+Po(~~r%60,2)})}OW("Z",":");OW("ZZ","");je("Z",vy);je("ZZ",vy);tr(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=kT(vy,t)});var F3=/([\+\-]|\d\d)/gi;function kT(t,e){var r=(e||"").match(t),n,i,s;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(F3)||["-",0,0],s=+(i[1]*60)+xt(i[2]),s===0?0:i[0]==="+"?s:-s)}function DT(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(Ds(t)||Jg(t)?t.valueOf():gr(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Ee.updateOffset(r,!1),r):gr(t).local()}function s_(t){return-Math.round(t._d.getTimezoneOffset())}Ee.updateOffset=function(){};function W3(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=kT(vy,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=s_(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?HW(this,$s(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:s_(this)}function B3(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function $3(t){return this.utcOffset(0,t)}function V3(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(s_(this),"m")),this}function z3(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=kT(lG,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function U3(t){return this.isValid()?(t=t?gr(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function j3(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Y3(){if(!gi(this._isDSTShifted))return this._isDSTShifted;var t={},e;return CT(t,this),t=xW(t),t._a?(e=t._isUTC?No(t._a):gr(t._a),this._isDSTShifted=this.isValid()&&L3(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function G3(){return this.isValid()?!this._isUTC:!1}function q3(){return this.isValid()?this._isUTC:!1}function PW(){return this.isValid()?this._isUTC&&this._offset===0:!1}var K3=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,X3=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function $s(t,e){var r=t,n=null,i,s,a;return zv(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:_a(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=K3.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:xt(n[_o])*i,h:xt(n[hn])*i,m:xt(n[As])*i,s:xt(n[va])*i,ms:xt(i_(n[Vu]*1e3))*i}):(n=X3.exec(t))?(i=n[1]==="-"?-1:1,r={y:Ql(n[2],i),M:Ql(n[3],i),w:Ql(n[4],i),d:Ql(n[5],i),h:Ql(n[6],i),m:Ql(n[7],i),s:Ql(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=Z3(gr(r.from),gr(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),s=new Cy(r),zv(t)&&Dt(t,"_locale")&&(s._locale=t._locale),zv(t)&&Dt(t,"_isValid")&&(s._isValid=t._isValid),s}$s.fn=Cy.prototype;$s.invalid=D3;function Ql(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function vN(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function Z3(t,e){var r;return t.isValid()&&e.isValid()?(e=DT(e,t),t.isBefore(e)?r=vN(t,e):(r=vN(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function AW(t,e){return function(r,n){var i,s;return n!==null&&!isNaN(+n)&&(aW(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),i=$s(r,n),HW(this,i,t),this}}function HW(t,e,r,n){var i=e._milliseconds,s=i_(e._days),a=i_(e._months);t.isValid()&&(n=n??!0,a&&vW(t,_g(t,"Month")+a*r),s&&gW(t,"Date",_g(t,"Date")+s*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&Ee.updateOffset(t,s||a))}var Q3=AW(1,"add"),J3=AW(-1,"subtract");function NW(t){return typeof t=="string"||t instanceof String}function e5(t){return Ds(t)||Jg(t)||NW(t)||_a(t)||r5(t)||t5(t)||t===null||t===void 0}function t5(t){var e=Ku(t)&&!wT(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,a=n.length;for(i=0;i<a;i+=1)s=n[i],r=r||Dt(t,s);return e&&r}function r5(t){var e=ks(t),r=!1;return e&&(r=t.filter(function(n){return!_a(n)&&NW(t)}).length===0),e&&r}function n5(t){var e=Ku(t)&&!wT(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<n.length;i+=1)s=n[i],r=r||Dt(t,s);return e&&r}function i5(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function s5(t,e){arguments.length===1&&(arguments[0]?e5(arguments[0])?(t=arguments[0],e=void 0):n5(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||gr(),n=DT(r,this).startOf("day"),i=Ee.calendarFormat(this,n)||"sameElse",s=e&&(ko(e[i])?e[i].call(this,r):e[i]);return this.format(s||this.localeData().calendar(i,this,gr(r)))}function o5(){return new em(this)}function a5(t,e){var r=Ds(t)?t:gr(t);return this.isValid()&&r.isValid()?(e=as(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function l5(t,e){var r=Ds(t)?t:gr(t);return this.isValid()&&r.isValid()?(e=as(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function u5(t,e,r,n){var i=Ds(t)?t:gr(t),s=Ds(e)?e:gr(e);return this.isValid()&&i.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function h5(t,e){var r=Ds(t)?t:gr(t),n;return this.isValid()&&r.isValid()?(e=as(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function c5(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function d5(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function f5(t,e,r){var n,i,s;if(!this.isValid())return NaN;if(n=DT(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=as(e),e){case"year":s=Uv(this,n)/12;break;case"month":s=Uv(this,n);break;case"quarter":s=Uv(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-i)/864e5;break;case"week":s=(this-n-i)/6048e5;break;default:s=this-n}return r?s:Qi(s)}function Uv(t,e){if(t.date()<e.date())return-Uv(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,s;return e-n<0?(i=t.clone().add(r-1,"months"),s=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),s=(e-n)/(i-n)),-(r+s)||0}Ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function g5(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function m5(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Vv(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ko(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Vv(r,"Z")):Vv(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function p5(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+n+i+s)}function v5(t){t||(t=this.isUtc()?Ee.defaultFormatUtc:Ee.defaultFormat);var e=Vv(this,t);return this.localeData().postformat(e)}function w5(t,e){return this.isValid()&&(Ds(t)&&t.isValid()||gr(t).isValid())?$s({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function y5(t){return this.from(gr(),t)}function C5(t,e){return this.isValid()&&(Ds(t)&&t.isValid()||gr(t).isValid())?$s({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function b5(t){return this.to(gr(),t)}function kW(t){var e;return t===void 0?this._locale._abbr:(e=Oa(t),e!=null&&(this._locale=e),this)}var DW=os("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function LW(){return this._locale}var cw=1e3,Fc=60*cw,dw=60*Fc,FW=(365*400+97)*24*dw;function Wc(t,e){return(t%e+e)%e}function WW(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-FW:new Date(t,e,r).valueOf()}function BW(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-FW:Date.UTC(t,e,r)}function S5(t){var e,r;if(t=as(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?BW:WW,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Wc(e+(this._isUTC?0:this.utcOffset()*Fc),dw);break;case"minute":e=this._d.valueOf(),e-=Wc(e,Fc);break;case"second":e=this._d.valueOf(),e-=Wc(e,cw);break}return this._d.setTime(e),Ee.updateOffset(this,!0),this}function R5(t){var e,r;if(t=as(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?BW:WW,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=dw-Wc(e+(this._isUTC?0:this.utcOffset()*Fc),dw)-1;break;case"minute":e=this._d.valueOf(),e+=Fc-Wc(e,Fc)-1;break;case"second":e=this._d.valueOf(),e+=cw-Wc(e,cw)-1;break}return this._d.setTime(e),Ee.updateOffset(this,!0),this}function E5(){return this._d.valueOf()-(this._offset||0)*6e4}function _5(){return Math.floor(this.valueOf()/1e3)}function T5(){return new Date(this.valueOf())}function x5(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function M5(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function I5(){return this.isValid()?this.toISOString():null}function O5(){return yT(this)}function P5(){return yl({},mt(this))}function A5(){return mt(this).overflow}function H5(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}rt("N",0,0,"eraAbbr");rt("NN",0,0,"eraAbbr");rt("NNN",0,0,"eraAbbr");rt("NNNN",0,0,"eraName");rt("NNNNN",0,0,"eraNarrow");rt("y",["y",1],"yo","eraYear");rt("y",["yy",2],0,"eraYear");rt("y",["yyy",3],0,"eraYear");rt("y",["yyyy",4],0,"eraYear");je("N",LT);je("NN",LT);je("NNN",LT);je("NNNN",U5);je("NNNNN",j5);tr(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?mt(r).era=i:mt(r).invalidEra=t});je("y",sd);je("yy",sd);je("yyy",sd);je("yyyy",sd);je("yo",Y5);tr(["y","yy","yyy","yyyy"],Wn);tr(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Wn]=r._locale.eraYearOrdinalParse(t,i):e[Wn]=parseInt(t,10)});function N5(t,e){var r,n,i,s=this._eras||Oa("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":i=Ee(s[r].since).startOf("day"),s[r].since=i.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":i=Ee(s[r].until).startOf("day").valueOf(),s[r].until=i.valueOf();break}}return s}function k5(t,e,r){var n,i,s=this.eras(),a,u,h;for(t=t.toUpperCase(),n=0,i=s.length;n<i;++n)if(a=s[n].name.toUpperCase(),u=s[n].abbr.toUpperCase(),h=s[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(u===t)return s[n];break;case"NNNN":if(a===t)return s[n];break;case"NNNNN":if(h===t)return s[n];break}else if([a,u,h].indexOf(t)>=0)return s[n]}function D5(t,e){var r=t.since<=t.until?1:-1;return e===void 0?Ee(t.since).year():Ee(t.since).year()+(e-t.offset)*r}function L5(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function F5(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function W5(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function B5(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-Ee(i[t].since).year())*r+i[t].offset;return this.year()}function $5(t){return Dt(this,"_erasNameRegex")||FT.call(this),t?this._erasNameRegex:this._erasRegex}function V5(t){return Dt(this,"_erasAbbrRegex")||FT.call(this),t?this._erasAbbrRegex:this._erasRegex}function z5(t){return Dt(this,"_erasNarrowRegex")||FT.call(this),t?this._erasNarrowRegex:this._erasRegex}function LT(t,e){return e.erasAbbrRegex(t)}function U5(t,e){return e.erasNameRegex(t)}function j5(t,e){return e.erasNarrowRegex(t)}function Y5(t,e){return e._eraYearOrdinalRegex||sd}function FT(){var t=[],e=[],r=[],n=[],i,s,a,u,h,c=this.eras();for(i=0,s=c.length;i<s;++i)a=Ra(c[i].name),u=Ra(c[i].abbr),h=Ra(c[i].narrow),e.push(a),t.push(u),r.push(h),n.push(a),n.push(u),n.push(h);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}rt(0,["gg",2],0,function(){return this.weekYear()%100});rt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function by(t,e){rt(0,[t,t.length],0,e)}by("gggg","weekYear");by("ggggg","weekYear");by("GGGG","isoWeekYear");by("GGGGG","isoWeekYear");je("G",py);je("g",py);je("GG",mr,Li);je("gg",mr,Li);je("GGGG",_T,ET);je("gggg",_T,ET);je("GGGGG",my,fy);je("ggggg",my,fy);rm(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=xt(t)});rm(["gg","GG"],function(t,e,r,n){e[n]=Ee.parseTwoDigitYear(t)});function G5(t){return $W.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function q5(t){return $W.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function K5(){return Ea(this.year(),1,4)}function X5(){return Ea(this.isoWeekYear(),1,4)}function Z5(){var t=this.localeData()._week;return Ea(this.year(),t.dow,t.doy)}function Q5(){var t=this.localeData()._week;return Ea(this.weekYear(),t.dow,t.doy)}function $W(t,e,r,n,i){var s;return t==null?xg(this,n,i).year:(s=Ea(t,n,i),e>s&&(e=s),J5.call(this,t,e,r,n,i))}function J5(t,e,r,n,i){var s=CW(t,e,r,n,i),a=Tg(s.year,0,s.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}rt("Q",0,"Qo","quarter");je("Q",uW);tr("Q",function(t,e){e[pa]=(xt(t)-1)*3});function eq(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}rt("D",["DD",2],"Do","date");je("D",mr,od);je("DD",mr,Li);je("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});tr(["D","DD"],_o);tr("Do",function(t,e){e[_o]=xt(t.match(mr)[0])});var VW=ad("Date",!0);rt("DDD",["DDDD",3],"DDDo","dayOfYear");je("DDD",gy);je("DDDD",hW);tr(["DDD","DDDD"],function(t,e,r){r._dayOfYear=xt(t)});function tq(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}rt("m",["mm",2],0,"minute");je("m",mr,TT);je("mm",mr,Li);tr(["m","mm"],As);var rq=ad("Minutes",!1);rt("s",["ss",2],0,"second");je("s",mr,TT);je("ss",mr,Li);tr(["s","ss"],va);var nq=ad("Seconds",!1);rt("S",0,0,function(){return~~(this.millisecond()/100)});rt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});rt(0,["SSS",3],0,"millisecond");rt(0,["SSSS",4],0,function(){return this.millisecond()*10});rt(0,["SSSSS",5],0,function(){return this.millisecond()*100});rt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});rt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});rt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});rt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});je("S",gy,uW);je("SS",gy,Li);je("SSS",gy,hW);var Cl,zW;for(Cl="SSSS";Cl.length<=9;Cl+="S")je(Cl,sd);function iq(t,e){e[Vu]=xt(("0."+t)*1e3)}for(Cl="S";Cl.length<=9;Cl+="S")tr(Cl,iq);zW=ad("Milliseconds",!1);rt("z",0,0,"zoneAbbr");rt("zz",0,0,"zoneName");function sq(){return this._isUTC?"UTC":""}function oq(){return this._isUTC?"Coordinated Universal Time":""}var Me=em.prototype;Me.add=Q3;Me.calendar=s5;Me.clone=o5;Me.diff=f5;Me.endOf=R5;Me.format=v5;Me.from=w5;Me.fromNow=y5;Me.to=C5;Me.toNow=b5;Me.get=pG;Me.invalidAt=A5;Me.isAfter=a5;Me.isBefore=l5;Me.isBetween=u5;Me.isSame=h5;Me.isSameOrAfter=c5;Me.isSameOrBefore=d5;Me.isValid=O5;Me.lang=DW;Me.locale=kW;Me.localeData=LW;Me.max=O3;Me.min=I3;Me.parsingFlags=P5;Me.set=vG;Me.startOf=S5;Me.subtract=J3;Me.toArray=x5;Me.toObject=M5;Me.toDate=T5;Me.toISOString=m5;Me.inspect=p5;typeof Symbol<"u"&&Symbol.for!=null&&(Me[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Me.toJSON=I5;Me.toString=g5;Me.unix=_5;Me.valueOf=E5;Me.creationData=H5;Me.eraName=L5;Me.eraNarrow=F5;Me.eraAbbr=W5;Me.eraYear=B5;Me.year=fW;Me.isLeapYear=mG;Me.weekYear=G5;Me.isoWeekYear=q5;Me.quarter=Me.quarters=eq;Me.month=wW;Me.daysInMonth=TG;Me.week=Me.weeks=NG;Me.isoWeek=Me.isoWeeks=kG;Me.weeksInYear=Z5;Me.weeksInWeekYear=Q5;Me.isoWeeksInYear=K5;Me.isoWeeksInISOWeekYear=X5;Me.date=VW;Me.day=Me.days=qG;Me.weekday=KG;Me.isoWeekday=XG;Me.dayOfYear=tq;Me.hour=Me.hours=n3;Me.minute=Me.minutes=rq;Me.second=Me.seconds=nq;Me.millisecond=Me.milliseconds=zW;Me.utcOffset=W3;Me.utc=$3;Me.local=V3;Me.parseZone=z3;Me.hasAlignedHourOffset=U3;Me.isDST=j3;Me.isLocal=G3;Me.isUtcOffset=q3;Me.isUtc=PW;Me.isUTC=PW;Me.zoneAbbr=sq;Me.zoneName=oq;Me.dates=os("dates accessor is deprecated. Use date instead.",VW);Me.months=os("months accessor is deprecated. Use month instead",wW);Me.years=os("years accessor is deprecated. Use year instead",fW);Me.zone=os("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",B3);Me.isDSTShifted=os("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Y3);function aq(t){return gr(t*1e3)}function lq(){return gr.apply(null,arguments).parseZone()}function UW(t){return t}var Lt=bT.prototype;Lt.calendar=GY;Lt.longDateFormat=ZY;Lt.invalidDate=JY;Lt.ordinal=rG;Lt.preparse=UW;Lt.postformat=UW;Lt.relativeTime=iG;Lt.pastFuture=sG;Lt.set=jY;Lt.eras=N5;Lt.erasParse=k5;Lt.erasConvertYear=D5;Lt.erasAbbrRegex=V5;Lt.erasNameRegex=$5;Lt.erasNarrowRegex=z5;Lt.months=SG;Lt.monthsShort=RG;Lt.monthsParse=_G;Lt.monthsRegex=MG;Lt.monthsShortRegex=xG;Lt.week=OG;Lt.firstDayOfYear=HG;Lt.firstDayOfWeek=AG;Lt.weekdays=zG;Lt.weekdaysMin=jG;Lt.weekdaysShort=UG;Lt.weekdaysParse=GG;Lt.weekdaysRegex=ZG;Lt.weekdaysShortRegex=QG;Lt.weekdaysMinRegex=JG;Lt.isPM=t3;Lt.meridiem=i3;function fw(t,e,r,n){var i=Oa(),s=No().set(n,e);return i[r](s,t)}function jW(t,e,r){if(_a(t)&&(e=t,t=void 0),t=t||"",e!=null)return fw(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=fw(t,n,r,"month");return i}function WT(t,e,r,n){typeof t=="boolean"?(_a(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,_a(e)&&(r=e,e=void 0),e=e||"");var i=Oa(),s=t?i._week.dow:0,a,u=[];if(r!=null)return fw(e,(r+s)%7,n,"day");for(a=0;a<7;a++)u[a]=fw(e,(a+s)%7,n,"day");return u}function uq(t,e){return jW(t,e,"months")}function hq(t,e){return jW(t,e,"monthsShort")}function cq(t,e,r){return WT(t,e,r,"weekdays")}function dq(t,e,r){return WT(t,e,r,"weekdaysShort")}function fq(t,e,r){return WT(t,e,r,"weekdaysMin")}_l("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=xt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});Ee.lang=os("moment.lang is deprecated. Use moment.locale instead.",_l);Ee.langData=os("moment.langData is deprecated. Use moment.localeData instead.",Oa);var jo=Math.abs;function gq(){var t=this._data;return this._milliseconds=jo(this._milliseconds),this._days=jo(this._days),this._months=jo(this._months),t.milliseconds=jo(t.milliseconds),t.seconds=jo(t.seconds),t.minutes=jo(t.minutes),t.hours=jo(t.hours),t.months=jo(t.months),t.years=jo(t.years),this}function YW(t,e,r,n){var i=$s(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function mq(t,e){return YW(this,t,e,1)}function pq(t,e){return YW(this,t,e,-1)}function wN(t){return t<0?Math.floor(t):Math.ceil(t)}function vq(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,s,a,u,h;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=wN(o_(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Qi(t/1e3),n.seconds=i%60,s=Qi(i/60),n.minutes=s%60,a=Qi(s/60),n.hours=a%24,e+=Qi(a/24),h=Qi(GW(e)),r+=h,e-=wN(o_(h)),u=Qi(r/12),r%=12,n.days=e,n.months=r,n.years=u,this}function GW(t){return t*4800/146097}function o_(t){return t*146097/4800}function wq(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=as(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+GW(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(o_(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Pa(t){return function(){return this.as(t)}}var qW=Pa("ms"),yq=Pa("s"),Cq=Pa("m"),bq=Pa("h"),Sq=Pa("d"),Rq=Pa("w"),Eq=Pa("M"),_q=Pa("Q"),Tq=Pa("y"),xq=qW;function Mq(){return $s(this)}function Iq(t){return t=as(t),this.isValid()?this[t+"s"]():NaN}function hh(t){return function(){return this.isValid()?this._data[t]:NaN}}var Oq=hh("milliseconds"),Pq=hh("seconds"),Aq=hh("minutes"),Hq=hh("hours"),Nq=hh("days"),kq=hh("months"),Dq=hh("years");function Lq(){return Qi(this.days()/7)}var ua=Math.round,Pc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Fq(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function Wq(t,e,r,n){var i=$s(t).abs(),s=ua(i.as("s")),a=ua(i.as("m")),u=ua(i.as("h")),h=ua(i.as("d")),c=ua(i.as("M")),m=ua(i.as("w")),p=ua(i.as("y")),v=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||a<=1&&["m"]||a<r.m&&["mm",a]||u<=1&&["h"]||u<r.h&&["hh",u]||h<=1&&["d"]||h<r.d&&["dd",h];return r.w!=null&&(v=v||m<=1&&["w"]||m<r.w&&["ww",m]),v=v||c<=1&&["M"]||c<r.M&&["MM",c]||p<=1&&["y"]||["yy",p],v[2]=e,v[3]=+t>0,v[4]=n,Fq.apply(null,v)}function Bq(t){return t===void 0?ua:typeof t=="function"?(ua=t,!0):!1}function $q(t,e){return Pc[t]===void 0?!1:e===void 0?Pc[t]:(Pc[t]=e,t==="s"&&(Pc.ss=e-1),!0)}function Vq(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Pc,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Pc,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),s=Wq(this,!r,n,i),r&&(s=i.pastFuture(+this,s)),i.postformat(s)}var N0=Math.abs;function Bh(t){return(t>0)-(t<0)||+t}function Sy(){if(!this.isValid())return this.localeData().invalidDate();var t=N0(this._milliseconds)/1e3,e=N0(this._days),r=N0(this._months),n,i,s,a,u=this.asSeconds(),h,c,m,p;return u?(n=Qi(t/60),i=Qi(n/60),t%=60,n%=60,s=Qi(r/12),r%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",h=u<0?"-":"",c=Bh(this._months)!==Bh(u)?"-":"",m=Bh(this._days)!==Bh(u)?"-":"",p=Bh(this._milliseconds)!==Bh(u)?"-":"",h+"P"+(s?c+s+"Y":"")+(r?c+r+"M":"")+(e?m+e+"D":"")+(i||n||t?"T":"")+(i?p+i+"H":"")+(n?p+n+"M":"")+(t?p+a+"S":"")):"P0D"}var At=Cy.prototype;At.isValid=k3;At.abs=gq;At.add=mq;At.subtract=pq;At.as=wq;At.asMilliseconds=qW;At.asSeconds=yq;At.asMinutes=Cq;At.asHours=bq;At.asDays=Sq;At.asWeeks=Rq;At.asMonths=Eq;At.asQuarters=_q;At.asYears=Tq;At.valueOf=xq;At._bubble=vq;At.clone=Mq;At.get=Iq;At.milliseconds=Oq;At.seconds=Pq;At.minutes=Aq;At.hours=Hq;At.days=Nq;At.weeks=Lq;At.months=kq;At.years=Dq;At.humanize=Vq;At.toISOString=Sy;At.toString=Sy;At.toJSON=Sy;At.locale=kW;At.localeData=LW;At.toIsoString=os("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Sy);At.lang=DW;rt("X",0,0,"unix");rt("x",0,0,"valueOf");je("x",py);je("X",uG);tr("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});tr("x",function(t,e,r){r._d=new Date(xt(t))});//! moment.js
Ee.version="2.30.1";zY(gr);Ee.fn=Me;Ee.min=P3;Ee.max=A3;Ee.now=H3;Ee.utc=No;Ee.unix=aq;Ee.months=uq;Ee.isDate=Jg;Ee.locale=_l;Ee.invalid=dy;Ee.duration=$s;Ee.isMoment=Ds;Ee.weekdays=cq;Ee.parseZone=lq;Ee.localeData=Oa;Ee.isDuration=zv;Ee.monthsShort=hq;Ee.weekdaysMin=fq;Ee.defineLocale=PT;Ee.updateLocale=l3;Ee.locales=u3;Ee.weekdaysShort=dq;Ee.normalizeUnits=as;Ee.relativeTimeRounding=Bq;Ee.relativeTimeThreshold=$q;Ee.calendarFormat=i5;Ee.prototype=Me;Ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function KW(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function a_(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function ig(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function Gr(t,e,r,n){let i=-1,s=t,a=r;Array.isArray(t)||(s=Array.from(t));const u=s.length;for(n&&u&&(i+=1,a=s[i]),i+=1;i<u;)a=e(a,s[i],i,s),i+=1;return a}function Ta(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let a=-1;for(;r<i;){const u=n[r];e(u,r,n)&&(a+=1,s[a]=u),r+=1}return s}function St(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let a=-1;for(;r<i;){const u=n[r];a+=1,s[a]=e(u,r,n),r+=1}return s}function te(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function XW(t){return Gr(t,(e,r)=>e+r,0)}function zq(t){return Gr(t,(e,r)=>e>r?e:r,Array.isArray(t)?t[0]:void 0)}function Uq(t){return Gr(t,(e,r)=>e<r?e:r,Array.isArray(t)?t[0]:void 0)}function jq(t){return t.length?XW(t)/t.length:0}function ZW(t){return Gr(t,(e,r)=>e.concat(Array.isArray(r)?ZW(r):r),[])}function BT(t){const e=[];return te(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function l_(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return te(i,a=>{s=s.filter(u=>!a.includes(u))}),s}function Yq(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return te(i,a=>{s=s.filter(u=>a.includes(u))}),s}function Gq(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e],s=new Set(n);return te(i,a=>{te(a,u=>{s.has(u)||s.add(u)})}),Array.from(s)}function u_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const qq=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:jq,arrayEach:te,arrayFilter:Ta,arrayFlatten:ZW,arrayMap:St,arrayMax:zq,arrayMin:Uq,arrayReduce:Gr,arraySum:XW,arrayUnique:BT,extendArray:a_,getDifferenceOfArrays:l_,getIntersectionOfArrays:Yq,getUnionOfArrays:Gq,pivot:ig,stringToArray:u_,to2dArray:KW},Symbol.toStringTag,{value:"Module"}));function Gt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Gr(t,(s,a,u)=>{const h=a.replace(/\r?\n\s*/g,""),c=r[u]?r[u]:"";return s+h+c},"").trim()}function Mr(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Ue(t){return typeof t<"u"}function fr(t){return typeof t>"u"}function Ir(t){return t===null||t===""||fr(t)}function QW(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Kf="length",sg=t=>parseInt(t,16),yN=t=>parseInt(t,10),gw=(t,e,r)=>t.substr(e,r),og=t=>t.codePointAt(0)-65,h_=t=>`${t}`.replace(/\-/g,""),Kq=t=>sg(gw(h_(t),sg("12"),og("F")))/(sg(gw(h_(t),og("B"),~~![][Kf]))||9),Xq=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let CN=!1;const bN={invalid:()=>Gt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Gt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Gt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},SN={invalid:()=>Gt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Gt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Gt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function JW(t,e){const r=!Ir(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.0.0";let s,a="invalid",u="invalid";t=h_(t||"");const h=Zq(t);if(r||n||h)if(h){const c=Ee("16/12/2024","DD/MM/YYYY"),m=Math.floor(c.toDate().getTime()/864e5),p=Kq(t);s=Ee((p+1)*864e5,"x").format("MMMM DD, YYYY"),m>p?(a="expired",u="expired"):(a="valid",u="valid")}else n?(a="non_commercial",u="valid"):(a="invalid",u="invalid");else a="missing",u="missing";if(Xq()&&(a="valid",u="valid"),!CN&&a!=="valid"&&(bN[a]({keyValidityDate:s,hotVersion:i})&&console[a==="non_commercial"?"info":"warn"](bN[a]({keyValidityDate:s,hotVersion:i})),CN=!0),u!=="valid"&&e.parentNode&&SN[u]({keyValidityDate:s,hotVersion:i})){const m=document.createElement("div");m.className="handsontable hot-display-license-info",m.innerHTML=SN[u]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(m,e.nextSibling)}}function Zq(t){let e=[][Kf],r=e;if(t[Kf]!==og("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=og(i.shift());s;s=og(i.shift()||"A"))--s<""[Kf]?r=r|(yN(`${yN(sg(n)+(sg(gw(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=gw(t,s,s?i[Kf]===1?9:8:6);return r===e}const Qq=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:JW,isDefined:Ue,isEmpty:Ir,isRegExp:QW,isUndefined:fr,stringify:Mr},Symbol.toStringTag,{value:"Module"}));function Bn(t){return t[0].toUpperCase()+t.substr(1)}function Jq(){const t=[];for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];let i=r.length;for(;i;){i-=1;const s=Mr(r[i]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function $T(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function VT(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function zT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function c_(t){return Ry(`${t}`,{ALLOWED_TAGS:[]})}function Ry(t,e){return VY.sanitize(t,e)}const eK=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Jq,isPercentValue:VT,randomString:$T,sanitize:Ry,stripTags:c_,substitute:zT,toUpperCaseFirst:Bn},Symbol.toStringTag,{value:"Module"})),ld=t=>["tabindex",t],tK=()=>["role","treegrid"],Io=()=>["role","presentation"],rK=()=>["role","gridcell"],nK=()=>["role","rowheader"],eB=()=>["role","rowgroup"],iK=()=>["role","columnheader"],d_=()=>["role","row"],sK=()=>["role","menu"],oK=()=>["role","menuitem"],aK=()=>["role","menuitemcheckbox"],lK=()=>["role","combobox"],tB=()=>["role","listbox"],uK=()=>["role","option"],hK=()=>["role","checkbox"],cK=()=>["scope","col"],dK=()=>["scope","row"],fK=()=>["type","text"],mw=t=>["aria-label",t],Ll=()=>["aria-hidden","true"],gK=()=>["aria-disabled","true"],mK=()=>["aria-multiselectable","true"],rB=t=>["aria-haspopup",t],nB=t=>["aria-rowcount",t],Ey=t=>["aria-colcount",t],iB=t=>["aria-rowindex",t],UT=t=>["aria-colindex",t],ts=t=>["aria-expanded",t],pK=t=>["aria-sort",t],RN=()=>["aria-readonly","true"],EN=()=>["aria-invalid","true"],sB=t=>["aria-checked",t],jT=()=>["aria-selected","true"],vK=()=>["aria-autocomplete","list"],wK=t=>["aria-controls",t],yK=t=>["aria-activedescendant",t],CK=t=>["aria-live",t],bK=t=>["aria-relevant",t],SK=t=>["aria-setsize",t],RK=t=>["aria-posinset",t];function oB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function aB(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function lB(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Xu(t){return lB(t)&&t.parent}function EK(t){return!!Object.getPrototypeOf(t.parent)}function Ol(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:a,nodeName:u}=s;if(a===n&&(e.includes(u)||e.includes(s)))return s;const{host:h}=s;h&&a===i?s=h:s=s.parentNode}return null}function Xf(t,e,r){const n=[];let i=t;for(;i&&(i=Ol(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function uB(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(s=>e.test(s));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function Tl(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function hB(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function al(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function cB(t){return!t||!t.length?[]:t.filter(e=>!!e)}function dB(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&r.push(i),!s})),{regexFree:n,regexes:r}}function nt(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Re(t,e){typeof e=="string"&&(e=e.split(" ")),e=cB(e),e.length>0&&t.classList.add(...e)}function tt(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=dB(e,!0);r=cB(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function it(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function ch(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=dB(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function YT(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)YT(e[r])}}function Ls(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const fB=/(<(.*)>|&(.*);)/;function dh(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;fB.test(e)?t.innerHTML=r?Ry(e):e:Pl(t,e)}function Pl(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Ls(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Zu(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Zu(n.host.impl);if(n.host)return Zu(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function un(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,a,u;for(s=i.offsetLeft,a=i.offsetTop,u=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,a+=i.offsetTop,u=i;return u&&u.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:s,top:a}}function GT(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function _y(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Ty(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?GT(e):t.scrollTop}function qT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?_y(e):t.scrollLeft}function Ig(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:a,overflowY:u}=i.style;if([s,a,u].includes("scroll"))return i;if({overflow:s,overflowX:a,overflowY:u}=r.getComputedStyle(i),n.includes(s)||n.includes(a)||n.includes(u)||i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(a)||n.includes(s)))return i;i=i.parentNode}return r}function gB(t){return t.scrollHeight-t.clientHeight}function mB(t){return t.scrollWidth-t.clientWidth}function Qu(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),s=["scroll","hidden","auto"],a=i.getPropertyValue("overflow"),u=i.getPropertyValue("overflow-y"),h=i.getPropertyValue("overflow-x");if(s.includes(a)||s.includes(u)||s.includes(h))return n;n=n.parentNode}return r}function Og(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function _K(t,e){const{selectorText:r}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&r&&(t.msMatchesSelector?n=t.msMatchesSelector(r):t.matches&&(n=t.matches(r))),n}function Fr(t){return t.offsetWidth}function Or(t){return t.offsetHeight}function Bc(t){return t.clientHeight||t.innerHeight}function KT(t){return t.clientWidth||t.innerWidth}function TK(t,e,r){t.addEventListener(e,r,!1)}function xK(t,e,r){t.removeEventListener(e,r,!1)}function XT(t){return t.selectionStart?t.selectionStart:0}function pB(t){return t.selectionEnd?t.selectionEnd:0}function MK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function f_(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function nm(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let k0;function IK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function bn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return k0===void 0&&(k0=IK(t)),k0}function vB(t){return t.offsetWidth!==t.clientWidth}function wB(t){return t.offsetHeight!==t.clientHeight}function xy(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function OK(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function im(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function ag(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function My(t){return ag(t)&&t.hasAttribute("data-hot-input")===!1}function PK(t){const e=t.ownerDocument.activeElement;My(e)||t.select()}function ZT(t){return!t.parentNode}function yB(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function QT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),s=n.defaultView.getSelection();it(t,"contenteditable",!0),r&&it(t,...Ll()),e&&Re(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function JT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&tt(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function CB(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;QT(t,r),e(),JT(t,r)}const AK=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:fB,addClass:Re,addEvent:TK,clearTextSelection:f_,closest:Ol,closestDown:Xf,empty:Ls,fastInnerHTML:dh,fastInnerText:Pl,findFirstParentWithClass:uB,getCaretPosition:XT,getCssTransform:OK,getFrameElement:lB,getMaximumScrollLeft:mB,getMaximumScrollTop:gB,getParent:oB,getParentWindow:Xu,getScrollLeft:qT,getScrollTop:Ty,getScrollableElement:Ig,getScrollbarWidth:bn,getSelectionEndPosition:pB,getSelectionText:MK,getStyle:Og,getTrimmingContainer:Qu,getWindowScrollLeft:_y,getWindowScrollTop:GT,hasAccessToParentWindow:EK,hasClass:nt,hasHorizontalScrollbar:wB,hasVerticalScrollbar:vB,index:hB,innerHeight:Bc,innerWidth:KT,isChildOf:Tl,isDetached:ZT,isInput:ag,isOutsideInput:My,isThisHotChild:aB,isVisible:Zu,makeElementContentEditableAndSelectItsContent:QT,matchesCSSRules:_K,observeVisibilityChangeOnce:yB,offset:un,outerHeight:Or,outerWidth:Fr,overlayContainsElement:al,removeAttribute:ch,removeClass:tt,removeContentEditableFromElementAndDeselect:JT,removeEvent:xK,removeTextNodes:YT,resetCssTransform:im,runWithSelectedContendEditableElement:CB,selectElementIfAllowed:PK,setAttribute:it,setCaretPosition:nm,setOverlayPosition:xy},Symbol.toStringTag,{value:"Module"}));function nr(t){return typeof t=="function"}function bB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0;const n={lastCallThrottled:!0};let i=null;function s(){for(var a=arguments.length,u=new Array(a),h=0;h<a;h++)u[h]=arguments[h];const c=Date.now();let m=!1;n.lastCallThrottled=!0,r||(r=c,m=!0);const p=e-(c-r);return m?(n.lastCallThrottled=!1,t.apply(this,u)):(i&&clearTimeout(i),i=setTimeout(()=>{n.lastCallThrottled=!1,t.apply(this,u),r=0,i=void 0},p)),n}return s}function HK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const n=bB(t,e);let i=r;function s(){i=r}function a(){for(var u=arguments.length,h=new Array(u),c=0;c<u;c++)h[c]=arguments[c];return i?(i-=1,t.apply(this,h)):n.apply(this,h)}return a.clearHits=s,a}function Iy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,a)},e),n}return i}function NK(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=e;return function(){for(var a=arguments.length,u=new Array(a),h=0;h<a;h++)u[h]=arguments[h];return Gr(i,(c,m)=>m(c),n.apply(this,u))}}function e1(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return t.apply(this,r.concat(a))}}function SB(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];const h=n.concat(a);let c;return h.length>=e?c=t.apply(this,h):c=r(h),c}}return r([])}function kK(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];const h=n.concat(a.reverse());let c;return h.length>=e?c=t.apply(this,h):c=r(h),c}}return r([])}function pw(t,e,r,n,i,s,a,u){return Ue(u)?t.call(e,r,n,i,s,a,u):Ue(a)?t.call(e,r,n,i,s,a):Ue(s)?t.call(e,r,n,i,s):Ue(i)?t.call(e,r,n,i):Ue(n)?t.call(e,r,n):Ue(r)?t.call(e,r):t.call(e)}const DK=Object.freeze(Object.defineProperty({__proto__:null,curry:SB,curryRight:kK,debounce:Iy,fastCall:pw,isFunction:nr,partial:e1,pipe:NK,throttle:bB,throttleAfterHits:HK},Symbol.toStringTag,{value:"Module"}));var _N={},D0,TN;function LK(){if(TN)return D0;TN=1;var t=Yr(),e=BF(),r=Qr(),n=sh(),i=cy(),s=t([].push);return D0=function(a){if(r(a))return a;if(e(a)){for(var u=a.length,h=[],c=0;c<u;c++){var m=a[c];typeof m=="string"?s(h,m):(typeof m=="number"||n(m)==="Number"||n(m)==="String")&&s(h,i(m))}var p=h.length,v=!0;return function(y,C){if(v)return v=!1,C;if(e(this))return C;for(var R=0;R<p;R++)if(h[R]===y)return C}}},D0}var xN;function FK(){if(xN)return _N;xN=1;var t=sr(),e=Jc(),r=hy(),n=Vn(),i=Yr(),s=xn(),a=Qr(),u=sT(),h=vT(),c=LK(),m=iT(),p=String,v=e("JSON","stringify"),y=i(/./.exec),C=i("".charAt),R=i("".charCodeAt),_=i("".replace),x=i(1 .toString),I=/[\uD800-\uDFFF]/g,k=/^[\uD800-\uDBFF]$/,W=/^[\uDC00-\uDFFF]$/,B=!m||s(function(){var se=e("Symbol")("stringify detection");return v([se])!=="[null]"||v({a:se})!=="{}"||v(Object(se))!=="{}"}),z=s(function(){return v("\uDF06\uD834")!=='"\\udf06\\ud834"'||v("\uDEAD")!=='"\\udead"'}),U=function(se,ne){var fe=h(arguments),j=c(ne);if(!(!a(j)&&(se===void 0||u(se))))return fe[1]=function(ae,P){if(a(j)&&(P=n(j,this,p(ae),P)),!u(P))return P},r(v,null,fe)},J=function(se,ne,fe){var j=C(fe,ne-1),ae=C(fe,ne+1);return y(k,se)&&!y(W,ae)||y(W,se)&&!y(k,j)?"\\u"+x(R(se,0),16):se};return v&&t({target:"JSON",stat:!0,arity:3,forced:B||z},{stringify:function(ne,fe,j){var ae=h(arguments),P=r(B?U:v,null,ae);return z&&typeof P=="string"?_(P,I,J):P}}),_N}FK();function Gc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},wt(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Gc(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Gc(r[0])]:e[n]=[]:e[n]=null)})),e}function Vs(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function jr(t,e,r){const n=Array.isArray(r);return wt(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function sm(t,e){wt(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),sm(t[n],e[n])):t[n]=e[n]})}function $n(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Fs(t){const e={};return wt(t,(r,n)=>{e[n]=r}),e}function qt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return te(r,i=>{t.MIXINS.push(i.MIXIN_NAME),wt(i,(s,a)=>{if(t.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[a]=s;else{const u=function(m,p){const v=`_${m}`,y=C=>{let R=C;return(Array.isArray(R)||vt(R))&&(R=$n(R)),R};return function(){return this[v]===void 0&&(this[v]=y(p)),this[v]}},h=function(m){const p=`_${m}`;return function(v){this[p]=v}};Object.defineProperty(t.prototype,a,{get:u(a,s),set:h(a),configurable:!0})}})}),t}function Oy(t,e){return JSON.stringify(t)===JSON.stringify(e)}function vt(t){return Object.prototype.toString.call(t)==="[object Object]"}function Do(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function wt(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function RB(t,e){const r=e.split(".");let n=t;return wt(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function jv(t,e,r){const n=e.split(".");let i=t;n.forEach((s,a)=>{a!==n.length-1?(Ur(i,s)||(i[s]={}),i=i[s]):i[s]=r})}function Py(t){if(!vt(t))return 0;const e=function(r){let n=0;return vt(r)?wt(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function bi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Ur(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const WK=Object.freeze(Object.defineProperty({__proto__:null,clone:Fs,createObjectPropListener:bi,deepClone:$n,deepExtend:sm,deepObjectSize:Py,defineGetter:Do,duckSchema:Gc,extend:jr,getProperty:RB,hasOwnProperty:Ur,inherit:Vs,isObject:vt,isObjectEqual:Oy,mixin:qt,objectEach:wt,setProperty:jv},Symbol.toStringTag,{value:"Module"}));function Pg(t){return window.requestAnimationFrame(t)}function Ag(t){window.cancelAnimationFrame(t)}function t1(){return"ontouchstart"in window}function EB(){return typeof window<"u"}let $h;function _B(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return $h||(typeof Intl=="object"?$h=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?$h=(r,n)=>`${r}`.localeCompare(n):$h=(r,n)=>r===n?0:r>n?-1:1,$h)}const BK=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Ag,getComparisonFunction:_B,isCSR:EB,isTouchSupported:t1,requestAnimationFrame:Pg},Symbol.toStringTag,{value:"Module"})),qi=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Aa={chrome:qi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:qi(t=>/CriOS/.test(t)),edge:qi(t=>/Edge/.test(t)),edgeWebKit:qi(t=>/EdgiOS/.test(t)),firefox:qi(t=>/Firefox/.test(t)),firefoxWebKit:qi(t=>/FxiOS/.test(t)),mobile:qi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:qi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ud={mac:qi(t=>/^Mac/.test(t)),win:qi(t=>/^Win/.test(t)),linux:qi(t=>/^Linux/.test(t)),ios:qi(t=>/iPhone|iPad|iPod/i.test(t))};function TB(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wt(Aa,r=>{let{test:n}=r;return void n(t,e)})}function xB(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wt(ud,e=>{let{test:r}=e;return void r(t)})}EB()&&(TB(),xB());function r1(){return Aa.chrome.value}function MB(){return Aa.chromeWebKit.value}function Yv(){return Aa.firefox.value}function IB(){return Aa.firefoxWebKit.value}function n1(){return Aa.safari.value}function OB(){return Aa.edge.value}function $K(){return Aa.edgeWebKit.value}function wa(){return Aa.mobile.value}function i1(){return ud.ios.value}function s1(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ud.mac.value}function g_(){return ud.win.value}function vw(){return ud.mac.value}function VK(){return ud.linux.value}const zK=Object.freeze(Object.defineProperty({__proto__:null,isChrome:r1,isChromeWebKit:MB,isEdge:OB,isEdgeWebKit:$K,isFirefox:Yv,isFirefoxWebKit:IB,isIOS:i1,isIpadOS:s1,isLinuxOS:VK,isMacOS:vw,isMobileBrowser:wa,isSafari:n1,isWindowsOS:g_,setBrowserMeta:TB,setPlatformMeta:xB},Symbol.toStringTag,{value:"Module"})),Ke={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Yv()?182:174,AUDIO_MUTE:Yv()?181:173,AUDIO_UP:Yv()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},UK=[Ke.ALT,Ke.ARROW_DOWN,Ke.ARROW_LEFT,Ke.ARROW_RIGHT,Ke.ARROW_UP,Ke.AUDIO_DOWN,Ke.AUDIO_MUTE,Ke.AUDIO_UP,Ke.BACKSPACE,Ke.CAPS_LOCK,Ke.DELETE,Ke.END,Ke.ENTER,Ke.ESCAPE,Ke.F1,Ke.F2,Ke.F3,Ke.F4,Ke.F5,Ke.F6,Ke.F7,Ke.F8,Ke.F9,Ke.F10,Ke.F11,Ke.F12,Ke.F13,Ke.F14,Ke.F15,Ke.F16,Ke.F17,Ke.F18,Ke.F19,Ke.HOME,Ke.INSERT,Ke.MEDIA_NEXT,Ke.MEDIA_PLAY_PAUSE,Ke.MEDIA_PREV,Ke.MEDIA_STOP,Ke.NULL,Ke.NUM_LOCK,Ke.PAGE_DOWN,Ke.PAGE_UP,Ke.PAUSE,Ke.SCROLL_LOCK,Ke.SHIFT,Ke.TAB];function PB(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function o1(t){return UK.includes(t)}function jK(t){const e=[];return vw()?e.push(Ke.COMMAND_LEFT,Ke.COMMAND_RIGHT,Ke.COMMAND_FIREFOX):e.push(Ke.CONTROL),e.includes(t)}function AB(t){return[Ke.CONTROL,Ke.COMMAND_LEFT,Ke.COMMAND_RIGHT,Ke.COMMAND_FIREFOX].includes(t)}function hd(t,e){const r=e.split("|");let n=!1;return te(r,i=>{if(t===Ke[i])return n=!0,!1}),n}const YK=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Ke,isCtrlKey:jK,isCtrlMetaKey:AB,isFunctionKey:o1,isKey:hd,isPrintableChar:PB},Symbol.toStringTag,{value:"Module"}));function ls(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ml(t){return t.isImmediatePropagationEnabled===!1}function Al(t){return t.button===2}function Ay(t){return t.button===0}function HB(t){return t instanceof TouchEvent}function NB(t,e){const r={x:t.offsetX,y:t.offsetY};let n=t.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return r;for(;n!==e;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}const GK=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ml,isLeftClick:Ay,isRightClick:Al,isTouchEvent:HB,offsetRelativeTo:NB,stopImmediatePropagation:ls},Symbol.toStringTag,{value:"Module"}));function Vt(){Ue(console)&&console.warn(...arguments)}function a1(){Ue(console)&&console.error(...arguments)}const Bu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],L0=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),F0=new Map([[]]);var MN={},W0,IN;function qK(){if(IN)return W0;IN=1;var t=rd();return W0=function(e,r,n){for(var i=0,s=arguments.length>2?n:t(r),a=new e(s);s>i;)a[i]=r[i++];return a},W0}var B0,ON;function KK(){if(ON)return B0;ON=1;var t=cn();return B0=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},B0}var $0,PN;function Hy(){if(PN)return $0;PN=1;var t=Bs(),e=gT(),r=Dl().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),$0=function(s){i[n][s]=!0},$0}var AN;function XK(){if(AN)return MN;AN=1;var t=sr(),e=Yr(),r=Si(),n=Gg(),i=qK(),s=KK(),a=Hy(),u=Array,h=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(m){m!==void 0&&r(m);var p=n(this),v=i(u,p);return h(v,m)}}),a("toSorted"),MN}XK();var HN={},NN={},kN;function ZK(){if(kN)return NN;kN=1;var t=sr(),e=id(),r=Si(),n=Jr(),i=Ho();return t({target:"Iterator",proto:!0,real:!0},{find:function(a){n(this),r(a);var u=i(this),h=0;return e(u,function(c,m){if(a(c,h++))return m(c)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),NN}var DN;function QK(){return DN||(DN=1,ZK()),HN}QK();function JK(t,e){kB(t,e),e.add(t)}function V0(t,e,r){kB(t,e),e.set(t,r)}function kB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LN(t,e,r){return t.set(ww(t,e),r),r}function Tn(t,e){return t.get(ww(t,e))}function ww(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const e6=100;var Ii=new WeakMap,Rc=new WeakMap,z0=new WeakMap,U0=new WeakSet;class FN{constructor(){JK(this,U0),V0(this,Ii,new Map),V0(this,Rc,new Map),V0(this,z0,new Set),Bu.forEach(e=>ww(U0,this,WN).call(this,e))}getHooks(e){var r;return(r=Tn(Ii,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Tn(Ii,this).has(e)||(ww(U0,this,WN).call(this,e),Bu.push(e));const i=Tn(Ii,this).get(e);if(i.find(c=>c.callback===r))return;const s=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,u=!!n.initialHook;let h=!1;if(u){const c=i.find(m=>m.initialHook);c&&(c.callback=r,h=!0)}if(!h){i.push({callback:r,orderIndex:s,runOnce:a,initialHook:u,skip:!1});let c=Tn(z0,this).has(e);!c&&s!==0&&(c=!0,Tn(z0,this).add(e)),c&&i.length>1&&Tn(Ii,this).set(e,i.toSorted((m,p)=>m.orderIndex-p.orderIndex))}}has(e){return Tn(Ii,this).has(e)&&Tn(Ii,this).get(e).length>0}remove(e,r){if(!Tn(Ii,this).has(e))return!1;const n=Tn(Ii,this).get(e),i=n.find(s=>s.callback===r);if(i){let s=Tn(Rc,this).get(e);return i.skip=!0,s+=1,s>e6&&(Tn(Ii,this).set(e,n.filter(a=>!a.skip)),s=0),Tn(Rc,this).set(e,s),!0}return!1}destroy(){Tn(Ii,this).clear(),Tn(Rc,this).clear(),LN(Ii,this,null),LN(Rc,this,null)}}function WN(t){Tn(Ii,this).set(t,[]),Tn(Rc,this).set(t,0)}function t6(t,e,r){return(e=r6(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r6(t){var e=n6(t,"string");return typeof e=="symbol"?e:e+""}function n6(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const i6=Gt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ze{constructor(){t6(this,"globalBucket",new FN)}static getSingleton(){return o6()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new FN),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?te(r,s=>this.add(e,s,n)):(L0.has(e)&&Vt(zT(i6,{hookName:e,removedInVersion:L0.get(e)})),F0.has(e)&&Vt(F0.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?te(r,s=>this.once(e,s,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?te(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,s,a,u,h){{const c=this.getBucket().getHooks(r),m=c?c.length:0;let p=0;if(m)for(;p<m;){if(!c[p]||c[p].skip){p+=1;continue}const v=pw(c[p].callback,e,n,i,s,a,u,h);v!==void 0&&(n=v),c[p]&&c[p].runOnce&&this.remove(r,c[p].callback),p+=1}}{const c=this.getBucket(e).getHooks(r),m=c?c.length:0;let p=0;if(m)for(;p<m;){if(!c[p]||c[p].skip){p+=1;continue}const v=pw(c[p].callback,e,n,i,s,a,u,h);v!==void 0&&(n=v),c[p]&&c[p].runOnce&&this.remove(r,c[p].callback,e),p+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Bu.push(e)}deregister(e){this.isRegistered(e)&&Bu.splice(Bu.indexOf(e),1)}isDeprecated(e){return F0.has(e)||L0.has(e)}isRegistered(e){return Bu.indexOf(e)>=0}getRegistered(){return Bu}}const s6=new ze;function o6(){return s6}const j0=new Map;function zs(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";j0.has(t)||j0.set(t,new Map);const e=j0.get(t);function r(u,h){e.set(u,h)}function n(u){return e.get(u)}function i(u){return e.has(u)}function s(){return[...e.keys()]}function a(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:a}}const m_=new WeakMap,{register:a6,getItem:DB,hasItem:LB,getNames:l6,getValues:Nge}=zs("editors");function u6(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},ze.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function FB(t,e){let r;if(typeof t=="function")m_.get(t)||mi(null,t),r=m_.get(t);else if(typeof t=="string")r=DB(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function yw(t){if(typeof t=="function")return t;if(!LB(t))throw Error(`No registered editor found under "${t}" name`);return DB(t).getConstructor()}function mi(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new u6(e);typeof t=="string"&&a6(t,r),m_.set(e,r)}function h6(t,e,r){return(e=c6(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c6(t){var e=d6(t,"string");return typeof e=="symbol"?e:e+""}function d6(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Gv=0;class ns{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;h6(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(a){n.call(this,f6(a))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),Gv+=1,()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,a;for(;s;)if(s-=1,a=this.context.eventListeners[s],a.event===r&&a.element===e){if(n&&n!==a.callback||i&&a.eventManager!==this)continue;this.context.eventListeners.splice(s,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options),Gv-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Gv-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let a;n.createEvent?(a=n.createEvent("MouseEvents"),a.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):a=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${r}`,a)}}function f6(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ls(this)},t}function g6(){return Gv}function m6(t,e){p6(t,e),e.add(t)}function p6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jl(t,e,r){return(e=v6(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v6(t){var e=w6(t,"string");return typeof e=="symbol"?e:e+""}function w6(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Y0=new WeakSet;class p_{constructor(e,r,n){m6(this,Y0),Jl(this,"hot",void 0),Jl(this,"tableMeta",void 0),Jl(this,"selection",void 0),Jl(this,"eventManager",void 0),Jl(this,"destroyed",!1),Jl(this,"activeEditor",void 0),Jl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new ns(e),this.hot.addHook("afterDocumentKeyDown",i=>BN(Y0,this,y6).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,s,a)=>BN(Y0,this,C6).call(this,i,s,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let a=n,u=i;if(Array.isArray(s)&&([a,u]=s),this.cellProperties=this.hot.getCellMeta(a,u),!this.isCellEditable()){this.clearActiveEditor();return}const h=this.hot.getCell(n,i,!0);if(h){const c=this.hot.getCellEditor(this.cellProperties),m=this.hot.colToProp(u),p=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),u);this.activeEditor=FB(c,this.hot),this.activeEditor.prepare(n,i,m,h,p,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:a}=this.hot,u=s.isHidden(this.hot.toPhysicalRow(n))||a.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function y6(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ml(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!o1(r)&&!AB(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function C6(t,e){e.isCell()&&this.openEditor(null,t,!0)}const $N=new WeakMap;p_.getInstance=function(t,e,r){let n=$N.get(t);return n||(n=new p_(t,e,r),$N.set(t,n)),n};function b6(t,e){WB(t,e),e.add(t)}function ef(t,e,r){WB(t,e),e.set(t,r)}function WB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wr(t,e){return t.get(ga(t,e))}function tf(t,e,r){return t.set(ga(t,e),r),r}function ga(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const $c=Object.freeze({CELL:"cell",MIXED:"mixed"});var yn=new WeakMap,up=new WeakMap,hp=new WeakMap,cp=new WeakMap,dp=new WeakMap,hl=new WeakSet;class S6{constructor(e){var r=this;b6(this,hl),ef(this,yn,void 0),ef(this,up,void 0),ef(this,hp,1),ef(this,cp,null),ef(this,dp,new Map);const n=e.getSettings();tf(yn,this,e),tf(up,this,n.imeFastEdit?$c.MIXED:$c.CELL),wr(yn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return ga(hl,r,E6).call(r,...s)}),wr(yn,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return ga(hl,r,VN).call(r,...s)}),wr(yn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return ga(hl,r,VN).call(r,...s)}),wr(yn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return ga(hl,r,R6).call(r,...s)})}getFocusMode(){return wr(up,this)}setFocusMode(e){Object.values($c).includes(e)?tf(up,this,e):Vt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return wr(hp,this)}setRefocusDelay(e){tf(hp,this,e)}setRefocusElementGetter(e){tf(cp,this,e)}getRefocusElement(){var e;return typeof wr(cp,this)=="function"?wr(cp,this).call(this):(e=wr(yn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,s;const a=(i=wr(yn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!a)return;let u=wr(yn,this).runHooks("modifyFocusedElement",a.row,a.col,n);u instanceof HTMLElement||(u=n),u&&!((s=wr(yn,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&u.focus({preventScroll:!0})};e?r(e):ga(hl,this,l1).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wr(hp,this);wr(yn,this).getSettings().imeFastEdit&&!((e=wr(yn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&(wr(dp,this).has(r)||wr(dp,this).set(r,Iy(()=>{var n;(n=this.getRefocusElement())===null||n===void 0||n.select()},r)),wr(dp,this).get(r)())}}function l1(t){var e;const r=(e=wr(yn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!wr(yn,this).selection.isCellVisible(r)){t(null);return}const n=wr(yn,this).getCell(r.row,r.col,!0);n===null?wr(yn,this).addHookOnce("afterScroll",()=>{t(wr(yn,this).getCell(r.row,r.col,!0))}):t(n)}function VN(){ga(hl,this,l1).call(this,t=>{const{activeElement:e}=wr(yn,this).rootDocument;e&&My(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function R6(){ga(hl,this,l1).call(this,t=>{this.getFocusMode()===$c.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function E6(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?$c.MIXED:$c.CELL)}var zN={},G0,UN;function _6(){if(UN)return G0;UN=1;var t=Ws(),e=sh(),r=Bs(),n=r("match");return G0=function(i){var s;return t(i)&&((s=i[n])!==void 0?!!s:e(i)==="RegExp")},G0}var q0,jN;function T6(){if(jN)return q0;jN=1;var t=Jr();return q0=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},q0}var K0,YN;function x6(){if(YN)return K0;YN=1;var t=Vn(),e=ss(),r=qg(),n=T6(),i=RegExp.prototype;return K0=function(s){var a=s.flags;return a===void 0&&!("flags"in i)&&!e(s,"flags")&&r(i,s)?t(n,s):a},K0}var X0,GN;function M6(){if(GN)return X0;GN=1;var t=Yr(),e=ed(),r=Math.floor,n=t("".charAt),i=t("".replace),s=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return X0=function(h,c,m,p,v,y){var C=m+h.length,R=p.length,_=u;return v!==void 0&&(v=e(v),_=a),i(y,_,function(x,I){var k;switch(n(I,0)){case"$":return"$";case"&":return h;case"`":return s(c,0,m);case"'":return s(c,C);case"<":k=v[s(I,1,-1)];break;default:var W=+I;if(W===0)return x;if(W>R){var B=r(W/10);return B===0?x:B<=R?p[B-1]===void 0?n(I,1):p[B-1]+n(I,1):x}k=p[W-1]}return k===void 0?"":k})},X0}var qN;function I6(){if(qN)return zN;qN=1;var t=sr(),e=Vn(),r=Yr(),n=Yg(),i=Qr(),s=ay(),a=_6(),u=cy(),h=Kg(),c=x6(),m=M6(),p=Bs(),v=kl(),y=p("replace"),C=TypeError,R=r("".indexOf),_=r("".replace),x=r("".slice),I=Math.max;return t({target:"String",proto:!0},{replaceAll:function(W,B){var z=n(this),U,J,se,ne,fe,j,ae,P,ie,Le,me=0,Ae="";if(!s(W)){if(U=a(W),U&&(J=u(n(c(W))),!~R(J,"g")))throw new C("`.replaceAll` does not allow non-global regexes");if(se=h(W,y),se)return e(se,W,z,B);if(v&&U)return _(u(z),W,B)}for(ne=u(z),fe=u(W),j=i(B),j||(B=u(B)),ae=fe.length,P=I(1,ae),ie=R(ne,fe);ie!==-1;)Le=j?u(B(fe,ie,ne)):m(fe,ne,ie,[],void 0,B),Ae+=x(ne,me,ie)+Le,me=ie+ae,ie=ie+P>ne.length?-1:R(ne,fe,ie+P);return me<ne.length&&(Ae+=x(ne,me)),Ae}}),zN}I6();var KN={},XN={},ZN;function O6(){if(ZN)return XN;ZN=1;var t=sr(),e=id(),r=Si(),n=Jr(),i=Ho(),s=TypeError;return t({target:"Iterator",proto:!0,real:!0},{reduce:function(u){n(this),r(u);var h=i(this),c=arguments.length<2,m=c?void 0:arguments[1],p=0;if(e(h,function(v){c?(c=!1,m=v):m=u(m,v,p),p++},{IS_RECORD:!0}),c)throw new s("Reduce of empty iterator with no initial value");return m}}),XN}var QN;function P6(){return QN||(QN=1,O6()),KN}P6();const BB={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},A6=new RegExp(Object.keys(BB).map(t=>`(${t})`).join("|"),"gi");function H6(t){return(t&&t.nodeName||"")==="TABLE"}function v_(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,a=s>0?i[0].length:0,u=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],m=r?1:0,p=e?1:0;for(let v=0;v<s;v+=1){const y=e&&v===0,C=[];for(let _=0;_<a;_+=1){const x=!y&&r&&_===0;let I="";if(y)I=`<th>${t.getColHeader(_-m)}</th>`;else if(x)I=`<th>${t.getRowHeader(v-p)}</th>`;else{const k=i[v][_],{hidden:W,rowspan:B,colspan:z}=t.getCellMeta(v-p,_-m);if(!W){const U=[];if(B&&U.push(`rowspan="${B}"`),z&&U.push(`colspan="${z}"`),Ir(k))I=`<td ${U.join(" ")}></td>`;else{const J=k.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");I=`<td ${U.join(" ")}>${J}</td>`}}}C.push(I)}const R=["<tr>",...C,"</tr>"].join("");y?h.splice(1,0,R):c.splice(-1,0,R)}return u.splice(1,0,h.join(""),c.join("")),u.join("")}function w_(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,a=[];n===0&&r.push("<tbody>");for(let u=0;u<s;u+=1){const h=i[u],c=Ir(h)?"":h.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,m=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(m.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${c}</td>`)}r.push("<tr>",...a,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function $B(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if(typeof s=="string"){const k=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,W=>{const B=W.match(/<td\b[^>]*?>/g)[0],z=/<p.*?>/g,U=W.substring(B.length,W.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(z,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${B}${U}</td>`});i.insertAdjacentHTML("afterbegin",`${k}`),s=i.querySelector("table")}if(!s||!H6(s))return;const a=i.querySelector('meta[name$="enerator"]'),u=s.querySelector("tbody th")!==null,h=s.querySelector("tr"),c=h?Array.from(h.cells).reduce((k,W)=>k+W.colSpan,0)-(u?1:0):0,m=s.tFoot&&Array.from(s.tFoot.rows)||[],p=[];let v=!1,y=0,C=0;if(s.tHead){const k=Array.from(s.tHead.rows).filter(W=>{const B=W.querySelector("td")!==null;return B&&p.push(W),!B});y=k.length,v=y>0,y>1?r.nestedHeaders=Array.from(k).reduce((W,B)=>{const z=Array.from(B.cells).reduce((U,J,se)=>{if(u&&se===0)return U;const{colSpan:ne,innerHTML:fe}=J,j=ne>1?{label:fe,colspan:ne}:fe;return U.push(j),U},[]);return W.push(z),W},[]):v&&(r.colHeaders=Array.from(k[0].children).reduce((W,B,z)=>(u&&z===0||W.push(B.innerHTML),W),[]))}p.length&&(r.fixedRowsTop=p.length),m.length&&(r.fixedRowsBottom=m.length);const R=[...p,...Array.from(s.tBodies).reduce((k,W)=>(k.push(...Array.from(W.rows)),k),[]),...m];C=R.length;const _=new Array(C);for(let k=0;k<C;k++)_[k]=new Array(c);const x=[],I=[];for(let k=0;k<C;k++){const W=R[k],B=Array.from(W.cells),z=B.length;for(let U=0;U<z;U++){const J=B[U],{nodeName:se,innerHTML:ne,rowSpan:fe,colSpan:j}=J,ae=_[k].findIndex(P=>P===void 0);if(se==="TD"){if(fe>1||j>1){for(let me=k;me<k+fe;me++)if(me<C)for(let Ae=ae;Ae<ae+j;Ae++)_[me][Ae]=null;const ie=J.getAttribute("style");ie&&ie.includes("mso-ignore:colspan")||x.push({col:ae,row:k,rowspan:fe,colspan:j})}let P="";a&&/excel/gi.test(a.content)?P=ne.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):P=ne.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),_[k][ae]=P.replace(A6,ie=>BB[ie])}else I.push(ne)}}return x.length&&(r.mergeCells=x),I.length&&(r.rowHeaders=I),_.length&&(r.data=_),r}const N6=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:w_,htmlToGridSettings:$B,instanceToHTML:v_},Symbol.toStringTag,{value:"Module"}));function Ln(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function VB(t){return Ln(t,[","])}function Xe(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function y_(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function u1(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function _t(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const k6=Object.freeze(Object.defineProperty({__proto__:null,clamp:_t,isNumeric:Ln,isNumericLike:VB,rangeEach:Xe,rangeEachReverse:y_,valueAccordingPercent:u1},Symbol.toStringTag,{value:"Module"})),C_="asc",D6="desc",JN=new Map([[C_,[-1,1]],[D6,[1,-1]]]),L6=t=>`The priority '${t}' is already declared in a map.`,F6=t=>`The priority '${t}' is not a number.`;function W6(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=nr(t)?t:L6,e=nr(e)?e:F6;function n(s,a){if(!Ln(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,a)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C_;const[a,u]=JN.get(s)||JN.get(C_);return[...r].sort((h,c)=>h[0]<c[0]?a:u).map(h=>h[1])}return{addItem:n,getItems:i}}const B6=t=>`The id '${t}' is already declared in a map.`;function Ny(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=nr(t)?t:B6;function r(c,m){if(h(c))throw new Error(t(c));e.set(c,m)}function n(c){return e.delete(c)}function i(){e.clear()}function s(c){const[m]=u().find(p=>{let[v,y]=p;return c===y?v:!1})||[null];return m}function a(c){return e.get(c)}function u(){return[...e]}function h(c){return e.has(c)}return{addItem:r,clear:i,getId:s,getItem:a,getItems:u,hasItem:h,removeItem:n}}const $6=t=>`'${t}' value is already declared in a unique set.`;function V6(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=nr(t)?t:$6;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const h1=t=>`There is already registered "${t}" plugin.`,z6=t=>`There is already registered plugin on priority "${t}".`,U6=t=>`The priority "${t}" is not a number.`,zB=W6({errorPriorityExists:z6,errorPriorityNaN:U6}),UB=V6({errorItemExists:h1}),b_=Ny({errorIdExists:h1});function c1(){return[...zB.getItems(),...UB.getItems()]}function om(t){const e=Bn(t);return b_.getItem(e)}function j6(t){return!!om(t)}function It(t,e,r){[t,e,r]=G6(t,e,r),om(t)===void 0&&Y6(t,e,r)}function Y6(t,e,r){const n=Bn(t);if(b_.hasItem(n))throw new Error(h1(n));r===void 0?UB.addItem(n):zB.addItem(r,n),b_.addItem(n,e)}function G6(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:q6,getItem:K6,hasItem:jB,getNames:X6,getValues:kge}=zs("renderers");function Cw(t){if(typeof t=="function")return t;if(!jB(t))throw Error(`No registered renderer found under "${t}" name`);return K6(t)}function Pi(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),q6(t,e)}const{register:Z6,getItem:Q6,hasItem:YB,getNames:J6,getValues:Dge}=zs("validators");function d1(t){if(typeof t=="function")return t;if(!YB(t))throw Error(`No registered validator found under "${t}" name`);return Q6(t)}function $u(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Z6(t,e)}var ek={},tk;function e8(){if(tk)return ek;tk=1;var t=sr(),e=ed(),r=rd(),n=Xg(),i=Hy();return t({target:"Array",proto:!0},{at:function(a){var u=e(this),h=r(u),c=n(a),m=c>=0?c:h+c;return m<0||m>=h?void 0:u[m]}}),i("at"),ek}e8();var rk={},nk;function t8(){if(nk)return rk;nk=1;var t=sr(),e=Yr(),r=Yg(),n=Xg(),i=cy(),s=xn(),a=e("".charAt),u=s(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:u},{at:function(c){var m=i(r(this)),p=m.length,v=n(c),y=v>=0?v:p+v;return y<0||y>=p?void 0:a(m,y)}}),rk}t8();function rf(t,e,r){return(e=r8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r8(t){var e=n8(t,"string");return typeof e=="symbol"?e:e+""}function n8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class i8{constructor(){rf(this,"count",0),rf(this,"startColumn",null),rf(this,"endColumn",null),rf(this,"startPosition",null),rf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:a}=r,u=i>0?s+1:s;n>=i&&n+a<=i+u&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:a,totalColumns:u,needReverse:h,startPositions:c,columnWidth:m}=e;if(this.endColumn===u-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const C=c[this.endColumn]+m-c[this.startColumn-1];if(C<=i&&(this.startColumn-=1),C>=i)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const p=a>0?i+1:i,v=n+i-p,y=this.startColumn===null?0:e.getColumnWidth(this.startColumn);v<-1*s||n>c.at(-1)||-1*n-i>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,u<this.endColumn&&(this.endColumn=u-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function nf(t,e,r){return(e=s8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s8(t){var e=o8(t,"string");return typeof e=="symbol"?e:e+""}function o8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a8{constructor(){nf(this,"count",0),nf(this,"startRow",null),nf(this,"endRow",null),nf(this,"startPosition",null),nf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:a}=r;n>=i&&n+a<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:a,needReverse:u,startPositions:h,rowHeight:c}=e;if(this.endRow===a-1&&u)for(this.startRow=this.endRow;this.startRow>0;){const v=h[this.endRow]+c-h[this.startRow-1];if(v<=i-s&&(this.startRow-=1),v>=i-s)break}this.startPosition=(r=h[this.startRow])!==null&&r!==void 0?r:null;const m=n+i-s,p=this.startRow===null?0:e.getRowHeight(this.startRow);m<p||n>h.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function sf(t,e,r){return(e=l8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l8(t){var e=u8(t,"string");return typeof e=="symbol"?e:e+""}function u8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GB{constructor(){sf(this,"count",0),sf(this,"startColumn",null),sf(this,"endColumn",null),sf(this,"startPosition",null),sf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);const a=i>0?s+1:s;n>=i&&n<=i+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:a,totalColumns:u,needReverse:h,startPositions:c,columnWidth:m}=e;if(this.endColumn===u-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=c[this.endColumn]+m-c[this.startColumn-1];if(this.startColumn-=1,y>i)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const p=a>0?i+1:i;n+i-p<-1*s||n>c.at(-1)+m||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,u<this.endColumn&&(this.endColumn=u-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function of(t,e,r){return(e=h8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h8(t){var e=c8(t,"string");return typeof e=="symbol"?e:e+""}function c8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qB{constructor(){of(this,"count",0),of(this,"startRow",null),of(this,"endRow",null),of(this,"startPosition",null),of(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:a,needReverse:u,startPositions:h,rowHeight:c}=e;if(this.endRow===a-1&&u)for(this.startRow=this.endRow;this.startRow>0;){const p=h[this.endRow]+c-h[this.startRow-1];if(this.startRow-=1,p>=i-s)break}this.startPosition=(r=h[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>h.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function af(t,e,r){return(e=d8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d8(t){var e=f8(t,"string");return typeof e=="symbol"?e:e+""}function f8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g8{constructor(){af(this,"count",0),af(this,"startColumn",0),af(this,"endColumn",0),af(this,"startPosition",0),af(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function lf(t,e,r){return(e=m8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m8(t){var e=p8(t,"string");return typeof e=="symbol"?e:e+""}function p8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v8{constructor(){lf(this,"count",0),lf(this,"startRow",0),lf(this,"endRow",0),lf(this,"startPosition",0),lf(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function ik(t,e,r){return(e=w8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w8(t){var e=y8(t,"string");return typeof e=="symbol"?e:e+""}function y8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C8 extends GB{constructor(){super(...arguments),ik(this,"columnStartOffset",0),ik(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof n=="function"){const a=this.startColumn,u=this.endColumn;n(this),this.columnStartOffset=a-this.startColumn,this.columnEndOffset=this.endColumn-u}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function sk(t,e,r){return(e=b8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b8(t){var e=S8(t,"string");return typeof e=="symbol"?e:e+""}function S8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R8 extends qB{constructor(){super(...arguments),sk(this,"rowStartOffset",0),sk(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof n=="function"){const a=this.startRow,u=this.endRow;n(this),this.rowStartOffset=a-this.startRow,this.rowEndOffset=this.endRow-u}this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ok(t,e,r){return(e=E8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E8(t){var e=_8(t,"string");return typeof e=="symbol"?e:e+""}function _8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KB{constructor(e){ok(this,"calculationTypes",[]),ok(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function gs(t,e,r){return(e=T8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T8(t){var e=x8(t,"string");return typeof e=="symbol"?e:e+""}function x8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qc=50;class M8 extends KB{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:a,overrideFn:u,inlineStartOffset:h}=e;super(r),gs(this,"viewportWidth",0),gs(this,"scrollOffset",0),gs(this,"zeroBasedScrollOffset",0),gs(this,"totalColumns",0),gs(this,"columnWidthFn",null),gs(this,"columnWidth",0),gs(this,"overrideFn",null),gs(this,"inlineStartOffset",0),gs(this,"totalCalculatedWidth",0),gs(this,"startPositions",[]),gs(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=a,this.overrideFn=u,this.inlineStartOffset=h,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?qc:r}}function Wi(t,e,r){return(e=I8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I8(t){var e=O8(t,"string");return typeof e=="symbol"?e:e+""}function O8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P8 extends KB{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,defaultRowHeight:a,rowHeightFn:u,overrideFn:h,horizontalScrollbarHeight:c}=e;super(r),Wi(this,"viewportHeight",0),Wi(this,"scrollOffset",0),Wi(this,"zeroBasedScrollOffset",0),Wi(this,"totalRows",0),Wi(this,"rowHeightFn",null),Wi(this,"rowHeight",0),Wi(this,"overrideFn",null),Wi(this,"horizontalScrollbarHeight",0),Wi(this,"innerViewportHeight",0),Wi(this,"totalCalculatedHeight",0),Wi(this,"startPositions",[]),Wi(this,"needReverse",!0),this.defaultHeight=a,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=u,this.overrideFn=h,this.horizontalScrollbarHeight=c??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function A8(t,e,r){H8(t,e),e.set(t,r)}function H8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ak(t,e,r){return(e=N8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N8(t){var e=k8(t,"string");return typeof e=="symbol"?e:e+""}function k8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vh(t,e){return t.get(XB(t,e))}function lk(t,e,r){return t.set(XB(t,e),r),r}function XB(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yo=new WeakMap;class Ju{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;ak(this,"row",null),ak(this,"col",null),A8(this,Yo,!1),lk(Yo,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Vh(Yo,this)}isSouthEastOf(e){return this.row>=e.row&&(Vh(Yo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Vh(Yo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Vh(Yo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Vh(Yo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Ju&&lk(Yo,this,e.isRtl()),this}clone(){return new Ju(this.row,this.col,Vh(Yo,this))}toObject(){return{row:this.row,col:this.col}}}function D8(t,e,r){L8(t,e),e.set(t,r)}function L8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z0(t,e,r){return(e=F8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F8(t){var e=W8(t,"string");return typeof e=="symbol"?e:e+""}function W8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bi(t,e){return t.get(ZB(t,e))}function B8(t,e,r){return t.set(ZB(t,e),r),r}function ZB(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var li=new WeakMap;class am{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Z0(this,"highlight",null),Z0(this,"from",null),Z0(this,"to",null),D8(this,li,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),B8(li,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),a=e.getOuterTopStartCorner(),u=e.getOuterBottomEndCorner(),h=Math.min(n.row,a.row),c=Math.min(n.col,a.col),m=Math.max(i.row,u.row),p=Math.max(i.col,u.col),v=this._createCellCoords(h,c),y=this._createCellCoords(m,p);return this.from=v,this.to=y,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Bi(li,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Bi(li,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Bi(li,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Bi(li,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Bi(li,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Bi(li,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Bi(li,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Bi(li,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Ju))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Bi(li,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Bi(li,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new am(this.highlight,this.from,this.to,Bi(li,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Ju(e,r,Bi(li,this))}}function Zs(t,e,r){$8(t,e),e.set(t,r)}function $8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(t,e){return t.get(QB(t,e))}function Ga(t,e,r){return t.set(QB(t,e),r),r}function QB(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $i=new WeakMap,Q0=new WeakMap,pn=new WeakMap,zh=new WeakMap,fp=new WeakMap,ms=new WeakMap,J0=new WeakMap,uf=new WeakMap,eu=new WeakMap,Qs=new WeakMap;let JB=class{constructor(e,r,n,i,s,a){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Zs(this,$i,void 0),Zs(this,Q0,void 0),Zs(this,pn,void 0),Zs(this,zh,void 0),Zs(this,fp,void 0),Zs(this,ms,void 0),Zs(this,J0,void 0),Zs(this,uf,void 0),Zs(this,eu,[null,null]),Zs(this,Qs,[null,null]),Ga($i,this,n),Ga(Q0,this,r),Ga(pn,this,s),Ga(zh,this,a),Ga(fp,this,u),Ga(ms,this,i),Ga(J0,this,e),this.registerEvents()}registerEvents(){Ze(ms,this).addEventListener(Ze(pn,this).holder,"contextmenu",n=>this.onContextMenu(n)),Ze(ms,this).addEventListener(Ze(pn,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Ze(ms,this).addEventListener(Ze(pn,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{Ze(ms,this).addEventListener(Ze(pn,this).holder,"touchstart",n=>this.onTouchStart(n)),Ze(ms,this).addEventListener(Ze(pn,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Ze(ms,this).addEventListener(Ze(pn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ze($i,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ze($i,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{Ze(ms,this).addEventListener(Ze(pn,this).holder,"mouseup",n=>this.onMouseUp(n)),Ze(ms,this).addEventListener(Ze(pn,this).holder,"mousedown",n=>this.onMouseDown(n))};wa()?e():(t1()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(Ze(uf,this)&&n){const[i,s]=[n.row,Ze(uf,this).from.row],[a,u]=[n.col,Ze(uf,this).from.col];return i===s&&a===u}return!1}parentCell(e){const r={},n=Ze(pn,this).TABLE,i=Xf(e,["TD","TH"],n);return i?(r.coords=Ze(pn,this).getCoords(i),r.TD=i):nt(e,"wtBorder")&&nt(e,"current")?(r.coords=Ze(zh,this).getFocusSelection().cellRange.highlight,r.TD=Ze(pn,this).getCell(r.coords)):nt(e,"wtBorder")&&nt(e,"area")&&Ze(zh,this).getAreaSelection().cellRange&&(r.coords=Ze(zh,this).getAreaSelection().cellRange.to,r.TD=Ze(pn,this).getCell(r.coords)),r}onMouseDown(e){const r=Ze(Q0,this).rootDocument.activeElement,n=e1(oB,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const s=this.parentCell(i);nt(i,"corner")?Ze($i,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Ze($i,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Ze(Qs,this)[0]=s.TD,clearTimeout(Ze(eu,this)[0]),Ze(eu,this)[0]=setTimeout(()=>{Ze(Qs,this)[0]=null},1e3))}onContextMenu(e){if(Ze($i,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!Ze($i,this).has("onCellMouseOver"))return;const r=Ze(pn,this).TABLE,n=Xf(e.target,["TD","TH"],r),i=Ze(fp,this)||this;n&&n!==i.lastMouseOver&&Tl(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,Ze(pn,this).getCoords(n),n))}onMouseOut(e){if(!Ze($i,this).has("onCellMouseOut"))return;const r=Ze(pn,this).TABLE,n=Xf(e.target,["TD","TH"],r),i=Xf(e.relatedTarget,["TD","TH"],r),s=Ze(fp,this)||this;n&&n!==i&&Tl(n,r)&&(this.callListener("onCellMouseOut",e,Ze(pn,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&Ze($i,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===Ze(Qs,this)[0]&&r.TD===Ze(Qs,this)[1]?(nt(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),Ze(Qs,this)[0]=null,Ze(Qs,this)[1]=null):r.TD===Ze(Qs,this)[0]&&(Ze(Qs,this)[1]=r.TD,clearTimeout(Ze(eu,this)[1]),Ze(eu,this)[1]=setTimeout(()=>{Ze(Qs,this)[1]=null},500)))}onTouchStart(e){Ga(uf,this,Ze(zh,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=Ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Ze($i,this).getSetting("isDataViewInstance")){const u=["A","BUTTON","INPUT"];i1()&&(MB()||IB())&&this.selectedCellWasTouched(n)&&!u.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=Ze($i,this).getSettingPure(e);s&&s(r,n,i,Ze(J0,this).call(this))}destroy(){clearTimeout(Ze(eu,this)[0]),clearTimeout(Ze(eu,this)[1]),Ze(ms,this).destroy()}};function eR(t,e,r){return(e=V8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V8(t){var e=z8(t,"string");return typeof e=="symbol"?e:e+""}function z8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U8{constructor(e,r,n){eR(this,"offset",void 0),eR(this,"total",void 0),eR(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function tR(t,e,r){return(e=j8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j8(t){var e=Y8(t,"string");return typeof e=="symbol"?e:e+""}function Y8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G8{constructor(e,r,n){tR(this,"offset",void 0),tR(this,"total",void 0),tR(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const q8=0,bw=1,Sw=2;function gp(t,e,r){return(e=K8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K8(t){var e=X8(t,"string");return typeof e=="symbol"?e:e+""}function X8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uk{constructor(){gp(this,"currentSize",0),gp(this,"nextSize",0),gp(this,"currentOffset",0),gp(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function rR(t,e,r){return(e=Z8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z8(t){var e=Q8(t,"string");return typeof e=="symbol"?e:e+""}function Q8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J8{constructor(){rR(this,"size",new uk),rR(this,"workingSpace",q8),rR(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof uk}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=bw,e.workingSpace=Sw,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Sw,e.workingSpace=bw,this.sharedSize=e.getViewSize()}}function Uh(t,e,r){return(e=e4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e4(t){var e=t4(t,"string");return typeof e=="symbol"?e:e+""}function t4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e${constructor(e,r,n){Uh(this,"rootNode",void 0),Uh(this,"nodesPool",void 0),Uh(this,"sizeSet",new J8),Uh(this,"childNodeType",void 0),Uh(this,"visualIndex",0),Uh(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=r,this.childNodeType=n.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:r}=this;let n=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)n+=1;else if(r.isPlaceOn(bw))break;i=i.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:r}=this,n=this.isSharedViewSet(),{nextSize:i}=r.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const u=this.nodesPool();!n||n&&r.isPlaceOn(Sw)?e.appendChild(u):e.insertBefore(u,e.firstChild),s+=1}const a=n&&r.isPlaceOn(bw);for(;s>i;)e.removeChild(a?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:r}=this;let n=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(Sw)&&(n+=r.sharedSize.nextSize);let i=e.childNodes[n];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class t$ extends e${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function r4(t,e,r){return(e=n4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n4(t){var e=i4(t,"string");return typeof e=="symbol"?e:e+""}function i4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s4{constructor(e){r4(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function hf(t,e,r){return(e=o4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o4(t){var e=a4(t,"string");return typeof e=="symbol"?e:e+""}function a4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lm{constructor(e,r){hf(this,"nodesPool",null),hf(this,"nodeType",void 0),hf(this,"rootNode",void 0),hf(this,"table",null),hf(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new s4(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function hk(t,e,r){return(e=l4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l4(t){var e=u4(t,"string");return typeof e=="symbol"?e:e+""}function u4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h4 extends lm{constructor(){super("TH"),hk(this,"orderViews",new WeakMap),hk(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new t$(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let a=0;a<e;a++){const u=this.table.renderedRowToSource(a),h=i.getRenderedNode(a);this.sourceRowIndex=u;const c=this.obtainOrderView(h),m=s.obtainOrderView(h);c.appendView(m).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let p=0;p<n;p++){c.render();const v=c.getCurrentNode();v.className="",v.removeAttribute("style"),ch(v,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&it(v,[nK(),dK(),UT(p+1),ld(-1)]),r[p](u,v,p)}c.end()}}}class c4 extends lm{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let u=0,h=e;u<h;u++){for(n=this.rootNode.childNodes[u],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let u=e;u<a;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Ls(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&it(this.rootNode,[eB()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,a=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&it(a,[d_(),iB(r+1)]);for(let u=-1*s;u<i;u+=1){const h=this.table.renderedColumnToSource(u),c=a.childNodes[u+s];c.className="",c.removeAttribute("style"),ch(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&it(c,[UT(u+1+this.table.rowHeadersCount),ld(-1),iK(),...u>=0?[cK()]:[d_()]]),n[r](h,c,r)}}}}let ck=!1;class d4 extends lm{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!ck&&e>1e3&&(ck=!0,Vt(Gt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),a=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${a}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),a=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+r].style.width=`${a}px`}const n=this.rootNode.firstChild;n&&Re(n,"rowHeader")}}function f4(t,e,r){return(e=g4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g4(t){var e=m4(t,"string");return typeof e=="symbol"?e:e+""}function m4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mp={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let dk=!1;class p4 extends lm{constructor(e){super("TR",e),f4(this,"orderView",void 0),this.orderView=new e$(e,r=>this.nodesPool.obtain(r),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!dk&&e>1e3&&(dk=!0,Vt(Gt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&it(this.rootNode,[eB()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;it(s,[d_(),iB(a+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}tt(s,[mp.rowEven,mp.rowOdd]),(a+1)%2===0?Re(s,mp.rowEven):Re(s,mp.rowOdd)}this.orderView.end()}}function fk(t,e,r){return(e=v4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v4(t){var e=w4(t,"string");return typeof e=="symbol"?e:e+""}function w4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y4 extends lm{constructor(){super("TD"),fk(this,"orderViews",new WeakMap),fk(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new t$(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let u=0;u<e;u++){const h=this.table.renderedRowToSource(u),c=n.getRenderedNode(u);this.sourceRowIndex=h;const m=this.obtainOrderView(c),p=i.obtainOrderView(c);m.prependView(p).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let v=0;v<r;v++){m.render();const y=m.getCurrentNode(),C=this.table.renderedColumnToSource(v);if(nt(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),ch(y,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(h,C,y),this.table.isAriaEnabled()){var s,a;it(y,[...y.hasAttribute("role")?[]:[rK()],ld(-1),UT(C+((s=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}m.end()}}}function Xr(t,e,r){return(e=C4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C4(t){var e=b4(t,"string");return typeof e=="symbol"?e:e+""}function b4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S4{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Xr(this,"rootNode",void 0),Xr(this,"rootDocument",void 0),Xr(this,"rowHeaders",null),Xr(this,"columnHeaders",null),Xr(this,"colGroup",null),Xr(this,"rows",null),Xr(this,"cells",null),Xr(this,"rowFilter",null),Xr(this,"columnFilter",null),Xr(this,"rowUtils",null),Xr(this,"columnUtils",null),Xr(this,"rowsToRender",0),Xr(this,"columnsToRender",0),Xr(this,"rowHeaderFunctions",[]),Xr(this,"rowHeadersCount",0),Xr(this,"columnHeaderFunctions",[]),Xr(this,"columnHeadersCount",0),Xr(this,"cellRenderer",void 0),Xr(this,"activeOverlayName",void 0),Xr(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),s=this.rowUtils;if(i.firstChild){const a=this.renderedRowToSource(n),u=s.getHeightByOverlayName(a,this.activeOverlayName),c=this.stylesHandler.areCellsBorderBox()?0:1;u?i.firstChild.style.height=`${u-c}px`:i.firstChild.style.height=""}}}}class R4{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:a,cellRenderer:u,stylesHandler:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new S4(e,{cellRenderer:u,stylesHandler:h}),this.renderer.setRenderers({rowHeaders:new h4,columnHeaders:new c4(r),colGroup:new d4(n),rows:new p4(i),cells:new y4}),this.renderer.setAxisUtils(s,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function nR(t,e,r){return(e=E4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E4(t){var e=_4(t,"string");return typeof e=="symbol"?e:e+""}function _4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T4{constructor(e,r){nR(this,"dataAccessObject",void 0),nR(this,"wtSettings",void 0),nR(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let a=Array.isArray(r)?r[s]:r;a=a??i,this.headerWidths.set(s,a)}}}}function gk(t,e,r){return(e=x4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x4(t){var e=M4(t,"string");return typeof e=="symbol"?e:e+""}function M4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I4{constructor(e,r){gk(this,"dataAccessObject",void 0),gk(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function Js(t,e,r){return(e=O4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O4(t){var e=P4(t,"string");return typeof e=="symbol"?e:e+""}function P4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cd{constructor(e,r,n,i,s){Js(this,"wtSettings",null),Js(this,"domBindings",void 0),Js(this,"TBODY",null),Js(this,"THEAD",null),Js(this,"COLGROUP",null),Js(this,"hasTableHeight",!0),Js(this,"hasTableWidth",!0),Js(this,"isTableVisible",!1),Js(this,"tableOffset",0),Js(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,YT(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new I4(this.dataAccessObject,this.wtSettings),this.columnUtils=new T4(this.dataAccessObject,this.wtSettings),this.tableRenderer=new R4({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!nt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&it(n,[Io()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!nt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&it(n,[Io()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!nt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&it(n.parentNode,[Io()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&it(n,[Io()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),a=r.getSetting("totalColumns"),u=r.getSetting("rowHeaders"),h=u.length,c=r.getSetting("columnHeaders"),m=c.length;let p=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=un(this.holder),p=i.createCalculators(p),h&&!r.getSetting("fixedColumnsStart"))){const y=n.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,C!==this.correctHeaderWidth&&(p=!1)}if(p)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=un(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const y=s>0?this.getFirstRenderedRow():0,C=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new G8(y,s,m),this.columnFilter=new U8(C,a,h);let R=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const _={};this.wtSettings.getSetting("beforeDraw",!0,_),R=_.skipRender!==!0}R&&(this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(To)||this.is(xl))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(To))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(To)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let v=!1;return this.isMaster&&(v=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(v=n.bottomOverlay.resetFixedPosition()||v),v=n.inlineStartOverlay.resetFixedPosition()||v,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),v?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(p),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let s,a,u;const h=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),a=this.getColumnHeader(r,n),a&&(u=Bc(a),(!s&&i<u||s<u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u),Array.isArray(h)?h[n]!==null&&h[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=h[n]):isNaN(h)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=h),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(h[n]||h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=h[n]||h))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,a=i.length;s<a;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(To))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const a=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,u=(i<0?this.THEAD:this.TBODY).childNodes[s];return u==null?void 0:u.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=s==null?void 0:s.childNodes[i];a&&r.push(a)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=Ol(r,["TD","TH"])),r===null)return null;const n=r.parentNode,i=n.parentNode;let s=hB(n),a=r.cellIndex;al(rh,r,this.wtRootElement)||al(eh,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):al(xl,r,this.wtRootElement)||al(To,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),al(rh,r,this.wtRootElement)||al(th,r,this.wtRootElement)||al(xl,r,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a);const u=this.wtSettings.getSetting("onModifyGetCoordsElement",s,a);return u&&Array.isArray(u)&&([s,a]=u),this.wot.createCellCoords(s,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=Bc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),s=i?Or:Bc,a=i?0:1,u=i?1:0;let h,c,m,p,v;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,m=this.rowFilter.renderedToSource(e),h=this.getRowHeight(m),p=this.getTrForRow(m),v=p.querySelector("th");const y=m===0?u:0;v?c=s(v):c=s(p)-a,(!h&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<c-y||h<c)&&(i||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[m]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Fr(this.TABLE)}getHeight(){return Or(this.TABLE)}getTotalWidth(){const e=Fr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Or(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Zu(this.TABLE)}_modifyRowHeaderWidth(e){let r=nr(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const A4="stickyRowsBottom",f1={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Do(f1,"MIXIN_NAME",A4,{writable:!1,enumerable:!1});const H4="stickyColumnsStart",ky={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Do(ky,"MIXIN_NAME",H4,{writable:!1,enumerable:!1});class g1 extends cd{constructor(e,r,n,i){super(e,r,n,i,xl)}}qt(g1,f1);qt(g1,ky);const eh="top",To="bottom",th="inline_start",rh="top_inline_start_corner",xl="bottom_inline_start_corner",r$=[eh,To,th,rh,xl],N4=new Map([[eh,`ht_clone_${eh}`],[To,`ht_clone_${To}`],[th,`ht_clone_${th} ht_clone_left`],[rh,`ht_clone_${rh} ht_clone_top_left_corner`],[xl,`ht_clone_${xl} ht_clone_bottom_left_corner`]]);function k4(t,e){D4(t,e),e.add(t)}function D4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L4(t,e,r){return(e=F4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F4(t){var e=W4(t,"string");return typeof e=="symbol"?e:e+""}function W4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cf=new WeakSet;class B4{constructor(e){k4(this,cf),L4(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),s=this.scrollViewportVertically(e.row,n);return i||s}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const s=bi(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedColumnsStart:a,inlineStartOverlay:u}=this.dataAccessObject,h=r==="auto";if(h&&e<a)return!1;const c=this.getFirstVisibleColumn(),m=this.getLastVisibleColumn();let p=!1;return(h&&(e<c||e>m)||!h)&&(p=u.scrollTo(e,h?e>=this.getLastPartiallyVisibleColumn():r==="end")),p}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const s=bi(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedRowsBottom:a,fixedRowsTop:u,topOverlay:h}=this.dataAccessObject,c=r==="auto";if(c&&(e<u||e>i-a-1))return!1;const m=this.getFirstVisibleRow(),p=this.getLastVisibleRow();let v=!1;return(c&&(e<m||e>p)||!c)&&(v=h.scrollTo(e,c?e>=this.getLastPartiallyVisibleRow():r==="bottom")),v}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return pp(cf,this,pk).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return pp(cf,this,pk).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return pp(cf,this,mk).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return pp(cf,this,mk).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function mk(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:a}=this.dataAccessObject;if(r.mainTableScrollableElement===a){const u=e.getSetting("rtlMode");let h=null;if(u){const m=n.TABLE.getBoundingClientRect(),v=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(m.right-v)}else h=un(n.wtRootElement).left;const c=Math.abs(qT(a,a));if(h>c){const m=KT(a);let p=i.getRowHeaderWidth();for(let v=1;v<=s;v++)if(p+=r.sumCellSizes(v-1,v),h+p-c>=m){t=v-2;break}}}return t}function pk(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const a=un(r.wtRootElement),u=Ty(s,s);if(a.top>u){const h=Bc(s);let c=n.getColumnHeaderHeight();for(let m=1;m<=i;m++)if(c+=e.sumCellSizes(m-1,m),a.top+c-u>=h){t=m-2;break}}}return t}function Vi(t,e,r){return(e=$4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $4(t){var e=V4(t,"string");return typeof e=="symbol"?e:e+""}function V4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m1{get eventManager(){return new ns(this)}constructor(e,r){Vi(this,"wtTable",void 0),Vi(this,"wtScroll",void 0),Vi(this,"wtViewport",void 0),Vi(this,"wtOverlays",void 0),Vi(this,"selectionManager",void 0),Vi(this,"wtEvent",void 0),Vi(this,"guid",`wt_${$T()}`),Vi(this,"drawInterrupted",!1),Vi(this,"drawn",!1),Vi(this,"activeOverlayName","master"),Vi(this,"domBindings",void 0),Vi(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new B4(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Pl(n,e[r])}])}}createCellCoords(e,r){return new Ju(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new am(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function vk(t,e,r){return(e=z4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z4(t){var e=U4(t,"string");return typeof e=="symbol"?e:e+""}function U4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j4 extends m1{constructor(e,r,n){super(e,r),vk(this,"cloneSource",void 0),vk(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new JB(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function Y4(t,e,r){return(e=G4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G4(t){var e=q4(t,"string");return typeof e=="symbol"?e:e+""}function q4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class um{constructor(e,r,n,i,s){Y4(this,"wtSettings",null),Do(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:a,hider:u,spreader:h,holder:c,wtRootElement:m}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=u,this.spreader=h,this.holder=c,this.wtRootElement=m,this.trimmingContainer=Qu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Qu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Ig(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Vt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),a=r<this.wtSettings.getSetting("fixedRowsTop"),u=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),h=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(h),top:h.offsetTop},m={start:this.getRelativeStartPosition(e),top:e.offsetTop};let p=null;return i?p=this.getRelativeCellPositionWithinWindow(a,s,m,c):p=this.getRelativeCellPositionWithinHolder(a,u,s,m,c),p}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,u=0;if(!r)a=i.start;else{let h=s.left;this.isRtl()&&(h=this.domBindings.rootWindow.innerWidth-(s.left+s.width+bn())),a=h<=0?-1*h:0}return e?u=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:u=i.top,{start:n.start+a,top:n.top+u}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let u=0,h=0;if(n||(u=a.horizontal-s.start),r){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();h=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(h=a.vertical-s.top);return{start:i.start-u,top:i.top-h}}makeClone(){if(r$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),a=n.createElement("table"),u=e.wtRootElement.parentNode;s.className=`${N4.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&it(s,[Io()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(a),u.appendChild(s);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===eh||c==="vertical"&&this.type===th?this.mainTableScrollableElement=i:i.getComputedStyle(u).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Ig(e.TABLE),new j4(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class K4 extends um{constructor(e,r,n,i,s,a){super(e,r,xl,n,i),this.bottomOverlay=s,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new g1(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${a}px`}else im(r),this.repositionOverlay();let n=Or(this.clone.wtTable.TABLE);const i=Fr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=bn(n)),i.style.bottom=`${s}px`}}const X4="calculatedColumns",Dy={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Do(Dy,"MIXIN_NAME",X4,{writable:!1,enumerable:!1});class p1 extends cd{constructor(e,r,n,i){super(e,r,n,i,To)}}qt(p1,f1);qt(p1,Dy);function Z4(t,e,r){return(e=Q4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q4(t){var e=J4(t,"string");return typeof e=="symbol"?e:e+""}function J4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e9 extends um{constructor(e,r,n,i){super(e,r,To,n,i),Z4(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new p1(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=bn(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.mainTableScrollableElement===r?(r.scrollTo(_y(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,stylesHandler:i}=this.wot,s=i.getDefaultRowHeight();let a=e,u=0;for(;a<r;){const h=n.getRowHeight(a);u+=h===void 0?s:h,a+=1}return u}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||u==="horizontal"){let c=r.getWorkspaceWidth();r.hasVerticalScroll()&&(c-=bn(n)),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=Or(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;r&&s.offsetHeight!==s.clientHeight&&(a=bn(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=a,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ty(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),a=i-s,u=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-u+i,0),n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const a=this.wot.wtTable.holder.parentNode,u=nt(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Re(a,"innerBorderBottom"),s=!u):(tt(a,"innerBorderBottom"),s=u)}return s}}const t9="calculatedRows",v1={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Do(v1,"MIXIN_NAME",t9,{writable:!1,enumerable:!1});class w1 extends cd{constructor(e,r,n,i){super(e,r,n,i,th)}}qt(w1,v1);qt(w1,ky);const r9="localHooks",Mn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,s,a){if(this._localHooks[t]){const u=this._localHooks[t].length;for(let h=0;h<u;h++)pw(this._localHooks[t][h],this,e,r,n,i,s,a)}},clearLocalHooks(){return this._localHooks={},this}};Do(Mn,"MIXIN_NAME",r9,{writable:!1,enumerable:!1});let n$=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};qt(n$,Mn);const i$="active-header",y1="header",C1="area",Rw="focus",n9="fill",i9="row",s9="column",o9="custom-selection",b1=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var wk={},yk;function a9(){if(yk)return wk;yk=1;var t=Hy();return t("flat"),wk}a9();function l9(t,e){s$(t,e),e.add(t)}function Ck(t,e,r){s$(t,e),e.set(t,r)}function s$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Er(t,e){return t.get(lg(t,e))}function bk(t,e,r){return t.set(lg(t,e),r),r}function lg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ss=new WeakMap,Nn=new WeakMap,vp=new WeakSet;class u9{constructor(){l9(this,vp),Ck(this,Ss,void 0),Ck(this,Nn,void 0)}setActiveOverlay(e){return bk(Nn,this,e),this}setActiveSelection(e){return bk(Ss,this,e),this}scan(){const e=Er(Ss,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,s]=Er(Ss,this).getCorners(),{wtTable:a}=Er(Nn,this),u=a.getRenderedColumnsCount(),h=a.getColumnHeadersCount();let c=0;for(let m=-a.getRowHeadersCount();m<u;m++){const p=a.columnFilter.renderedToSource(m);if(!(p<n||p>s)){for(let v=-h;v<0;v++){if(v<r||v>i)continue;const y=v+h;let C=a.getColumnHeader(p,y);const R=Er(Nn,this).getSetting("onBeforeHighlightingColumnHeader",p,y,{selectionType:Er(Ss,this).settings.selectionType,columnCursor:c,selectionWidth:s-n+1});R!==null&&(R!==p&&(C=a.getColumnHeader(R,y)),e(C))}c+=1}}}scanRowsInHeadersRange(e){const[r,n,i,s]=Er(Ss,this).getCorners(),{wtTable:a}=Er(Nn,this),u=a.getRenderedRowsCount(),h=a.getRowHeadersCount();let c=0;for(let m=-a.getColumnHeadersCount();m<u;m++){const p=a.rowFilter.renderedToSource(m);if(!(p<r||p>i)){for(let v=-h;v<0;v++){if(v<n||v>s)continue;const y=v+h;let C=a.getRowHeader(p,y);const R=Er(Nn,this).getSetting("onBeforeHighlightingRowHeader",p,y,{selectionType:Er(Ss,this).settings.selectionType,rowCursor:c,selectionHeight:i-r+1});R!==null&&(R!==p&&(C=a.getRowHeader(R,y)),e(C))}c+=1}}}scanCellsRange(e){const{wtTable:r}=Er(Nn,this);lg(vp,this,h9).call(this,(n,i)=>{const s=r.getCell(Er(Nn,this).createCellCoords(n,i)),a=Er(Nn,this).getSetting("onAfterDrawSelection",n,i,Er(Ss,this).settings.layerLevel);typeof a=="string"&&Re(s,a),e(s)})}scanRowsInCellsRange(e){const[r,,n]=Er(Ss,this).getCorners(),{wtTable:i}=Er(Nn,this);lg(vp,this,Sk).call(this,(s,a)=>{if(s>=r&&s<=n){const u=i.getCell(Er(Nn,this).createCellCoords(s,a));e(u)}})}scanColumnsInCellsRange(e){const[,r,,n]=Er(Ss,this).getCorners(),{wtTable:i}=Er(Nn,this);lg(vp,this,Sk).call(this,(s,a)=>{if(a>=r&&a<=n){const u=i.getCell(Er(Nn,this).createCellCoords(s,a));e(u)}})}}function h9(t){let[e,r,n,i]=Er(Ss,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:s}=Er(Nn,this),a=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),a){if(r=Math.max(r,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),i<r||n<e)return}else if(!(s.getCell(Er(Nn,this).createCellCoords(e,r))instanceof HTMLElement))return;for(let u=e;u<=n;u+=1)for(let h=r;h<=i;h+=1)t(u,h)}function Sk(t){const{wtTable:e}=Er(Nn,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const s=e.rowFilter.renderedToSource(i);for(let a=0;a<n;a+=1)t(s,e.columnFilter.renderedToSource(a))}}class Rk{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=b1(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ls(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function a(h){if(h.clientY<Math.floor(s.top)||h.clientY>Math.ceil(s.top+s.height)||h.clientX<Math.floor(s.left)||h.clientX>Math.ceil(s.left+s.width))return!0}function u(h){a(h)&&(n.eventManager.removeEventListener(i,"mousemove",u),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",u)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let u=0;u<5;u++){const h=n[u],c=r.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[h]&&this.settings[h].hide&&(c.className+=" hidden"),i=c.style,i.backgroundColor=this.settings[h]&&this.settings[h].color?this.settings[h].color:e.border.color,i.height=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,i.width=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),wa()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let a=s.bordersHolder;a||(a=r.createElement("div"),a.className="htBorders",s.bordersHolder=a,s.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const r=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};wt(i,(a,u)=>{this.selectionHandles.styles.bottomHitArea[u]=a,this.selectionHandles.styles.topHitArea[u]=a});const s={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};wt(s,(a,u)=>{this.selectionHandles.styles.bottom[u]=a,this.selectionHandles.styles.top[u]=a}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,a){const h=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:m,bottom:p,bottomHitArea:v}=this.selectionHandles.styles,y=parseInt(c.borderWidth,10),C=parseInt(c.width,10),R=parseInt(m.width,10),_=this.wot.wtTable.getWidth(),x=this.wot.wtTable.getHeight();c.top=`${parseInt(n-C-1,10)}px`,c[h]=`${parseInt(i-C-1,10)}px`,m.top=`${parseInt(n-R/4*3,10)}px`,m[h]=`${parseInt(i-R/4*3,10)}px`;const I=Math.min(parseInt(i+s,10),_-C-y*2),k=Math.min(parseInt(i+s-R/4,10),_-R-y*2);p[h]=`${I}px`,v[h]=`${k}px`;const W=Math.min(parseInt(n+a,10),x-C-y*2),B=Math.min(parseInt(n+a-R/4,10),x-R-y*2);p.top=`${W}px`,v.top=`${B}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",m.display="block",this.isPartRange(e,r)?(p.display="none",v.display="none"):(p.display="block",v.display="block")):(c.display="none",p.display="none",m.display="none",v.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",m.zIndex="9999"):(c.zIndex="",m.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,s]=e;if(r<0&&i<0||n<0&&s<0){this.disappear();return}const{wtTable:a,rootDocument:u,rootWindow:h}=this.wot,c=r!==i||n!==s,m=a.getFirstRenderedRow(),p=a.getLastRenderedRow(),v=a.getFirstRenderedColumn(),y=a.getLastRenderedColumn();let C;if(c){if(n=Math.max(n,v),s=Math.min(s,y),r=Math.max(r,m),i=Math.min(i,p),s<n||i<r){this.disappear();return}C=a.getCell(this.wot.createCellCoords(r,n))}else if(C=a.getCell(this.wot.createCellCoords(r,n)),!(C instanceof HTMLElement)){this.disappear();return}const R=c?a.getCell(this.wot.createCellCoords(i,s)):C,_=un(C),x=c?un(R):_,I=un(a.TABLE),k=_.top,W=_.left,B=this.wot.wtSettings.getSetting("rtlMode");let z=0,U=0;if(B){const me=Fr(a.TABLE),Ae=Fr(C),ve=h.innerWidth-I.left-me;U=W+Ae-x.left,z=h.innerWidth-W-Ae-ve-1}else U=x.left+Fr(R)-W,z=W-I.left-1;if(this.isEntireColumnSelected(r,i)){const me=r,Ae=this.getDimensionsFromHeader("columns",n,s,me,I);let ve=null;Ae&&([ve,z,U]=Ae),ve&&(C=ve)}let J=k-I.top-1,se=x.top+Or(R)-k;if(this.isEntireRowSelected(n,s)){const me=n,Ae=this.getDimensionsFromHeader("rows",r,i,me,I);let ve=null;Ae&&([ve,J,se]=Ae),ve&&(C=ve)}const ne=h.getComputedStyle(C);parseInt(ne.borderTopWidth,10)>0&&(J+=1,se=se>0?se-1:0),parseInt(ne[B?"borderRightWidth":"borderLeftWidth"],10)>0&&(z+=1,U=U>0?U-1:0);const fe=B?"right":"left";this.topStyle.top=`${J}px`,this.topStyle[fe]=`${z}px`,this.topStyle.width=`${U}px`,this.topStyle.display="block",this.startStyle.top=`${J}px`,this.startStyle[fe]=`${z}px`,this.startStyle.height=`${se}px`,this.startStyle.display="block";const j=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${J+se-j}px`,this.bottomStyle[fe]=`${z}px`,this.bottomStyle.width=`${U}px`,this.bottomStyle.display="block",this.endStyle.top=`${J}px`,this.endStyle[fe]=`${z+U-j}px`,this.endStyle.height=`${se+1}px`,this.endStyle.display="block";let ae=this.settings.border.cornerVisible;ae=typeof ae=="function"?ae(this.settings.layerLevel):ae;const P=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[ie,Le]=[i,s];if(P&&Array.isArray(P)&&([,,ie,Le]=P),wa()||!ae||this.isPartRange(ie,Le))this.cornerStyle.display="none";else{this.cornerStyle.top=`${J+se+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[fe]=`${z+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let me=Qu(a.TABLE);const Ae=me===h;Ae&&(me=u.documentElement);const ve=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Be=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),E=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const M=Ae?R.getBoundingClientRect().left:R.offsetLeft;let D=!1,$=0;B?($=M-parseInt(this.cornerDefaultStyle.width,10)/2,D=$<0):($=M+Fr(R)+parseInt(this.cornerDefaultStyle.width,10)/2,D=$>=KT(me)),D&&(this.cornerStyle[fe]=`${Math.floor(z+U+this.cornerCenterPointOffset-Be-ve)}px`,this.cornerStyle[B?"borderLeftWidth":"borderRightWidth"]=0)}i===this.wot.getSetting("totalRows")-1&&(Ae?R.getBoundingClientRect().top:R.offsetTop)+Or(R)+parseInt(this.cornerDefaultStyle.height,10)/2>=Bc(me)&&(this.cornerStyle.top=`${Math.floor(J+se+this.cornerCenterPointOffset-E-ve)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}wa()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,J,z,U,se)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:a}=this.wot,u=a.wtRootElement.parentNode;let h=null,c=null,m=null,p=null,v=null,y=null,C=null,R=null;switch(e){case"rows":h=function(){return a.getRowHeader(...arguments)},c=function(){return Or(...arguments)},m="ht__selection--rows",y="top";break;case"columns":h=function(){return a.getColumnHeader(...arguments)},c=function(){return Fr(...arguments)},m="ht__selection--columns",y="left";break}if(u.classList.contains(m)){const _=this.wot.getSetting("columnHeaders").length;if(C=h(r,_-i),R=h(n,_-i),!C||!R)return!1;const x=un(C),I=un(R);return C&&R&&(p=x[y]-s[y]-1,v=I[y]+c(R)-x[y]),[C,p,v]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?Re(this[e],"hidden"):(nt(this[e],"hidden")&&tt(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?Re(this[e],"hidden"):tt(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",wa()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function c9(t,e){o$(t,e),e.add(t)}function jh(t,e,r){o$(t,e),e.set(t,r)}function o$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yt(t,e){return t.get(S1(t,e))}function Ek(t,e,r){return t.set(S1(t,e),r),r}function S1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var kn=new WeakMap,pi=new WeakMap,iR=new WeakMap,Zf=new WeakMap,sR=new WeakMap,tu=new WeakMap,_k=new WeakSet;class d9{constructor(e){c9(this,_k),jh(this,kn,void 0),jh(this,pi,void 0),jh(this,iR,new u9),jh(this,Zf,new WeakMap),jh(this,sR,new WeakSet),jh(this,tu,new Map),Ek(pi,this,e)}setActiveOverlay(e){return Ek(kn,this,e),yt(iR,this).setActiveOverlay(yt(kn,this)),yt(Zf,this).has(yt(kn,this))||yt(Zf,this).set(yt(kn,this),new Set),this}getFocusSelection(){return yt(pi,this)!==null?yt(pi,this).getFocus():null}getAreaSelection(){return yt(pi,this)!==null?yt(pi,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(yt(tu,this).has(e)){const n=yt(tu,this).get(e);if(n.has(yt(kn,this)))return n.get(yt(kn,this));const i=new Rk(yt(kn,this),e.settings);return n.set(yt(kn,this),i),i}const r=new Rk(yt(kn,this),e.settings);return yt(tu,this).set(e,new Map([[yt(kn,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=yt(tu,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){yt(tu,this).get(e).forEach(r=>r.destroy()),yt(tu,this).delete(e)}render(e){if(yt(pi,this)===null)return;e&&S1(_k,this,f9).call(this);const r=Array.from(yt(pi,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){const a=r[s],{className:u,headerAttributes:h,createLayers:c,selectionType:m}=a.settings;yt(sR,this).has(a)||(yt(sR,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const p=this.getBorderInstance(a);if(a.isEmpty()){p==null||p.disappear();continue}u&&yt(iR,this).setActiveSelection(a).scan().forEach(C=>{if(n.has(C)){const R=n.get(C);R.has(u)&&c===!0?R.set(u,R.get(u)+1):R.set(u,1)}else n.set(C,new Map([[u,1]]));h&&(i.has(C)||i.set(C,[]),C.nodeName==="TH"&&i.get(C).push(...h))});const v=a.getCorners();yt(kn,this).getSetting("onBeforeDrawBorders",v,m),p==null||p.appear(v)}n.forEach((s,a)=>{var u;const h=Array.from(s).map(c=>{let[m,p]=c;return p===1?m:[m,...Array.from({length:p-1},(v,y)=>`${m}-${y+1}`)]}).flat();h.forEach(c=>yt(Zf,this).get(yt(kn,this)).add(c)),Re(a,h),a.nodeName==="TD"&&Array.isArray((u=yt(pi,this).options)===null||u===void 0?void 0:u.cellAttributes)&&it(a,yt(pi,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{it(s,[...i.get(s)])})}}function f9(){const t=yt(Zf,this).get(yt(kn,this)),e=yt(kn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const s=yt(kn,this).wtTable.TABLE.querySelectorAll(`.${r}`);let a=[];Array.isArray((n=yt(pi,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(a=yt(pi,this).options.cellAttributes.map(u=>u[0])),Array.isArray((i=yt(pi,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(a=[...a,...yt(pi,this).options.headerAttributes.map(u=>u[0])]);for(let u=0,h=s.length;u<h;u++)tt(s[u],r),ch(s[u],a)}),t.clear()}class g9 extends um{constructor(e,r,n,i){super(e,r,th,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new w1(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),xy(n,`${s}px`,"0px")):(s=this.getScrollPosition(),im(n));const a=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===r&&r.scrollX!==e?(r.scrollTo(e,GT(r)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||u==="vertical"){let c=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(c-=bn(n)),c=Math.min(c,e.wtRootElement.scrollHeight),a.height=`${c}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const h=Fr(this.clone.wtTable.TABLE);a.width=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=b1(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),u=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,h=s===0&&i.length>0&&!nt(u.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),m=0;if(r){const p=this.wot.wtTable.getColumnWidth(e),v=this.wot.wtViewport.getViewportWidth();p>v&&(r=!1)}return r&&u.offsetWidth!==u.clientWidth&&(m=bn(this.domBindings.rootDocument)),r?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=h):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=m,mB(this.mainTableScrollableElement)===c-h&&h>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(h),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(qT(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),a=i-s;n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),a=r.getSetting("totalRows"),u=r.getSetting("preventOverflow")==="vertical";a?tt(n,"emptyRows"):Re(n,"emptyRows");let h=!1;if(!u){if(s&&!i.length)Re(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const c=nt(n,"innerBorderInlineStart");e?(Re(n,"innerBorderLeft innerBorderInlineStart"),h=!c):(tt(n,"innerBorderLeft innerBorderInlineStart"),h=c)}}return h}}const m9="stickyRowsTop",R1={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Do(R1,"MIXIN_NAME",m9,{writable:!1,enumerable:!1});class E1 extends cd{constructor(e,r,n,i){super(e,r,n,i,rh)}}qt(E1,R1);qt(E1,ky);function Tk(t,e,r){return(e=p9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p9(t){var e=v9(t,"string");return typeof e=="symbol"?e:e+""}function v9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w9 extends um{constructor(e,r,n,i,s,a){super(e,r,rh,n,i),Tk(this,"topOverlay",void 0),Tk(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new E1(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();xy(e,`${i}px`,`${s}px`)}else im(e);let r=Or(this.clone.wtTable.TABLE);const n=Fr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class _1 extends cd{constructor(e,r,n,i){super(e,r,n,i,eh)}}qt(_1,R1);qt(_1,Dy);function y9(t,e,r){return(e=C9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C9(t){var e=b9(t,"string");return typeof e=="symbol"?e:e+""}function b9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S9 extends um{constructor(e,r,n,i){super(e,r,eh,n,i),y9(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new _1(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:u}=this.wot,h=u.hider.getBoundingClientRect(),c=Math.ceil(h.bottom),m=e.offsetHeight;s=c===m,i=this.getOverlayOffset(),xy(e,"0px",`${i}px`)}else i=this.getScrollPosition(),im(e);const a=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),a}setScrollPosition(e){const r=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===r&&r.scrollY!==e?(r.scrollTo(_y(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wot.stylesHandler.getDefaultRowHeight();let i=e,s=0;for(;i<r;){const a=this.wot.wtTable.getRowHeight(i);s+=a===void 0?n:a,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||u==="horizontal"){let c=r.getWorkspaceWidth();r.hasVerticalScroll()&&(c-=bn(n)),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=Or(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=b1(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,a=(n.cloneSource?n.cloneSource:n).wtTable.holder,u=i.getSetting("columnHeaders"),c=i.getSetting("fixedRowsTop")===0&&u.length>0&&!nt(a.parentNode,"innerBorderTop")?1:0;let m=this.getTableParentOffset(),p=0;if(r){const v=this.wot.wtTable.getRowHeight(e),y=this.wot.wtViewport.getViewportHeight();v>y&&(r=!1)}if(r&&a.offsetHeight!==a.clientHeight&&(p=bn(this.domBindings.rootDocument)),r){const v=i.getSetting("fixedRowsBottom"),y=i.getSetting("totalRows");m+=this.sumCellSizes(0,e+1),m-=n.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),m+=1,m+=c}else m+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return m+=p,gB(this.mainTableScrollableElement)===m-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(m)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ty(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),a=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),a=n.getSetting("preventOverflow")==="horizontal";s?tt(i,"emptyColumns"):Re(i,"emptyColumns");let u=!1;if(!r&&!a){const h=n.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==h,m=n.getSetting("columnHeaders");if((c||h===0)&&m.length>0){const p=nt(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(Re(i,"innerBorderTop"),u=!p):(tt(i,"innerBorderTop"),u=p)}}return u}}function wp(t,e,r){R9(t,e),e.set(t,r)}function R9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Go(t,e,r){return(e=E9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E9(t){var e=_9(t,"string");return typeof e=="symbol"?e:e+""}function _9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ru(t,e,r){return t.set(a$(t,e),r),r}function qo(t,e){return t.get(a$(t,e))}function a$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yh=new WeakMap,yp=new WeakMap,Gh=new WeakMap,Cp=new WeakMap;class T9{constructor(e,r,n,i,s,a){Go(this,"wot",null),wp(this,Yh,[]),Go(this,"topOverlay",null),Go(this,"bottomOverlay",null),Go(this,"inlineStartOverlay",null),Go(this,"topInlineStartCornerOverlay",null),Go(this,"bottomInlineStartCornerOverlay",null),Go(this,"browserLineHeight",void 0),Go(this,"wtSettings",null),wp(this,yp,!1),wp(this,Gh,0),wp(this,Cp,null),Go(this,"resizeObserver",new ResizeObserver(m=>{Pg(()=>{!Array.isArray(m)||!m.length||(ru(Gh,this,qo(Gh,this)+1),qo(Gh,this)===100&&(Vt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),qo(Cp,this)!==null&&clearTimeout(qo(Cp,this)),ru(Cp,this,setTimeout(()=>{ru(Gh,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;const{rootDocument:u,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=bn(u);const c=h.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:Ig(a.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...qo(Yh,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new S9(...e),this.bottomOverlay=new e9(...e),this.inlineStartOverlay=new g9(...e),this.topInlineStartCornerOverlay=new w9(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new K4(...e,this.bottomOverlay,this.inlineStartOverlay),ru(Yh,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ru(yp,this,qo(Yh,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),qo(Yh,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),qo(Yh,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",p=>this.onKeyDown(p)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",p=>this.onTableScroll(p),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",p=>this.onTableScroll(p),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,a=this.scrollableElement===r,u=this.wtSettings.getSetting("preventWheel"),h={passive:a};(u||s||!r1())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",p=>this.onCloneWheel(p,u),h),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(p=>{if(p&&p.needFullRender){const{holder:v}=p.clone.wtTable;this.eventManager.addEventListener(v,"wheel",y=>this.onCloneWheel(y,u),h)}});let m;this.eventManager.addEventListener(r,"resize",()=>{Pg(()=>{clearTimeout(m),this.wtSettings.getSetting("onWindowResize"),m=setTimeout(()=>{ru(Gh,this,0)},200)})}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,a=e.target,u=s!==n&&a!==n&&!a.contains(s),h=i!==n&&a!==n&&!a.contains(i);if(this.keyPressed&&(u||h)||this.scrollableElement===n)return;const c=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=hd(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,r=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=r.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=i;const a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!qo(yp,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),ru(yp,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Ig(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),u=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,m=u+this.inlineStartOverlay.sumCellSizes(0,s),v=r.hider.style,y=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),C=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,m-r.holder.clientWidth),R=y()?1:0,_=C()?1:0;v.width=`${m+_}px`,v.height=`${c+R}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return te(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];te(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function xk(t,e,r){return(e=x9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x9(t){var e=M9(t,"string");return typeof e=="symbol"?e:e+""}function M9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I9{constructor(e){xk(this,"settings",{}),xk(this,"defaults",Object.freeze(this.getDefaults())),wt(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Pl(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?wt(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class T1 extends cd{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Qu(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=Og(e,"height",r),s=Og(e,"overflow",r),a=this.holder.style,{scrollWidth:u,scrollHeight:h}=e;let c=e.offsetWidth,m=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){const v=e.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",e.nextElementSibling?n.insertBefore(v,e.nextElementSibling):n.appendChild(v);const y=parseInt(r.getComputedStyle(v).height,10);n.removeChild(v),y===0&&(m=0)}m=Math.min(m,h),a.height=i==="auto"?"auto":`${m}px`,c=Math.min(c,u),a.width=`${c}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:m>0,this.hasTableWidth=c>0}this.isTableVisible=Zu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const u=e.getSetting("rowHeaders").length,h=this.getRenderedColumnsCount();for(let c=0;c<s;c++)for(let m=-1*u;m<h;m++)this.markIfOversizedColumnHeader(m);r.hasOversizedColumnHeadersMarked[n]=!0}}}qt(T1,v1);qt(T1,Dy);class O9{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new v8:new R8],["fullyVisible",()=>new a8],["partiallyVisible",()=>new qB]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new g8:new C8],["fullyVisible",()=>new i8],["partiallyVisible",()=>new GB]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=Or(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return un(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Or(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=Fr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),s,a;this.rowHeaderWidth=NaN;let u=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const h=r.getSetting("fixedRowsTop"),c=r.getSetting("fixedRowsBottom"),m=r.getSetting("totalRows");return h&&u>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,h),u+=a,i-=a),c&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(m-c,m),i-=a),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=bn(this.domBindings.rootDocument),new P8({calculationTypes:e.map(p=>[p,this.rowsCalculatorTypes.get(p)()]),viewportHeight:i,scrollOffset:u,totalRows:r.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:p=>n.getRowHeight(p),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=r.getSetting("fixedColumnsStart");if(a&&s>=0){const u=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);s+=u,i-=u}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=bn(this.domBindings.rootDocument)),new M8({calculationTypes:e.map(u=>[u,this.columnsCalculatorTypes.get(u)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:u=>n.getColumnWidth(u),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!r.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s,rowStartOffset:a,rowEndOffset:u}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,c=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(c)&&c>0?(r=Math.max(0,r-Math.min(a,c)),n=Math.min(h,n+Math.min(u,c))):c==="auto"&&(r=Math.max(0,r-Math.ceil(a/2)),n=Math.min(h,n+Math.ceil(u/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<h)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s,columnStartOffset:a,columnEndOffset:u}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,c=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(c)&&c>0?(r=Math.max(0,r-Math.min(a,c)),n=Math.min(h,n+Math.min(u,c))):c==="auto"&&(r=Math.max(0,r-Math.ceil(a/2)),n=Math.min(h,n+Math.ceil(u/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<h)}resetHasOversizedColumnHeadersMarked(){wt(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}function P9(t,e){l$(t,e),e.add(t)}function nu(t,e,r){l$(t,e),e.set(t,r)}function l$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dr(t,e){return t.get(Os(t,e))}function Is(t,e,r){return t.set(Os(t,e),r),r}function Os(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Mk=23;var mo=new WeakMap,ma=new WeakMap,x1=new WeakMap,S_=new WeakMap,ll=new WeakMap,Qf=new WeakMap,Hg=new WeakMap,wo=new WeakSet;class A9{constructor(e){P9(this,wo),nu(this,mo,void 0),nu(this,ma,void 0),nu(this,x1,void 0),nu(this,S_,void 0),nu(this,ll,!0),nu(this,Qf,{}),nu(this,Hg,{}),Is(ma,this,e.rootTable.parentElement.parentElement),Is(S_,this,e.rootDocument)}isClassicTheme(){return dr(ll,this)}getCSSVariableValue(e){var r;if(dr(ll,this))return null;if(dr(Qf,this)[`--ht-${e}`])return dr(Qf,this)[`--ht-${e}`];const n=(r=Os(wo,this,D9).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Os(wo,this,u$).call(this,`--ht-${e}`);if(n!==null)return dr(Qf,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=dr(Hg,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(dr(ll,this))return Mk;const e=Os(wo,this,H9).call(this);return!e&&nt(dr(ma,this),"ht-wrapper")?(Vt(`The "${dr(mo,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Is(ll,this,!0),this.useTheme(),Mk):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Os(wo,this,Ik).call(this),Is(ll,this,!0),Is(mo,this,e||void 0);return}e&&e!==dr(mo,this)&&(dr(mo,this)&&Os(wo,this,L9).call(this),Is(mo,this,e),Is(ll,this,!1),Os(wo,this,N9).call(this),Os(wo,this,Ik).call(this))}getThemeName(){return dr(mo,this)}removeClassNames(){nt(dr(ma,this),dr(mo,this))&&tt(dr(ma,this),dr(mo,this))}}function H9(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function N9(){tt(dr(ma,this),/ht-theme-.*/g),Re(dr(ma,this),dr(mo,this))}function Ik(){this.isClassicTheme()||Is(x1,this,getComputedStyle(dr(ma,this)));const t=Os(wo,this,k9).call(this,["box-sizing","border-bottom-width"]);dr(Hg,this).td={...dr(Hg,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function k9(t){const e=dr(S_,this),r=dr(ma,this),n=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),a=e.createElement("tr"),u=e.createElement("td");a.appendChild(u),i.appendChild(s),i.appendChild(a),n.appendChild(i),r.appendChild(n);const h=getComputedStyle(u),c={};return t.forEach(m=>{c[m]=h.getPropertyValue(m)}),r.removeChild(n),c}function D9(t){const e=Math.ceil(parseFloat(Os(wo,this,u$).call(this,t)));return Number.isNaN(e)?null:e}function u$(t){const e=dr(x1,this).getPropertyValue(t);return e===""?null:e}function L9(){Is(Hg,this,{}),Is(Qf,this,{}),Is(ll,this,!0)}class F9 extends m1{constructor(e,r){super(e,new I9(r)),this.stylesHandler=new A9(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new T1(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new O9(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new d9(this.wtSettings.getSetting("selections")),this.wtEvent=new JB(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new T9(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];wt(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),tt(this.wtTable.wtRootElement.parentNode,r),Re(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!r$.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class M1{constructor(e){e instanceof m1?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new M1(r);return()=>n},this._wot=new F9(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function Ok(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:a,cellCoordsFactory:u}=t;const h=s.isSelected()?s.getSelectedRange().current():null,c=s.isSelectedByCorner(),m=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&h)i.row>=0&&i.col>=0&&!a.cell?s.setRangeEnd(i):(c||m)&&i.row>=0&&i.col>=0&&!a.cell?s.setRangeEnd(u(i.row,i.col)):c&&i.row<0&&!a.column?s.setRangeEnd(u(h.to.row,i.col)):m&&i.col<0&&!a.row?s.setRangeEnd(u(i.row,h.to.col)):(!c&&!m&&i.col<0||c&&i.col<0)&&!a.row?s.selectRows(Math.max(h.from.row,0),i.row,i.col):(!c&&!m&&i.row<0||m&&i.row<0)&&!a.column&&s.selectColumns(Math.max(h.from.col,0),i.col,i.row);else{const p=!s.inInSelection(i),v=r||n&&p;i.row<0&&i.col>=0&&!a.column?v&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?v&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?v&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function W9(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const a=n.isSelectedByRowHeader(),u=n.isSelectedByColumnHeader(),h=n.tableProps.countCols(),c=n.tableProps.countRows();n.markSource("mouse"),u&&!i.column?n.setRangeEnd(s(c-1,r.col)):a&&!i.row?n.setRangeEnd(s(r.row,h-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}const B9=new Map([["mousedown",Ok],["mouseover",W9],["touchstart",Ok]]);function Pk(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:s}=e;B9.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:Ay(t)||t.type==="touchstart",isRightClick:Al(t)})}const h$=new WeakMap,I1=Symbol("rootInstance");function $9(t){h$.set(t,!0)}function V9(t){return t===I1}function qv(t){return h$.has(t)}function z9(t,e){c$(t,e),e.add(t)}function iu(t,e,r){c$(t,e),e.set(t,r)}function c$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qa(t,e,r){return(e=U9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U9(t){var e=j9(t,"string");return typeof e=="symbol"?e:e+""}function j9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vn(t,e){return t.get(Vc(t,e))}function zi(t,e,r){return t.set(Vc(t,e),r),r}function Vc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var oR=new WeakMap,bp=new WeakMap,Sp=new WeakMap,Ko=new WeakMap,ps=new WeakMap,aR=new WeakMap,lR=new WeakMap,Jf=new WeakSet;class Y9{constructor(e){z9(this,Jf),qa(this,"hot",void 0),qa(this,"eventManager",void 0),qa(this,"settings",void 0),qa(this,"THEAD",void 0),qa(this,"TBODY",void 0),qa(this,"_wt",void 0),qa(this,"activeWt",void 0),iu(this,oR,0),iu(this,bp,0),qa(this,"postponedAdjustElementsSize",!1),iu(this,Sp,!1),iu(this,Ko,void 0),iu(this,ps,void 0),iu(this,aR,0),iu(this,lR,0),this.hot=e,this.eventManager=new ns(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),Vc(Jf,this,q9).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Re(e,"handsontable"),zi(ps,this,r.createElement("TABLE")),Re(vn(ps,this),"htCore"),this.hot.getSettings().tableClassName&&Re(vn(ps,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(it(vn(ps,this),[Io()]),it(e,[tK(),nB(-1),Ey(this.hot.countCols()),mK()])),this.THEAD=r.createElement("THEAD"),vn(ps,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),vn(ps,this).appendChild(this.TBODY),this.hot.table=vn(ps,this),this.hot.container.insertBefore(vn(ps,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,s=r.documentElement;this.eventManager.addEventListener(e,"mousedown",u=>{zi(Sp,this,!0),this.isTextSelectionAllowed(u.target)||(f_(i),u.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{zi(Sp,this,!1)}),this.eventManager.addEventListener(e,"mousemove",u=>{vn(Sp,this)&&!this.isTextSelectionAllowed(u.target)&&(this.settings.fragmentSelection&&f_(i),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",u=>{n.isInProgress()&&!u.shiftKey&&n.finish()}),this.eventManager.addEventListener(s,"mouseup",u=>{n.isInProgress()&&Ay(u)&&n.finish(),zi(Ko,this,!1);const h=My(r.activeElement);ag(r.activeElement)&&!h||(h||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(u.target)&&!Al(u))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",u=>{n.isInProgress()&&Al(u)&&(n.finish(),zi(Ko,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{n.isInProgress()&&n.finish(),zi(Ko,this,!1)}),this.eventManager.addEventListener(s,"mousedown",u=>{const h=u.target,c=u.x||u.clientX,m=u.y||u.clientY;let p=u.target;if(vn(Ko,this)||!e||!this.hot.view)return;const{holder:v}=this._wt.wtTable;if(p===v){const C=bn(r);if(r.elementFromPoint(c+C,m)!==v||r.elementFromPoint(c,m+C)!==v)return}else for(;p!==s;){if(p===null){if(u.isTargetWebComponent)break;return}if(p===e)return;p=p.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(h):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Xu(i);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Xu(a);this.eventManager.addEventListener(vn(ps,this),"selectstart",u=>{this.settings.fragmentSelection||ag(u.target)||u.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),a=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(a))return 0;let u=0;return r<0?u=a+1:r>0&&(u=i-a),u}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Re(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&tt(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:vn(ps,this),isDataViewInstance:()=>qv(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((a,u)=>{const h=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(h,u)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),zi(bp,this,s.length),this.hot.getSettings().ariaTags&&Vc(Jf,this,d$).call(this)===this.hot.countCols()&&Vc(Jf,this,G9).call(this,vn(bp,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((a,u)=>{const h=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(h,u)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),zi(oR,this,s.length),s},columnWidth:s=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(a===null?s:a)},rowHeight:s=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(a===null?s:a)},rowHeightByOverlayName:(s,a)=>{const u=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),h=u===null?s:u;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(h),h,a)},cellRenderer:(s,a,u)=>{const[h,c]=this.translateFromRenderableToVisualIndex(s,a),m=this.hot.runHooks("modifyGetCellCoords",h,c,!1,"meta");let p=h,v=c;Array.isArray(m)&&([p,v]=m);const y=this.hot.getCellMeta(p,v),C=this.hot.colToProp(v);let R=this.hot.getDataAtRowProp(p,C);this.hot.hasHook("beforeValueRender")&&(R=this.hot.runHooks("beforeValueRender",R,y)),this.hot.runHooks("beforeRenderer",u,h,c,C,R,y),this.hot.getCellRenderer(y)(this.hot,u,h,c,C,R,y),this.hot.runHooks("afterRenderer",u,h,c,C,R,y)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Zu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,a,u,h)=>{const c=this.translateFromRenderableToVisualCoords(a),m={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=h,zi(Ko,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,c,u,m),!ml(s)&&(Pk(s,{coords:c,selection:this.hot.selection,controller:m,cellCoordsFactory:(p,v)=>this.hot._createCellCoords(p,v)}),this.hot.runHooks("afterOnCellMouseDown",s,c,u),this.activeWt=this._wt)},onCellContextMenu:(s,a,u,h)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,zi(Ko,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,c,u),!ml(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,c,u),this.activeWt=this._wt)},onCellMouseOut:(s,a,u,h)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOut",s,c,u),!ml(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,c,u),this.activeWt=this._wt)},onCellMouseOver:(s,a,u,h)=>{const c=this.translateFromRenderableToVisualCoords(a),m={row:!1,column:!1,cell:!1};this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOver",s,c,u,m),!ml(s)&&(vn(Ko,this)&&Pk(s,{coords:c,selection:this.hot.selection,controller:m,cellCoordsFactory:(p,v)=>this.hot._createCellCoords(p,v)}),this.hot.runHooks("afterOnCellMouseOver",s,c,u),this.activeWt=this._wt)},onCellMouseUp:(s,a,u,h)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseUp",s,c,u),!(ml(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,c,u),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,a)=>this.beforeRender(s,a),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,a)=>{const u=this.hot.rowIndexMapper,h=s<0;let c=s;return!h&&(c=u.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollVertically",c,a),this.hot.runHooks("beforeViewportScroll"),h?c:u.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:(s,a)=>{const u=this.hot.columnIndexMapper,h=s<0;let c=s;return!h&&(c=u.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c,a),this.hot.runHooks("beforeViewportScroll"),h?c:u.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,a,u)=>{const h=this.hot.rowIndexMapper,c=s<0;let m=s;c||(m=h.getVisualFromRenderableIndex(s));const p=this.hot.runHooks("beforeHighlightingRowHeader",m,a,u);return c?p:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:(s,a,u)=>{const h=this.hot.columnIndexMapper,c=s<0;let m=s;c||(m=h.getVisualFromRenderableIndex(s));const p=this.hot.runHooks("beforeHighlightingColumnHeader",m,a,u);return c?p:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:(s,a,u)=>{let h;const[c,m]=this.translateFromRenderableToVisualIndex(s,a),p=this.hot.selection.getSelectedRange();if(p.size()>0){const y=p.peekByIndex(u??0);h=[y.from.row,y.from.col,y.to.row,y.to.col]}return this.hot.runHooks("afterDrawSelection",c,m,h,u)},onBeforeDrawBorders:(s,a)=>{const[u,h,c,m]=s,p=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(m)];return this.hot.runHooks("beforeDrawBorders",p,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,a,u,h)=>{const c=this.hot.rowIndexMapper,m=this.hot.columnIndexMapper,p=a>=0?m.getVisualFromRenderableIndex(a):a,v=s>=0?c.getVisualFromRenderableIndex(s):s,y=this.hot.runHooks("modifyGetCellCoords",v,p,u,h);if(Array.isArray(y)){const[C,R,_,x]=y;return[C>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(C,1)):C,R>=0?m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(R,1)):R,_>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(_,-1)):_,x>=0?m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(x,-1)):x]}},onModifyGetCoordsElement:(s,a)=>{const u=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,c=a>=0?h.getVisualFromRenderableIndex(a):a,m=s>=0?u.getVisualFromRenderableIndex(s):s,p=this.hot.runHooks("modifyGetCoordsElement",m,c);if(Array.isArray(p)){const[v,y]=p;return[v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,1)):v,y>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(y,1)):y]}},viewportRowCalculatorOverride:s=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const u=this.countRenderableRows(),h=s.startRow,c=s.endRow;if(typeof a=="number")s.startRow=Math.max(h-a,0),s.endRow=Math.min(c+a,u-1);else if(a==="auto"){const m=Math.max(1,Math.ceil(c/u*12));s.startRow=Math.max(h-m,0),s.endRow=Math.min(c+m,u-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const u=this.countRenderableColumns(),h=s.startColumn,c=s.endColumn;if(typeof a=="number"&&(s.startColumn=Math.max(h-a,0),s.endColumn=Math.min(c+a,u-1)),a==="auto"){const m=Math.max(1,Math.ceil(c/u*6));s.startColumn=Math.max(h-m,0),s.endColumn=Math.min(c+m,u-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new M1(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(ag(e))return!0;const r=Tl(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return vn(Ko,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!nt(n,"relative")){Ls(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),a=n.createElement("span");s.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,i),s.appendChild(a),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(r.firstChild){const a=r.firstChild;nt(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,n,i),a.className="",Re(a,["relative",...s()])):(Ls(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:a}=this.hot,u=a.createElement("div"),h=a.createElement("span"),c=s();u.classList.add("relative",...c),h.className="colHeader",this.settings.ariaTags&&(it(u,...Io()),it(h,...Io())),this.updateCellHeader(h,e,n,i),u.appendChild(h),r.appendChild(u)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(nt(e,"colHeader")?s=a.wtTable.columnFilter.sourceToRendered(r):nt(e,"rowHeader")&&(s=a.wtTable.rowFilter.sourceToRendered(r))),s>-1?dh(e,n(r,i)):(Pl(e," "),Re(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){zi(aR,this,e),zi(lR,this,r)}getLastSize(){return{width:vn(aR,this),height:vn(lR,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return vn(oR,this)}getRowHeadersCount(){return vn(bp,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function d$(){return parseInt(this.hot.rootElement.getAttribute(Ey()[0]),10)}function G9(t){const e=Vc(Jf,this,d$).call(this)+t;it(this.hot.rootElement,...Ey(e))}function q9(){const t=this.hot.rootElement;this.hasVerticalScroll()?Re(t,"htHasScrollY"):tt(t,"htHasScrollY"),this.hasHorizontalScroll()?Re(t,"htHasScrollX"):tt(t,"htHasScrollX")}var Ak={},Hk={},Nk;function K9(){if(Nk)return Hk;Nk=1;var t=sr(),e=id(),r=Si(),n=Jr(),i=Ho();return t({target:"Iterator",proto:!0,real:!0},{every:function(a){n(this),r(a);var u=i(this),h=0;return!e(u,function(c,m){if(!a(c,h++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),Hk}var kk;function X9(){return kk||(kk=1,K9()),Ak}X9();const f$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",R_=f$.length;function Ly(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%R_,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/R_,10);return r}function Z9(t){let e=0;if(t)for(let r=0,n=t.length-1;r<t.length;r+=1,n-=1)e+=R_**n*(f$.indexOf(t[r])+1);return e-=1,e}function Q9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let n,i;for(n=0;n<t;n++){const s=[];for(i=0;i<e;i++)s.push(Ly(i)+(n+1));r.push(s)}return r}function J9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let n,i;for(n=0;n<t;n++){const s={};for(i=0;i<e;i++)s[`prop${i}`]=Ly(i)+(n+1);r.push(s)}return r}function eX(t,e){const r=[];let n;for(let i=0;i<t;i++){n=[];for(let s=0;s<e;s++)n.push("");r.push(n)}return r}function O1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,s)=>{Array.isArray(i)?i.forEach((a,u)=>{n.push([s+e,u,a])}):Object.keys(i).forEach(a=>{n.push([s+e,a,i[a]])})}),n}function P1(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&vt(t[0])&&(e=Py(t[0]))),e}function g$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function m$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const tX=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:P1,createEmptySpreadsheetData:eX,createSpreadsheetData:Q9,createSpreadsheetObjectData:J9,dataRowToChangesArray:O1,isArrayOfArrays:g$,isArrayOfObjects:m$,spreadsheetColumnIndex:Z9,spreadsheetColumnLabel:Ly},Symbol.toStringTag,{value:"Module"}));function df(t,e,r){return(e=rX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rX(t){var e=nX(t,"string");return typeof e=="symbol"?e:e+""}function nX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iX{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];df(this,"hot",void 0),df(this,"data",void 0),df(this,"dataType","array"),df(this,"colToProp",()=>{}),df(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return te(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0,{dataDotNotation:a}=this.hot.getSettings();let u=null,h=null;if(u=this.modifyRowData(e),Array.isArray(u))h=[],s?u.forEach((c,m)=>{h[m]=this.getAtPhysicalCell(e,m,u)}):Xe(r,n,c=>{h[c-r]=this.getAtPhysicalCell(e,c,u)});else if(vt(u)||nr(u))if(i?h=[]:h={},!s||i){const m=this.countFirstRowKeys()-1;Xe(0,m,p=>{const v=this.colToProp(p);if(p>=(r||0)&&p<=(n||m)&&!Number.isInteger(v)){const y=this.getAtPhysicalCell(e,v,u);i?h.push(y):a?jv(h,v,y):h[v]=y}})}else wt(u,(c,m)=>{const p=this.getAtPhysicalCell(e,m,u);a?jv(h,m,p):h[m]=p});return h}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=bi(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}Number.isInteger(r)?this.data[e][r]=n:jv(this.data[e],r,n)}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?RB(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const s=bi(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,a=null,u=null,h=null;e===null||r===null?(i=!0,s=0,u=this.countRows()-1):(s=Math.min(e.row,r.row),a=Math.min(e.col,r.col),u=Math.max(e.row,r.row),h=Math.max(e.col,r.col));const c=[];return Xe(s,u,m=>{c.push(i?this.getAtRow(m,void 0,void 0,n):this.getAtRow(m,a,h,n))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return P1(this.data)}destroy(){this.data=null,this.hot=null}}var Dk={},Lk={},Fk;function sX(){if(Fk)return Lk;Fk=1;var t=sr(),e=id(),r=Si(),n=Jr(),i=Ho();return t({target:"Iterator",proto:!0,real:!0},{some:function(a){n(this),r(a);var u=i(this),h=0;return e(u,function(c,m){if(a(c,h++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),Lk}var Wk;function oX(){return Wk||(Wk=1,sX()),Dk}oX();function Bk(t,e,r){return(e=aX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aX(t){var e=lX(t,"string");return typeof e=="symbol"?e:e+""}function lX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Bk(this,"indexedValues",[]),Bk(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,nr(this.initValueOrFn)?Xe(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Xe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}qt(fh,Mn);function A1(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,a)=>nr(n)?n(s,a):n),...i===void 0?[]:t.slice(i)]}function H1(t,e){return Ta(t,(r,n)=>e.includes(n)===!1)}class Fl extends fh{insert(e,r){this.indexedValues=A1(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=H1(this.indexedValues,e),super.remove(e)}}class Fy extends Fl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Gr(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function N1(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Ng(t,e){return Ta(t,r=>e.includes(r)===!1)}function k1(t,e){return St(t,r=>r-e.filter(n=>n<r).length)}function D1(t,e){const r=e[0],n=e.length;return St(t,i=>i>=r?i+n:i)}function uX(t,e,r){return(e=hX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hX(t){var e=cX(t,"string");return typeof e=="symbol"?e:e+""}function cX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wy extends fh{constructor(){super(...arguments),uX(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ng(this.orderOfIndexes,[e]),nr(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=A1(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=D1(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=H1(this.indexedValues,e),this.orderOfIndexes=Ng(this.orderOfIndexes,e),this.orderOfIndexes=k1(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class hm extends Fl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Gr(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}const $k=new Map([["indexesSequence",{getListWithInsertedItems:N1,getListWithRemovedItems:Ng}],["physicallyIndexed",{getListWithInsertedItems:A1,getListWithRemovedItems:H1}]]),p$=t=>{if($k.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return $k.get(t)};class v$ extends fh{constructor(){super(e=>e)}insert(e,r){const n=D1(this.indexedValues,r);this.indexedValues=N1(n,e,r),super.insert(e,r)}remove(e){const r=Ng(this.indexedValues,e);this.indexedValues=k1(r,e),super.remove(e)}}const Vk=new Map([["hiding",Fy],["index",fh],["linkedPhysicalIndexToValue",Wy],["physicalIndexToValue",Fl],["trimming",hm]]);function dX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Vk.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Vk.get(t))(e)}function fX(t,e,r){return(e=gX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gX(t){var e=mX(t,"string");return typeof e=="symbol"?e:e+""}function mX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let E_=0;class L1{constructor(){fX(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)),E_+=1)}unregister(e){const r=this.collection.get(e);Ue(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r),E_-=1)}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return fr(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}qt(L1,Mn);function pX(){return E_}function uR(t,e,r){return(e=vX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vX(t){var e=wX(t,"string");return typeof e=="symbol"?e:e+""}function wX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zk extends L1{constructor(e,r){super(),uR(this,"mergedValuesCache",[]),uR(this,"aggregationFunction",void 0),uR(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=St(this.get(),s=>s.getValues()),n=[],i=Ue(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const a=[];for(let u=0;u<this.getLength();u+=1)a.push(r[u][s]);n.push(a)}return St(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return Ue(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function yX(t,e,r){CX(t,e),e.set(t,r)}function CX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bX(t,e,r){return t.set(w$(t,e),r),r}function SX(t,e){return t.get(w$(t,e))}function w$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hR=new WeakMap;class y${constructor(){yX(this,hR,[])}subscribe(e){return this.addLocalHook("change",e),this._write(SX(hR,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){bX(hR,this,e)}}qt(y$,Mn);function Uk(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ff(t,e,r){RX(t,e),e.set(t,r)}function RX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ui(t,e){return t.get(C$(t,e))}function Rp(t,e,r){return t.set(C$(t,e),r),r}function C$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ep=new WeakMap,gf=new WeakMap,_p=new WeakMap,Tp=new WeakMap,xp=new WeakMap;class EX{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ff(this,Ep,new Set),ff(this,gf,[]),ff(this,_p,[]),ff(this,Tp,!1),ff(this,xp,!1),Rp(xp,this,e??!1)}createObserver(){const e=new y$;return Ui(Ep,this).add(e),e.addLocalHook("unsubscribe",()=>{Ui(Ep,this).delete(e)}),e._writeInitialChanges(Uk(Ui(gf,this),Ui(_p,this))),e}emit(e){let r=Ui(_p,this);(!Ui(Tp,this)||Ui(gf,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Ui(xp,this)):Rp(gf,this,new Array(e.length).fill(Ui(xp,this))),Ui(Tp,this)||(Rp(Tp,this,!0),r=Ui(gf,this)));const n=Uk(r,e);Ui(Ep,this).forEach(i=>i._write(n)),Rp(_p,this,e)}}function Kn(t,e,r){return(e=_X(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _X(t){var e=TX(t,"string");return typeof e=="symbol"?e:e+""}function TX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class __{constructor(){Kn(this,"indexesSequence",new v$),Kn(this,"trimmingMapsCollection",new zk(e=>e.some(r=>r===!0),!1)),Kn(this,"hidingMapsCollection",new zk(e=>e.some(r=>r===!0),!1)),Kn(this,"variousMapsCollection",new L1),Kn(this,"hidingChangesObservable",new EX({initialIndexValue:!1})),Kn(this,"notTrimmedIndexesCache",[]),Kn(this,"notHiddenIndexesCache",[]),Kn(this,"isBatched",!1),Kn(this,"indexesSequenceChanged",!1),Kn(this,"indexesChangeSource",void 0),Kn(this,"trimmedIndexesChanged",!1),Kn(this,"hiddenIndexesChanged",!1),Kn(this,"renderablePhysicalIndexesCache",[]),Kn(this,"fromPhysicalToVisualIndexesCache",new Map),Kn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,dX(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof hm?this.trimmingMapsCollection.register(e,r):r instanceof Fy?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return Ue(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return Ue(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return Ue(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return Ue(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return r>0?a=s.findIndex(u=>u>e):a=s.reverse().findIndex(u=>u<e),a===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=St(e,c=>this.getPhysicalFromVisualIndex(c)),i=this.getNotTrimmedIndexesLength(),s=e.length,a=Ng(this.getIndexesSequence(),n),u=a.filter(c=>this.isTrimmed(c)===!1);let h=a.indexOf(u[u.length-1])+1;if(r+s<i){const c=u[r];h=a.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(N1(a,h,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=Ue(n)?n:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=St(new Array(r).fill(i),(u,h)=>u+h);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,a),this.hidingMapsCollection.insertToEvery(s,a),this.variousMapsCollection.insertToEvery(s,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}qt(__,Mn);function xX(t,e){return wt(e,(r,n)=>{fr(t[n])&&(t[n]=r)}),t}function b$(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function S$(t){Ue(t)&&a1(Gt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function MX(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:IX,getValues:OX}=zs("phraseFormatters");function PX(t,e){IX(t,e)}function AX(){return OX()}PX("pluralize",MX);const R$="ContextMenu:items",dt=R$,F1=`${dt}.noItems`,W1=`${dt}.insertRowAbove`,B1=`${dt}.insertRowBelow`,$1=`${dt}.insertColumnOnTheLeft`,V1=`${dt}.insertColumnOnTheRight`,z1=`${dt}.removeRow`,U1=`${dt}.removeColumn`,j1=`${dt}.undo`,Y1=`${dt}.redo`,Ew=`${dt}.readOnly`,G1=`${dt}.clearColumn`,q1=`${dt}.copy`,K1=`${dt}.copyWithHeaders`,X1=`${dt}.copyWithGroupHeaders`,Z1=`${dt}.copyHeadersOnly`,Q1=`${dt}.cut`,J1=`${dt}.freezeColumn`,ex=`${dt}.unfreezeColumn`,tx=`${dt}.mergeCells`,rx=`${dt}.unmergeCells`,nx=`${dt}.addComment`,ix=`${dt}.editComment`,sx=`${dt}.removeComment`,ox=`${dt}.readOnlyComment`,ax=`${dt}.align`,lx=`${dt}.align.left`,ux=`${dt}.align.center`,hx=`${dt}.align.right`,cx=`${dt}.align.justify`,dx=`${dt}.align.top`,fx=`${dt}.align.middle`,gx=`${dt}.align.bottom`,mx=`${dt}.borders`,px=`${dt}.borders.top`,vx=`${dt}.borders.right`,wx=`${dt}.borders.bottom`,yx=`${dt}.borders.left`,Cx=`${dt}.borders.remove`,bx=`${dt}.nestedHeaders.insertChildRow`,Sx=`${dt}.nestedHeaders.detachFromParent`,Rx=`${dt}.hideColumn`,Ex=`${dt}.showColumn`,_x=`${dt}.hideRow`,Tx=`${dt}.showRow`,si="Filters:",Pr=`${si}conditions`,By=`${Pr}.none`,xx=`${Pr}.isEmpty`,Mx=`${Pr}.isNotEmpty`,Ix=`${Pr}.isEqualTo`,Ox=`${Pr}.isNotEqualTo`,Px=`${Pr}.beginsWith`,Ax=`${Pr}.endsWith`,Hx=`${Pr}.contains`,Nx=`${Pr}.doesNotContain`,HX=`${Pr}.byValue`,kx=`${Pr}.greaterThan`,Dx=`${Pr}.greaterThanOrEqualTo`,Lx=`${Pr}.lessThan`,Fx=`${Pr}.lessThanOrEqualTo`,Wx=`${Pr}.isBetween`,Bx=`${Pr}.isNotBetween`,$x=`${Pr}.after`,Vx=`${Pr}.before`,zx=`${Pr}.today`,Ux=`${Pr}.tomorrow`,jx=`${Pr}.yesterday`,Yx=`${si}labels.filterByCondition`,Gx=`${si}labels.filterByValue`,qx=`${si}labels.conjunction`,$y=`${si}labels.disjunction`,_w=`${si}values.blankCells`,Kx=`${si}buttons.selectAll`,Xx=`${si}buttons.clear`,Zx=`${si}buttons.ok`,Qx=`${si}buttons.cancel`,Jx=`${si}buttons.placeholder.search`,eM=`${si}buttons.placeholder.value`,tM=`${si}buttons.placeholder.secondValue`,rM="CheckboxRenderer:",nM=`${rM}checked`,iM=`${rM}unchecked`,NX=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:nM,CHECKBOX_RENDERER_NAMESPACE:rM,CHECKBOX_UNCHECKED:iM,CONTEXTMENU_ITEMS_ADD_COMMENT:nx,CONTEXTMENU_ITEMS_ALIGNMENT:ax,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:gx,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:ux,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:cx,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:lx,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:fx,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:hx,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:dx,CONTEXTMENU_ITEMS_BORDERS:mx,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:wx,CONTEXTMENU_ITEMS_BORDERS_LEFT:yx,CONTEXTMENU_ITEMS_BORDERS_RIGHT:vx,CONTEXTMENU_ITEMS_BORDERS_TOP:px,CONTEXTMENU_ITEMS_CLEAR_COLUMN:G1,CONTEXTMENU_ITEMS_COPY:q1,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Z1,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:X1,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:K1,CONTEXTMENU_ITEMS_CUT:Q1,CONTEXTMENU_ITEMS_EDIT_COMMENT:ix,CONTEXTMENU_ITEMS_FREEZE_COLUMN:J1,CONTEXTMENU_ITEMS_HIDE_COLUMN:Rx,CONTEXTMENU_ITEMS_HIDE_ROW:_x,CONTEXTMENU_ITEMS_INSERT_LEFT:$1,CONTEXTMENU_ITEMS_INSERT_RIGHT:V1,CONTEXTMENU_ITEMS_MERGE_CELLS:tx,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Sx,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:bx,CONTEXTMENU_ITEMS_NO_ITEMS:F1,CONTEXTMENU_ITEMS_READ_ONLY:Ew,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:ox,CONTEXTMENU_ITEMS_REDO:Y1,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Cx,CONTEXTMENU_ITEMS_REMOVE_COLUMN:U1,CONTEXTMENU_ITEMS_REMOVE_COMMENT:sx,CONTEXTMENU_ITEMS_REMOVE_ROW:z1,CONTEXTMENU_ITEMS_ROW_ABOVE:W1,CONTEXTMENU_ITEMS_ROW_BELOW:B1,CONTEXTMENU_ITEMS_SHOW_COLUMN:Ex,CONTEXTMENU_ITEMS_SHOW_ROW:Tx,CONTEXTMENU_ITEMS_UNDO:j1,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:ex,CONTEXTMENU_ITEMS_UNMERGE_CELLS:rx,CONTEXT_MENU_ITEMS_NAMESPACE:R$,FILTERS_BUTTONS_CANCEL:Qx,FILTERS_BUTTONS_CLEAR:Xx,FILTERS_BUTTONS_OK:Zx,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Jx,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:tM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:eM,FILTERS_BUTTONS_SELECT_ALL:Kx,FILTERS_CONDITIONS_AFTER:$x,FILTERS_CONDITIONS_BEFORE:Vx,FILTERS_CONDITIONS_BEGINS_WITH:Px,FILTERS_CONDITIONS_BETWEEN:Wx,FILTERS_CONDITIONS_BY_VALUE:HX,FILTERS_CONDITIONS_CONTAINS:Hx,FILTERS_CONDITIONS_EMPTY:xx,FILTERS_CONDITIONS_ENDS_WITH:Ax,FILTERS_CONDITIONS_EQUAL:Ix,FILTERS_CONDITIONS_GREATER_THAN:kx,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Dx,FILTERS_CONDITIONS_LESS_THAN:Lx,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Fx,FILTERS_CONDITIONS_NAMESPACE:Pr,FILTERS_CONDITIONS_NONE:By,FILTERS_CONDITIONS_NOT_BETWEEN:Bx,FILTERS_CONDITIONS_NOT_CONTAIN:Nx,FILTERS_CONDITIONS_NOT_EMPTY:Mx,FILTERS_CONDITIONS_NOT_EQUAL:Ox,FILTERS_CONDITIONS_TODAY:zx,FILTERS_CONDITIONS_TOMORROW:Ux,FILTERS_CONDITIONS_YESTERDAY:jx,FILTERS_DIVS_FILTER_BY_CONDITION:Yx,FILTERS_DIVS_FILTER_BY_VALUE:Gx,FILTERS_LABELS_CONJUNCTION:qx,FILTERS_LABELS_DISJUNCTION:$y,FILTERS_NAMESPACE:si,FILTERS_VALUES_BLANK_CELLS:_w},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const E$={languageCode:"en-US",[F1]:"No available options",[W1]:"Insert row above",[B1]:"Insert row below",[$1]:"Insert column left",[V1]:"Insert column right",[z1]:["Remove row","Remove rows"],[U1]:["Remove column","Remove columns"],[j1]:"Undo",[Y1]:"Redo",[Ew]:"Read only",[G1]:"Clear column",[ax]:"Alignment",[lx]:"Left",[ux]:"Center",[hx]:"Right",[cx]:"Justify",[dx]:"Top",[fx]:"Middle",[gx]:"Bottom",[J1]:"Freeze column",[ex]:"Unfreeze column",[mx]:"Borders",[px]:"Top",[vx]:"Right",[wx]:"Bottom",[yx]:"Left",[Cx]:"Remove border(s)",[nx]:"Add comment",[ix]:"Edit comment",[sx]:"Delete comment",[ox]:"Read-only comment",[tx]:"Merge cells",[rx]:"Unmerge cells",[q1]:"Copy",[K1]:["Copy with header","Copy with headers"],[X1]:["Copy with group header","Copy with group headers"],[Z1]:["Copy header only","Copy headers only"],[Q1]:"Cut",[bx]:"Insert child row",[Sx]:"Detach from parent",[Rx]:["Hide column","Hide columns"],[Ex]:["Show column","Show columns"],[_x]:["Hide row","Hide rows"],[Tx]:["Show row","Show rows"],[By]:"None",[xx]:"Is empty",[Mx]:"Is not empty",[Ix]:"Is equal to",[Ox]:"Is not equal to",[Px]:"Begins with",[Ax]:"Ends with",[Hx]:"Contains",[Nx]:"Does not contain",[kx]:"Greater than",[Dx]:"Greater than or equal to",[Lx]:"Less than",[Fx]:"Less than or equal to",[Wx]:"Is between",[Bx]:"Is not between",[$x]:"After",[Vx]:"Before",[zx]:"Today",[Ux]:"Tomorrow",[jx]:"Yesterday",[_w]:"Blank cells",[Yx]:"Filter by condition",[Gx]:"Filter by value",[qx]:"And",[$y]:"Or",[Kx]:"Select all",[Xx]:"Clear",[Zx]:"OK",[Qx]:"Cancel",[Jx]:"Search",[eM]:"Value",[tM]:"Second value",[nM]:"Checked",[iM]:"Unchecked"},kX=NX,T_=E$.languageCode,{register:DX,getItem:_$,hasItem:LX,getValues:FX}=zs("languagesDictionaries");T$(E$);function T$(t,e){let r=t,n=e;return vt(t)&&(n=t,r=n.languageCode),WX(r,n),DX(r,$n(n)),$n(n)}function WX(t,e){t!==T_&&xX(e,_$(T_))}function x$(t){return sM(t)?$n(_$(t)):null}function sM(t){return LX(t)}function BX(){return FX()}function M$(t,e,r){const n=x$(t);if(n===null)return null;const i=n[e];if(fr(i))return null;const s=$X(i,r);return Array.isArray(s)?s[0]:s}function $X(t,e){let r=t;return te(AX(),n=>{r=n(t,e)}),r}function VX(t){let e=b$(t);return sM(e)||(e=T_,S$(t)),e}function zX(t,e,r){return(e=UX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UX(t){var e=jX(t,"string");return typeof e=="symbol"?e:e+""}function jX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ha extends n${constructor(e,r){super(e,null),zX(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((s===null||s.col===null||s.row===null)&&(a=this.getNearestNotHiddenCoords(r,n,i)),a!==null&&e.overlaps(a)){const u=e.highlight.clone();if(u.row>=0&&(u.row=a.row),u.col>=0&&(u.col=a.col),this.cellRange===null){const h=this.settings.visualToRenderableCoords(u);this.cellRange=this.settings.createCellRange(h)}e.setHighlight(u)}return this.settings.selectionType==="focus"&&s!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function cR(t){let{activeHeaderClassName:e,...r}=t;return new Ha({className:e,...r,selectionType:i$})}function YX(t){let{areaCornerVisible:e,...r}=t;return new Ha({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:C1})}function GX(t){let{...e}=t;return new Ha({className:"highlight",...e,selectionType:C1})}function qX(t){let{columnClassName:e,...r}=t;return new Ha({className:e,...r,selectionType:s9})}function KX(t){let{cellCornerVisible:e,...r}=t;return new Ha({className:"current",headerAttributes:[jT()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Rw})}function XX(t){let{border:e,visualCellRange:r,...n}=t;return new Ha({...e,...n,selectionType:o9},r)}function ZX(t){let{...e}=t;return new Ha({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:n9})}function jk(t){let{headerClassName:e,...r}=t;return new Ha({className:e,...r,selectionType:y1})}function QX(t){let{rowClassName:e,...r}=t;return new Ha({className:e,...r,selectionType:i9})}function JX(t,e){e7(t,e),e.add(t)}function e7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ui(t,e,r){return(e=t7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t7(t){var e=r7(t,"string");return typeof e=="symbol"?e:e+""}function r7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var eo=new WeakSet;class n7{constructor(e){JX(this,eo),ui(this,"options",void 0),ui(this,"layerLevel",0),ui(this,"focus",void 0),ui(this,"fill",void 0),ui(this,"layeredAreas",new Map),ui(this,"areas",new Map),ui(this,"rowHeaders",new Map),ui(this,"columnHeaders",new Map),ui(this,"activeRowHeaders",new Map),ui(this,"activeColumnHeaders",new Map),ui(this,"activeCornerHeaders",new Map),ui(this,"rowHighlights",new Map),ui(this,"columnHighlights",new Map),ui(this,"customSelections",[]),this.options=e,this.focus=KX(e),this.fill=ZX(e)}isEnabledFor(e,r){let n=e;e===Rw&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Xo(eo,this,Zo).call(this,this.layeredAreas,YX)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Xo(eo,this,Zo).call(this,this.areas,GX)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Xo(eo,this,Zo).call(this,this.rowHeaders,jk)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Xo(eo,this,Zo).call(this,this.columnHeaders,jk)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Xo(eo,this,Zo).call(this,this.activeRowHeaders,cR)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Xo(eo,this,Zo).call(this,this.activeColumnHeaders,cR)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Xo(eo,this,Zo).call(this,this.activeCornerHeaders,cR)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Xo(eo,this,Zo).call(this,this.rowHighlights,QX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Xo(eo,this,Zo).call(this,this.columnHighlights,qX)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(XX({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),te(this.areas.values(),e=>void e.clear()),te(this.layeredAreas.values(),e=>void e.clear()),te(this.rowHeaders.values(),e=>void e.clear()),te(this.columnHeaders.values(),e=>void e.clear()),te(this.activeRowHeaders.values(),e=>void e.clear()),te(this.activeColumnHeaders.values(),e=>void e.clear()),te(this.activeCornerHeaders.values(),e=>void e.clear()),te(this.rowHighlights.values(),e=>void e.clear()),te(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Zo(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function Yk(t,e,r){return(e=i7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i7(t){var e=s7(t,"string");return typeof e=="symbol"?e:e+""}function s7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o7{constructor(e){Yk(this,"ranges",[]),Yk(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function a7(t,e){I$(t,e),e.add(t)}function dR(t,e,r){I$(t,e),e.set(t,r)}function I$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e){return t.get(Zr(t,e))}function Mp(t,e,r){return t.set(Zr(t,e),r),r}function Zr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ip=new WeakMap,ar=new WeakMap,Hs=new WeakMap,an=new WeakSet;class x_{constructor(e,r){a7(this,an),dR(this,Ip,void 0),dR(this,ar,void 0),dR(this,Hs,{x:0,y:0}),Mp(Ip,this,e),Mp(ar,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ot(ar,this).createCellCoords(e,r);let s=Ot(Ip,this).current().highlight;const a=Ot(ar,this).visualToRenderableCoords(s);let u=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),a.row!==null&&a.col!==null){const{width:c,height:m}=Zr(an,this,O$).call(this),{row:p,col:v}=Zr(an,this,qk).call(this,s),y=Ot(ar,this).fixedRowsBottom(),C=Ot(ar,this).minSpareRows(),R=Ot(ar,this).minSpareCols(),_=Ot(ar,this).autoWrapRow(),x=Ot(ar,this).autoWrapCol(),I=Ot(ar,this).createCellCoords(p+i.row,v+i.col);if(I.row>=m){const B=bi(n&&C>0&&y===0),z=I.col+1,U=Ot(ar,this).createCellCoords(I.row-m,z>=c?z-c:z);this.runLocalHooks("beforeColumnWrap",B,Zr(an,this,qh).call(this,U),z>=c),B.value?this.runLocalHooks("insertRowRequire",Ot(ar,this).countRenderableRows()):x&&I.assign(U)}else if(I.row<0){const B=bi(x),z=I.col-1,U=Ot(ar,this).createCellCoords(m+I.row,z<0?c+z:z);this.runLocalHooks("beforeColumnWrap",B,Zr(an,this,qh).call(this,U),z<0),x&&I.assign(U)}if(I.col>=c){const B=bi(n&&R>0),z=I.row+1,U=Ot(ar,this).createCellCoords(z>=m?z-m:z,I.col-c);this.runLocalHooks("beforeRowWrap",B,Zr(an,this,qh).call(this,U),z>=m),B.value?this.runLocalHooks("insertColRequire",Ot(ar,this).countRenderableColumns()):_&&I.assign(U)}else if(I.col<0){const B=bi(_),z=I.row-1,U=Ot(ar,this).createCellCoords(z<0?m+z:z,c+I.col);this.runLocalHooks("beforeRowWrap",B,Zr(an,this,qh).call(this,U),z<0),_&&I.assign(U)}const{rowDir:k,colDir:W}=Zr(an,this,Gk).call(this,I);u=k,h=W,s=Zr(an,this,qh).call(this,I)}return this.runLocalHooks("afterTransformStart",s,u,h),s}transformEnd(e,r){const n=Ot(ar,this).createCellCoords(e,r),i=Ot(Ip,this).current(),s=Ot(ar,this).visualToRenderableCoords(i.highlight),a=Zr(an,this,fR).call(this,i.to.row,i.from.row),u=Zr(an,this,gR).call(this,i.to.col,i.from.col),h=i.to.clone();let c=0,m=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&a!==null&&u!==null){const{row:p,col:v}=Zr(an,this,qk).call(this,i.highlight),y=Ot(ar,this).createCellCoords(a+n.row,u+n.col),C=i.getTopStartCorner(),R=i.getTopEndCorner(),_=i.getBottomEndCorner();if(n.col<0&&u>=v&&y.col<v){const W=y.col-v;y.col=Zr(an,this,gR).call(this,C.col,R.col)+W}else if(n.col>0&&u<=v&&y.col>v){const W=Zr(an,this,gR).call(this,R.col,C.col),B=Math.max(y.col-W,1);y.col=W+B}if(n.row<0&&a>=p&&y.row<p){const W=y.row-p;y.row=Zr(an,this,fR).call(this,C.row,_.row)+W}else if(n.row>0&&a<=p&&y.row>p){const W=Zr(an,this,fR).call(this,_.row,C.row),B=Math.max(y.row-W,1);y.row=W+B}const{rowDir:x,colDir:I}=Zr(an,this,Gk).call(this,y);c=x,m=I;const k=Zr(an,this,qh).call(this,y);n.row===0&&n.col!==0?h.col=k.col:n.row!==0&&n.col===0?h.row=k.row:(h.row=k.row,h.col=k.col)}return this.runLocalHooks("afterTransformEnd",h,c,m),h}setOffsetSize(e){let{x:r,y:n}=e;Mp(Hs,this,{x:r,y:n})}resetOffsetSize(){Mp(Hs,this,{x:0,y:0})}}function Gk(t){const{width:e,height:r}=Zr(an,this,O$).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function O$(){return{width:Ot(Hs,this).x+Ot(ar,this).countRenderableColumns(),height:Ot(Hs,this).y+Ot(ar,this).countRenderableRows()}}function fR(t,e){const r=Ot(ar,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:Ot(Hs,this).y+r}function gR(t,e){const r=Ot(ar,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:Ot(Hs,this).x+r}function qk(t){const{row:e,col:r}=Ot(ar,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return Ot(ar,this).createCellCoords(Ot(Hs,this).y+e,Ot(Hs,this).x+r)}function qh(t){const e=t.clone();return e.col=t.col-Ot(Hs,this).x,e.row=t.row-Ot(Hs,this).y,Ot(ar,this).renderableToVisualCoords(e)}qt(x_,Mn);const Vy=0,zy=1,P$=2,oM=3,l7=[oM,P$],u7=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],mR=Symbol("root"),Kk=Symbol("child");function Kc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mR;if(e!==mR&&e!==Kk)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===mR;let i=Vy;if(r){const s=t[0];t.length===0?i=zy:n&&s instanceof am?i=oM:n&&Array.isArray(s)?i=Kc(s,Kk):t.length>=2&&t.length<=4&&!t.some((u,h)=>!u7[h].includes(typeof u))&&(i=P$)}return i}function kg(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!l7.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const a=t===oM;let u=a?s.from.row:s[0],h=a?s.from.col:s[1],c=a?s.to.row:s[2],m=a?s.to.col:s[3];if(typeof i=="function"&&(typeof h=="string"&&(h=i(h)),typeof m=="string"&&(m=i(m))),fr(c)&&(c=u),fr(m)&&(m=h),!n){const y=u,C=h,R=c,_=m;u=Math.min(y,R),h=Math.min(C,_),c=Math.max(y,R),m=Math.max(C,_)}const p=e(u,h),v=e(c,m);return r(p,p,v)}}function h7(t){const e=Kc(t.getSelected());if(e===Vy||e===zy)return[];const r=kg(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;te(t.getSelected(),a=>{const{from:u,to:h}=r(a),c=Math.max(u.col,0),m=h.col-c+1;te(Array.from(new Array(m),(p,v)=>c+v),p=>{n.has(p)||n.add(p)})});const i=Array.from(n).sort((a,u)=>a-u);return Gr(i,(a,u,h,c)=>(h!==0&&u===c[h-1]+1?a[a.length-1][1]+=1:a.push([u,1]),a),[])}function c7(t){const e=Kc(t.getSelected());if(e===Vy||e===zy)return[];const r=kg(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;te(t.getSelected(),a=>{const{from:u,to:h}=r(a),c=Math.max(u.row,0),m=h.row-c+1;te(Array.from(new Array(m),(p,v)=>c+v),p=>{n.has(p)||n.add(p)})});const i=Array.from(n).sort((a,u)=>a-u);return Gr(i,(a,u,h,c)=>(h!==0&&u===c[h-1]+1?a[a.length-1][1]+=1:a.push([u,1]),a),[])}function Kh(t,e,r){d7(t,e),e.set(t,r)}function d7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function su(t,e,r){return(e=f7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f7(t){var e=g7(t,"string");return typeof e=="symbol"?e:e+""}function g7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hr(t,e){return t.get(A$(t,e))}function to(t,e,r){return t.set(A$(t,e),r),r}function A$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pn=new WeakMap,ou=new WeakMap,Op=new WeakMap,mf=new WeakMap,Pp=new WeakMap,pf=new WeakMap;class H${constructor(e,r){var n=this;su(this,"settings",void 0),su(this,"tableProps",void 0),su(this,"inProgress",!1),su(this,"selectedRange",new o7((i,s,a)=>this.tableProps.createCellRange(i,s,a))),su(this,"highlight",void 0),Kh(this,Pn,void 0),Kh(this,ou,void 0),su(this,"selectedByRowHeader",new Set),su(this,"selectedByColumnHeader",new Set),Kh(this,Op,!1),Kh(this,mf,!1),Kh(this,Pp,"unknown"),Kh(this,pf,-1),this.settings=e,this.tableProps=r,this.highlight=new n7({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[jT()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,a)=>this.tableProps.createCellRange(i,s,a)}),to(Pn,this,new x_(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),to(ou,this,new x_(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),hr(Pn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformStart",...s)}),hr(Pn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("afterModifyTransformStart",...s)}),hr(Pn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),hr(Pn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("afterModifyTransformEnd",...s)}),hr(Pn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("insertRowRequire",...s)}),hr(Pn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("insertColRequire",...s)}),hr(Pn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeRowWrap",...s)}),hr(Pn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeColumnWrap",...s)}),hr(ou,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),hr(ou,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){to(Pp,this,e)}markEndSource(){to(Pp,this,"unknown")}getSelectionSource(){return hr(Pp,this)}setExpectedLayers(e){to(pf,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,to(pf,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",a=fr(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,u=e.clone();to(Op,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,u),(!s||s&&!a&&fr(r))&&this.selectedRange.clear(),this.selectedRange.add(u).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!s||i===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const h=a.getHorizontalDirection(),c=a.getVerticalDirection(),m=this.isMultiple();a.setTo(r),m&&(h!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),m&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const u=hr(pf,this)===-1||this.selectedRange.size()===hr(pf,this);this.runLocalHooks("afterSetRangeEnd",e,u)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(te(this.highlight.getAreas(),C=>void C.clear()),te(this.highlight.getLayeredAreas(),C=>void C.clear()),te(this.highlight.getRowHeaders(),C=>void C.clear()),te(this.highlight.getColumnHeaders(),C=>void C.clear()),te(this.highlight.getActiveRowHeaders(),C=>void C.clear()),te(this.highlight.getActiveColumnHeaders(),C=>void C.clear()),te(this.highlight.getActiveCornerHeaders(),C=>void C.clear()),te(this.highlight.getRowHighlights(),C=>void C.clear()),te(this.highlight.getColumnHighlights(),C=>void C.clear())),this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),a=this.highlight.createLayeredArea(),u=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),m=this.highlight.createActiveColumnHeader(),p=this.highlight.createActiveCornerHeader(),v=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(s.clear(),a.clear(),u.clear(),h.clear(),c.clear(),m.clear(),p.clear(),v.clear(),y.clear(),this.highlight.isEnabledFor(C1,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),r===1)){const C=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(C.from).commit().syncWith(C),this.highlight.createLayeredArea().add(C.from).commit().syncWith(C),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(y1,e.highlight)){if(!e.isSingleHeader()){const _=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),x=this.tableProps.createCellCoords(e.to.row,-1),I=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),k=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(u.add(_).commit(),h.add(I).commit(),v.add(_).commit(),y.add(I).commit()):(u.add(_).add(x).commit(),h.add(I).add(k).commit(),v.add(_).add(x).commit(),y.add(I).add(k).commit())}const C=!hr(mf,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),R=!hr(mf,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());C&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),R&&m.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),C&&R&&p.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Rw,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(to(Op,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?hr(Pn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):hr(Pn,this).resetOffsetSize(),this.setRangeStart(hr(Pn,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?hr(Pn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):hr(Pn,this).resetOffsetSize(),this.setRangeEnd(hr(Pn,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:s}=n.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,s-1),u=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?hr(ou,this).setOffsetSize({x:s<0?Math.abs(s):-a,y:i<0?Math.abs(i):-u}):hr(ou,this).setOffsetSize({x:s<0?0:-a,y:i<0?0:-u});const h=hr(ou,this).transformStart(e,r);this.setRangeFocus(h.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:a}=n,u=this.tableProps.countRows(),h=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),m=c?-1:0,p=c?0:r;this.getSelectedRange().pop();const v=this.tableProps.createCellCoords(_t(i.row+p,m,u-1),i.col),y=this.tableProps.createCellCoords(_t(s.row+r,m,u-1),s.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(v,!0,this.tableProps.createCellCoords(_t(a.row+r,0,u-1),a.col)):this.setRangeStartOnly(v,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:a}=n,u=this.tableProps.countCols(),h=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),m=h?-1:0,p=h?0:r;this.getSelectedRange().pop();const v=this.tableProps.createCellCoords(i.row,_t(i.col+p,m,u-1)),y=this.tableProps.createCellCoords(s.row,_t(s.col+r,m,u-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(v,!0,this.tableProps.createCellCoords(a.row,_t(a.col+r,0,u-1))):this.setRangeStartOnly(v,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=bi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&hr(Op,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:s}=i.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),u=this.tableProps.countCols();return(a>0&&s<0||a===0)&&i.getWidth()===u};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:s}=i.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),u=this.tableProps.countRows();return(a>0&&s<0||a===0)&&i.getHeight()===u};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),a=this.tableProps.countCols(),u=this.tableProps.countRowHeaders(),h=this.tableProps.countColHeaders(),c=n?-h:0,m=r?-u:0;if(c===0&&m===0&&(s===0||a===0))return;let p=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:v,disableHeadersHighlight:y}=i;to(mf,this,y),v&&Number.isInteger(v==null?void 0:v.row)&&Number.isInteger(v==null?void 0:v.col)&&(p=this.tableProps.createCellCoords(_t(v.row,c,s-1),_t(v.col,m,a-1)));const C=this.tableProps.createCellCoords(c,m),R=this.tableProps.createCellCoords(s-1,a-1);this.clear(),this.setRangeStartOnly(C,void 0,p),m<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.finish(),to(mf,this,!1)}selectCells(e){var r=this;const n=Kc(e);if(n===zy)return!1;if(n===Vy)throw new Error(Gt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=kg(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:h=>this.tableProps.propToCol(h),keepDirection:!0}),s=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},u=!e.some(h=>{const c=i(h),m=c.isValid(a);return!(m&&!c.containsHeaders()||m&&c.containsHeaders()&&c.isSingleHeader())});return u&&(this.clear(),this.setExpectedLayers(e.length),te(e,h=>{const{from:c,to:m}=i(h);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(m.clone())}),this.finish()),u}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,a=this.tableProps.countRows(),u=this.tableProps.countCols(),h=this.tableProps.countColHeaders(),c=h===0?0:-h,m=this.tableProps.createCellCoords(c,i),p=this.tableProps.createCellCoords(a-1,s),v=this.tableProps.createCellRange(m,m,p).isValid({countRows:a,countCols:u,countRowHeaders:0,countColHeaders:h});if(v){let y=0,C=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(y=_t(n.row,c,a-1),C=_t(n.col,Math.min(i,s),Math.max(i,s))):(y=_t(n,c,a-1),C=i);const R=this.tableProps.createCellCoords(y,C),_=h===0?0:_t(R.row,c,-1),x=a-1,I=this.tableProps.createCellCoords(_,i),k=this.tableProps.createCellCoords(x,s);this.runLocalHooks("beforeSelectColumns",I,k,R),I.row=_,k.row=x,this.setRangeStartOnly(I,void 0,R),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(k),this.runLocalHooks("afterSelectColumns",I,k,R),this.finish()}return v}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),u=a===0?0:-a,h=this.tableProps.createCellCoords(e,u),c=this.tableProps.createCellCoords(r,s-1),m=this.tableProps.createCellRange(h,h,c).isValid({countRows:i,countCols:s,countRowHeaders:a,countColHeaders:0});if(m){let p=0,v=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(p=_t(n.row,Math.min(e,r),Math.max(e,r)),v=_t(n.col,u,s-1)):(p=e,v=_t(n,u,s-1));const y=this.tableProps.createCellCoords(p,v),C=a===0?0:_t(y.col,u,-1),R=s-1,_=this.tableProps.createCellCoords(e,C),x=this.tableProps.createCellCoords(r,R);this.runLocalHooks("beforeSelectRows",_,x,y),_.col=C,x.col=R,this.setRangeStartOnly(_,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(x),this.runLocalHooks("afterSelectRows",_,x,y),this.finish()}return m}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:a}=n;this.clear(),a.assign({row:_t(a.row,-1/0,e-1),col:_t(a.col,-1/0,r-1)}),i.assign({row:_t(i.row,-1/0,e-1),col:_t(i.col,-1/0,r-1)}),s.assign({row:_t(s.row,0,e-1),col:_t(s.col,0,r-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(a).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(Rw,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),a=this.highlight.createLayeredArea(),u=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),m=this.highlight.createActiveColumnHeader(),p=this.highlight.createActiveCornerHeader(),v=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();s.commit(),a.commit(),u.commit(),h.commit(),c.commit(),m.commit(),p.commit(),v.commit(),y.commit()}this.highlight.useLayerLevel(r)}}qt(H$,Mn);const Xk=/^(\r\n|\n\r|\r|\n)/,m7=/^[^\t\r\n]+/,Zk=/^\t/;function p7(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(Zk))t=t.replace(Zk,""),r+=1,e[n][r]="";else if(t.match(Xk))t=t.replace(Xk,""),r=0,n+=1,e[n]=[""];else{let s="";if(t.startsWith('"')){let a=0,u=!0;for(;u;){const h=t.slice(0,1);h==='"'&&(a+=1),s+=h,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(u=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,h=>new Array(Math.floor(h.length/2)).fill('"').join(""))}else{const a=t.match(m7);s=a?a[0]:"",t=t.slice(s.length)}e[n][r]=s}return e}function ug(t){let e,r,n,i,s="",a;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),a=t[e][n],typeof a=="string"?a.indexOf(`
`)>-1?s+=`"${a.replace(/"/g,'""')}"`:s+=a:a==null?s+="":s+=a;e!==r-1&&(s+=`
`)}return s}function au(t,e,r){return(e=v7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v7(t){var e=w7(t,"string");return typeof e=="symbol"?e:e+""}function w7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ac{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){au(this,"hot",void 0),au(this,"metaManager",void 0),au(this,"tableMeta",void 0),au(this,"dataSource",void 0),au(this,"duckSchema",void 0),au(this,"colToPropCache",void 0),au(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,a=!1;if(typeof r=="function"){const u=Py(e);i=u>0?u:this.countFirstRowKeys(),a=!0}else{const u=this.tableMeta.maxCols;i=Math.min(u,r.length)}for(n=0;n<i;n++){const u=a?r(n):r[n];if(vt(u)){if(typeof u.data<"u"){const h=a?s:n;this.colToPropCache[h]=u.data,this.propToColCache.set(u.data,h)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return P1(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,a;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&wt(e,(u,h)=>{u===null?(a=s+h,this.colToPropCache.push(a),this.propToColCache.set(a,i),i+=1):i=this.recursiveDuckColumns(u,i,`${h}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&Ue(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(Ue(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Gc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let a=s,u=0,h=e;if((typeof h!="number"||h>=s)&&(h=s),h<this.hot.countRows()&&(a=this.hot.toPhysicalRow(h)),this.hot.runHooks("beforeCreateRow",h,r,n)===!1||a===null)return{delta:0};const m=this.tableMeta.maxRows,p=this.getSchema().length,v=[];for(;u<r&&s+u<m;){let C=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?C=$n(this.getSchema()):(C=[],Xe(p-1,()=>C.push(null))):this.hot.dataType==="function"?C=this.tableMeta.dataSchema(h+u):(C={},sm(C,this.getSchema())),v.push(C),u+=1}this.hot.rowIndexMapper.insertIndexes(h,u),i==="below"&&(a=Math.min(a+1,s)),this.spliceData(a,0,v);const y=this.hot.toVisualRow(a);return this.hot.countSourceRows()===v.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),u>0&&(e==null?this.metaManager.createRow(null,u):n!=="auto"&&this.metaManager.createRow(a,r)),this.hot.runHooks("afterCreateRow",y,u,n),this.hot.forceFullRender=!0,{delta:u,startPhysicalIndex:a}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,a=this.tableMeta.maxCols,u=this.hot.countSourceCols();let h=e;if((typeof h!="number"||h>=u)&&(h=u),this.hot.runHooks("beforeCreateCol",h,r,n)===!1)return{delta:0};let m=u;h<this.hot.countCols()&&(m=this.hot.toPhysicalColumn(h));const p=this.hot.countSourceRows();let v=this.hot.countCols(),y=0,C=m;i==="end"&&(C=Math.min(C+1,u));const R=C;for(;y<r&&v<a;){if(typeof h!="number"||h>=v)if(p>0)for(let x=0;x<p;x+=1)typeof s[x]>"u"&&(s[x]=[]),s[x].push(null);else s.push([null]);else for(let x=0;x<p;x++)s[x].splice(C,0,null);y+=1,C+=1,v+=1}this.hot.columnIndexMapper.insertIndexes(h,y),y>0&&(e==null?this.metaManager.createColumn(null,y):n!=="auto"&&this.metaManager.createColumn(R,r));const _=this.hot.toVisualColumn(R);return this.hot.runHooks("afterCreateCol",_,y,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:y,startPhysicalIndex:R}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),a=this.hot.countSourceRows();if(i=(a+i)%a,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const h=s.length;if(this.filterData(i,h,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const m=Ue(this.tableMeta.columns)||Ue(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&m===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((m,p)=>p-m).forEach(m=>{this.metaManager.removeRow(m,1)}),this.hot.runHooks("afterRemoveRow",i,h,s,n),this.hot.forceFullRender=!0,!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,r),a=s.slice(0).sort((p,v)=>v-p);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let h=!0;const c=a.length,m=this.dataSource;for(let p=0;p<c;p++)h&&s[0]!==s[p]-p&&(h=!1);if(h)for(let p=0,v=this.hot.countSourceRows();p<v;p++)m[p].splice(s[0],r),p===0&&this.metaManager.removeColumn(s[0],r);else for(let p=0,v=this.hot.countSourceRows();p<v;p++)for(let y=0;y<c;y++)m[p].splice(a[y],1),p===0&&this.metaManager.removeColumn(a[y],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),a=i.slice(r+n);for(var u=arguments.length,h=new Array(u>3?u-3:0),c=3;c<u;c++)h[c-3]=arguments[c];a_(h,a);let m=0;for(;m<n;)h.push(null),m+=1;return KW(h),this.hot.populateFromArray(r,e,h,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),a=i.slice(r+n);for(var u=arguments.length,h=new Array(u>3?u-3:0),c=3;c<u;c++)h[c-3]=arguments[c];a_(h,a);let m=0;for(;m<n;)h.push(null),m+=1;return this.hot.populateFromArray(e,r,[h],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(a=>this.dataSource.push(a))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,a)=>n.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;const{dataDotNotation:a}=this.hot.getSettings();let u=null;if(i&&i.hasOwnProperty&&Ur(i,r))u=i[r];else if(a&&typeof r=="string"&&r.indexOf(".")>-1){let h=i;if(!h)return null;const c=r.split(".");for(let m=0,p=c.length;m<p;m++)if(h=h[c[m]],typeof h>"u")return null;u=h}else typeof r=="function"&&(u=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const h=bi(u);this.hot.runHooks("modifyData",n,this.propToCol(r),h,"get"),h.isTouched()&&(u=h.value)}return u}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let s=n,a=this.dataSource[i];const u=this.hot.runHooks("modifyRowData",i);if(a=isNaN(u)?u:a,this.hot.hasHook("modifyData")){const c=bi(s);this.hot.runHooks("modifyData",i,this.propToCol(r),c,"set"),c.isTouched()&&(s=c.value)}const{dataDotNotation:h}=this.hot.getSettings();if(a&&a.hasOwnProperty&&Ur(a,r))a[r]=s;else if(h&&typeof r=="string"&&r.indexOf(".")>-1){let c=a,m=0,p;const v=r.split(".");for(m=0,p=v.length-1;m<p;m++)typeof c[v[m]]>"u"&&(c[v[m]]={}),c=c[v[m]];c[v[m]]=s}else typeof r=="function"?r(this.dataSource.slice(i,i+1)[0],s):a[r]=s}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let s=(n+e)%n,a=r,u;for(;s<n&&a;)u=this.hot.toPhysicalRow(s),i.push(u),a-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let s=(n+e)%n,a=r;for(;s<n&&a;){const u=this.hot.toPhysicalColumn(s);i.push(u),a-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Ac.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,a,u;const h=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(h===0||c===0)return[];const m=n===Ac.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,p=Math.min(Math.max(h-1,0),Math.max(e.row,r.row)),v=Math.min(Math.max(c-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=p;s++){u=[];const y=s>=0?this.hot.toPhysicalRow(s):s;for(a=Math.min(e.col,r.col);a<=v&&y!==null;a++)u.push(m.call(this,s,this.colToProp(a)));y!==null&&i.push(u)}return i}getText(e,r){return ug(this.getRange(e,r,Ac.DESTINATION_RENDERER))}getCopyableText(e,r){return ug(this.getRange(e,r,Ac.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:y7,getItem:C7,hasItem:N$,getNames:b7,getValues:Wge}=zs("cellTypes");function aM(t){if(!N$(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return C7(t)}function ji(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&mi(t,r),n&&Pi(t,n),i&&$u(t,i),y7(t,e)}function S7(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Ur(e,t)}function Uy(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?aM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&wt(e,(s,a)=>void t._automaticallyAssignedMetaProps.delete(a)),!vt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};wt(n,(s,a)=>{if(S7(a,r)){var u;i[a]=s,(u=t._automaticallyAssignedMetaProps)===null||u===void 0||u.add(a)}}),jr(t,i)}function R7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Vs(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Kv(t){return Number.isInteger(t)&&t>=0}function Xv(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Ap(t){return t==null}const k$=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Ir(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Ir(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),Oy(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function Qk(t,e,r){return(e=E7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E7(t){var e=_7(t,"string");return typeof e=="symbol"?e:e+""}function _7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T7(){return class{}}class x7{constructor(e){Qk(this,"metaCtor",T7()),Qk(this,"meta",void 0),this.meta=this.metaCtor.prototype,jr(this.meta,k$()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;jr(this.meta,e),Uy(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function M7(t,e,r){return(e=I7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I7(t){var e=O7(t,"string");return typeof e=="symbol"?e:e+""}function O7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P7{constructor(e){M7(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){jr(this.meta,e),Uy(this.meta,e,e)}}function Hp(t,e,r){return(e=A7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A7(t){var e=H7(t,"string");return typeof e=="symbol"?e:e+""}function H7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tw{constructor(e){Hp(this,"valueFactory",void 0),Hp(this,"data",[]),Hp(this,"index",[]),Hp(this,"holes",new Set),this.valueFactory=e}obtain(e){Xv(()=>Kv(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Xv(()=>Kv(e)||Ap(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let a=0;a<r;a++)n.push(i+a),this.data.push(void 0);const s=Ap(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Xv(()=>Kv(e)||Ap(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Ap(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return Ta(this.data,(e,r)=>!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function Jk(t,e,r){return(e=N7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N7(t){var e=k7(t,"string");return typeof e=="symbol"?e:e+""}function k7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const D7=["data","width"];class L7{constructor(e){Jk(this,"globalMeta",void 0),Jk(this,"metas",new Tw(()=>this._createMeta())),this.globalMeta=e,this.metas=new Tw(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);jr(n,r),Uy(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return R7(this.globalMeta.getMetaConstructor(),D7).prototype}}function eD(t,e,r){return(e=F7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F7(t){var e=W7(t,"string");return typeof e=="symbol"?e:e+""}function W7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B7{constructor(e){eD(this,"columnMeta",void 0),eD(this,"metas",new Tw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);jr(i,n),Uy(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const a=this.metas.obtain(e).obtain(r);(s=a._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),a[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)Ue(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Xv(()=>Kv(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Tw(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class D${constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new x7(e),this.tableMeta=new P7(this.globalMeta),this.columnMeta=new L7(this.globalMeta),this.cellMeta=new B7(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){let{visualRow:i,visualColumn:s}=n;const a=this.cellMeta.getMeta(e,r);return a.visualRow=i,a.visualCol=s,a.row=e,a.col=r,this.runLocalHooks("afterGetCellMeta",a),a}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}qt(D$,Mn);function tD(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:a,internalSource:u,source:h,metaManager:c,firstRun:m}=n,p=Bn(u),v=i.getSettings();Array.isArray(v.dataSchema)?i.dataType="array":nr(v.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${p}`,t,m,h);const y=new Ac(i,t,c);if(e(y),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const C=y.getSchema();t=[];let R,_=0,x=0;for(_=0,x=v.startRows;_<x;_++)if((i.dataType==="object"||i.dataType==="function")&&v.dataSchema)R=$n(C),t.push(R);else if(i.dataType==="array")R=$n(C[0]),t.push(R);else{R=[];for(let I=0,k=v.startCols;I<k;I++)R.push(null);t.push(R)}}else throw new Error(`${u} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),v.data=t,y.dataSource=t,a.data=t,a.dataType=i.dataType,a.colToProp=y.colToProp.bind(y),a.propToCol=y.propToCol.bind(y),a.countCachedColumns=y.countCachedColumns.bind(y),r(y),i.runHooks(`after${p}`,t,m,h),m||(i.runHooks("afterChange",null,u),i.render()),i.getSettings().ariaTags&&it(i.rootElement,[nB(-1),Ey(i.countCols()+(i.view?i.countRowHeaders():0))])}function rD(t,e,r){return(e=$7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $7(t){var e=V7(t,"string");return typeof e=="symbol"?e:e+""}function V7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z7{constructor(e){rD(this,"metaManager",void 0),rD(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),ze.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:a}=e,u=this.metaManager.hot,h=u.colToProp(a);e.prop=h,u.runHooks("beforeGetCellMeta",s,a,e);const c=Ur(e,"type")?e.type:null;let m=nr(e.cells)?e.cells(n,i,h):null;if(c)if(m){var p;m.type=(p=m.type)!==null&&p!==void 0?p:c}else m={type:c};m&&this.metaManager.updateCellMeta(n,i,m),u.runHooks("afterGetCellMeta",s,a,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function U7(t,e,r){j7(t,e),e.set(t,r)}function j7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pR(t,e,r){return(e=Y7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y7(t){var e=G7(t,"string");return typeof e=="symbol"?e:e+""}function G7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q7(t,e){return t.get(K7(t,e))}function K7(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var nD=new WeakMap;class X7{constructor(e){pR(this,"metaManager",void 0),pR(this,"usageTracker",new Set),pR(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),U7(this,nD,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:s}=e,a=typeof i=="string",u=a?i:r,h=`_${u}`;this.metaManager.globalMeta.meta[h]=this.metaManager.globalMeta.meta[u],s?(this.installPropWatcher(r,h,s),a&&this.installPropWatcher(i,h,s)):n&&(this.installPropWatcher(r,h,q7(nD,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const a=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,a),this[r]=s},enumerable:!0,configurable:!0})}}const L$="gridDefault",Wl="editorManager.handlingEditor",Z7={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Q7="hooksRefRegisterer",F$={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){te(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){wt(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Do(F$,"MIXIN_NAME",Q7,{writable:!1,enumerable:!1});function vs(t,e,r){return(e=J7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J7(t){var e=eZ(t,"string");return typeof e=="symbol"?e:e+""}function eZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tZ="base",Dr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class dd{static get EDITOR_TYPE(){return tZ}constructor(e){vs(this,"hot",void 0),vs(this,"state",Dr.VIRGIN),vs(this,"_opened",!1),vs(this,"_fullEditMode",!1),vs(this,"_closeCallback",null),vs(this,"TD",null),vs(this,"row",null),vs(this,"col",null),vs(this,"prop",null),vs(this,"originalValue",null),vs(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,a){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=a,this.state=this.isOpened()?this.state:Dr.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,a;if(r){const h=this.hot.getSelectedLast();n=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),s=Math.max(h[0],h[2]),a=Math.max(h[1],h[3])}else[n,i,s,a]=[this.row,this.col,null,null];const u=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(u)&&([n,i]=u),this.hot.populateFromArray(n,i,e,s,a,"edit")}beginEditing(e,r){if(this.state!==Dr.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),a=()=>{if(this.state=Dr.EDITING,this.isInFullEditMode()){const h=typeof e=="string"?e:Mr(this.originalValue);this.setValue(h)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",a),n.view.scrollViewport(n._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",a),a())}finishEditing(e,r,n){let i;if(n){const s=this._closeCallback;this._closeCallback=a=>{s&&s(a),n(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Dr.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Dr.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=Dr.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=Dr.FINISHED,this.discardEditor(a)}):(this.state=Dr.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Dr.FINISHED,this.discardEditor()}discardEditor(e){this.state===Dr.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Dr.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Dr.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Dr.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,a=un(r),u=Fr(r),h=un(this.hot.rootElement),c=Fr(this.hot.rootElement),m=n.topOverlay.holder,p=n.inlineStartOverlay.holder,v=m!==s?m.scrollTop:0,y=p!==s?p.scrollLeft:0,C=s.innerWidth-h.left-c,{wtTable:R}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,_=R.name,x=["master","inline_start"].includes(_)?v:0,I=["master","top","bottom"].includes(_)?y:0,k=a.top===h.top?0:1;let W=a.top-h.top-k-x,B=0;this.hot.isRtl()?B=s.innerWidth-a.left-u-C-1+I:B=a.left-h.left-1-I,["top","top_inline_start_corner"].includes(_)&&(W+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(_)&&(B+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const z=this.hot.hasColHeaders(),U=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),J=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ne=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(z&&U<=0||U===ne)&&(W+=1),J<=0&&(B+=1);const fe=i.rowsRenderCalculator.startPosition,j=i.columnsRenderCalculator.startPosition,ae=Math.abs(n.inlineStartOverlay.getScrollPosition()),P=n.topOverlay.getScrollPosition(),ie=bn(this.hot.rootDocument);let Le=r.offsetTop;if(["inline_start","master"].includes(_)&&(Le+=fe-P),["bottom","bottom_inline_start_corner"].includes(_)){const{wtViewport:ge,wtTable:Se}=n.bottomOverlay.clone;Le+=ge.getWorkspaceHeight()-Se.getHeight()-ie}let me=r.offsetLeft;this.hot.isRtl()?(me>=0?me=R.getWidth()-r.offsetLeft:me=Math.abs(me),me+=j-ae-u):["top","master","bottom"].includes(_)&&(me+=j-ae);const Ae=s.getComputedStyle(this.TD),ve=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Be=parseInt(Ae[ve],10)>0?0:1,E=parseInt(Ae.borderTopWidth,10)>0?0:1,M=Fr(r)+Be,D=Or(r)+E,$=vB(m)?ie:0,X=wB(p)?ie:0,ce=this.hot.view.maximumVisibleElementWidth(me)-$+Be,we=Math.max(this.hot.view.maximumVisibleElementHeight(Le)-X+E,this.hot.view.getDefaultRowHeight());return{top:W,start:B,height:D,maxHeight:we,width:M,maxWidth:ce}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}qt(dd,F$);const rZ={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===Dr.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},nZ={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},iZ={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},sZ={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},oZ={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const a=t.getSettings(),u=typeof a.enterMoves=="function"?a.enterMoves(e):a.enterMoves;r.includes("shift")?t.selection.transformFocus(-u.row,-u.col):t.selection.transformFocus(u.row,u.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),ls(e))}};function aZ(){return[Z7,rZ,nZ,iZ,sZ,oZ]}const lZ={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},uZ={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(n!==null){const i=t._createCellCoords(n,e.col),s=e.row-t.getFirstFullyVisibleRow(),a=Math.min(i.row-s,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}},hZ={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},cZ={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},dZ={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(r.col,n.col,e)}},fZ={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),a=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||a){const u=r.getNearestNotHiddenIndex(t.countRows()-1,-1),h=i.clone();h.row=n.row,e.setRangeStart(h,void 0,!1,n.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(u,s.col))}}},gZ={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const a=r.getNearestNotHiddenIndex(t.countCols()-1,-1),u=i.clone();u.col=n.col,e.setRangeStart(u,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},mZ={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const a=parseInt(t.getSettings().fixedColumnsStart,10),u=r.getNearestNotHiddenIndex(a,1),h=i.clone();h.col=n.col,e.setRangeStart(h,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,u))}}},pZ={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),a=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||a){const u=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),h=i.clone();h.col=n.col,e.setRangeStart(h,void 0,!1,n.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,u))}}},vZ={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),a=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||a){const u=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),h=i.clone();h.col=n.col,e.setRangeStart(h,void 0,!1,n.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,u))}}},wZ={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),a=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||a){const u=r.getNearestNotHiddenIndex(0,1),h=i.clone();h.row=n.row,e.setRangeStart(h,void 0,!1,n.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(u,s.col))}}},yZ={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(r.row,n.row,e)}},CZ={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},bZ={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(n!==null){const i=t._createCellCoords(n,e.col),s=e.row-t.getFirstFullyVisibleRow(),a=Math.max(i.row-s,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}};function SZ(){return[lZ,uZ,hZ,cZ,dZ,fZ,gZ,mZ,pZ,vZ,wZ,yZ,CZ,bZ]}const RZ={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},EZ={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+r;n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},_Z={name:"moveCellSelectionInlineEnd",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},TZ={name:"moveCellSelectionInlineStart",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},xZ={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},MZ={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},IZ={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),t.selection.setRangeStart(t._createCellCoords(r,e))}},OZ={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),a=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,a))}},PZ={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},AZ={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,s))}},HZ={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},NZ={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},kZ={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(r,e))}},DZ={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(i,1),u=n.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(a,u))}},LZ={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},FZ={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+r);n===-r?i=-1:n+i<r&&(i=-(n+r)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function WZ(){return[RZ,EZ,_Z,TZ,xZ,MZ,IZ,OZ,PZ,AZ,HZ,NZ,kZ,DZ,LZ,FZ]}const BZ={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},$Z={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,a=t._createCellCoords(r,n),u=t._createCellCoords(i,s);if(!t._createCellRange(a,a,u).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const m=Math.floor(t.countVisibleCols()/2);c.col=Math.max(e.col-m,0)}if(e.row>=0){const m=Math.floor(t.countVisibleRows()/2);c.row=Math.max(e.row-m,0)}t.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},VZ={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},zZ={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},UZ={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let a=0;a<e.length;a++)e[a].forAll((u,h)=>{if(u>=0&&h>=0&&(u!==r||h!==n)){const{readOnly:c}=t.getCellMeta(u,h);c||s.set(`${u}x${h}`,[u,h,i])}});t.setDataAtCell(Array.from(s.values()))}},jZ=[...aZ(),...SZ(),...WZ(),BZ,$Z,VZ,zZ,UZ];function W$(t){const e={};return jZ.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return i(t,...a)}}),e}function YZ(t){const e=t.getShortcutManager().addContext("editor"),r=W$(t),n={group:Wl};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function GZ(t){const e=t.getShortcutManager().addContext("grid"),r=W$(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return Ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:L$};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:Wl,runOnlyIf:()=>Ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function qZ(t){[GZ,YZ].forEach(e=>e(t))}function KZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=iD(t),i=iD(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function iD(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&it(r,[Io(),Ll()]),r}function XZ(t){const e=ZZ(t);let r;const{activate:n,deactivate:i}=KZ(t,{onFocusFromTop(){var p;const v=(p=e(r))!==null&&p!==void 0?p:M_(t);v&&(t.runHooks("modifyFocusOnTabNavigation","from_above",v),t.selectCell(v.row,v.col)),t.listen()},onFocusFromBottom(){var p;const v=(p=e(r))!==null&&p!==void 0?p:I_(t);v&&(t.runHooks("modifyFocusOnTabNavigation","from_below",v),t.selectCell(v.row,v.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let a=!0,u=!1,h=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(p,v,y,C,R)=>{if(u&&(s.wrapped&&s.flipped||h)&&(h=!1,R.value=!0),a){var _;r=(_=t.getSelectedRangeLast())===null||_===void 0?void 0:_.highlight}}),t.addHook("beforeRowWrap",(p,v,y)=>{s.wrapped=!0,s.flipped=y});function c(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const m={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:L$,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...m,callback:()=>{const{tabNavigation:p}=t.getSettings();u=!0,t.getSelectedRangeLast()&&!p&&(a=!1),p||(h=!0)},position:"before"},{...m,callback:p=>{const{tabNavigation:v,autoWrapRow:y}=t.getSettings();if(u=!1,a=!0,!v||!t.selection.isSelected()||y&&s.wrapped&&s.flipped||!y&&s.wrapped)return y&&s.wrapped&&s.flipped&&(r=p.shiftKey?M_(t):I_(t)),c(),!1;p.preventDefault()},position:"after"}])}function M_(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function I_(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let a=n.getRenderableIndexesLength()-1,u=i.getRenderableIndexesLength()-1;if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}if(u<0){if(!s||t.countColHeaders()===0)return null;u=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(a))!==null&&e!==void 0?e:a,(r=i.getVisualFromRenderableIndex(u))!==null&&r!==void 0?r:u)}function ZZ(t){return e=>{if(!e)return null;const r=M_(t),n=I_(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function QZ(t){return e=>{let{col:r}=e;t.scrollViewportTo({col:r})}}function JZ(){return()=>{}}function eQ(t){return e=>{t.scrollViewportTo(e.toObject())}}function tQ(t){return e=>{t.scrollViewportTo(e.toObject())}}function rQ(t){return e=>{t.scrollViewportTo(e.toObject())}}function nQ(t){return e=>{let{row:r}=e;t.scrollViewportTo({row:r})}}function iQ(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e;if(n<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&n>=0)t.scrollViewportTo({row:n});else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i})}}}function sQ(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let a;e.isFocusSelectionChanged()?a=eQ(t):e.isSelectedByCorner()?a=JZ():e.isSelectedByRowHeader()?a=nQ(t):e.isSelectedByColumnHeader()?a=QZ(t):e.getSelectedRange().size()===1&&e.isMultiple()?a=tQ(t):e.getSelectedRange().size()===1&&!e.isMultiple()?a=iQ(t):e.getSelectedRange().size()>1&&(a=rQ(t)),(s=a)===null||s===void 0||s(i)}}}const sD=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Np=t=>t.map(e=>{const r=e.toLowerCase();return sD.has(r)?sD.get(r):r}).sort().join("+"),oQ=t=>t.split("+"),oD=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),vR=t=>{let{which:e,key:r}=t;if(oD.has(e))return oD.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},B$=Symbol("shortcut-context");function $$(t){return vt(t)&&t.__kindOf===B$}const aQ=t=>{const e=Ny({errorIdExists:h=>`The "${h}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:h,callback:c,group:m,runOnlyIf:p=()=>!0,captureCtrl:v=!1,preventDefault:y=!0,stopPropagation:C=!1,relativeToGroup:R,position:_,forwardToContext:x}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(fr(m))throw new Error("You need to define the shortcut's group.");if(nr(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(h)===!1)throw new Error(Gt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const I={callback:c,group:m,runOnlyIf:p,captureCtrl:v,preventDefault:y,stopPropagation:C};Ue(R)&&(I.relativeToGroup=R,I.position=_),$$(x)&&(I.forwardToContext=x),h.forEach(k=>{const W=Np(k);if(e.hasItem(W)){const z=e.getItem(W);let U=z.findIndex(J=>J.group===R);U!==-1?_==="before"?U-=1:U+=1:U=z.length,z.splice(U,0,I)}else e.addItem(W,[I])})},n=function(h){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};h.forEach(m=>{wt(c,(p,v)=>{Object.prototype.hasOwnProperty.call(m,v)===!1&&(m[v]=c[v])}),r(m)})},i=h=>{const c=Np(h);e.removeItem(c)};return{__kindOf:B$,addShortcut:r,addShortcuts:n,getShortcuts:h=>{const c=Np(h),m=e.getItem(c);return Ue(m)?m.slice():[]},hasShortcut:h=>{const c=Np(h);return e.hasItem(c)},removeShortcutsByKeys:i,removeShortcutsByGroup:h=>{e.getItems().forEach(m=>{let[p,v]=m;const y=v.filter(C=>C.group!==h);y.length===0?i(oQ(p)):(v.length=0,v.push(...y))})}}};function lQ(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const uQ=["meta","alt","shift","control"],vf=lQ(),wf=[];let kp=0;function hQ(t,e,r,n,i){const s=y=>uQ.includes(y),a=function(y){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const R=[];return y.altKey&&R.push("alt"),C&&(y.ctrlKey||y.metaKey)?R.push("control/meta"):(y.ctrlKey&&R.push("control"),y.metaKey&&R.push("meta")),y.shiftKey&&R.push("shift"),R},u=y=>{if(e(y)===!1||r(y)===!1||y.keyCode===229||typeof y.key!="string"||ml(y))return;const R=vR(y);let _=[];s(R)||(_=a(y));const x=[R].concat(_);!i(y,x)&&(vw()&&_.includes("meta")||!vw()&&_.includes("control"))&&i(y,[R].concat(a(y,!0))),n(y)},h=y=>{if(typeof y.key=="string"){const C=vR(y);s(C)&&vf.press(C)}},c=y=>{if(typeof y.key=="string"){const C=vR(y);s(C)&&vf.release(C)}},m=()=>{vf.releaseAll()};return{mount:()=>{let y=t;for(kp+=1;y;)kp===1&&(y.document.documentElement.addEventListener("keydown",h),wf.push({event:"keydown",listener:h}),y.document.documentElement.addEventListener("keyup",c),wf.push({event:"keyup",listener:c})),y.document.documentElement.addEventListener("keydown",u),y.document.documentElement.addEventListener("blur",m),y=Xu(y)},unmount:()=>{let y=t;for(kp-=1;y;){if(kp===0){for(let C=0;C<wf.length;C++){const{event:R,listener:_}=wf[C];y.document.documentElement.removeEventListener(R,_)}wf.length=0}y.document.documentElement.removeEventListener("keydown",u),y.document.documentElement.removeEventListener("blur",m),y=Xu(y)}},isPressed:y=>vf.isPressed(y),releasePressedKeys:()=>vf.releaseAll()}}const cQ=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=Ny({errorIdExists:C=>`The "${C}" context name is already registered.`});let a="grid";const u=C=>{const R=aQ(C);return s.addItem(C,R),R},h=()=>a,c=C=>s.getItem(C),m=C=>{if(!s.hasItem(C))throw new Error(Gt`You've tried to activate the "${C}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=C};let p=!1;const v=function(C,R){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h();const x=$$(_)?_:c(_);let I=!1;if(!x.hasShortcut(R))return I;const k=x.getShortcuts(R);for(let W=0;W<k.length;W++){const{callback:B,runOnlyIf:z,preventDefault:U,stopPropagation:J,captureCtrl:se,forwardToContext:ne}=k[W];if(z(C)===!0){if(p=se,I=B(C,R)===!1,p=!1,U&&C.preventDefault(),J&&(ls(C),C.stopPropagation()),I)break;ne&&v(C,R,ne)}}return I},y=hQ(e,r,n,i,v);return y.mount(),{addContext:u,getActiveContextName:h,getContext:c,setActiveContextName:m,isCtrlPressed:()=>!p&&(y.isPressed("control")||y.isPressed("meta")),releasePressedKeys:()=>y.releasePressedKeys(),destroy:()=>y.unmount()}};function aD(t){const{classNames:e}=uB(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let wR=null;const yR=new Map;function V$(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new ns(s);let u,h,c,m,p,v,y=!0;V9(i)&&$9(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const C=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",R=["rtl","ltr"].includes(C)?C:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",R),this.isRtl=function(){return R==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=VX(e.language);const _=new D$(s,e,[z7,X7]),x=_.getTableMeta(),I=_.getGlobalMeta(),k=Ny();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),qv(this)&&(JW(e.licenseKey,t),Re(t,"ht-wrapper")),this.guid=`ht_${$T()}`,yR.set(this.guid,this),this.columnIndexMapper=new __,this.rowIndexMapper=new __,this.columnIndexMapper.addLocalHook("indexesSequenceChange",E=>{s.runHooks("afterColumnSequenceChange",E)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",E=>{s.runHooks("afterRowSequenceChange",E)}),h=new iX(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const W=E=>{const{row:M,col:D}=E;return s._createCellCoords(M>=0?s.rowIndexMapper.getRenderableFromVisualIndex(M):M,D>=0?s.columnIndexMapper.getRenderableFromVisualIndex(D):D)},B=E=>{const{row:M,col:D}=E;return s._createCellCoords(M>=0?s.rowIndexMapper.getVisualFromRenderableIndex(M):M,D>=0?s.columnIndexMapper.getVisualFromRenderableIndex(D):D)},z=(E,M)=>{const D=M>E?1:-1,$=Math.min(E,M),X=Math.max(E,M),ce=s.rowIndexMapper.getNearestNotHiddenIndex(E,D);return ce===null||D===1&&ce>X||D===-1&&ce<$?null:ce>=0?s.rowIndexMapper.getRenderableFromVisualIndex(ce):ce},U=(E,M)=>{const D=M>E?1:-1,$=Math.min(E,M),X=Math.max(E,M),ce=s.columnIndexMapper.getNearestNotHiddenIndex(E,D);return ce===null||D===1&&ce>X||D===-1&&ce<$?null:ce>=0?s.columnIndexMapper.getRenderableFromVisualIndex(ce):ce};let J=new H$(x,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:E=>u.propToCol(E),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(E,M)=>s._createCellCoords(E,M),createCellRange:(E,M,D)=>s._createCellRange(E,M,D),visualToRenderableCoords:W,renderableToVisualCoords:B,findFirstNonHiddenRenderableRow:z,findFirstNonHiddenRenderableColumn:U,isDisabledCellSelection:(E,M)=>E<0||M<0?s.getSettings().disableVisualSelection:s.getCellMeta(E,M).disableVisualSelection});this.selection=J;const se=E=>{let{hiddenIndexesChanged:M}=E;M&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",se),this.rowIndexMapper.addLocalHook("cacheUpdated",se),this.selection.addLocalHook("afterSetRangeEnd",(E,M)=>{const D=bi(!1),$=this.selection.getSelectedRange(),{from:X,to:ce}=$.current(),we=$.size()-1;this.runHooks("afterSelection",X.row,X.col,ce.row,ce.col,D,we),this.runHooks("afterSelectionByProp",X.row,s.colToProp(X.col),ce.row,s.colToProp(ce.col),D,we),M&&(!D.isTouched()||D.isTouched()&&!D.value)&&v.scrollTo(E);const ge=J.isSelectedByRowHeader(),Se=J.isSelectedByColumnHeader();ge&&Se?Re(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ge?(tt(this.rootElement,"ht__selection--columns"),Re(this.rootElement,"ht__selection--rows")):Se?(tt(this.rootElement,"ht__selection--rows"),Re(this.rootElement,"ht__selection--columns")):tt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),J.getSelectionSource()!=="shift"&&m.closeEditor(null),s.view.render(),m.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",E=>{this.runHooks("beforeSelectionFocusSet",E.row,E.col)}),this.selection.addLocalHook("afterSetFocus",E=>{const M=bi(!1);this.runHooks("afterSelectionFocusSet",E.row,E.col,M),(!M.isTouched()||M.isTouched()&&!M.value)&&v.scrollTo(E),m.closeEditor(),s.view.render(),m.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",E=>{const M=E.length-1,{from:D,to:$}=E[M];this.runHooks("afterSelectionEnd",D.row,D.col,$.row,$.col,M),this.runHooks("afterSelectionEndByProp",D.row,s.colToProp(D.col),$.row,s.colToProp($.col),M)}),this.selection.addLocalHook("afterIsMultipleSelection",E=>{const M=this.runHooks("afterIsMultipleSelection",E.value);E.value&&(E.value=M)}),this.selection.addLocalHook("afterDeselect",()=>{m.closeEditor(),s.view.render(),tt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("beforeSetRangeStart",...M)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("beforeSetRangeStartOnly",...M)}).addLocalHook("beforeSetRangeEnd",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("beforeSetRangeEnd",...M)}).addLocalHook("beforeSelectColumns",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("beforeSelectColumns",...M)}).addLocalHook("afterSelectColumns",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("afterSelectColumns",...M)}).addLocalHook("beforeSelectRows",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("beforeSelectRows",...M)}).addLocalHook("afterSelectRows",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("afterSelectRows",...M)}).addLocalHook("beforeModifyTransformStart",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("modifyTransformStart",...M)}).addLocalHook("afterModifyTransformStart",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("afterModifyTransformStart",...M)}).addLocalHook("beforeModifyTransformFocus",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("modifyTransformFocus",...M)}).addLocalHook("afterModifyTransformFocus",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("afterModifyTransformFocus",...M)}).addLocalHook("beforeModifyTransformEnd",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("modifyTransformEnd",...M)}).addLocalHook("afterModifyTransformEnd",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("afterModifyTransformEnd",...M)}).addLocalHook("beforeRowWrap",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("beforeRowWrap",...M)}).addLocalHook("beforeColumnWrap",function(){for(var E=arguments.length,M=new Array(E),D=0;D<E;D++)M[D]=arguments[D];return n.runHooks("beforeColumnWrap",...M)}).addLocalHook("insertRowRequire",E=>this.alter("insert_row_above",E,1,"auto")).addLocalHook("insertColRequire",E=>this.alter("insert_col_start",E,1,"auto")),c={alter(E,M){var D,$;let X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,ce=arguments.length>3?arguments[3]:void 0,we=arguments.length>4?arguments[4]:void 0;const ge=Se=>{if(Se.length===0)return[];const L=[...Se];return L.sort((Z,le)=>{let[S]=Z,[Y]=le;return S===Y?0:S>Y?1:-1}),Gr(L,(Z,le)=>{let[S,Y]=le;const K=Z[Z.length-1],[H,A]=K,V=H+A;if(S<=V){const G=Math.max(Y-(V-S),0);K[1]+=G}else Z.push([S,Y]);return Z},[L[0]])};switch(E){case"insert_row_below":case"insert_row_above":const Se=s.countSourceRows();if(x.maxRows===Se)return;const L=E==="insert_row_below"?"below":"above";M=(D=M)!==null&&D!==void 0?D:L==="below"?Se:0;const{delta:F,startPhysicalIndex:Z}=u.createRow(M,X,{source:ce,mode:L});J.shiftRows(s.toVisualRow(Z),F);break;case"insert_col_start":case"insert_col_end":const le=E==="insert_col_end"?"end":"start";M=($=M)!==null&&$!==void 0?$:le==="end"?s.countSourceCols():0;const{delta:S,startPhysicalIndex:Y}=u.createCol(M,X,{source:ce,mode:le});if(S){if(Array.isArray(x.colHeaders)){const A=[s.toVisualColumn(Y),0];A.length+=S,Array.prototype.splice.apply(x.colHeaders,A)}J.shiftColumns(s.toVisualColumn(Y),S)}break;case"remove_row":const K=A=>{let V=0;te(A,G=>{let[ee,re]=G;const de=Ir(ee)?s.countRows()-1:Math.max(ee-V,0);if(Number.isInteger(ee)&&(ee=Math.max(ee-V,0)),!u.removeRow(ee,re,ce))return;if(J.isSelected()){const{row:ke}=s.getSelectedRangeLast().highlight;ke>=ee&&ke<=ee+re-1&&m.closeEditor(!0)}const ye=s.countRows();ye===0?J.deselect():ce==="ContextMenu.removeRow"?J.refresh():J.shiftRows(ee,-re);const Ie=x.fixedRowsTop;Ie>=de+1&&(x.fixedRowsTop-=Math.min(re,Ie-de));const Ne=x.fixedRowsBottom;Ne&&de>=ye-Ne&&(x.fixedRowsBottom-=Math.min(re,Ne)),V+=re})};Array.isArray(M)?K(ge(M)):K([[M,X]]);break;case"remove_col":const H=A=>{let V=0;te(A,G=>{let[ee,re]=G;const de=Ir(ee)?s.countCols()-1:Math.max(ee-V,0);let be=s.toPhysicalColumn(de);if(Number.isInteger(ee)&&(ee=Math.max(ee-V,0)),!u.removeCol(ee,re,ce))return;if(J.isSelected()){const{col:ke}=s.getSelectedRangeLast().highlight;ke>=ee&&ke<=ee+re-1&&m.closeEditor(!0)}s.countCols()===0?J.deselect():ce==="ContextMenu.removeColumn"?J.refresh():J.shiftColumns(ee,-re);const Ne=x.fixedColumnsStart;Ne>=de+1&&(x.fixedColumnsStart-=Math.min(re,Ne-de)),Array.isArray(x.colHeaders)&&(typeof be>"u"&&(be=-1),x.colHeaders.splice(be,re)),V+=re})};Array.isArray(M)?H(ge(M)):H([[M,X]]);break;default:throw new Error(`There is no such action "${E}"`)}s.view.render(),we||c.adjustRowsAndCols()},adjustRowsAndCols(){const E=x.minRows,M=x.minSpareRows,D=x.minCols,$=x.minSpareCols;if(E){const X=s.countRows();X<E&&u.createRow(X,E-X,{source:"auto"})}if(M){const X=s.countEmptyRows(!0);if(X<M){const ce=M-X,we=Math.min(ce,x.maxRows-s.countSourceRows());u.createRow(s.countRows(),we,{source:"auto"})}}{let X;(D||$)&&(X=s.countEmptyCols(!0));let ce=s.countCols();if(D&&!x.columns&&ce<D){const we=D-ce;X+=we,u.createCol(ce,we,{source:"auto"})}if($&&!x.columns&&s.dataType==="array"&&X<$){ce=s.countCols();const we=$-X,ge=Math.min(we,x.maxCols-ce);u.createCol(ce,ge,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(E,M,D,$,X){let ce,we,ge,Se;const L=[],F={},Z=[],le=E.row,S=E.col;if(we=M.length,we===0)return!1;let Y=0,K=0;switch(vt(D)&&(Y=D.col-S+1,K=D.row-le+1),X){case"shift_down":const H=ig(M),A=H.length,V=Math.max(A,Y),G=s.getData().slice(le),ee=ig(G).slice(S,S+V);for(ge=0;ge<V;ge+=1)if(ge<A){for(ce=0,we=H[ge].length;ce<K-we;ce+=1)H[ge].push(H[ge][ce%we]);ge<ee.length?Z.push(H[ge].concat(ee[ge])):Z.push(H[ge].concat(new Array(G.length).fill(null)))}else Z.push(H[ge%A].concat(ee[ge]));s.populateFromArray(le,S,ig(Z));break;case"shift_right":const re=M.length,de=Math.max(re,K),be=s.getData().slice(le).map(zt=>zt.slice(S));for(ce=0;ce<de;ce+=1)if(ce<re){for(ge=0,Se=M[ce].length;ge<Y-Se;ge+=1)M[ce].push(M[ce][ge%Se]);if(ce<be.length)for(let zt=0;zt<be[ce].length;zt+=1)M[ce].push(be[ce][zt]);else M[ce].push(...new Array(be[0].length).fill(null))}else M.push(M[ce%we].slice(0,de).concat(be[ce]));s.populateFromArray(le,S,M);break;case"overwrite":default:F.row=E.row,F.col=E.col;let ye=0,Ie=0,Ne=!0,ke;const Rt=function(ht){let Ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Mt=M[ht%M.length];return Ht!==null?Mt[Ht%Mt.length]:Mt},Br=M.length,pr=D?D.row-E.row+1:0;for(D?we=pr:we=Math.max(Br,pr),ce=0;ce<we&&!(D&&F.row>D.row&&pr>Br||!x.allowInsertRow&&F.row>s.countRows()-1||F.row>=x.maxRows);ce++){const zt=ce-ye,ht=Rt(zt).length,Ht=D?D.col-E.col+1:0;if(D?Se=Ht:Se=Math.max(ht,Ht),F.col=E.col,ke=s.getCellMeta(F.row,F.col),($==="CopyPaste.paste"||$==="Autofill.fill")&&ke.skipRowOnPaste){ye+=1,F.row+=1,we+=1;continue}for(Ie=0,ge=0;ge<Se&&!(D&&F.col>D.col&&Ht>ht||!x.allowInsertColumn&&F.col>s.countCols()-1||F.col>=x.maxCols);ge++){if(ke=s.getCellMeta(F.row,F.col),($==="CopyPaste.paste"||$==="Autofill.fill")&&ke.skipColumnOnPaste){Ie+=1,F.col+=1,Se+=1;continue}if(ke.readOnly&&$!=="UndoRedo.undo"){F.col+=1;continue}const Mt=ge-Ie;let ft=Rt(zt,Mt),st=s.getDataAtCell(F.row,F.col);if(ft!==null&&typeof ft=="object")if(Array.isArray(ft)&&st===null&&(st=[]),st===null||typeof st!="object")Ne=!1;else{const Fo=Gc(Array.isArray(st)?st:st[0]||st),qe=Gc(Array.isArray(ft)?ft:ft[0]||ft);Oy(Fo,qe)||Array.isArray(Fo)&&Array.isArray(qe)?ft=$n(ft):Ne=!1}else st!==null&&typeof st=="object"&&(Ne=!1);Ne&&L.push([F.row,F.col,ft]),Ne=!0,F.col+=1}F.row+=1}s.setDataAtCell(L,null,null,$||"populateFromArray");break}}};function ne(E){const M=b$(E);sM(M)?(s.runHooks("beforeLanguageChange",M),I.language=M,s.runHooks("afterLanguageChange",M)):S$(E)}function fe(E,M){const D=E==="className"?s.rootElement:s.table;if(y)Re(D,M);else{let $=[],X=[];I[E]&&($=Array.isArray(I[E])?I[E]:u_(I[E])),M&&(X=Array.isArray(M)?M:u_(M));const ce=l_($,X),we=l_(X,$);ce.length&&tt(D,ce),we.length&&Re(D,we)}I[E]=M}this.init=function(){h.setData(x.data),s.runHooks("beforeInit"),(wa()||s1())&&Re(s.rootElement,"mobile"),this.updateSettings(x,!0),this.view=new Y9(this);const E=x.themeName||aD(s.rootElement);s.useTheme(E),s.view.addClassNameToLicenseElement(s.getCurrentThemeName()),m=p_.getInstance(s,x,J),v=sQ(s),p=new S6(s),qv(this)&&XZ(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),y&&s.rootElement.offsetParent===null&&yB(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof y=="object"&&(s.runHooks("afterChange",y[0],y[1]),y=!1),s.runHooks("afterInit")};function j(){let E=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,E=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&E===!1&&(E=!0,this.onQueueEmpty(this.valid))}}}function ae(E){const M=E.replace(",",".");return isNaN(parseFloat(M))===!1?parseFloat(M):E}function P(E,M,D){if(!E.length){D();return}const $=s.getActiveEditor(),X=new j;let ce=!0;X.onQueueEmpty=()=>{$&&ce&&$.cancelChanges(),D()};for(let we=E.length-1;we>=0;we--){const[ge,Se,,L]=E[we],F=u.propToCol(Se);let Z;Number.isInteger(F)?Z=s.getCellMeta(ge,F):Z={...Object.getPrototypeOf(x),...x},Z.type==="numeric"&&typeof L=="string"&&VB(L)&&(E[we][3]=ae(L)),s.getCellValidator(Z)&&(X.addValidatorToQueue(),s.validateCell(E[we][3],Z,function(le,S){return function(Y){if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&S.allowInvalid===!1&&(ce=!1,E.splice(le,1),S.valid=!0),X.removeValidatorFormQueue()}}(we,Z),M))}X.checkIfQueueIsEmpty()}function ie(E,M){for(let $=E.length-1;$>=0;$--){let X=!1;if(E[$]===null){E.splice($,1);continue}if(!((E[$][2]===null||E[$][2]===void 0)&&(E[$][3]===null||E[$][3]===void 0))){if(x.allowInsertRow)for(;E[$][0]>s.countRows()-1;){const{delta:ce}=u.createRow(void 0,void 0,{source:M});if(ce===0){X=!0;break}}if(s.dataType==="array"&&(!x.columns||x.columns.length===0)&&x.allowInsertColumn)for(;u.propToCol(E[$][1])>s.countCols()-1;){const{delta:ce}=u.createCol(void 0,void 0,{source:M});if(ce===0){X=!0;break}}X||u.set(E[$][0],E[$][1],E[$][3])}}const D=E.length>0;if(s.forceFullRender=!0,D){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",E,M),m.closeEditor(),s.view.render(),m.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",E,M||"edit");const $=s.getActiveEditor();$&&Ue($.refreshValue)&&$.refreshValue()}else s.view.render()}this._createCellCoords=function(E,M){return s.view._wt.createCellCoords(E,M)},this._createCellRange=function(E,M,D){return s.view._wt.createCellRange(E,M,D)},this.validateCell=function(E,M,D,$){let X=s.getCellValidator(M);function ce(we){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||M.hidden===!0){D(we);return}const Se=M.visualCol,L=M.visualRow,F=s.getCell(L,Se,!0);if(F&&F.nodeName!=="TH"){const Z=s.rowIndexMapper.getRenderableFromVisualIndex(L),le=s.columnIndexMapper.getRenderableFromVisualIndex(Se);s.view._wt.getSetting("cellRenderer",Z,le,F)}D(we)}QW(X)&&(X=function(we){return function(ge,Se){Se(we.test(ge))}}(X)),nr(X)?(E=s.runHooks("beforeValidate",E,M.visualRow,M.prop,$),s._registerImmediate(()=>{X.call(M,E,we=>{s&&(we=s.runHooks("afterValidate",we,E,M.visualRow,M.prop,$),M.valid=we,ce(we),s.runHooks("postAfterValidate",we,E,M.visualRow,M.prop,$))})})):s._registerImmediate(()=>{M.valid=!0,ce(M.valid,!1)})};function Le(E,M,D){return Array.isArray(E)?E:[[E,M,D]]}function me(E,M){const D=s.getActiveEditor(),$=s.runHooks("beforeChange",E,M||"edit"),X=E.filter(ce=>ce!==null);return $===!1||X.length===0?(D&&D.cancelChanges(),[]):X}this.setDataAtCell=function(E,M,D,$){const X=Le(E,M,D),ce=[];let we=$,ge,Se,L;for(ge=0,Se=X.length;ge<Se;ge++){if(typeof X[ge]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof X[ge][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");X[ge][1]>=this.countCols()?L=X[ge][1]:L=u.colToProp(X[ge][1]),ce.push([X[ge][0],L,h.getAtCell(this.toPhysicalRow(X[ge][0]),X[ge][1]),X[ge][2]])}!we&&typeof E=="object"&&(we=M);const F=me(ce,we);s.runHooks("afterSetDataAtCell",F,we),P(F,we,()=>{ie(F,we)})},this.setDataAtRowProp=function(E,M,D,$){const X=Le(E,M,D),ce=[];let we=$,ge,Se;for(ge=0,Se=X.length;ge<Se;ge++)ce.push([X[ge][0],X[ge][1],h.getAtCell(this.toPhysicalRow(X[ge][0]),X[ge][1]),X[ge][2]]);!we&&typeof E=="object"&&(we=M);const L=me(ce,$);s.runHooks("afterSetDataAtRowProp",L,we),P(L,we,()=>{ie(L,we)})},this.listen=function(){s&&!s.isListening()&&(yR.forEach(E=>{s!==E&&E.unlisten()}),wR=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(wR=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return wR===s.guid},this.destroyEditor=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;m.closeEditor(E),s.view.render(),M&&J.isSelected()&&m.prepareEditor()},this.populateFromArray=function(E,M,D,$,X,ce,we){if(!(typeof D=="object"&&typeof D[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const ge=typeof $=="number"?s._createCellCoords($,X):null;return c.populateFromArray(s._createCellCoords(E,M),D,ge,ce,we)},this.spliceCol=function(E,M,D){for(var $=arguments.length,X=new Array($>3?$-3:0),ce=3;ce<$;ce++)X[ce-3]=arguments[ce];return u.spliceCol(E,M,D,...X)},this.spliceRow=function(E,M,D){for(var $=arguments.length,X=new Array($>3?$-3:0),ce=3;ce<$;ce++)X[ce-3]=arguments[ce];return u.spliceRow(E,M,D,...X)},this.getSelected=function(){if(J.isSelected())return St(J.getSelectedRange(),E=>{let{from:M,to:D}=E;return[M.row,M.col,D.row,D.col]})},this.getSelectedLast=function(){const E=this.getSelected();let M;return E&&E.length>0&&(M=E[E.length-1]),M},this.getSelectedRange=function(){if(J.isSelected())return Array.from(J.getSelectedRange())},this.getSelectedRangeLast=function(){const E=this.getSelectedRange();let M;return E&&E.length>0&&(M=E[E.length-1]),M},this.emptySelectedCells=function(E){if(!J.isSelected()||this.countRows()===0||this.countCols()===0)return;const M=[];te(J.getSelectedRange(),D=>{if(D.isSingleHeader())return;const $=D.getTopStartCorner(),X=D.getBottomEndCorner();Xe($.row,X.row,ce=>{Xe($.col,X.col,we=>{this.getCellMeta(ce,we).readOnly||M.push([ce,we,null])})})}),M.length>0&&this.setDataAtCell(M,E)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const E=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(E,0),!this.isRenderSuspended()&&E===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(E){this.suspendRender();const M=E();return this.resumeRender(),M},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const M=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(M,0),(!this.isExecutionSuspended()&&M===this.executionSuspendedCounter||E)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(E){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const D=E();return this.resumeExecution(M),D},this.batch=function(E){this.suspendRender(),this.suspendExecution();const M=E();return this.resumeExecution(),this.resumeRender(),M},this.refreshDimensions=function(){if(!s.view)return;const{width:E,height:M}=s.view.getLastSize(),{width:D,height:$}=s.rootElement.getBoundingClientRect(),X=D!==E||$!==M;s.runHooks("beforeRefreshDimensions",{width:E,height:M},{width:D,height:$},X)!==!1&&((X||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(D,$),s.render()),s.runHooks("afterRefreshDimensions",{width:E,height:M},{width:D,height:$},X))},this.updateData=function(E,M){tD(E,D=>{u=D},D=>{u=D,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),J.refresh()},{hotInstance:s,dataMap:u,dataSource:h,internalSource:"updateData",source:M,metaManager:_,firstRun:y})},this.loadData=function(E,M){tD(E,D=>{u=D},()=>{_.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),J.refresh(),y&&(y=[null,"loadData"])},{hotInstance:s,dataMap:u,dataSource:h,internalSource:"loadData",source:M,metaManager:_,firstRun:y})},this.getInitialColumnCount=function(){const E=x.columns;let M=0;if(Array.isArray(E))M=E.length;else if(nr(E))if(s.dataType==="array"){const D=this.countSourceCols();for(let $=0;$<D;$+=1)E($)&&(M+=1)}else(s.dataType==="object"||s.dataType==="function")&&(M=u.colToPropCache.length);else if(Ue(x.dataSchema)){const D=u.getSchema();M=Array.isArray(D)?D.length:Py(D)}else M=this.countSourceCols();return M},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(E,M,D,$){return fr(E)?u.getAll():u.getRange(s._createCellCoords(E,M),s._createCellCoords(D,$),u.DESTINATION_RENDERER)},this.getCopyableText=function(E,M,D,$){return u.getCopyableText(s._createCellCoords(E,M),s._createCellCoords(D,$))},this.getCopyableData=function(E,M){return u.getCopyable(E,u.colToProp(M))},this.getSchema=function(){return u.getSchema()},this.updateSettings=function(E){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const D=(y?s.loadData:s.updateData).bind(this);let $=!1,X,ce;if(Ue(E.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ue(E.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ue(E.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(X in E)X==="data"||(X==="language"?ne(E.language):X==="className"?fe("className",E.className):X==="tableClassName"&&s.table?(fe("tableClassName",E.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):ze.getSingleton().isRegistered(X)||ze.getSingleton().isDeprecated(X)?nr(E[X])?ze.getSingleton().addAsFixed(X,E[X],s):Array.isArray(E[X])&&ze.getSingleton().add(X,E[X],s):!M&&Ur(E,X)&&(I[X]=E[X]));E.data===void 0&&x.data===void 0?D(null,"updateSettings"):E.data!==void 0?D(E.data,"updateSettings"):E.columns!==void 0&&(u.createMap(),s.initIndexMappers());const we=s.countCols(),ge=x.columns;if(ge&&nr(ge)&&($=!0),(E.cell!==void 0||E.cells!==void 0||E.columns!==void 0)&&_.clearCache(),we>0)for(X=0,ce=0;X<we;X++){if(ge){const F=$?ge(X):ge[ce];F&&_.updateColumnMeta(ce,F)}ce+=1}Ue(E.cell)&&wt(E.cell,F=>{s.setCellMetaObject(F.row,F.col,F)}),s.runHooks("afterCellMetaReset");let Se=s.rootElement.style.height;Se!==""&&(Se=parseInt(s.rootElement.style.height,10));let L=E.height;if(nr(L)&&(L=L()),M&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),L===null){const F=s.rootElement.getAttribute("data-initialstyle");F&&(F.indexOf("height")>-1||F.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",F):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else L!==void 0&&(s.rootElement.style.height=isNaN(L)?`${L}`:`${L}px`,s.rootElement.style.overflow="hidden");if(typeof E.width<"u"){let F=E.width;nr(F)&&(F=F()),s.rootElement.style.width=isNaN(F)?`${F}`:`${F}px`}if(!M){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const F=s.getCurrentThemeName(),Z=Ur(E,"themeName");F&&Z&&(s.view.getStylesHandler().removeClassNames(),s.view.removeClassNameFromLicenseElement(F));const le=Z&&E.themeName||aD(s.rootElement);s.useTheme(le),s.view.addClassNameToLicenseElement(s.getCurrentThemeName())}s.runHooks("afterUpdateSettings",E)}c.adjustRowsAndCols(),s.view&&!y&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!M&&s.view&&(Se===""||L===""||L===void 0)&&Se!==L&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const E=s.getSelectedLast();if(x.getValue){if(nr(x.getValue))return x.getValue.call(s);if(E)return s.getData()[E[0][0]][x.getValue]}else if(E)return s.getDataAtCell(E[0],E[1])},this.getSettings=function(){return x},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(E,M,D,$,X){c.alter(E,M,D,$,X)},this.getCell=function(E,M){let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,$=M,X=E;if(M>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(M)))return null;$=this.columnIndexMapper.getRenderableFromVisualIndex(M)}if(E>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(E)))return null;X=this.rowIndexMapper.getRenderableFromVisualIndex(E)}return X===null||$===null||X===void 0||$===void 0?null:s.view.getCellAtCoords(s._createCellCoords(X,$),D)},this.getCoords=function(E){const M=this.view._wt.wtTable.getCoords(E);if(M===null)return null;const{row:D,col:$}=M;let X=D,ce=$;return D>=0&&(X=this.rowIndexMapper.getVisualFromRenderableIndex(D)),$>=0&&(ce=this.columnIndexMapper.getVisualFromRenderableIndex($)),s._createCellCoords(X,ce)},this.colToProp=function(E){return u.colToProp(E)},this.propToCol=function(E){return u.propToCol(E)},this.toVisualRow=E=>this.rowIndexMapper.getVisualFromPhysicalIndex(E),this.toVisualColumn=E=>this.columnIndexMapper.getVisualFromPhysicalIndex(E),this.toPhysicalRow=E=>this.rowIndexMapper.getPhysicalFromVisualIndex(E),this.toPhysicalColumn=E=>this.columnIndexMapper.getPhysicalFromVisualIndex(E),this.getDataAtCell=function(E,M){return u.get(E,u.colToProp(M))},this.getDataAtRowProp=function(E,M){return u.get(E,M)},this.getDataAtCol=function(E){const M=[],D=u.getRange(s._createCellCoords(0,E),s._createCellCoords(x.data.length-1,E),u.DESTINATION_RENDERER);for(let $=0;$<D.length;$+=1)for(let X=0;X<D[$].length;X+=1)M.push(D[$][X]);return M},this.getDataAtProp=function(E){const M=[],D=u.getRange(s._createCellCoords(0,u.propToCol(E)),s._createCellCoords(x.data.length-1,u.propToCol(E)),u.DESTINATION_RENDERER);for(let $=0;$<D.length;$+=1)for(let X=0;X<D[$].length;X+=1)M.push(D[$][X]);return M},this.getSourceData=function(E,M,D,$){let X;return E===void 0?X=h.getData():X=h.getByRange(s._createCellCoords(E,M),s._createCellCoords(D,$)),X},this.getSourceDataArray=function(E,M,D,$){let X;return E===void 0?X=h.getData(!0):X=h.getByRange(s._createCellCoords(E,M),s._createCellCoords(D,$),!0),X},this.getSourceDataAtCol=function(E){return h.getAtColumn(E)},this.setSourceDataAtCell=function(E,M,D,$){const X=Le(E,M,D),ce=this.hasHook("afterSetSourceDataAtCell"),we=[];ce&&te(X,Se=>{let[L,F,Z]=Se;we.push([L,F,h.getAtCell(L,F),Z])}),te(X,Se=>{let[L,F,Z]=Se;h.setAtCell(L,F,Z)}),ce&&this.runHooks("afterSetSourceDataAtCell",we,$),this.render();const ge=s.getActiveEditor();ge&&Ue(ge.refreshValue)&&ge.refreshValue()},this.getSourceDataAtRow=function(E){return h.getAtRow(E)},this.getSourceDataAtCell=function(E,M){return h.getAtCell(E,M)},this.getDataAtRow=function(E){return u.getRange(s._createCellCoords(E,0),s._createCellCoords(E,this.countCols()-1),u.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(E,M,D,$){const X=E===void 0?[0,0,this.countRows(),this.countCols()]:[E,M,D,$],[ce,we]=X;let[,,ge,Se]=X,L=null,F=null;ge===void 0&&(ge=ce),Se===void 0&&(Se=we);let Z="mixed";return Xe(Math.max(Math.min(ce,ge),0),Math.max(ce,ge),le=>{let S=!0;return Xe(Math.max(Math.min(we,Se),0),Math.max(we,Se),Y=>(F=this.getCellMeta(le,Y).type,L?S=L===F:L=F,S)),Z=S?F:"mixed",S}),Z},this.removeCellMeta=function(E,M,D){const[$,X]=[this.toPhysicalRow(E),this.toPhysicalColumn(M)];let ce=_.getCellMetaKeyValue($,X,D);s.runHooks("beforeRemoveCellMeta",E,M,D,ce)!==!1&&(_.removeCellMeta($,X,D),s.runHooks("afterRemoveCellMeta",E,M,D,ce)),ce=null},this.spliceCellsMeta=function(E){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var D=arguments.length,$=new Array(D>2?D-2:0),X=2;X<D;X++)$[X-2]=arguments[X];if($.length>0&&!Array.isArray($[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");M>0&&_.removeRow(this.toPhysicalRow(E),M),$.length>0&&te($.reverse(),ce=>{_.createRow(this.toPhysicalRow(E)),te(ce,(we,ge)=>this.setCellMetaObject(E,ge,we))}),s.render()},this.setCellMetaObject=function(E,M,D){typeof D=="object"&&wt(D,($,X)=>{this.setCellMeta(E,M,X,$)})},this.setCellMeta=function(E,M,D,$){if(s.runHooks("beforeSetCellMeta",E,M,D,$)===!1)return;let ce=E,we=M;E<this.countRows()&&(ce=this.toPhysicalRow(E)),M<this.countCols()&&(we=this.toPhysicalColumn(M)),_.setCellMeta(ce,we,D,$),s.runHooks("afterSetCellMeta",E,M,D,$)},this.getCellsMeta=function(){return _.getCellsMeta()},this.getCellMeta=function(E,M){let D=this.toPhysicalRow(E),$=this.toPhysicalColumn(M);return D===null&&(D=E),$===null&&($=M),_.getCellMeta(D,$,{visualRow:E,visualColumn:M})},this.getColumnMeta=function(E){return _.getColumnMeta(this.toPhysicalColumn(E))},this.getCellMetaAtRow=function(E){return _.getCellsMetaAtRow(E)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||x.columns)},this.getCellRenderer=function(E,M){const D=typeof E=="number"?s.getCellMeta(E,M).renderer:E.renderer;return typeof D=="string"?Cw(D):fr(D)?Cw("text"):D},this.getCellEditor=function(E,M){const D=typeof E=="number"?s.getCellMeta(E,M).editor:E.editor;return typeof D=="string"?yw(D):fr(D)?yw("text"):D},this.getCellValidator=function(E,M){const D=typeof E=="number"?s.getCellMeta(E,M).validator:E.validator;return typeof D=="string"?d1(D):D},this.validateCells=function(E){this._validateCells(E)},this.validateRows=function(E,M){if(!Array.isArray(E))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(M,E)},this.validateColumns=function(E,M){if(!Array.isArray(E))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(M,void 0,E)},this._validateCells=function(E,M,D){const $=new j;E&&($.onQueueEmpty=E);let X=s.countRows()-1;for(;X>=0;){if(M!==void 0&&M.indexOf(X)===-1){X-=1;continue}let ce=s.countCols()-1;for(;ce>=0;){if(D!==void 0&&D.indexOf(ce)===-1){ce-=1;continue}$.addValidatorToQueue(),s.validateCell(s.getDataAtCell(X,ce),s.getCellMeta(X,ce),we=>{if(typeof we!="boolean")throw new Error("Validation error: result is not boolean");we===!1&&($.valid=!1),$.removeValidatorFormQueue()},"validateCells"),ce-=1}X-=1}$.checkIfQueueIsEmpty()},this.getRowHeader=function(E){let M=x.rowHeaders,D=E;return D!==void 0&&(D=s.runHooks("modifyRowHeader",D)),D===void 0?(M=[],Xe(s.countRows()-1,$=>{M.push(s.getRowHeader($))})):Array.isArray(M)&&M[D]!==void 0?M=M[D]:nr(M)?M=M(D):M&&typeof M!="string"&&typeof M!="number"&&(M=D+1),M},this.hasRowHeaders=function(){return!!x.rowHeaders},this.hasColHeaders=function(){if(x.colHeaders!==void 0&&x.colHeaders!==null)return!!x.colHeaders;for(let E=0,M=s.countCols();E<M;E++)if(s.getColHeader(E))return!0;return!1},this.getColHeader=function(E){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const D=s.runHooks("modifyColHeader",E);if(D===void 0){const ge=[],Se=s.countCols();for(let L=0;L<Se;L++)ge.push(s.getColHeader(L));return ge}let $=x.colHeaders;const X=function(ge){const Se=[],L=s.countCols();let F=0;for(;F<L;F++)nr(x.columns)&&x.columns(F)&&Se.push(F);return Se[ge]},ce=s.toPhysicalColumn(D),we=X(ce);return x.colHeaders===!1?$=null:x.columns&&nr(x.columns)&&x.columns(we)&&x.columns(we).title?$=x.columns(we).title:x.columns&&x.columns[ce]&&x.columns[ce].title?$=x.columns[ce].title:Array.isArray(x.colHeaders)&&x.colHeaders[ce]!==void 0?$=x.colHeaders[ce]:nr(x.colHeaders)?$=x.colHeaders(ce):x.colHeaders&&typeof x.colHeaders!="string"&&typeof x.colHeaders!="number"&&($=Ly(D)),$=s.runHooks("modifyColumnHeaderValue",$,E,M),$},this._getColWidthFromSettings=function(E){let M;if(E>=0&&(M=s.getCellMeta(0,E).width),(M===void 0||M===x.width)&&(M=x.colWidths),M!=null){switch(typeof M){case"object":M=M[E];break;case"function":M=M(E);break}typeof M=="string"&&(M=parseInt(M,10))}return M},this.getColWidth=function(E,M){let D=s._getColWidthFromSettings(E);return D=s.runHooks("modifyColWidth",D,E,M),D===void 0&&(D=qc),D},this._getRowHeightFromSettings=function(E){let M=x.rowHeights;if(M!=null){switch(typeof M){case"object":M=M[E];break;case"function":M=M(E);break}typeof M=="string"&&(M=parseInt(M,10))}return M},this.getRowHeight=function(E,M){let D=s._getRowHeightFromSettings(E);return D=s.runHooks("modifyRowHeight",D,E,M),D},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return u.getLength()},this.countCols=function(){const E=x.maxCols,M=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(E,M)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,M=0;return y_(s.countRows()-1,D=>{if(s.isEmptyRow(D))M+=1;else if(E===!0)return!1}),M},this.countEmptyCols=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,M=0;return y_(s.countCols()-1,D=>{if(s.isEmptyCol(D))M+=1;else if(E===!0)return!1}),M},this.isEmptyRow=function(E){return x.isEmptyRow.call(s,E)},this.isEmptyCol=function(E){return x.isEmptyCol.call(s,E)},this.selectCell=function(E,M,D,$){let X=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,ce=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return fr(E)||fr(M)?!1:this.selectCells([[E,M,D,$]],X,ce)},this.selectCells=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;M===!1&&v.suspend();const $=J.selectCells(E);return $&&D&&s.listen(),v.resume(),$},this.selectColumns=function(E){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,D=arguments.length>2?arguments[2]:void 0;return J.selectColumns(E,M,D)},this.selectRows=function(E){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,D=arguments.length>2?arguments[2]:void 0;return J.selectRows(E,M,D)},this.deselectCell=function(){J.deselect()},this.selectAll=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,D=arguments.length>2?arguments[2]:void 0;v.skipNextScrollCycle(),J.selectAll(E,M,D)};const Ae=(E,M)=>E.getNearestNotHiddenIndex(M,1,!0);this.scrollViewportTo=function(E){var M;if(typeof E=="number"){var D;E={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(D=arguments[4])!==null&&D!==void 0?D:!0}}const{row:$,col:X,considerHiddenIndexes:ce}=(M=E)!==null&&M!==void 0?M:{};let we=$,ge=X;if(ce===void 0||ce){const F=Number.isInteger($)&&$>=0,Z=Number.isInteger(X)&&X>=0,le=F?Ae(this.rowIndexMapper,$):void 0,S=Z?Ae(this.columnIndexMapper,X):void 0;if(le===null||S===null)return!1;we=F?s.rowIndexMapper.getRenderableFromVisualIndex(le):$,ge=Z?s.columnIndexMapper.getRenderableFromVisualIndex(S):X}const Se=Number.isInteger(we),L=Number.isInteger(ge);return Se&&we>=0&&L&&ge>=0?s.view.scrollViewport(s._createCellCoords(we,ge),E.horizontalSnap,E.verticalSnap):Se&&we>=0&&(L&&ge<0||!L)?s.view.scrollViewportVertically(we,E.verticalSnap):L&&ge>=0&&(Se&&we<0||!Se)?s.view.scrollViewportHorizontally(ge,E.horizontalSnap):!1},this.scrollToFocusedCell=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",E);const{highlight:M}=this.getSelectedRangeLast();this.scrollViewportTo(M.toObject())?this.view.render():(this.removeHook("afterScroll",E),this._registerImmediate(()=>E()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),_.clearCache(),yR.delete(this.guid),qv(s)){const E=this.rootDocument.querySelector(".hot-display-license-info");E&&E.parentNode.removeChild(E)}Ls(s.rootElement),a.destroy(),m&&m.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),k.getItems().forEach(E=>{let[,M]=E;M.destroy()}),k.clear(),s.runHooks("afterDestroy")},!0),ze.getSingleton().destroy(s),wt(s,(E,M,D)=>{nr(E)?D[M]=ve(M):M!=="guid"&&(D[M]=null)}),s.isDestroyed=!0,u&&u.destroy(),u=null,c=null,J=null,m=null,s=null};function ve(E){return()=>{throw new Error(`The "${E}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return m.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(E){const M=Bn(E);return M==="UndoRedo"?this.undoRedo:k.getItem(M)},this.getPluginName=function(E){return E===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:k.getId(E)},this.getInstance=function(){return s},this.addHook=function(E,M,D){ze.getSingleton().add(E,M,s,D)},this.hasHook=function(E){return ze.getSingleton().has(E,s)||ze.getSingleton().has(E)},this.addHookOnce=function(E,M,D){ze.getSingleton().once(E,M,s,D)},this.removeHook=function(E,M){ze.getSingleton().remove(E,M,s)},this.runHooks=function(E,M,D,$,X,ce,we){return ze.getSingleton().run(s,E,M,D,$,X,ce,we)},this.getTranslatedPhrase=function(E,M){return M$(x.language,E,M)},this.toHTML=()=>v_(this),this.toTableElement=()=>{const E=this.rootDocument.createElement("div");return E.insertAdjacentHTML("afterbegin",v_(this)),E.firstElementChild},this.timeouts=[],this.useTheme=E=>{this.view.getStylesHandler().useTheme(E),this.runHooks("afterSetTheme",E,!!y)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(E){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=E;typeof D=="function"&&(D=setTimeout(D,M)),this.timeouts.push(D)},this._clearTimeouts=function(){te(this.timeouts,E=>{clearTimeout(E)})},this.immediates=[],this._registerImmediate=function(E){this.immediates.push(setImmediate(E))},this._clearImmediates=function(){te(this.immediates,E=>{clearImmediate(E)})},this._getEditorManager=function(){return m},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const Be=cQ({handleEvent(){return s.isListening()},beforeKeyDown:E=>this.runHooks("beforeKeyDown",E),afterKeyDown:E=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",E)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",E=>{E.ctrlKey===!1&&E.metaKey===!1&&Be.releasePressedKeys()}),this.getShortcutManager=function(){return Be},this.getFocusManager=function(){return p},c1().forEach(E=>{const M=om(E);k.addItem(E,new M(this))}),qZ(s),Be.setActiveContextName("grid"),ze.getSingleton().run(s,"construct")}function lD(t,e,r){t.addEventListener(e,r,!1)}function uD(t,e,r){t.removeEventListener(e,r,!1)}function Dp(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function z$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:p=>p.value,...e},n=t.body,i=t.createTextNode(""),s=t.createElement("span");let a;function u(){var p,v;i.textContent=r.textContent(a),s.style.position="absolute",s.style.fontSize=Dp(a).fontSize,s.style.fontFamily=Dp(a).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);const y=parseInt(((p=Dp(a))===null||p===void 0?void 0:p.paddingInlineStart)||0,10),C=parseInt(((v=Dp(a))===null||v===void 0?void 0:v.paddingInlineEnd)||0,10),R=s.clientWidth+2+y+C;n.removeChild(s);const _=a.style;_.height=`${r.minHeight}px`,r.minWidth>R?_.width=`${r.minWidth}px`:R>r.maxWidth?_.width=`${r.maxWidth}px`:_.width=`${R}px`;const x=a.scrollHeight?a.scrollHeight-1:0;r.minHeight>x?_.height=`${r.minHeight}px`:r.maxHeight<x?(_.height=`${r.maxHeight}px`,_.overflowY="visible"):_.height=`${x}px`}function h(){t.defaultView.setTimeout(u,0)}function c(p){if(p&&p.minHeight)if(p.minHeight==="inherit")r.minHeight=a.clientHeight;else{const v=parseInt(p.minHeight,10);isNaN(v)||(r.minHeight=v)}if(p&&p.maxHeight)if(p.maxHeight==="inherit")r.maxHeight=a.clientHeight;else{const v=parseInt(p.maxHeight,10);isNaN(v)||(r.maxHeight=v)}if(p&&p.minWidth)if(p.minWidth==="inherit")r.minWidth=a.clientWidth;else{const v=parseInt(p.minWidth,10);isNaN(v)||(r.minWidth=v)}if(p&&p.maxWidth)if(p.maxWidth==="inherit")r.maxWidth=a.clientWidth;else{const v=parseInt(p.maxWidth,10);isNaN(v)||(r.maxWidth=v)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function m(p,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=p,c(v),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${r.minHeight}px`,a.style.minWidth=`${r.minWidth}px`,a.style.maxWidth=`${r.maxWidth}px`,a.style.overflowY="hidden"),y&&(lD(a,"input",u),lD(a,"keydown",h)),u()}return{init:m,resize:u,unObserve(){uD(a,"input",u),uD(a,"keydown",h)}}}function hD(t,e){const r=XT(e),n=e.value.split(`
`);let i=r,s=0;for(let a=0;a<n.length;a++){const u=n[a];a!==0&&(s+=n[a-1].length+1);const h=s+u.length;if(t==="home"?i=s:t==="end"&&(i=h),r<=h)break}nm(e,i)}function lu(t,e,r){return(e=dQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dQ(t){var e=fQ(t,"string");return typeof e=="symbol"?e:e+""}function fQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gQ="ht_editor_visible",Lp="ht_editor_hidden",cD="textEditor",mQ="text";class gh extends dd{static get EDITOR_TYPE(){return mQ}constructor(e){super(e),lu(this,"eventManager",new ns(this)),lu(this,"autoResize",z$(this.hot.rootDocument)),lu(this,"TEXTAREA",void 0),lu(this,"textareaStyle",void 0),lu(this,"TEXTAREA_PARENT",void 0),lu(this,"textareaParentStyle",void 0),lu(this,"layerClass",void 0),this.eventManager=new ns(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),aB(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,a){const u=this.state;if(super.prepare(e,r,n,i,s,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:h}=a;h&&!this.isOpened()&&(this.TEXTAREA.value=""),u!==Dr.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===Dr.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),nm(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),it(this.TEXTAREA,[["data-hot-input",""],ld(-1)]),Re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Re(this.TEXTAREA_PARENT,"handsontableInputHolder"),nt(this.TEXTAREA_PARENT,this.layerClass)&&tt(this.TEXTAREA_PARENT,this.layerClass),Re(this.TEXTAREA_PARENT,Lp),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){OB()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",tt(this.TEXTAREA_PARENT,this.layerClass),Re(this.TEXTAREA_PARENT,Lp)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Xe(e.length-1,n=>{const i=e[n];if(nt(i,"handsontableEditor"))return r=!0,!1}),nt(this.TEXTAREA_PARENT,Lp)&&tt(this.TEXTAREA_PARENT,Lp),r?(this.layerClass=gQ,Re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Re(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Dr.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:a,maxHeight:u}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const h=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(a,u),maxWidth:s,maxHeight:u},!0)}bindEvents(){i1()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Dr.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Dr.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>Ue(this.hot.getSelected()),group:cD},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[u]=a;hD(u,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[u]=a;hD(u,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(cD)}}const pQ="base";function cm(t,e,r,n,i,s,a){const u=a.ariaTags,h=[],c=[],m=[],p=[];a.className&&Re(e,a.className),a.readOnly?(h.push(a.readOnlyCellClassName),u&&p.push(RN())):u&&m.push(RN()[0]),a.valid===!1&&a.invalidCellClassName?(h.push(a.invalidCellClassName),u&&p.push(EN())):(c.push(a.invalidCellClassName),u&&m.push(EN()[0])),a.wordWrap===!1&&a.noWordWrapClassName&&h.push(a.noWordWrapClassName),!s&&a.placeholder&&h.push(a.placeholderCellClassName),tt(e,c),Re(e,h),ch(e,m),it(e,p)}cm.RENDERER_TYPE=pQ;const vQ="text";function Na(t,e,r,n,i,s,a){cm.apply(this,[t,e,r,n,i,s,a]);let u=s;if(!u&&a.placeholder&&(u=a.placeholder),u=Mr(u),a.trimWhitespace&&(u=u.trim()),a.rendererTemplate){Ls(e);const h=t.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=t.getSourceDataAtRow(r),e.appendChild(h)}else Pl(e,u)}Na.RENDERER_TYPE=vQ;const wQ="text",U$={CELL_TYPE:wQ,editor:gh,renderer:Na};ji(U$);lt.editors={BaseEditor:dd};function lt(t,e){const r=new V$(t,e||{},I1);return r.init(),r}lt.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new V$(t,e,I1)};lt.DefaultSettings=k$();lt.hooks=ze.getSingleton();lt.CellCoords=Ju;lt.CellRange=am;lt.packageName="handsontable";lt.buildDate="16/12/2024 13:19:38";lt.version="15.0.0";lt.languages={dictionaryKeys:kX,getLanguageDictionary:x$,getLanguagesDictionaries:BX,registerLanguageDictionary:T$,getTranslatedPhrase:M$};const dD="handsontableEditor",yQ="handsontable";class lM extends gh{static get EDITOR_TYPE(){return yQ}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),nm(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a);const u=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(c,m){const p=this.getSourceData(m.row,m.col);p!==void 0&&u.setValue(p),u.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&jr(h,a.handsontable),this.htOptions=h}beginEditing(e,r){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,r,n)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.htEditor.useTheme(e)})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:dD,relativeToGroup:Wl,position:"before"},i=(s,a)=>{const u=this.htEditor;if(s!==void 0&&(s<0||u.flipped&&s>u.countRows()-1?u.deselectCell():u.selectCell(s,0),u.getData().length))return a.preventDefault(),ls(a),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const a=this.htEditor;let u,h;return!a.getSelectedLast()&&a.flipped?u=a.countRows()-1:a.getSelectedLast()&&(a.flipped?(h=a.getSelectedLast()[0],u=Math.max(0,h-1)):(h=a.getSelectedLast()[0],u=h-1)),i(u,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const a=this.htEditor;let u,h;if(!a.getSelectedLast()&&!a.flipped)u=0;else if(a.getSelectedLast()){if(a.flipped)u=a.getSelectedLast()[0]+1;else if(!a.flipped){const c=a.countRows()-1;h=a.getSelectedLast()[0],u=Math.min(c,h+1)}}return i(u,s)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(dD)}}function CQ(t,e,r){bQ(t,e),e.set(t,r)}function bQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fp(t,e,r){return(e=SQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SQ(t){var e=RQ(t,"string");return typeof e=="symbol"?e:e+""}function RQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fD(t,e){return t.get(EQ(t,e))}function EQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _Q="autocomplete";var CR=new WeakMap;class uM extends lM{constructor(){super(...arguments),Fp(this,"query",null),Fp(this,"strippedChoices",[]),Fp(this,"rawChoices",[]),CQ(this,CR,this.hot.guid.slice(0,9)),Fp(this,"sortByRelevance",function(e,r,n){const i=[],s=[],a=e.length;let u=r.length,h,c,m,p;if(a===0){for(m=0;m<u;m++)s.push(m);return s}for(m=0;m<u;m++){if(c=c_(Mr(r[m])),n)p=c.indexOf(e);else{const v=this.cellProperties.locale;p=c.toLocaleLowerCase(v).indexOf(e.toLocaleLowerCase(v))}p!==-1&&(h=c.length-p-a,i.push({baseIndex:m,index:p,charsLeft:h,value:c}))}for(i.sort((v,y)=>{if(y.index===-1)return-1;if(v.index===-1)return 1;if(v.index<y.index)return-1;if(y.index<v.index)return 1;if(v.index===y.index){if(v.charsLeft<y.charsLeft)return-1;if(v.charsLeft>y.charsLeft)return 1}return 0}),m=0,u=i.length;m<u;m++)s.push(i[m].baseIndex);return s})}static get EDITOR_TYPE(){return _Q}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return Ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Re(this.htContainer,"autocompleteEditor"),Re(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&it(this.TEXTAREA,[fK(),lK(),rB("listbox"),vK()])}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a),this.hot.getSettings().ariaTags&&it(this.TEXTAREA,[ts("false"),wK(`${fD(CR,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=n==null?void 0:n.length,{row:s,col:a}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",u=>this.onBeforeKeyDown(u)),this.htEditor.updateSettings({colWidths:e?[Fr(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(u,h,c,m,p,v,y)=>{Na(u,h,c,m,p,v,y);const{filteringCaseSensitive:C,allowHtml:R,locale:_}=this.cellProperties,x=this.query;let I=Mr(v),k,W;I&&!R&&(k=C===!0?I.indexOf(x):I.toLocaleLowerCase(_).indexOf(x.toLocaleLowerCase(_)),k!==-1&&(W=I.substr(k,x.length),I=I.replace(W,`<strong>${W}</strong>`))),r&&it(h,[uK(),...n?[SK(i)]:[],...n?[RK(n.indexOf(v)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${m}`]]),h.innerHTML=I},afterSelectionEnd:(u,h)=>{if(r){const c=this.htEditor.getCell(u,h,!0);it(c,[jT()]),it(this.TEXTAREA,...yK(c.id))}}}),r&&(it(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Io()),it(this.htEditor.rootElement,[tB(),CK("polite"),bK("text"),["id",`${fD(CR,this)}-listbox-${s}-${a}`]]),it(this.TEXTAREA,...ts("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&it(this.TEXTAREA,[ts("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=XT(this.TEXTAREA),n=pB(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let a=null,u=null,h=e;i&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),h,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(a)?a.length:0;if(s===!1)c&&(u=a[0]);else{const m=[];for(let p=0,v=h.length;p<v&&!(i&&c<=p);p++)c?m.push(h[a[p]]):m.push(h[p]);u=0,h=m}this.strippedChoices=h,h.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(ig([h])),h.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(u)),this.hot.listen(),nm(this.TEXTAREA,r,r===n?void 0:n)}flipDropdownIfNeeded(){const e=Qu(this.hot.view._wt.wtTable.TABLE),r=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(r||!r&&(n||n==="horizontal"))return!1;const i=un(this.TEXTAREA),s=Or(this.TEXTAREA),a=this.getHeight(),u=e.scrollTop,h=Or(this.hot.view._wt.wtTable.THEAD),c=un(e),m=i.top-c.top-h+u,p=e.scrollHeight-m-h-s,v=a>p&&m>p;return v?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(v?m:p,a),v}limitDropdownIfNeeded(e,r){if(r>e){let n=0,i=0,s=0,a=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),n+=s,i+=1;while(n<e);a=n-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-a}px`),this.setDropdownHeight(n-s)}}flipDropdown(e){const r=this.htEditor.rootElement.style;r.position="absolute",r.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+bn(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),r=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(s,a)=>a).reduce((s,a)=>s+this.htEditor.getRowHeight(a),0)+r+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),r=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+r}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,n=St(e,s=>Mr(s));return St(n,s=>r?s:c_(s))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),n={row:r?r.from.row:-1};let i=!1;return e===Ke.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(i=!0),e===Ke.ARROW_UP&&n.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(PB(e.keyCode)||e.keyCode===Ke.BACKSPACE||e.keyCode===Ke.DELETE||e.keyCode===Ke.INSERT){let r=10;if(e.keyCode===Ke.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}const TQ="checkbox";class j$ extends dd{static get EDITOR_TYPE(){return TQ}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');nt(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const bl=()=>window,Zi=()=>window.document,O_=(t,e)=>window.setTimeout(t,e),po=function(t,e,r,n){t.addEventListener(e,r,!!n)},Qo=function(t,e,r,n){t.removeEventListener(e,r,!!n)},xQ=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Oi=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},bR=function(t,e){Oi(t,e)||(t.className=t.className===""?e:t.className+" "+e)},SR=function(t,e){t.className=xQ((" "+t.className+" ").replace(" "+e+" "," "))},hM=function(t){return/Array/.test(Object.prototype.toString.call(t))},Hi=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},MQ=function(t){let e=t.getDay();return e===0||e===6},IQ=function(t){return t%4===0&&t%100!==0||t%400===0},gD=function(t,e){return[31,IQ(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Wp=function(t){Hi(t)&&t.setHours(0,0,0,0)},Bp=function(t,e){return t.getTime()===e.getTime()},xw=function(t,e,r){let n,i;for(n in e)i=t[n]!==void 0,i&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?Hi(e[n])?r&&(t[n]=new Date(e[n].getTime())):hM(e[n])?r&&(t[n]=e[n].slice(0)):t[n]=xw({},e[n],r):(r||!i)&&(t[n]=e[n]);return t},mD=function(t,e,r){let n=Zi().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=xw(n,r),t.dispatchEvent(n)},pD=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},ro={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},vD=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},OQ=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},PQ=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),n=t.getDay(),i=e,s=i-1,a=7,u=function(v){return(v+a-1)%a};t.setDate(r+s-u(n));let h=new Date(t.getFullYear(),0,i),c=24*60*60*1e3,m=(t.getTime()-h.getTime())/c;return 1+Math.round((m-s+u(h.getDay()))/a)},AQ=function(t,e,r,n,i){let s=new Date(n,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():PQ(s,i))+"</td>"},HQ=function(t,e,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},NQ=function(t){return"<tbody>"+t.join("")+"</tbody>"},kQ=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+vD(t,e)+'">'+vD(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},DQ=function(t,e,r,n,i,s){let a,u,h,c=t._o,m=r===c.minYear,p=r===c.maxYear,v='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',y,C,R=!0,_=!0;for(h=[],a=0;a<12;a++)h.push('<option value="'+(r===i?a-e:12+a-e)+'"'+(a===n?' selected="selected"':"")+(m&&a<c.minMonth||p&&a>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[a]+"</option>");for(y='<div class="pika-label">'+c.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",hM(c.yearRange)?(a=c.yearRange[0],u=c.yearRange[1]+1):(a=r-c.yearRange,u=1+r+c.yearRange),h=[];a<u&&a<=c.maxYear;a++)a>=c.minYear&&h.push('<option value="'+a+'"'+(a===r?' selected="selected"':"")+">"+a+"</option>");return C='<div class="pika-label">'+r+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",c.showMonthAfterYear?v+=C+y:v+=y+C,m&&(n===0||c.minMonth>=n)&&(R=!1),p&&(n===11||c.maxMonth<=n)&&(_=!1),e===0&&(v+='<button class="pika-prev'+(R?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(v+='<button class="pika-next'+(_?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),v+="</div>"},LQ=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+kQ(t)+NQ(e)+"</table>"};function P_(t){let e=this,r=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||bl().event;let s=i.target||i.srcElement;if(s)if(Oi(s,"is-disabled")||(Oi(s,"pika-button")&&!Oi(s,"is-empty")&&!Oi(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),r.bound&&O_(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):Oi(s,"pika-prev")?e.prevMonth():Oi(s,"pika-next")&&e.nextMonth()),Oi(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||bl().event;let s=i.target||i.srcElement;s&&(Oi(s,"pika-select-month")?e.gotoMonth(s.value):Oi(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||bl().event,e.isVisible())switch(i.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let i=this.moment(r.field.value,r.format,r.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),Hi(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Zi().activeElement;do if(Oi(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=O_(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||bl().event;let s=i.target||i.srcElement,a=s;if(s){!hasEventListeners&&Oi(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),po(s,"change",e._onChange)));do if(Oi(a,"pika-single")||a===r.trigger)return;while(a=a.parentNode);e._v&&s!==r.trigger&&a!==r.trigger&&e.hide()}},e.el=Zi().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),po(e.el,"mousedown",e._onMouseDown,!0),po(e.el,"touchend",e._onMouseDown,!0),po(e.el,"change",e._onChange),r.keyboardInput&&po(Zi(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?Zi().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),po(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let n=r.defaultDate;Hi(n)?r.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",po(r.trigger,"click",e._onInputClick),po(r.trigger,"focus",e._onInputFocus),po(r.trigger,"blur",e._onInputBlur)):this.show()}P_.prototype={config:function(t){this._o||(this._o=xw({},ro,!0));let e=xw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,Hi(e.minDate)||(e.minDate=!1),Hi(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),hM(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||ro.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Hi(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Hi(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",mD(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Hi(t))return;let r=this._o.minDate,n=this._o.maxDate;Hi(r)&&t<r?t=r:Hi(n)&&t>n&&(t=n),this._d=new Date(t.getTime()),Wp(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),mD(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Hi(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=i<r.getTime()||n.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(r.valueOf()+n):t==="subtract"&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=pD(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=pD({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Wp(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=ro.minDate,this._o.minYear=ro.minYear,this._o.minMonth=ro.minMonth,this._o.startRange=ro.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Wp(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=ro.maxDate,this._o.maxYear=ro.maxYear,this._o.maxMonth=ro.maxMonth,this._o.endRange=ro.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,n=e.maxYear,i=e.minMonth,s=e.maxMonth,a="",u;this._y<=r&&(this._y=r,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=n&&(this._y=n,!isNaN(s)&&this._m>s&&(this._m=s));for(let h=0;h<e.numberOfMonths;h++)u="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+DQ(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,u)+this.render(this.calendars[h].year,this.calendars[h].month,u)+"</div>";this.el.innerHTML=a,e.bound&&e.field.type!=="hidden"&&O_(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,n,i,s,a,u,h,c,m;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,n=bl().innerWidth||Zi().documentElement.clientWidth,i=bl().innerHeight||Zi().documentElement.clientHeight,s=Zi().body.scrollTop||Zi().documentElement.scrollTop,c=!0,m=!0,h=t.getBoundingClientRect(),a=h.left+bl().pageXOffset,u=h.bottom+bl().pageYOffset,(this._o.reposition&&a+e>n||this._o.position.indexOf("right")>-1&&a-e+t.offsetWidth>0)&&(a=a-e+t.offsetWidth,c=!1),(this._o.reposition&&u+r>i+s||this._o.position.indexOf("top")>-1&&u-r-t.offsetHeight>0)&&(u=u-r-t.offsetHeight,m=!1),a<0&&(a=0),u<0&&(u=0),this.el.style.left=a+"px",this.el.style.top=u+"px",bR(this.el,c?"left-aligned":"right-aligned"),bR(this.el,m?"bottom-aligned":"top-aligned"),SR(this.el,c?"right-aligned":"left-aligned"),SR(this.el,m?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let n=this._o,i=new Date,s=gD(t,e),a=new Date(t,e,1).getDay(),u=[],h=[];Wp(i),n.firstDay>0&&(a-=n.firstDay,a<0&&(a+=7));let c=e===0?11:e-1,m=e===11?0:e+1,p=e===0?t-1:t,v=e===11?t+1:t,y=gD(p,c),C=s+a,R=C;for(;R>7;)R-=7;C+=7-R;let _=!1;for(let x=0,I=0;x<C;x++){let k=new Date(t,e,1+(x-a)),W=Hi(this._d)?Bp(k,this._d):!1,B=Bp(k,i),z=n.events.indexOf(k.toDateString())!==-1,U=x<a||x>=s+a,J=1+(x-a),se=e,ne=t,fe=n.startRange&&Bp(n.startRange,k),j=n.endRange&&Bp(n.endRange,k),ae=n.startRange&&n.endRange&&n.startRange<k&&k<n.endRange,P=n.minDate&&k<n.minDate||n.maxDate&&k>n.maxDate||n.disableWeekends&&MQ(k)||n.disableDayFn&&n.disableDayFn(k);U&&(x<a?(J=y+J,se=c,ne=p):(J=J-s,se=m,ne=v));let ie={day:J,month:se,year:ne,hasEvent:z,isSelected:W,isToday:B,isDisabled:P,isEmpty:U,isStartRange:fe,isEndRange:j,isInRange:ae,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&W&&(_=!0),h.push(OQ(ie)),++I===7&&(n.showWeekNumber&&h.unshift(AQ(this,x-a,e,t,n.firstWeekOfYearMinDays)),u.push(HQ(h,n.isRTL,n.pickWholeWeek,_)),h=[],I=0,_=!1)}return LQ(n,u,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),SR(this.el,"is-hidden"),this._o.bound&&(po(Zi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Qo(Zi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),bR(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Qo(this.el,"mousedown",this._onMouseDown,!0),Qo(this.el,"touchend",this._onMouseDown,!0),Qo(this.el,"change",this._onChange),t.keyboardInput&&Qo(Zi(),"keydown",this._onKeyChange),t.field&&(Qo(t.field,"change",this._onInputChange),t.bound&&(Qo(t.trigger,"click",this._onInputClick),Qo(t.trigger,"focus",this._onInputFocus),Qo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function RR(t,e,r){return(e=FQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FQ(t){var e=WQ(t,"string");return typeof e=="symbol"?e:e+""}function WQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Y$="date",wD="dateEditor";class G$ extends gh{constructor(){super(...arguments),RR(this,"defaultDateFormat","DD/MM/YYYY"),RR(this,"parentDestroyed",!1),RR(this,"$datePicker",null)}static get EDITOR_TYPE(){return Y$}init(){if(typeof Ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof P_!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||(tt(this.datePicker,/ht-theme-.*/g),Re(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Re(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();tt(this.datePicker,/ht-theme-.*/g),Re(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",r=>{nt(r.target,"pika-day")&&this.hideDatepicker(),r.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:wD})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(wD),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),i=e?o1(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new P_(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Ee),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,Ee(s,r,!0).isValid()&&this.$datePicker.setMoment(Ee(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!n&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Ee(s,r,!0).isValid()&&this.$datePicker.setMoment(Ee(s,r),!0),!i&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&sm(r,this.cellProperties.datePickerConfig);const n=r.onSelect,i=r.onClose;return r.field=e,r.trigger=e,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=r.format||this.defaultDateFormat,r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Ee(a).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(a),n&&n()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},r}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==Dr.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:a}=(r=s.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,u=n.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),h=n.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),c=i.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),m=i.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=u&&this.row<=h&&this.col>=c&&this.col<=m){const p=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+p.top+Or(this.TD)}px`;let v=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?v+=p.right-Fr(this.datePicker):v+=p.left,this.datePickerStyle.left=`${v}px`}else this.hideDatepicker()}}const BQ="dropdown";class cM extends uM{static get EDITOR_TYPE(){return BQ}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}ze.getSingleton().add("beforeValidate",function(t,e,r){const n=this.propToCol(r);if(Number.isInteger(n)){const i=this.getCellMeta(e,n);i.editor===cM&&i.strict===void 0&&(i.filter=!1,i.strict=!0)}});const $Q="numeric";class q$ extends gh{static get EDITOR_TYPE(){return $Q}}function VQ(t,e,r){return(e=zQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zQ(t){var e=UQ(t,"string");return typeof e=="symbol"?e:e+""}function UQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jQ="password";class K$ extends gh{constructor(){super(...arguments),VQ(this,"autoResize",z$(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return jQ}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Ls(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ER="ht_editor_visible",yD="selectEditor",YQ="select";class X$ extends dd{static get EDITOR_TYPE(){return YQ}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),r=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",r&&e.setAttribute(...Ll()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),Re(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",nt(this.selectWrapper,ER)&&tt(this.selectWrapper,ER),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a);const u=this.cellProperties.selectOptions;let h;typeof u=="function"?h=this.prepareOptions(u(this.row,this.col,this.prop)):h=this.prepareOptions(u),Ls(this.select),wt(h,(c,m)=>{const p=this.hot.rootDocument.createElement("OPTION");p.value=m,dh(p,c),this.select.appendChild(p)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let n=0,i=e.length;n<i;n++)r[e[n]]=e[n];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Dr.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:n,height:i}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${i}px`,s.width=`${n}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",Re(this.selectWrapper,ER)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={group:yD};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(yD)}}const GQ="time";class Z$ extends gh{static get EDITOR_TYPE(){return GQ}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a),this.TEXTAREA.dir="ltr"}}function qQ(){mi(dd),mi(uM),mi(j$),mi(G$),mi(cM),mi(lM),mi(q$),mi(K$),mi(X$),mi(gh),mi(Z$)}const KQ="html";function dM(t,e,r,n,i,s,a){cm.apply(this,[t,e,r,n,i,s,a]),dh(e,s??"",!1)}dM.RENDERER_TYPE=KQ;const XQ="autocomplete";function fd(t,e,r,n,i,s,a){const{rootDocument:u}=t,h=a.allowHtml?dM:Na,c=u.createElement("DIV"),m=t.getSettings().ariaTags;if(c.className="htAutocompleteArrow",m&&c.setAttribute(...Ll()),c.appendChild(u.createTextNode("▼")),h.apply(this,[t,e,r,n,i,s,a]),e.firstChild||e.appendChild(u.createTextNode(" ")),e.insertBefore(c,e.firstChild),Re(e,"htAutocomplete"),!t.acArrowListener){const p=new ns(t);t.acArrowListener=function(v){nt(v.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},p.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{p.destroy()})}}fd.RENDERER_TYPE=XQ;const ZQ="dropdown";function fM(t,e,r,n,i,s,a){fd.apply(this,[t,e,r,n,i,s,a])}fM.RENDERER_TYPE=ZQ;const CD=new WeakMap,bD=new WeakMap,QQ="htBadValue",Xc="data-row",Zc="data-col",JQ="checkboxRenderer",Q$="checkbox";ze.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:n,type:i,row:s,column:a,prop:u}=e;if(i===Q$){if(n){const{value:h,property:c}=n;let m=r;if(h)m=typeof h=="function"?h(s,a,u,r):h;else if(c){const p=this.getDataAtRowProp(s,c);m=p!==null?p:r}t=m}return t}});function gM(t,e,r,n,i,s,a){const{rootDocument:u}=t,h=t.getSettings().ariaTags;cm.apply(this,[t,e,r,n,i,s,a]),eJ(t);let c=tJ(u);const m=a.label;let p=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Ls(e),s===a.checkedTemplate||Mr(s).toLocaleLowerCase(a.locale)===Mr(a.checkedTemplate).toLocaleLowerCase(a.locale)?c.checked=!0:s===a.uncheckedTemplate||Mr(s).toLocaleLowerCase(a.locale)===Mr(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?c.checked=!1:Ir(s)?Re(c,"noValue"):(c.style.display="none",Re(c,QQ),p=!0),it(c,[[Xc,r],[Zc,n]]),h&&it(c,[mw(c.checked?t.getTranslatedPhrase(nM):t.getTranslatedPhrase(iM)),sB(c.checked),hK()]),!p&&m){let R="";if(m.value)R=typeof m.value=="function"?m.value.call(this,r,n,i,s):m.value;else if(m.property){const x=t.getDataAtRowProp(r,m.property);R=x!==null?x:""}const _=rJ(u,R,m.separated!==!0);m.position==="before"?m.separated?(e.appendChild(_),e.appendChild(c)):(_.appendChild(c),c=_):(!m.position||m.position==="after")&&(m.separated?(e.appendChild(c),e.appendChild(_)):(_.insertBefore(c,_.firstChild),c=_))}(!m||m&&!m.separated)&&e.appendChild(c),p&&e.appendChild(u.createTextNode("#bad-value#")),CD.has(t)||(CD.set(t,!0),v());function v(){const _=t.getShortcutManager().getContext("grid"),x={group:JQ,relativeToGroup:Wl,position:"before"};_.addShortcuts([{keys:[["space"]],callback:()=>(y(),!C()),runOnlyIf:()=>{var I;return(I=t.getSelectedRangeLast())===null||I===void 0?void 0:I.highlight.isCell()}},{keys:[["enter"]],callback:()=>(y(),!C()),runOnlyIf:()=>{const I=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(I==null?void 0:I.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(y(!0),!C()),runOnlyIf:()=>{var I;return(I=t.getSelectedRangeLast())===null||I===void 0?void 0:I.highlight.isCell()}}],x)}function y(){let R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const _=t.getSelectedRange(),x=[],I=new Map;let k=[],W=0;if(_){for(let B=0;B<_.length;B++){const{row:z,col:U}=_[B].getTopStartCorner(),{row:J,col:se}=_[B].getBottomEndCorner();for(let ne=z;ne<=J;ne+=1)for(let fe=U;fe<=se;fe+=1){const j=t.getCellMeta(ne,fe);if(j.hidden)continue;const ae={checkedTemplate:j.checkedTemplate,uncheckedTemplate:j.uncheckedTemplate};if(j.type!=="checkbox"){R===!0&&!j.readOnly&&(I.has(x.length)?I.set(x.length,[...I.get(x.length),[ne,fe,null]]):I.set(x.length,[[ne,fe,null]]));continue}if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const P=t.getDataAtCell(ne,fe);R===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(P)?k.push([ne,fe,j.uncheckedTemplate,ae]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(P)&&k.push([ne,fe,j.checkedTemplate,ae]):k.push([ne,fe,j.uncheckedTemplate,ae]),W+=1}x.push(W),W=0}k.every(B=>{let[,,z]=B;return z===k[0][2]})?k=k.map(B=>{let[z,U,J]=B;return[z,U,J]}):k=k.map(B=>{let[z,U,,J]=B;return[z,U,J.checkedTemplate]}),k.length>0&&x.forEach((B,z)=>{let U=k.splice(0,B);I.size&&I.has(z)&&(U=[...U,...I.get(z)]),t.setDataAtCell(U)})}}function C(){const R=t.getSelectedRange();if(R){for(let _=0;_<R.length;_++){const x=R[_].getTopStartCorner(),I=R[_].getBottomEndCorner();for(let k=x.row;k<=I.row;k++)for(let W=x.col;W<=I.col;W++){if(t.getCellMeta(k,W).readOnly)continue;const z=t.getCell(k,W);if(z instanceof HTMLElement&&z.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}gM.RENDERER_TYPE=Q$;function eJ(t){let e=bD.get(t);if(!e){const{rootElement:r}=t;e=new ns(t),e.addEventListener(r,"click",n=>iJ(n,t)),e.addEventListener(r,"mouseup",n=>nJ(n,t)),e.addEventListener(r,"change",n=>sJ(n,t)),bD.set(t,e)}return e}function tJ(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function rJ(t,e,r){const n=t.createElement("label");return n.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`,n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function nJ(t,e){const{target:r}=t;mM(r)&&(!r.hasAttribute(Xc)||!r.hasAttribute(Zc)||setTimeout(e.listen,10))}function iJ(t,e){const{target:r}=t;if(!mM(r)||!r.hasAttribute(Xc)||!r.hasAttribute(Zc))return;const n=parseInt(r.getAttribute(Xc),10),i=parseInt(r.getAttribute(Zc),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}function sJ(t,e){const{target:r}=t;if(!mM(r)||!r.hasAttribute(Xc)||!r.hasAttribute(Zc))return;const n=parseInt(r.getAttribute(Xc),10),i=parseInt(r.getAttribute(Zc),10),s=e.getCellMeta(n,i);if(!s.readOnly){let a=null;t.target.checked?a=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:a=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(n,i,a)}}function mM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const oJ="handsontable";function pM(t,e,r,n,i,s,a){fd.apply(this,[t,e,r,n,i,s,a])}pM.RENDERER_TYPE=oJ;var aJ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lJ(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var _R,SD;function uJ(){return SD||(SD=1,_R={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),_R}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var TR,RD;function J$(){if(RD)return TR;RD=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(h,c,m,p,v,y,C){if(!isNaN(+h))return+h;let R="",_=h.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(_!==h)return-1*r(_,c,m,p,v,y);for(let z=0;z<t.length;z++){let U=t[z];if(R=h.replace(RegExp(`([0-9 ])(${U.key})$`),"$1"),R!==h)return r(R,c,m,p,v,y)*U.factor}if(R=h.replace("%",""),R!==h)return r(R,c,m,p,v,y)/100;let x=parseFloat(h);if(isNaN(x))return;let I=p(x);if(I&&I!=="."&&(R=h.replace(new RegExp(`${e(I)}$`),""),R!==h))return r(R,c,m,p,v,y);let k={};Object.keys(y).forEach(z=>{k[y[z]]=z});let W=Object.keys(k).sort().reverse(),B=W.length;for(let z=0;z<B;z++){let U=W[z],J=k[U];if(R=h.replace(U,""),R!==h){let se;switch(J){case"thousand":se=Math.pow(10,3);break;case"million":se=Math.pow(10,6);break;case"billion":se=Math.pow(10,9);break;case"trillion":se=Math.pow(10,12);break}return r(R,c,m,p,v,y)*se}}}function n(h,c,m){let p=h.replace(m,"");return p=p.replace(new RegExp(`([0-9])${e(c.thousands)}([0-9])`,"g"),"$1$2"),p=p.replace(c.decimal,"."),p}function i(h,c,m="",p,v,y,C){if(h==="")return;if(h===v)return 0;let R=n(h,c,m);return r(R,c,m,p,v,y)}function s(h,c){if(!(h.indexOf(":")&&c.thousands!==":"))return!1;let p=h.split(":");if(p.length!==3)return!1;let v=+p[0],y=+p[1],C=+p[2];return!isNaN(v)&&!isNaN(y)&&!isNaN(C)}function a(h){let c=h.split(":"),m=+c[0],p=+c[1];return+c[2]+60*p+3600*m}function u(h,c){const m=yM();let p=m.currentDelimiters(),v=m.currentCurrency().symbol,y=m.currentOrdinal(),C=m.getZeroFormat(),R=m.currentAbbreviations(),_;if(typeof h=="string")s(h,p)?_=a(h):_=i(h,p,v,y,C,R);else if(typeof h=="number")_=h;else return;if(_!==void 0)return _}return TR={unformat:u},TR}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var xR,ED;function vM(){if(ED)return xR;ED=1;let t=J$();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,r=["currency","percent","byte","time","ordinal","number"],n=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],s=["sign","parenthesis"],a={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},c={output:{type:"string",validValues:r},base:{type:"string",validValues:["decimal","binary","general"],restriction:(_,x)=>x.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:_=>_.output==="byte"},characteristic:{type:"number",restriction:_=>_>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:n},average:"boolean",lowPrecision:{type:"boolean",restriction:(_,x)=>x.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:_=>_>=0,message:"value must be positive"},{restriction:(_,x)=>!x.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:_=>_>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(_,x)=>x.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},m={languageTag:{type:"string",mandatory:!0,restriction:_=>_.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:a,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function p(_,x){let I=v(_),k=C(x);return I&&k}function v(_){return t.unformat(_)!==void 0}function y(_,x,I,k=!1){let W=Object.keys(_).map(B=>{if(!x[B])return console.error(`${I} Invalid key: ${B}`),!1;let z=_[B],U=x[B];if(typeof U=="string"&&(U={type:U}),U.type==="format"){if(!y(z,c,`[Validate ${B}]`,!0))return!1}else if(typeof z!==U.type)return console.error(`${I} ${B} type mismatched: "${U.type}" expected, "${typeof z}" provided`),!1;if(U.restrictions&&U.restrictions.length){let J=U.restrictions.length;for(let se=0;se<J;se++){let{restriction:ne,message:fe}=U.restrictions[se];if(!ne(z,_))return console.error(`${I} ${B} invalid value: ${fe}`),!1}}return U.restriction&&!U.restriction(z,_)?(console.error(`${I} ${B} invalid value: ${U.message}`),!1):U.validValues&&U.validValues.indexOf(z)===-1?(console.error(`${I} ${B} invalid value: must be among ${JSON.stringify(U.validValues)}, "${z}" provided`),!1):!(U.children&&!y(z,U.children,`[Validate ${B}]`))});return k||W.push(...Object.keys(x).map(B=>{let z=x[B];if(typeof z=="string"&&(z={type:z}),z.mandatory){let U=z.mandatory;if(typeof U=="function"&&(U=U(_)),U&&_[B]===void 0)return console.error(`${I} Missing mandatory key "${B}"`),!1}return!0})),W.reduce((B,z)=>B&&z,!0)}function C(_){return y(_,c,"[Validate format]")}function R(_){return y(_,m,"[Validate language]")}return xR={validate:p,validateFormat:C,validateInput:v,validateLanguage:R},xR}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function hJ(t,e){let r=t.match(/^{([^}]*)}/);return r?(e.prefix=r[1],t.slice(r[0].length)):t}function cJ(t,e){let r=t.match(/{([^}]*)}$/);return r?(e.postfix=r[1],t.slice(0,-r[0].length)):t}function dJ(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function fJ(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function gJ(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function mJ(t,e){let r=t.match(/[1-9]+[0-9]*/);r&&(e.totalLength=+r[0])}function pJ(t,e){let n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}function vJ(t,e){let r=t.split(".")[1];if(r){let n=r.match(/0+/);n&&(e.mantissa=n[0].length)}}function wJ(t,e){const r=t.split(".")[1];r&&(e.trimMantissa=r.indexOf("[")!==-1)}function yJ(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function CJ(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function bJ(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function SJ(t,e){if(t.indexOf(".")!==-1){let r=t.split(".")[0];e.optionalCharacteristic=r.indexOf("0")===-1}}function RJ(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function EJ(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function _J(t,e={}){return typeof t!="string"?t:(t=hJ(t,e),t=cJ(t,e),dJ(t,e),mJ(t,e),pJ(t,e),SJ(t,e),yJ(t,e),CJ(t,e),vJ(t,e),bJ(t,e),wJ(t,e),fJ(t,e),gJ(t,e),RJ(t,e),EJ(t,e),e)}var wM={parseFormat:_J};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var MR,_D;function yM(){if(_D)return MR;_D=1;const t=uJ(),e=vM(),r=wM;let n={},i,s={},a=null,u={};function h(m){i=m}function c(){return s[i]}return n.languages=()=>Object.assign({},s),n.currentLanguage=()=>i,n.currentBytes=()=>c().bytes||{},n.currentCurrency=()=>c().currency,n.currentAbbreviations=()=>c().abbreviations,n.currentDelimiters=()=>c().delimiters,n.currentOrdinal=()=>c().ordinal,n.currentDefaults=()=>Object.assign({},c().defaults,u),n.currentOrdinalDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().ordinalFormat),n.currentByteDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().byteFormat),n.currentPercentageDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().percentageFormat),n.currentCurrencyDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().currencyFormat),n.currentTimeDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().timeFormat),n.setDefaults=m=>{m=r.parseFormat(m),e.validateFormat(m)&&(u=m)},n.getZeroFormat=()=>a,n.setZeroFormat=m=>a=typeof m=="string"?m:null,n.hasZeroFormat=()=>a!==null,n.languageData=m=>{if(m){if(s[m])return s[m];throw new Error(`Unknown tag "${m}"`)}return c()},n.registerLanguage=(m,p=!1)=>{if(!e.validateLanguage(m))throw new Error("Invalid language data");s[m.languageTag]=m,p&&h(m.languageTag)},n.setLanguage=(m,p=t.languageTag)=>{if(!s[m]){let v=m.split("-")[0],y=Object.keys(s).find(C=>C.split("-")[0]===v);if(!s[y]){h(p);return}h(y);return}h(m)},n.registerLanguage(t),i=t.languageTag,MR=n,MR}function TJ(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function xJ(t,e){t.forEach(r=>{let n;try{n=TJ(`../languages/${r}`)}catch{console.error(`Unable to load "${r}". No matching language file found.`)}n&&e.registerLanguage(n)})}var MJ=t=>({loadLanguagesInNode:e=>xJ(e,t)}),eV={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,a="[BigNumber Error] ",u=a+"Number primitive has more than 15 significant digits: ",h=1e14,c=14,m=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,y=1e9;function C(z){var U,J,se,ne=$.prototype={constructor:$,toString:null,valueOf:null},fe=new $(1),j=20,ae=4,P=-7,ie=21,Le=-1e7,me=1e7,Ae=!1,ve=1,Be=0,E={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},M="0123456789abcdefghijklmnopqrstuvwxyz",D=!0;function $(L,F){var Z,le,S,Y,K,H,A,V,G=this;if(!(G instanceof $))return new $(L,F);if(F==null){if(L&&L._isBigNumber===!0){G.s=L.s,!L.c||L.e>me?G.c=G.e=null:L.e<Le?G.c=[G.e=0]:(G.e=L.e,G.c=L.c.slice());return}if((H=typeof L=="number")&&L*0==0){if(G.s=1/L<0?(L=-L,-1):1,L===~~L){for(Y=0,K=L;K>=10;K/=10,Y++);Y>me?G.c=G.e=null:(G.e=Y,G.c=[L]);return}V=String(L)}else{if(!n.test(V=String(L)))return se(G,V,H);G.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}(Y=V.indexOf("."))>-1&&(V=V.replace(".","")),(K=V.search(/e/i))>0?(Y<0&&(Y=K),Y+=+V.slice(K+1),V=V.substring(0,K)):Y<0&&(Y=V.length)}else{if(I(F,2,M.length,"Base"),F==10&&D)return G=new $(L),ge(G,j+G.e+1,ae);if(V=String(L),H=typeof L=="number"){if(L*0!=0)return se(G,V,H,F);if(G.s=1/L<0?(V=V.slice(1),-1):1,$.DEBUG&&V.replace(/^0\.0*|\./,"").length>15)throw Error(u+L)}else G.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(Z=M.slice(0,F),Y=K=0,A=V.length;K<A;K++)if(Z.indexOf(le=V.charAt(K))<0){if(le=="."){if(K>Y){Y=A;continue}}else if(!S&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){S=!0,K=-1,Y=0;continue}return se(G,String(L),H,F)}H=!1,V=J(V,F,10,G.s),(Y=V.indexOf("."))>-1?V=V.replace(".",""):Y=V.length}for(K=0;V.charCodeAt(K)===48;K++);for(A=V.length;V.charCodeAt(--A)===48;);if(V=V.slice(K,++A)){if(A-=K,H&&$.DEBUG&&A>15&&(L>m||L!==s(L)))throw Error(u+G.s*L);if((Y=Y-K-1)>me)G.c=G.e=null;else if(Y<Le)G.c=[G.e=0];else{if(G.e=Y,G.c=[],K=(Y+1)%c,Y<0&&(K+=c),K<A){for(K&&G.c.push(+V.slice(0,K)),A-=c;K<A;)G.c.push(+V.slice(K,K+=c));K=c-(V=V.slice(K)).length}else K-=A;for(;K--;V+="0");G.c.push(+V)}}else G.c=[G.e=0]}$.clone=C,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.EUCLID=9,$.config=$.set=function(L){var F,Z;if(L!=null)if(typeof L=="object"){if(L.hasOwnProperty(F="DECIMAL_PLACES")&&(Z=L[F],I(Z,0,y,F),j=Z),L.hasOwnProperty(F="ROUNDING_MODE")&&(Z=L[F],I(Z,0,8,F),ae=Z),L.hasOwnProperty(F="EXPONENTIAL_AT")&&(Z=L[F],Z&&Z.pop?(I(Z[0],-1e9,0,F),I(Z[1],0,y,F),P=Z[0],ie=Z[1]):(I(Z,-1e9,y,F),P=-(ie=Z<0?-Z:Z))),L.hasOwnProperty(F="RANGE"))if(Z=L[F],Z&&Z.pop)I(Z[0],-1e9,-1,F),I(Z[1],1,y,F),Le=Z[0],me=Z[1];else if(I(Z,-1e9,y,F),Z)Le=-(me=Z<0?-Z:Z);else throw Error(a+F+" cannot be zero: "+Z);if(L.hasOwnProperty(F="CRYPTO"))if(Z=L[F],Z===!!Z)if(Z)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ae=Z;else throw Ae=!Z,Error(a+"crypto unavailable");else Ae=Z;else throw Error(a+F+" not true or false: "+Z);if(L.hasOwnProperty(F="MODULO_MODE")&&(Z=L[F],I(Z,0,9,F),ve=Z),L.hasOwnProperty(F="POW_PRECISION")&&(Z=L[F],I(Z,0,y,F),Be=Z),L.hasOwnProperty(F="FORMAT"))if(Z=L[F],typeof Z=="object")E=Z;else throw Error(a+F+" not an object: "+Z);if(L.hasOwnProperty(F="ALPHABET"))if(Z=L[F],typeof Z=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Z))D=Z.slice(0,10)=="0123456789",M=Z;else throw Error(a+F+" invalid: "+Z)}else throw Error(a+"Object expected: "+L);return{DECIMAL_PLACES:j,ROUNDING_MODE:ae,EXPONENTIAL_AT:[P,ie],RANGE:[Le,me],CRYPTO:Ae,MODULO_MODE:ve,POW_PRECISION:Be,FORMAT:E,ALPHABET:M}},$.isBigNumber=function(L){if(!L||L._isBigNumber!==!0)return!1;if(!$.DEBUG)return!0;var F,Z,le=L.c,S=L.e,Y=L.s;e:if({}.toString.call(le)=="[object Array]"){if((Y===1||Y===-1)&&S>=-1e9&&S<=y&&S===s(S)){if(le[0]===0){if(S===0&&le.length===1)return!0;break e}if(F=(S+1)%c,F<1&&(F+=c),String(le[0]).length==F){for(F=0;F<le.length;F++)if(Z=le[F],Z<0||Z>=h||Z!==s(Z))break e;if(Z!==0)return!0}}}else if(le===null&&S===null&&(Y===null||Y===1||Y===-1))return!0;throw Error(a+"Invalid BigNumber: "+L)},$.maximum=$.max=function(){return ce(arguments,-1)},$.minimum=$.min=function(){return ce(arguments,1)},$.random=function(){var L=9007199254740992,F=Math.random()*L&2097151?function(){return s(Math.random()*L)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Z){var le,S,Y,K,H,A=0,V=[],G=new $(fe);if(Z==null?Z=j:I(Z,0,y),K=i(Z/c),Ae)if(crypto.getRandomValues){for(le=crypto.getRandomValues(new Uint32Array(K*=2));A<K;)H=le[A]*131072+(le[A+1]>>>11),H>=9e15?(S=crypto.getRandomValues(new Uint32Array(2)),le[A]=S[0],le[A+1]=S[1]):(V.push(H%1e14),A+=2);A=K/2}else if(crypto.randomBytes){for(le=crypto.randomBytes(K*=7);A<K;)H=(le[A]&31)*281474976710656+le[A+1]*1099511627776+le[A+2]*4294967296+le[A+3]*16777216+(le[A+4]<<16)+(le[A+5]<<8)+le[A+6],H>=9e15?crypto.randomBytes(7).copy(le,A):(V.push(H%1e14),A+=7);A=K/7}else throw Ae=!1,Error(a+"crypto unavailable");if(!Ae)for(;A<K;)H=F(),H<9e15&&(V[A++]=H%1e14);for(K=V[--A],Z%=c,K&&Z&&(H=p[c-Z],V[A]=s(K/H)*H);V[A]===0;V.pop(),A--);if(A<0)V=[Y=0];else{for(Y=-1;V[0]===0;V.splice(0,1),Y-=c);for(A=1,H=V[0];H>=10;H/=10,A++);A<c&&(Y-=c-A)}return G.e=Y,G.c=V,G}}(),$.sum=function(){for(var L=1,F=arguments,Z=new $(F[0]);L<F.length;)Z=Z.plus(F[L++]);return Z},J=function(){var L="0123456789";function F(Z,le,S,Y){for(var K,H=[0],A,V=0,G=Z.length;V<G;){for(A=H.length;A--;H[A]*=le);for(H[0]+=Y.indexOf(Z.charAt(V++)),K=0;K<H.length;K++)H[K]>S-1&&(H[K+1]==null&&(H[K+1]=0),H[K+1]+=H[K]/S|0,H[K]%=S)}return H.reverse()}return function(Z,le,S,Y,K){var H,A,V,G,ee,re,de,be,ye=Z.indexOf("."),Ie=j,Ne=ae;for(ye>=0&&(G=Be,Be=0,Z=Z.replace(".",""),be=new $(le),re=be.pow(Z.length-ye),Be=G,be.c=F(B(_(re.c),re.e,"0"),10,S,L),be.e=be.c.length),de=F(Z,le,S,K?(H=M,L):(H=L,M)),V=G=de.length;de[--G]==0;de.pop());if(!de[0])return H.charAt(0);if(ye<0?--V:(re.c=de,re.e=V,re.s=Y,re=U(re,be,Ie,Ne,S),de=re.c,ee=re.r,V=re.e),A=V+Ie+1,ye=de[A],G=S/2,ee=ee||A<0||de[A+1]!=null,ee=Ne<4?(ye!=null||ee)&&(Ne==0||Ne==(re.s<0?3:2)):ye>G||ye==G&&(Ne==4||ee||Ne==6&&de[A-1]&1||Ne==(re.s<0?8:7)),A<1||!de[0])Z=ee?B(H.charAt(1),-Ie,H.charAt(0)):H.charAt(0);else{if(de.length=A,ee)for(--S;++de[--A]>S;)de[A]=0,A||(++V,de=[1].concat(de));for(G=de.length;!de[--G];);for(ye=0,Z="";ye<=G;Z+=H.charAt(de[ye++]));Z=B(Z,V,H.charAt(0))}return Z}}(),U=function(){function L(le,S,Y){var K,H,A,V,G=0,ee=le.length,re=S%v,de=S/v|0;for(le=le.slice();ee--;)A=le[ee]%v,V=le[ee]/v|0,K=de*A+V*re,H=re*A+K%v*v+G,G=(H/Y|0)+(K/v|0)+de*V,le[ee]=H%Y;return G&&(le=[G].concat(le)),le}function F(le,S,Y,K){var H,A;if(Y!=K)A=Y>K?1:-1;else for(H=A=0;H<Y;H++)if(le[H]!=S[H]){A=le[H]>S[H]?1:-1;break}return A}function Z(le,S,Y,K){for(var H=0;Y--;)le[Y]-=H,H=le[Y]<S[Y]?1:0,le[Y]=H*K+le[Y]-S[Y];for(;!le[0]&&le.length>1;le.splice(0,1));}return function(le,S,Y,K,H){var A,V,G,ee,re,de,be,ye,Ie,Ne,ke,Rt,Br,pr,zt,ht,Ht,Mt=le.s==S.s?1:-1,ft=le.c,st=S.c;if(!ft||!ft[0]||!st||!st[0])return new $(!le.s||!S.s||(ft?st&&ft[0]==st[0]:!st)?NaN:ft&&ft[0]==0||!st?Mt*0:Mt/0);for(ye=new $(Mt),Ie=ye.c=[],V=le.e-S.e,Mt=Y+V+1,H||(H=h,V=R(le.e/c)-R(S.e/c),Mt=Mt/c|0),G=0;st[G]==(ft[G]||0);G++);if(st[G]>(ft[G]||0)&&V--,Mt<0)Ie.push(1),ee=!0;else{for(pr=ft.length,ht=st.length,G=0,Mt+=2,re=s(H/(st[0]+1)),re>1&&(st=L(st,re,H),ft=L(ft,re,H),ht=st.length,pr=ft.length),Br=ht,Ne=ft.slice(0,ht),ke=Ne.length;ke<ht;Ne[ke++]=0);Ht=st.slice(),Ht=[0].concat(Ht),zt=st[0],st[1]>=H/2&&zt++;do{if(re=0,A=F(st,Ne,ht,ke),A<0){if(Rt=Ne[0],ht!=ke&&(Rt=Rt*H+(Ne[1]||0)),re=s(Rt/zt),re>1)for(re>=H&&(re=H-1),de=L(st,re,H),be=de.length,ke=Ne.length;F(de,Ne,be,ke)==1;)re--,Z(de,ht<be?Ht:st,be,H),be=de.length,A=1;else re==0&&(A=re=1),de=st.slice(),be=de.length;if(be<ke&&(de=[0].concat(de)),Z(Ne,de,ke,H),ke=Ne.length,A==-1)for(;F(st,Ne,ht,ke)<1;)re++,Z(Ne,ht<ke?Ht:st,ke,H),ke=Ne.length}else A===0&&(re++,Ne=[0]);Ie[G++]=re,Ne[0]?Ne[ke++]=ft[Br]||0:(Ne=[ft[Br]],ke=1)}while((Br++<pr||Ne[0]!=null)&&Mt--);ee=Ne[0]!=null,Ie[0]||Ie.splice(0,1)}if(H==h){for(G=1,Mt=Ie[0];Mt>=10;Mt/=10,G++);ge(ye,Y+(ye.e=G+V*c-1)+1,K,ee)}else ye.e=V,ye.r=+ee;return ye}}();function X(L,F,Z,le){var S,Y,K,H,A;if(Z==null?Z=ae:I(Z,0,8),!L.c)return L.toString();if(S=L.c[0],K=L.e,F==null)A=_(L.c),A=le==1||le==2&&(K<=P||K>=ie)?W(A,K):B(A,K,"0");else if(L=ge(new $(L),F,Z),Y=L.e,A=_(L.c),H=A.length,le==1||le==2&&(F<=Y||Y<=P)){for(;H<F;A+="0",H++);A=W(A,Y)}else if(F-=K,A=B(A,Y,"0"),Y+1>H){if(--F>0)for(A+=".";F--;A+="0");}else if(F+=Y-H,F>0)for(Y+1==H&&(A+=".");F--;A+="0");return L.s<0&&S?"-"+A:A}function ce(L,F){for(var Z,le,S=1,Y=new $(L[0]);S<L.length;S++)le=new $(L[S]),(!le.s||(Z=x(Y,le))===F||Z===0&&Y.s===F)&&(Y=le);return Y}function we(L,F,Z){for(var le=1,S=F.length;!F[--S];F.pop());for(S=F[0];S>=10;S/=10,le++);return(Z=le+Z*c-1)>me?L.c=L.e=null:Z<Le?L.c=[L.e=0]:(L.e=Z,L.c=F),L}se=function(){var L=/^(-?)0([xbo])(?=\w[\w.]*$)/i,F=/^([^.]+)\.$/,Z=/^\.([^.]+)$/,le=/^-?(Infinity|NaN)$/,S=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Y,K,H,A){var V,G=H?K:K.replace(S,"");if(le.test(G))Y.s=isNaN(G)?null:G<0?-1:1;else{if(!H&&(G=G.replace(L,function(ee,re,de){return V=(de=de.toLowerCase())=="x"?16:de=="b"?2:8,!A||A==V?re:ee}),A&&(V=A,G=G.replace(F,"$1").replace(Z,"0.$1")),K!=G))return new $(G,V);if($.DEBUG)throw Error(a+"Not a"+(A?" base "+A:"")+" number: "+K);Y.s=null}Y.c=Y.e=null}}();function ge(L,F,Z,le){var S,Y,K,H,A,V,G,ee=L.c,re=p;if(ee){e:{for(S=1,H=ee[0];H>=10;H/=10,S++);if(Y=F-S,Y<0)Y+=c,K=F,A=ee[V=0],G=s(A/re[S-K-1]%10);else if(V=i((Y+1)/c),V>=ee.length)if(le){for(;ee.length<=V;ee.push(0));A=G=0,S=1,Y%=c,K=Y-c+1}else break e;else{for(A=H=ee[V],S=1;H>=10;H/=10,S++);Y%=c,K=Y-c+S,G=K<0?0:s(A/re[S-K-1]%10)}if(le=le||F<0||ee[V+1]!=null||(K<0?A:A%re[S-K-1]),le=Z<4?(G||le)&&(Z==0||Z==(L.s<0?3:2)):G>5||G==5&&(Z==4||le||Z==6&&(Y>0?K>0?A/re[S-K]:0:ee[V-1])%10&1||Z==(L.s<0?8:7)),F<1||!ee[0])return ee.length=0,le?(F-=L.e+1,ee[0]=re[(c-F%c)%c],L.e=-F||0):ee[0]=L.e=0,L;if(Y==0?(ee.length=V,H=1,V--):(ee.length=V+1,H=re[c-Y],ee[V]=K>0?s(A/re[S-K]%re[K])*H:0),le)for(;;)if(V==0){for(Y=1,K=ee[0];K>=10;K/=10,Y++);for(K=ee[0]+=H,H=1;K>=10;K/=10,H++);Y!=H&&(L.e++,ee[0]==h&&(ee[0]=1));break}else{if(ee[V]+=H,ee[V]!=h)break;ee[V--]=0,H=1}for(Y=ee.length;ee[--Y]===0;ee.pop());}L.e>me?L.c=L.e=null:L.e<Le&&(L.c=[L.e=0])}return L}function Se(L){var F,Z=L.e;return Z===null?L.toString():(F=_(L.c),F=Z<=P||Z>=ie?W(F,Z):B(F,Z,"0"),L.s<0?"-"+F:F)}return ne.absoluteValue=ne.abs=function(){var L=new $(this);return L.s<0&&(L.s=1),L},ne.comparedTo=function(L,F){return x(this,new $(L,F))},ne.decimalPlaces=ne.dp=function(L,F){var Z,le,S,Y=this;if(L!=null)return I(L,0,y),F==null?F=ae:I(F,0,8),ge(new $(Y),L+Y.e+1,F);if(!(Z=Y.c))return null;if(le=((S=Z.length-1)-R(this.e/c))*c,S=Z[S])for(;S%10==0;S/=10,le--);return le<0&&(le=0),le},ne.dividedBy=ne.div=function(L,F){return U(this,new $(L,F),j,ae)},ne.dividedToIntegerBy=ne.idiv=function(L,F){return U(this,new $(L,F),0,1)},ne.exponentiatedBy=ne.pow=function(L,F){var Z,le,S,Y,K,H,A,V,G,ee=this;if(L=new $(L),L.c&&!L.isInteger())throw Error(a+"Exponent not an integer: "+Se(L));if(F!=null&&(F=new $(F)),H=L.e>14,!ee.c||!ee.c[0]||ee.c[0]==1&&!ee.e&&ee.c.length==1||!L.c||!L.c[0])return G=new $(Math.pow(+Se(ee),H?L.s*(2-k(L)):+Se(L))),F?G.mod(F):G;if(A=L.s<0,F){if(F.c?!F.c[0]:!F.s)return new $(NaN);le=!A&&ee.isInteger()&&F.isInteger(),le&&(ee=ee.mod(F))}else{if(L.e>9&&(ee.e>0||ee.e<-1||(ee.e==0?ee.c[0]>1||H&&ee.c[1]>=24e7:ee.c[0]<8e13||H&&ee.c[0]<=9999975e7)))return Y=ee.s<0&&k(L)?-0:0,ee.e>-1&&(Y=1/Y),new $(A?1/Y:Y);Be&&(Y=i(Be/c+2))}for(H?(Z=new $(.5),A&&(L.s=1),V=k(L)):(S=Math.abs(+Se(L)),V=S%2),G=new $(fe);;){if(V){if(G=G.times(ee),!G.c)break;Y?G.c.length>Y&&(G.c.length=Y):le&&(G=G.mod(F))}if(S){if(S=s(S/2),S===0)break;V=S%2}else if(L=L.times(Z),ge(L,L.e+1,1),L.e>14)V=k(L);else{if(S=+Se(L),S===0)break;V=S%2}ee=ee.times(ee),Y?ee.c&&ee.c.length>Y&&(ee.c.length=Y):le&&(ee=ee.mod(F))}return le?G:(A&&(G=fe.div(G)),F?G.mod(F):Y?ge(G,Be,ae,K):G)},ne.integerValue=function(L){var F=new $(this);return L==null?L=ae:I(L,0,8),ge(F,F.e+1,L)},ne.isEqualTo=ne.eq=function(L,F){return x(this,new $(L,F))===0},ne.isFinite=function(){return!!this.c},ne.isGreaterThan=ne.gt=function(L,F){return x(this,new $(L,F))>0},ne.isGreaterThanOrEqualTo=ne.gte=function(L,F){return(F=x(this,new $(L,F)))===1||F===0},ne.isInteger=function(){return!!this.c&&R(this.e/c)>this.c.length-2},ne.isLessThan=ne.lt=function(L,F){return x(this,new $(L,F))<0},ne.isLessThanOrEqualTo=ne.lte=function(L,F){return(F=x(this,new $(L,F)))===-1||F===0},ne.isNaN=function(){return!this.s},ne.isNegative=function(){return this.s<0},ne.isPositive=function(){return this.s>0},ne.isZero=function(){return!!this.c&&this.c[0]==0},ne.minus=function(L,F){var Z,le,S,Y,K=this,H=K.s;if(L=new $(L,F),F=L.s,!H||!F)return new $(NaN);if(H!=F)return L.s=-F,K.plus(L);var A=K.e/c,V=L.e/c,G=K.c,ee=L.c;if(!A||!V){if(!G||!ee)return G?(L.s=-F,L):new $(ee?K:NaN);if(!G[0]||!ee[0])return ee[0]?(L.s=-F,L):new $(G[0]?K:ae==3?-0:0)}if(A=R(A),V=R(V),G=G.slice(),H=A-V){for((Y=H<0)?(H=-H,S=G):(V=A,S=ee),S.reverse(),F=H;F--;S.push(0));S.reverse()}else for(le=(Y=(H=G.length)<(F=ee.length))?H:F,H=F=0;F<le;F++)if(G[F]!=ee[F]){Y=G[F]<ee[F];break}if(Y&&(S=G,G=ee,ee=S,L.s=-L.s),F=(le=ee.length)-(Z=G.length),F>0)for(;F--;G[Z++]=0);for(F=h-1;le>H;){if(G[--le]<ee[le]){for(Z=le;Z&&!G[--Z];G[Z]=F);--G[Z],G[le]+=h}G[le]-=ee[le]}for(;G[0]==0;G.splice(0,1),--V);return G[0]?we(L,G,V):(L.s=ae==3?-1:1,L.c=[L.e=0],L)},ne.modulo=ne.mod=function(L,F){var Z,le,S=this;return L=new $(L,F),!S.c||!L.s||L.c&&!L.c[0]?new $(NaN):!L.c||S.c&&!S.c[0]?new $(S):(ve==9?(le=L.s,L.s=1,Z=U(S,L,0,3),L.s=le,Z.s*=le):Z=U(S,L,0,ve),L=S.minus(Z.times(L)),!L.c[0]&&ve==1&&(L.s=S.s),L)},ne.multipliedBy=ne.times=function(L,F){var Z,le,S,Y,K,H,A,V,G,ee,re,de,be,ye,Ie,Ne=this,ke=Ne.c,Rt=(L=new $(L,F)).c;if(!ke||!Rt||!ke[0]||!Rt[0])return!Ne.s||!L.s||ke&&!ke[0]&&!Rt||Rt&&!Rt[0]&&!ke?L.c=L.e=L.s=null:(L.s*=Ne.s,!ke||!Rt?L.c=L.e=null:(L.c=[0],L.e=0)),L;for(le=R(Ne.e/c)+R(L.e/c),L.s*=Ne.s,A=ke.length,ee=Rt.length,A<ee&&(be=ke,ke=Rt,Rt=be,S=A,A=ee,ee=S),S=A+ee,be=[];S--;be.push(0));for(ye=h,Ie=v,S=ee;--S>=0;){for(Z=0,re=Rt[S]%Ie,de=Rt[S]/Ie|0,K=A,Y=S+K;Y>S;)V=ke[--K]%Ie,G=ke[K]/Ie|0,H=de*V+G*re,V=re*V+H%Ie*Ie+be[Y]+Z,Z=(V/ye|0)+(H/Ie|0)+de*G,be[Y--]=V%ye;be[Y]=Z}return Z?++le:be.splice(0,1),we(L,be,le)},ne.negated=function(){var L=new $(this);return L.s=-L.s||null,L},ne.plus=function(L,F){var Z,le=this,S=le.s;if(L=new $(L,F),F=L.s,!S||!F)return new $(NaN);if(S!=F)return L.s=-F,le.minus(L);var Y=le.e/c,K=L.e/c,H=le.c,A=L.c;if(!Y||!K){if(!H||!A)return new $(S/0);if(!H[0]||!A[0])return A[0]?L:new $(H[0]?le:S*0)}if(Y=R(Y),K=R(K),H=H.slice(),S=Y-K){for(S>0?(K=Y,Z=A):(S=-S,Z=H),Z.reverse();S--;Z.push(0));Z.reverse()}for(S=H.length,F=A.length,S-F<0&&(Z=A,A=H,H=Z,F=S),S=0;F;)S=(H[--F]=H[F]+A[F]+S)/h|0,H[F]=h===H[F]?0:H[F]%h;return S&&(H=[S].concat(H),++K),we(L,H,K)},ne.precision=ne.sd=function(L,F){var Z,le,S,Y=this;if(L!=null&&L!==!!L)return I(L,1,y),F==null?F=ae:I(F,0,8),ge(new $(Y),L,F);if(!(Z=Y.c))return null;if(S=Z.length-1,le=S*c+1,S=Z[S]){for(;S%10==0;S/=10,le--);for(S=Z[0];S>=10;S/=10,le++);}return L&&Y.e+1>le&&(le=Y.e+1),le},ne.shiftedBy=function(L){return I(L,-9007199254740991,m),this.times("1e"+L)},ne.squareRoot=ne.sqrt=function(){var L,F,Z,le,S,Y=this,K=Y.c,H=Y.s,A=Y.e,V=j+4,G=new $("0.5");if(H!==1||!K||!K[0])return new $(!H||H<0&&(!K||K[0])?NaN:K?Y:1/0);if(H=Math.sqrt(+Se(Y)),H==0||H==1/0?(F=_(K),(F.length+A)%2==0&&(F+="0"),H=Math.sqrt(+F),A=R((A+1)/2)-(A<0||A%2),H==1/0?F="5e"+A:(F=H.toExponential(),F=F.slice(0,F.indexOf("e")+1)+A),Z=new $(F)):Z=new $(H+""),Z.c[0]){for(A=Z.e,H=A+V,H<3&&(H=0);;)if(S=Z,Z=G.times(S.plus(U(Y,S,V,1))),_(S.c).slice(0,H)===(F=_(Z.c)).slice(0,H))if(Z.e<A&&--H,F=F.slice(H-3,H+1),F=="9999"||!le&&F=="4999"){if(!le&&(ge(S,S.e+j+2,0),S.times(S).eq(Y))){Z=S;break}V+=4,H+=4,le=1}else{(!+F||!+F.slice(1)&&F.charAt(0)=="5")&&(ge(Z,Z.e+j+2,1),L=!Z.times(Z).eq(Y));break}}return ge(Z,Z.e+j+1,ae,L)},ne.toExponential=function(L,F){return L!=null&&(I(L,0,y),L++),X(this,L,F,1)},ne.toFixed=function(L,F){return L!=null&&(I(L,0,y),L=L+this.e+1),X(this,L,F)},ne.toFormat=function(L,F,Z){var le,S=this;if(Z==null)L!=null&&F&&typeof F=="object"?(Z=F,F=null):L&&typeof L=="object"?(Z=L,L=F=null):Z=E;else if(typeof Z!="object")throw Error(a+"Argument not an object: "+Z);if(le=S.toFixed(L,F),S.c){var Y,K=le.split("."),H=+Z.groupSize,A=+Z.secondaryGroupSize,V=Z.groupSeparator||"",G=K[0],ee=K[1],re=S.s<0,de=re?G.slice(1):G,be=de.length;if(A&&(Y=H,H=A,A=Y,be-=Y),H>0&&be>0){for(Y=be%H||H,G=de.substr(0,Y);Y<be;Y+=H)G+=V+de.substr(Y,H);A>0&&(G+=V+de.slice(Y)),re&&(G="-"+G)}le=ee?G+(Z.decimalSeparator||"")+((A=+Z.fractionGroupSize)?ee.replace(new RegExp("\\d{"+A+"}\\B","g"),"$&"+(Z.fractionGroupSeparator||"")):ee):G}return(Z.prefix||"")+le+(Z.suffix||"")},ne.toFraction=function(L){var F,Z,le,S,Y,K,H,A,V,G,ee,re,de=this,be=de.c;if(L!=null&&(H=new $(L),!H.isInteger()&&(H.c||H.s!==1)||H.lt(fe)))throw Error(a+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+Se(H));if(!be)return new $(de);for(F=new $(fe),V=Z=new $(fe),le=A=new $(fe),re=_(be),Y=F.e=re.length-de.e-1,F.c[0]=p[(K=Y%c)<0?c+K:K],L=!L||H.comparedTo(F)>0?Y>0?F:V:H,K=me,me=1/0,H=new $(re),A.c[0]=0;G=U(H,F,0,1),S=Z.plus(G.times(le)),S.comparedTo(L)!=1;)Z=le,le=S,V=A.plus(G.times(S=V)),A=S,F=H.minus(G.times(S=F)),H=S;return S=U(L.minus(Z),le,0,1),A=A.plus(S.times(V)),Z=Z.plus(S.times(le)),A.s=V.s=de.s,Y=Y*2,ee=U(V,le,Y,ae).minus(de).abs().comparedTo(U(A,Z,Y,ae).minus(de).abs())<1?[V,le]:[A,Z],me=K,ee},ne.toNumber=function(){return+Se(this)},ne.toPrecision=function(L,F){return L!=null&&I(L,1,y),X(this,L,F,2)},ne.toString=function(L){var F,Z=this,le=Z.s,S=Z.e;return S===null?le?(F="Infinity",le<0&&(F="-"+F)):F="NaN":(L==null?F=S<=P||S>=ie?W(_(Z.c),S):B(_(Z.c),S,"0"):L===10&&D?(Z=ge(new $(Z),j+S+1,ae),F=B(_(Z.c),Z.e,"0")):(I(L,2,M.length,"Base"),F=J(B(_(Z.c),S,"0"),10,L,le,!0)),le<0&&Z.c[0]&&(F="-"+F)),F},ne.valueOf=ne.toJSON=function(){return Se(this)},ne._isBigNumber=!0,z!=null&&$.set(z),$}function R(z){var U=z|0;return z>0||z===U?U:U-1}function _(z){for(var U,J,se=1,ne=z.length,fe=z[0]+"";se<ne;){for(U=z[se++]+"",J=c-U.length;J--;U="0"+U);fe+=U}for(ne=fe.length;fe.charCodeAt(--ne)===48;);return fe.slice(0,ne+1||1)}function x(z,U){var J,se,ne=z.c,fe=U.c,j=z.s,ae=U.s,P=z.e,ie=U.e;if(!j||!ae)return null;if(J=ne&&!ne[0],se=fe&&!fe[0],J||se)return J?se?0:-ae:j;if(j!=ae)return j;if(J=j<0,se=P==ie,!ne||!fe)return se?0:!ne^J?1:-1;if(!se)return P>ie^J?1:-1;for(ae=(P=ne.length)<(ie=fe.length)?P:ie,j=0;j<ae;j++)if(ne[j]!=fe[j])return ne[j]>fe[j]^J?1:-1;return P==ie?0:P>ie^J?1:-1}function I(z,U,J,se){if(z<U||z>J||z!==s(z))throw Error(a+(se||"Argument")+(typeof z=="number"?z<U||z>J?" out of range: ":" not an integer: ":" not a primitive number: ")+String(z))}function k(z){var U=z.c.length-1;return R(z.e/c)==U&&z.c[U]%2!=0}function W(z,U){return(z.length>1?z.charAt(0)+"."+z.slice(1):z)+(U<0?"e":"e+")+U}function B(z,U,J){var se,ne;if(U<0){for(ne=J+".";++U;ne+=J);z=ne+z}else if(se=z.length,++U>se){for(ne=J,U-=se;--U;ne+=J);z+=ne}else U<se&&(z=z.slice(0,U)+"."+z.slice(U));return z}r=C(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(aJ)})(eV);var tV=eV.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const _s=yM(),IJ=vM(),OJ=wM,PJ=tV,_n={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},dm={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:rV,decimalSuffixes:Mw}=_s.currentBytes(),CM={general:{scale:1024,suffixes:Mw},binary:{scale:1024,suffixes:rV},decimal:{scale:1e3,suffixes:Mw}};function AJ(t,e={},r){if(typeof e=="string"&&(e=OJ.parseFormat(e)),!IJ.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",s=e.postfix||"",a=HJ(t,e,r);return a=QJ(a,i),a=JJ(a,s),a}function HJ(t,e,r){switch(e.output){case"currency":return e=Ec(e,_s.currentCurrencyDefaultFormat()),$J(t,e,_s);case"percent":return e=Ec(e,_s.currentPercentageDefaultFormat()),BJ(t,e,_s,r);case"byte":return e=Ec(e,_s.currentByteDefaultFormat()),LJ(t,e,_s,r);case"time":return e=Ec(e,_s.currentTimeDefaultFormat()),WJ(t);case"ordinal":return e=Ec(e,_s.currentOrdinalDefaultFormat()),FJ(t,e,_s);case"number":default:return fm({instance:t,providedFormat:e})}}function NJ(t){let e=CM.decimal;return jy(t._value,e.suffixes,e.scale).suffix}function kJ(t){let e=CM.binary;return jy(t._value,e.suffixes,e.scale).suffix}function DJ(t){let e=CM.general;return jy(t._value,e.suffixes,e.scale).suffix}function jy(t,e,r){let n=e[0],i=Math.abs(t);if(i>=r){for(let s=1;s<e.length;++s){let a=Math.pow(r,s),u=Math.pow(r,s+1);if(i>=a&&i<u){n=e[s],t=t/a;break}}n===e[0]&&(t=t/Math.pow(r,e.length-1),n=e[e.length-1])}return{value:t,suffix:n}}function LJ(t,e,r,n){let i=e.base||"binary",s=Object.assign({},dm,e);const{binarySuffixes:a,decimalSuffixes:u}=r.currentBytes();let c={general:{scale:1024,suffixes:u||Mw,marker:"bd"},binary:{scale:1024,suffixes:a||rV,marker:"b"},decimal:{scale:1e3,suffixes:u||Mw,marker:"d"}}[i],{value:m,suffix:p}=jy(t._value,c.suffixes,c.scale);return`${fm({instance:n(m),providedFormat:e,state:r,defaults:r.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${p}`}function FJ(t,e,r){let n=r.currentOrdinal(),i=Object.assign({},dm,e),s=fm({instance:t,providedFormat:e,state:r}),a=n(t._value);return`${s}${i.spaceSeparated?" ":""}${a}`}function WJ(t){let e=Math.floor(t._value/60/60),r=Math.floor((t._value-e*60*60)/60),n=Math.round(t._value-e*60*60-r*60);return`${e}:${r<10?"0":""}${r}:${n<10?"0":""}${n}`}function BJ(t,e,r,n){let i=e.prefixSymbol,s=fm({instance:n(t._value*100),providedFormat:e,state:r}),a=Object.assign({},dm,e);return i?`%${a.spaceSeparated?" ":""}${s}`:`${s}${a.spaceSeparated?" ":""}%`}function $J(t,e,r){const n=r.currentCurrency();let i=Object.assign({},e),s=Object.assign({},dm,i),a,u="",h=!!s.totalLength||!!s.forceAverage||s.average,c=i.currencyPosition||n.position,m=i.currencySymbol||n.symbol;const p=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),p&&(u=" "),c==="infix"&&(a=u+m+u);let v=fm({instance:t,providedFormat:i,state:r,decimalSeparator:a});return c==="prefix"&&(t._value<0&&s.negative==="sign"?v=`-${u}${m}${v.slice(1)}`:t._value>0&&s.forceSign?v=`+${u}${m}${v.slice(1)}`:v=m+u+v),(!c||c==="postfix")&&(u=!s.spaceSeparatedAbbreviation&&h?"":u,v=v+u+m),v}function VJ({value:t,forceAverage:e,lowPrecision:r=!0,abbreviations:n,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:a=Math.round}){let u="",h=Math.abs(t),c=-1;if(e&&n[e]&&_n[e]?(u=n[e],t=t/_n[e]):h>=_n.trillion||r&&a(h/_n.trillion)===1?(u=n.trillion,t=t/_n.trillion):h<_n.trillion&&h>=_n.billion||r&&a(h/_n.billion)===1?(u=n.billion,t=t/_n.billion):h<_n.billion&&h>=_n.million||r&&a(h/_n.million)===1?(u=n.million,t=t/_n.million):(h<_n.million&&h>=_n.thousand||r&&a(h/_n.thousand)===1)&&(u=n.thousand,t=t/_n.thousand),u&&(u=(i?" ":"")+u),s){let p=t<0,v=t.toString().split(".")[0],y=p?v.length-1:v.length;c=Math.max(s-y,0)}return{value:t,abbreviation:u,mantissaPrecision:c}}function zJ({value:t,characteristicPrecision:e}){let[r,n]=t.toExponential().split("e"),i=+r;if(!e)return{value:i,abbreviation:`e${n}`};let s=1;return s<e&&(i=i*Math.pow(10,e-s),n=+n-(e-s),n=n>=0?`+${n}`:n),{value:i,abbreviation:`e${n}`}}function $p(t){let e="";for(let r=0;r<t;r++)e+="0";return e}function UJ(t,e){let r=t.toString(),[n,i]=r.split("e"),[s,a=""]=n.split(".");if(+i>0)r=s+a+$p(i-a.length);else{let u=".";+s<0?u=`-0${u}`:u=`0${u}`;let h=($p(-i-1)+Math.abs(s)+a).substr(0,e);h.length<e&&(h+=$p(e-h.length)),r=u+h}return+i>0&&e>0&&(r+=`.${$p(e)}`),r}function jJ(t,e,r=Math.round){return t.toString().indexOf("e")!==-1?UJ(t,e):new PJ(r(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function YJ(t,e,r,n,i,s){if(n===-1)return t;let a=jJ(e,n,s),[u,h=""]=a.toString().split(".");if(h.match(/^0+$/)&&(r||i))return u;let c=h.match(/0+$/);return i&&c?`${u}.${h.toString().slice(0,c.index)}`:a.toString()}function GJ(t,e,r,n){let i=t,[s,a]=i.toString().split(".");if(s.match(/^-?0$/)&&r)return a?`${s.replace("0","")}.${a}`:s.replace("0","");const u=e<0&&s.indexOf("-")===0;if(u&&(s=s.slice(1),i=i.slice(1)),s.length<n){let h=n-s.length;for(let c=0;c<h;c++)i=`0${i}`}return u&&(i=`-${i}`),i.toString()}function qJ(t,e){let r=[],n=0;for(let i=t;i>0;i--)n===e&&(r.unshift(i),n=0),n++;return r}function KJ(t,e,r,n,i){let s=n.currentDelimiters(),a=s.thousands;i=i||s.decimal;let u=s.thousandsSize||3,h=t.toString(),c=h.split(".")[0],m=h.split(".")[1];const p=e<0&&c.indexOf("-")===0;return r&&(p&&(c=c.slice(1)),qJ(c.length,u).forEach((y,C)=>{c=c.slice(0,y+C)+a+c.slice(y+C)}),p&&(c=`-${c}`)),m?h=c+i+m:h=c,h}function XJ(t,e){return t+e}function ZJ(t,e,r){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:r==="sign"?t:`(${t.replace("-","")})`}function QJ(t,e){return e+t}function JJ(t,e){return t+e}function fm({instance:t,providedFormat:e,state:r=_s,decimalSeparator:n,defaults:i=r.currentDefaults()}){let s=t._value;if(s===0&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(s))return s.toString();let a=Object.assign({},dm,i,e),u=a.totalLength,h=u?0:a.characteristic,c=a.optionalCharacteristic,m=a.forceAverage,p=a.lowPrecision,v=!!u||!!m||a.average,y=u?-1:v&&e.mantissa===void 0?0:a.mantissa,C=u?!1:e.optionalMantissa===void 0?y===-1:a.optionalMantissa,R=a.trimMantissa,_=a.thousandSeparated,x=a.spaceSeparated,I=a.negative,k=a.forceSign,W=a.exponential,B=a.roundingFunction,z="";if(v){let J=VJ({value:s,forceAverage:m,lowPrecision:p,abbreviations:r.currentAbbreviations(),spaceSeparated:x,roundingFunction:B,totalLength:u});s=J.value,z+=J.abbreviation,u&&(y=J.mantissaPrecision)}if(W){let J=zJ({value:s,characteristicPrecision:h});s=J.value,z=J.abbreviation+z}let U=YJ(s.toString(),s,C,y,R,B);return U=GJ(U,s,c,h),U=KJ(U,s,_,r,n),(v||W)&&(U=XJ(U,z)),(k||s<0)&&(U=ZJ(U,s,I)),U}function Ec(t,e){if(!t)return e;let r=Object.keys(t);return r.length===1&&r[0]==="output"?e:t}var eee=t=>({format:(...e)=>AJ(...e,t),getByteUnit:(...e)=>DJ(...e,t),getBinaryByteUnit:(...e)=>kJ(...e,t),getDecimalByteUnit:(...e)=>NJ(...e,t),formatOrDefault:Ec});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const xa=tV;function tee(t,e,r){let n=new xa(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new xa(i),t._value=n.plus(i).toNumber(),t}function nV(t,e,r){let n=new xa(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new xa(i),t._value=n.minus(i).toNumber(),t}function ree(t,e,r){let n=new xa(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new xa(i),t._value=n.times(i).toNumber(),t}function nee(t,e,r){let n=new xa(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new xa(i),t._value=n.dividedBy(i).toNumber(),t}function iee(t,e,r){let n=e;return r.isNumbro(e)&&(n=e._value),t._value=n,t}function see(t,e,r){let n=r(t._value);return nV(n,e,r),Math.abs(n._value)}var oee=t=>({add:(e,r)=>tee(e,r,t),subtract:(e,r)=>nV(e,r,t),multiply:(e,r)=>ree(e,r,t),divide:(e,r)=>nee(e,r,t),set:(e,r)=>iee(e,r,t),difference:(e,r)=>see(e,r,t),BigNumber:xa});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const aee="2.5.0",Lo=yM(),lee=vM(),uee=MJ(Wr),hee=J$();let uu=eee(Wr),Lu=oee(Wr);const cee=wM;class iV{constructor(e){this._value=e}clone(){return Wr(this._value)}format(e={}){return uu.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=cee.parseFormat(e)),e=uu.formatOrDefault(e,Lo.currentCurrencyDefaultFormat()),e.output="currency",uu.format(this,e)}formatTime(e={}){return e.output="time",uu.format(this,e)}binaryByteUnits(){return uu.getBinaryByteUnit(this)}decimalByteUnits(){return uu.getDecimalByteUnit(this)}byteUnits(){return uu.getByteUnit(this)}difference(e){return Lu.difference(this,e)}add(e){return Lu.add(this,e)}subtract(e){return Lu.subtract(this,e)}multiply(e){return Lu.multiply(this,e)}divide(e){return Lu.divide(this,e)}set(e){return Lu.set(this,sV(e))}value(){return this._value}valueOf(){return this._value}}function sV(t){let e=t;return Wr.isNumbro(t)?e=t._value:typeof t=="string"?e=Wr.unformat(t):isNaN(t)&&(e=NaN),e}function Wr(t){return new iV(sV(t))}Wr.version=aee;Wr.isNumbro=function(t){return t instanceof iV};Wr.language=Lo.currentLanguage;Wr.registerLanguage=Lo.registerLanguage;Wr.setLanguage=Lo.setLanguage;Wr.languages=Lo.languages;Wr.languageData=Lo.languageData;Wr.zeroFormat=Lo.setZeroFormat;Wr.defaultFormat=Lo.currentDefaults;Wr.setDefaults=Lo.setDefaults;Wr.defaultCurrencyFormat=Lo.currentCurrencyDefaultFormat;Wr.validate=lee.validate;Wr.loadLanguagesInNode=uee.loadLanguagesInNode;Wr.unformat=hee.unformat;Wr.BigNumber=Lu.BigNumber;var dee=Wr,hu=lJ(dee);const fee="numeric";function oV(t,e){if(Ln(t)){const r=e.numericFormat,n=r&&r.culture||"-",i=r&&r.pattern;if(typeof n<"u"&&!hu.languages()[n]){const s=n.replace("-",""),a=hu.allLanguages?hu.allLanguages[n]:hu[s];a&&hu.registerLanguage(a)}hu.setLanguage(n),t=hu(t).format(i||"0")}return t}function bM(t,e,r,n,i,s,a){let u=s;if(Ln(u)){const h=a.className||"",c=h.length?h.split(" "):[];u=oV(u,a),c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight"),c.indexOf("htNumeric")<0&&c.push("htNumeric"),a.className=c.join(" "),e.dir="ltr"}Na(t,e,r,n,i,u,a)}bM.RENDERER_TYPE=fee;const gee="password";function SM(t,e,r,n,i,s,a){Na.apply(this,[t,e,r,n,i,s,a]);const u=a.hashLength||e.innerHTML.length,h=a.hashSymbol||"*";let c="";Xe(u-1,()=>{c+=h}),dh(e,c)}SM.RENDERER_TYPE=gee;const mee="select";function RM(t,e,r,n,i,s,a){Na.apply(this,[t,e,r,n,i,s,a])}RM.RENDERER_TYPE=mee;const pee="time";function EM(t,e,r,n,i,s,a){Na.apply(this,[t,e,r,n,i,s,a]),e.dir="ltr"}EM.RENDERER_TYPE=pee;function vee(){Pi(fd),Pi(cm),Pi(gM),Pi(fM),Pi(pM),Pi(dM),Pi(bM),Pi(SM),Pi(RM),Pi(Na),Pi(EM)}const wee="autocomplete";function Yy(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,TD(r,e)):TD(r,e)(this.source):e(!0)}Yy.VALIDATOR_TYPE=wee;function TD(t,e){const r=t;return function(n){let i=!1;for(let s=0,a=n.length;s<a;s++)if(r===n[s]){i=!0;break}e(i)}}function aV(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const yee=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:aV},Symbol.toStringTag,{value:"Module"})),Cee="date";function _M(t,e){const r=FB(Y$,this.instance);let n=t,i=!0;n==null&&(n="");let s=Ee(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=Ee(new Date(n)).isValid()||s;if(this.allowEmpty&&n===""&&(a=!0,s=!0),a||(i=!1),!a&&s&&(i=!0),a&&!s)if(this.correctFormat===!0){const u=bee(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"dateValidator"),i=!0}else i=!1;e(i)}_M.VALIDATOR_TYPE=Cee;function bee(t,e){const r=Ee(aV(t)),n=Ee(t,e),i=t.search(/[A-z]/g)>-1;let s;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?s=r:s=n,s.format(e)}const See="dropdown";function TM(t,e){Yy.apply(this,[t,e])}TM.VALIDATOR_TYPE=See;const Ree="numeric";function xM(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:Ln(t))}xM.VALIDATOR_TYPE=Ree;const Eee=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],_ee="time";function MM(t,e){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const a=Ee(i,Eee,!0).isValid()?Ee(i):Ee(i,r);let u=a.isValid(),h=Ee(i,r,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(u=!0,h=!0),u||(n=!1),!u&&h&&(n=!0),u&&!h)if(this.correctFormat===!0){const c=a.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,c,"timeValidator"),n=!0}else n=!1;e(n)}MM.VALIDATOR_TYPE=_ee;function Tee(){$u(Yy),$u(TM),$u(_M),$u(xM),$u(MM)}const xee="autocomplete",Mee={CELL_TYPE:xee,editor:uM,renderer:fd,validator:Yy},Iee="checkbox",Oee={CELL_TYPE:Iee,editor:j$,renderer:gM},Pee="date";function lV(t,e,r,n,i,s,a){fd.apply(this,[t,e,r,n,i,s,a])}lV.RENDERER_TYPE=Pee;const Aee="date",Hee={CELL_TYPE:Aee,editor:G$,renderer:lV,validator:_M},Nee="dropdown",kee={CELL_TYPE:Nee,editor:cM,renderer:fM,validator:TM},Dee="handsontable",Lee={CELL_TYPE:Dee,editor:lM,renderer:pM},Fee="numeric",Wee={CELL_TYPE:Fee,editor:q$,renderer:bM,validator:xM,dataType:"number"},Bee="password",$ee={CELL_TYPE:Bee,editor:K$,renderer:SM,copyable:!1},Vee="select",zee={CELL_TYPE:Vee,editor:X$,renderer:RM},Uee="time",jee={CELL_TYPE:Uee,editor:Z$,renderer:EM,validator:MM};function Yee(){ji(Mee),ji(Oee),ji(Hee),ji(kee),ji(Lee),ji(Wee),ji($ee),ji(zee),ji(U$),ji(jee)}function Gee(t,e){uV(t,e),e.add(t)}function qee(t,e,r){uV(t,e),e.set(t,r)}function uV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xh(t,e,r){return(e=Kee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kee(t){var e=Xee(t,"string");return typeof e=="symbol"?e:e+""}function Xee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zh(t,e){return t.get(hV(t,e))}function hV(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const xD=new Map([["plugin",j6],["cell-type",N$],["editor",LB],["renderer",jB],["validator",YB]]),cV=Symbol("mainSetting"),Zee="base",Vp=[];let no=null;var cu=new WeakMap,MD=new WeakSet;class Pt{static get PLUGIN_KEY(){return Zee}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){Gee(this,MD),Xh(this,"eventManager",new ns(this)),Xh(this,"pluginName",null),Xh(this,"pluginsInitializedCallbacks",[]),Xh(this,"isPluginsReady",!1),Xh(this,"enabled",!1),Xh(this,"initialized",!1),qee(this,cu,{}),Do(this,"hot",e,{writable:!1}),no=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(s=>{const[a,u]=s.split(":");if(!xD.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);xD.get(a)(u)||i.push(` - ${u} (${a})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Vp.push(s)}}if(no||(no=c1()),no.indexOf("UndoRedo")>=0&&no.splice(no.indexOf("UndoRedo"),1),no.indexOf(this.pluginName)>=0&&no.splice(no.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),no.length===0){if(Vp.length>0){const i=[`${Vp.join(`
`)}
`,"You have to import and register them manually."].join("");throw Vp.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||vt(r))&&n[cV]===e){var i;return Array.isArray(r)?r:(i=r[e])!==null&&i!==void 0?i:n[e]}if(vt(r)){var s;return(s=r[e])!==null&&s!==void 0?s:n[e]}return n[e]}addHook(e,r,n){Zh(cu,this)[e]=Zh(cu,this)[e]||[];const i=Zh(cu,this)[e];this.hot.addHook(e,r,n),i.push(r),Zh(cu,this)[e]=i}removeHooks(e){te(Zh(cu,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Zh(cu,this);wt(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){te(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=hV(MD,this,Qee).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),wt(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function Qee(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function du(t,e,r){return(e=Jee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jee(t){var e=ete(t,"string");return typeof e=="symbol"?e:e+""}function ete(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let IM=class{constructor(e){du(this,"hot",null),du(this,"container",null),du(this,"injected",!1),du(this,"rows",[]),du(this,"columns",[]),du(this,"samples",null),du(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),te(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),te(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{te(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(s=>{te(s.strings,a=>{const u=a.col,h=this.hot.getCellMeta(e,u),c=this.hot.getCellRenderer(h),m=r.createElement("td");m.setAttribute("ghost-table",1),c(this.hot,m,e,u,this.hot.colToProp(u),a.value,h),n.appendChild(m)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{te(i.strings,s=>{const a=s.col,u=e.createElement("th");n.push([a,u]),r.appendChild(u)})}),this.table.tHead.appendChild(r),te(n,i=>{const[s,a]=i;this.hot.view.appendColHeader(s,a)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{te(i.strings,s=>{const a=s.row,u=this.hot.getCellMeta(a,e),h=this.hot.getCellRenderer(u),c=r.createElement("td"),m=r.createElement("tr");c.setAttribute("ghost-table",1),h(this.hot,c,a,e,this.hot.colToProp(e),s.value,u),m.appendChild(c),n.appendChild(m)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let a=e+1;a<e+i;a++)s+=this.hot.getColWidth(a);return n.style.width=`${s}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),s=r.createElement("thead"),a=r.createElement("tbody"),u=r.createElement("colgroup"),h=r.createElement("tr"),c=r.createElement("th");return this.isVertical()&&i.appendChild(u),this.isHorizontal()&&(h.appendChild(c),s.appendChild(h),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&a.appendChild(h),i.appendChild(a),Re(i,e),n.appendChild(i),{fragment:n,table:i,tHead:s,tBody:a,colGroup:u,tr:h,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return Re(i,s),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function zp(t,e,r){return(e=tte(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tte(t){var e=rte(t,"string");return typeof e=="symbol"?e:e+""}function rte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gy{static get SAMPLE_COUNT(){return 3}constructor(e){zp(this,"samples",null),zp(this,"dataFactory",null),zp(this,"customSampleCount",null),zp(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Gy.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:s,to:a}=typeof n=="number"?{from:n,to:n}:n;return Xe(s,a,u=>{const h=this.generateSample(e,r,u);i.set(u,h)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",a=[];return Xe(r.from,r.to,u=>{const h=e==="row"?this.dataFactory(n,u):this.dataFactory(u,n);if(h===!1)return;const{value:c,bundleSeed:m}=h,p=typeof m=="string"&&m.length>0;let v;p?v=m:vt(c)?v=`${Object.keys(c).length}`:Array.isArray(c)?v=`${c.length}`:v=`${Mr(c).length}`,i.has(v)||i.set(v,{needed:this.getSampleCount(),strings:[]});const y=i.get(v);y.needed&&(!(a.indexOf(c)>-1)||this.allowDuplicates||p)&&(y.strings.push({value:c,[s]:u}),a.push(c),y.needed-=1)}),i}}function nte(t,e){dV(t,e),e.add(t)}function ID(t,e,r){dV(t,e),e.set(t,r)}function dV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yf(t,e,r){return(e=ite(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ite(t){var e=ste(t,"string");return typeof e=="symbol"?e:e+""}function ste(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zu(t,e){return t.get(So(t,e))}function OM(t,e,r){return t.set(So(t,e),r),r}function So(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("modifyAutoColumnSizeSeed");const IR="autoColumnSize",ote=10,ate="autoColumnSize";var _c=new WeakMap,Qc=new WeakMap,ia=new WeakSet;class hg extends Pt{static get PLUGIN_KEY(){return IR}static get PLUGIN_PRIORITY(){return ote}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),nte(this,ia),yf(this,"ghostTable",new IM(this.hot)),yf(this,"samplesGenerator",new Gy((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const a=this.hot.getCellMeta(r,n);let u="";a.spanned||(u=this.hot.getDataAtCell(r,n));let h="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(h=this.hot.runHooks("modifyAutoColumnSizeSeed",h,a,u)),{value:u,bundleSeed:h}})),yf(this,"inProgress",!1),yf(this,"measuredColumns",0),yf(this,"columnWidthsMap",new Fl),ID(this,_c,[]),ID(this,Qc,[]),this.hot.columnIndexMapper.registerMap(ate,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>So(ia,this,OD).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[IR]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return So(ia,e,hte).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return So(ia,e,cte).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return So(ia,e,fte).call(e,...i)}),this.addHook("beforeRender",()=>So(ia,this,ute).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>So(ia,this,dte).call(this)),super.enablePlugin()}updatePlugin(){OM(Qc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>So(ia,this,OD).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;Xe(i.from,i.to,a=>{let u=this.hot.toPhysicalColumn(a);u===null&&(u=a),(n||this.columnWidthsMap.getValueAtIndex(u)===null&&!this.hot._getColWidthFromSettings(u))&&this.samplesGenerator.generateColumnSamples(a,s).forEach((c,m)=>this.ghostTable.addColumn(m,c))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((a,u)=>{const h=this.hot.toPhysicalColumn(a);this.columnWidthsMap.setValueAtIndex(h,u)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const a=()=>{if(!this.hot){Ag(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+hg.CALCULATION_STEP,i)},e,r),n=n+hg.CALCULATION_STEP+1,n<i?s=Pg(a):(Ag(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateColumnsWidth({from:0,to:u},e,r),n=u+1),n<i?a():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[IR];let r=hg.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return vt(e)&&(r=e.syncLimit,VT(r)?r=u1(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,qc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,s)=>{const a=zu(_c,this).length;return(a-1<s||zu(_c,this)[s]!==i)&&n.push(this.hot.toVisualColumn(s)),a-1<s?zu(_c,this).push(i):zu(_c,this)[s]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function lte(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||this.samplesGenerator.generateColumnSamples(r,e).forEach((s,a)=>this.ghostTable.addColumn(a,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,n)=>{const i=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function ute(){this.calculateVisibleColumnsWidth(),this.inProgress||(So(ia,this,lte).call(this,zu(Qc,this)),OM(Qc,this,[]))}function hte(t,e){e||this.recalculateAllColumnsWidth()}function cte(t){const e=t.reduce((r,n)=>{let[,i]=n;const s=this.hot.propToCol(i);return Number.isInteger(s)&&r.indexOf(s)===-1&&r.push(s),r},[]);zu(Qc,this).push(...e)}function OD(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function dte(){OM(_c,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function fte(t){const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const a=this.hot.toVisualColumn(s);r.indexOf(a)===-1&&r.push(a)}return r},[]);zu(Qc,this).push(...e)}const Uu={horizontal:"horizontal",vertical:"vertical"};function gte(t,e,r){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function mte(t){const e={};return t===!0?(e.directions=Object.keys(Uu),e.autoInsertRow=!0):vt(t)?(Ue(t.autoInsertRow)?t.direction===Uu.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Uu)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function pte(t,e){vte(t,e),e.add(t)}function vte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qh(t,e,r){return(e=wte(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wte(t){var e=yte(t,"string");return typeof e=="symbol"?e:e+""}function yte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("modifyAutofillRange");ze.getSingleton().register("beforeAutofill");ze.getSingleton().register("afterAutofill");const PD="autofill",Cte=20,bte=["fillHandle"],Ste="insert_row_below",Rte=200;var Jh=new WeakSet;class Ete extends Pt{constructor(){super(...arguments),pte(this,Jh),Qh(this,"addingStarted",!1),Qh(this,"mouseDownOnCellCorner",!1),Qh(this,"mouseDragOutside",!1),Qh(this,"handleDraggedCells",0),Qh(this,"directions",[]),Qh(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return PD}static get PLUGIN_PRIORITY(){return Cte}static get SETTING_KEYS(){return[PD,...bte]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Cf(Jh,this,Tte).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Cf(Jh,this,_te).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>Cf(Jh,this,xte).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:n,endRow:i,endCol:s}]),u=[],h=[],c=[];return te(a,m=>{for(let p=m.startRow;p<=m.endRow;p+=1)u.indexOf(p)===-1&&u.push(p);for(let p=m.startCol;p<=m.endCol;p+=1)h.indexOf(p)===-1&&h.push(p)}),te(u,m=>{const p=[];te(h,v=>{p.push(this.hot.getCopyableData(m,v))}),c.push(p)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),a=s.getTopStartCorner(),u=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const h=[a.row,a.col,u.row,u.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,r),Math.max(u.row,n),Math.max(u.col,i)],h),{directionOfDrag:m,startOfDragCoords:p,endOfDragCoords:v}=gte(h,c,(y,C)=>this.hot._createCellCoords(y,C));if(p&&p.row>-1&&p.col>-1){const y=this.getSelectionData(),C=s.clone(),R=this.hot._createCellRange(p,p,v),_=this.hot.runHooks("beforeAutofill",y,C,R,m);if(_===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let x=_;const I=_;if(["up","left"].indexOf(m)>-1&&!(I.length===1&&I[0].length===0))if(x=[],m==="up"){const k=v.row-p.row+1,W=k%I.length;for(let B=0;B<k;B++)x.push(I[(B+(I.length-W))%I.length])}else{const k=v.col-p.col+1,W=k%I[0].length;for(let B=0;B<I.length;B++){x.push([]);for(let z=0;z<k;z++)x[B].push(I[B][(z+(I[B].length-W))%I[B].length])}}this.hot.populateFromArray(p.row,p.col,x,v.row,v.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",x,C,R,m),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),n=r.getBottomEndCorner();let i=e;if(this.directions.includes(Uu.vertical)&&this.directions.includes(Uu.horizontal)){const s=r.getTopStartCorner();(n.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(Uu.vertical))i=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(Uu.horizontal))i=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Ste,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Rte)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&r[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),n=this.hot.countRows();let i;for(let s=e[2]+1;s<n;s++){for(let h=e[1];h<=e[3];h++){const c=r[s][h];if(!Ir(c))return-1}const a=r[s][e[1]-1],u=r[s][e[3]+1];(!Ir(a)||!Ir(u))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...St(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,n=un(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+Or(this.hot.table),i=un(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+Fr(this.hot.table);return e.clientY>n&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Cf(Jh,this,Mte).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>Cf(Jh,this,Ite).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=mte(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function _te(){this.selectAdjacent()&&this.fillIn()}function Tte(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function xte(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Mte(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Ite(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Ote(t,e){fV(t,e),e.add(t)}function Pte(t,e,r){fV(t,e),e.set(t,r)}function fV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ec(t,e,r){return(e=Ate(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ate(t){var e=Hte(t,"string");return typeof e=="symbol"?e:e+""}function Hte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nte(t,e,r){return t.set(Ro(t,e),r),r}function PM(t,e){return t.get(Ro(t,e))}function Ro(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const OR="autoRowSize",kte=40,Dte="autoRowSize";var Dg=new WeakMap,sa=new WeakSet;class cg extends Pt{static get PLUGIN_KEY(){return OR}static get PLUGIN_PRIORITY(){return kte}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Ote(this,sa),ec(this,"headerHeight",null),ec(this,"ghostTable",new IM(this.hot)),ec(this,"samplesGenerator",new Gy((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||r>=0&&n>=0&&this.hot.getCellMeta(r,n).hidden)return!1;let a;return r>=0?a=this.hot.getDataAtCell(r,n):r===-1&&(a=this.hot.getColHeader(n)),{value:a}})),ec(this,"inProgress",!1),ec(this,"measuredRows",0),ec(this,"rowHeightsMap",new Fl),Pte(this,Dg,[]),this.hot.rowIndexMapper.registerMap(Dte,this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,i)=>Ro(sa,this,AD).call(this,r,n,i))}isEnabled(){const e=this.hot.getSettings()[OR];return e===!0||vt(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ro(sa,e,Wte).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ro(sa,e,Bte).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ro(sa,e,Vte).call(e,...i)}),this.addHook("beforeRender",()=>Ro(sa,this,Fte).call(this)),this.addHook("modifyRowHeight",(n,i)=>this.getRowHeight(i,n)),this.addHook("init",()=>Ro(sa,this,$te).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,n)=>Ro(sa,this,AD).call(this,e,r,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:e,to:r},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const a=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(a.get(-1))}Xe(i.from,i.to,a=>{let u=this.hot.toPhysicalRow(a);u===null&&(u=a),(n||this.rowHeightsMap.getValueAtIndex(u)===null)&&this.samplesGenerator.generateRowSamples(a,s).forEach((c,m)=>this.ghostTable.addRow(m,c))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((a,u)=>{a<0?this.headerHeight=u:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(a),u)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const a=()=>{if(!this.hot){Ag(s),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+cg.CALCULATION_STEP,i)},e,r),n=n+cg.CALCULATION_STEP+1,n<i?s=Pg(a):(Ag(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateRowsHeight({from:0,to:u},e,r),n=u+1),n<i?a():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[OR];let r=cg.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return vt(e)&&(r=e.syncLimit,VT(r)?r=u1(n,r):r>>=0),Math.min(r,n)}getRowHeight(e,r){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=r;return n!==null&&n>(r||0)&&(i=n),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Xe(Math.min(r,n),Math.max(r,n),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Lte(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{const i=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function Fte(){this.calculateVisibleRowsHeight(),this.inProgress||(Ro(sa,this,Lte).call(this,PM(Dg,this)),Nte(Dg,this,[]))}function AD(t,e,r){let n=t;return r&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function Wte(t,e){e||this.recalculateAllRowsHeight()}function Bte(t){const e=t.reduce((r,n)=>{let[i]=n;return r.indexOf(i)===-1&&r.push(i),r},[]);PM(Dg,this).push(...e)}function $te(){this.recalculateAllRowsHeight()}function Vte(t){const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const a=this.hot.toVisualRow(s);r.indexOf(a)===-1&&r.push(a)}return r},[]);PM(Dg,this).push(...e)}const{getListWithInsertedItems:zte,getListWithRemovedItems:Ute}=p$("physicallyIndexed");class jte extends fh{constructor(){super(e=>e)}insert(e,r){const n=D1(this.indexedValues,r);this.indexedValues=zte(n,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=Ute(this.indexedValues,e);this.indexedValues=k1(r,e),super.remove(e)}}const{getListWithInsertedItems:Yte,getListWithRemovedItems:Gte}=p$("physicallyIndexed");class qte extends fh{constructor(){super(e=>e)}insert(e,r){this.indexedValues=Yte(this.indexedValues,e,r,(n,i)=>this.getNextValue(i)),super.insert(e,r)}remove(e){this.indexedValues=Gte(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Kte(t,e){Xte(t,e),e.add(t)}function Xte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zte(t,e,r){return(e=Qte(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qte(t){var e=Jte(t,"string");return typeof e=="symbol"?e:e+""}function Jte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ere(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const HD="bindRowsWithHeaders",tre=210,rre="loose",ND=new Map([["loose",jte],["strict",qte]]);var kD=new WeakSet;class nre extends Pt{constructor(){super(...arguments),Kte(this,kD),Zte(this,"headerIndexes",null)}static get PLUGIN_KEY(){return HD}static get PLUGIN_PRIORITY(){return tre}isEnabled(){return!!this.hot.getSettings()[HD]}enablePlugin(){var e;if(this.enabled)return;const r=(e=ND.get(this.getSetting()))!==null&&e!==void 0?e:ND.get(rre);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",n=>ere(kD,this,ire).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function ire(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function sre(t,e){gV(t,e),e.add(t)}function ore(t,e,r){gV(t,e),e.set(t,r)}function gV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DD(t,e,r){return(e=are(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function are(t){var e=lre(t,"string");return typeof e=="symbol"?e:e+""}function lre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LD(t,e){return t.get(Hc(t,e))}function PR(t,e,r){return t.set(Hc(t,e),r),r}function Hc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Zv="collapsibleColumns",ure=290,hre=["nestedHeaders"],zc="collapsibleIndicator",FD=Zv,WD=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var tc=new WeakMap,bf=new WeakSet;class cre extends Pt{constructor(){super(...arguments),sre(this,bf),DD(this,"nestedHeadersPlugin",null),DD(this,"headerStateManager",null),ore(this,tc,null)}static get PLUGIN_KEY(){return Zv}static get PLUGIN_PRIORITY(){return ure}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Zv,...hre]}isEnabled(){return!!this.hot.getSettings()[Zv]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||Vt("You need to configure the Nested Headers plugin in order to use collapsible headers."),PR(tc,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Hc(bf,this,gre).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Hc(bf,e,mre).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Hc(bf,e,dre).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(n,i,s)=>Hc(bf,this,fre).call(this,n,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),PR(tc,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(r,n))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:r,col:a}):this.collapseSection({row:r,col:a}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:FD,relativeToGroup:Wl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FD)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(a){a&&a.parentNode.removeChild(a)};Xe(0,e-1,a=>{const u=r.childNodes[a],h=n.childNodes[a],c=i?i.childNodes[a]:null;Xe(0,u.childNodes.length-1,m=>{let p=u.childNodes[m].querySelector(`.${zc}`);s(p),h&&h.childNodes[m]&&(p=h.childNodes[m].querySelector(`.${zc}`),s(p)),i&&c&&c.childNodes[m]&&(p=c.childNodes[m].querySelector(`.${zc}`),s(p))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(n=>{const{collapsible:i,origColspan:s,headerLevel:a,columnIndex:u,isCollapsed:h}=n;if(i===!0&&s>1&&(h&&e==="expand"||!h&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:u}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!WD.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const n=Ta(e,y=>{let{row:C}=y;return C<0});let i=n.length>0;te(n,y=>{var C;let{row:R,col:_}=y;const{collapsible:x,isCollapsed:I}=(C=this.headerStateManager.getHeaderSettings(R,_))!==null&&C!==void 0?C:{};if(!x||I&&r==="collapse"||!I&&r==="expand")return i=!1,!1});const s=[],a=[];i&&te(n,y=>{let{row:C,col:R}=y;const{colspanCompensation:_,affectedColumns:x,rollbackModification:I}=this.headerStateManager.triggerNodeModification(r,C,R);_>0&&(a.push(...x),s.push(I))});const u=this.getCollapsedColumns();let h=[];r==="collapse"?h=BT([...u,...a]):r==="expand"&&(h=Ta(u,y=>!a.includes(y)));const c=WD.get(r);if(this.hot.runHooks(c.beforeHook,u,h,i)===!1){te(s,y=>{y()});return}this.hot.batchExecution(()=>{te(a,y=>{LD(tc,this).setValueAtIndex(this.hot.toPhysicalColumn(y),c.hideColumn)})},!0);const p=this.getCollapsedColumns().length!==u.length,v=this.hot.getSelectedRangeLast();if(r==="collapse"&&p&&v){const{row:y,col:C}=v.highlight;if((this.hot.rowIndexMapper.isHidden(y)||this.hot.columnIndexMapper.isHidden(C))&&a.includes(C)){const _=y>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(y,1,!0):y,x=C>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(C,1,!0):C;_!==null&&x!==null&&this.hot.selectCell(_,x)}}this.hot.runHooks(c.afterHook,u,h,i,p),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return LD(tc,this).getHiddenIndexes()}destroy(){PR(tc,this,null),super.destroy()}}function dre(t,e,r){var n;const{collapsible:i,origColspan:s,isCollapsed:a}=(n=this.headerStateManager.getHeaderSettings(r,t))!==null&&n!==void 0?n:{},u=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags;let c=e.querySelector(`.${zc}`);if(ch(e,[ts("")[0]]),u)c||(c=this.hot.rootDocument.createElement("div"),Re(c,zc),e.querySelector("div:first-child").appendChild(c)),tt(c,["collapsed","expanded"]),a?(Re(c,"collapsed"),Pl(c,"+"),h&&it(e,...ts(!1))):(Re(c,"expanded"),Pl(c,"-"),h&&it(e,...ts(!0))),h&&it(c,...Ll());else{var m;(m=c)===null||m===void 0||m.remove()}}function fre(t,e){nt(t.target,zc)&&(nt(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):nt(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ls(t))}function gre(){this.updatePlugin()}function mre(t,e){e||this.updatePlugin()}function fu(t,e,r){return(e=pre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pre(t){var e=vre(t,"string");return typeof e=="symbol"?e:e+""}function vre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wre=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],yre=!1,Cre=!0,bre=!0;class Sre{constructor(e,r){fu(this,"hot",void 0),fu(this,"sortingStates",new Wy),fu(this,"sortEmptyCells",yre),fu(this,"indicator",Cre),fu(this,"headerAction",bre),fu(this,"compareFunctionFactory",void 0),fu(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){vt(e)&&wt(e,(r,n)=>{wre.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[n]=r;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return vt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[n,i]=r;return{column:this.hot.toVisualColumn(n),...i}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(Ue(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function mV(t,e,r){const n=e.locale;return function(i,s){const{sortEmptyCells:a}=r;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof s=="string"&&(s=s.toLocaleLowerCase(n)),i===s?Oo:Ir(i)?Ir(s)?Oo:a&&t==="asc"?Tr:xr:Ir(s)?a&&t==="asc"?xr:Tr:isNaN(i)&&!isNaN(s)?t==="asc"?xr:Tr:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?Tr:xr:i>s?t==="asc"?xr:Tr:Oo}}const pV="default";function Rre(t,e,r){return function(n,i){const s=parseFloat(n),a=parseFloat(i),{sortEmptyCells:u}=r;if(s===a||isNaN(s)&&isNaN(a))return Oo;if(u){if(Ir(n))return t==="asc"?Tr:xr;if(Ir(i))return t==="asc"?xr:Tr}return isNaN(s)?xr:isNaN(a)?Tr:s<a?t==="asc"?Tr:xr:s>a?t==="asc"?xr:Tr:Oo}}const Ere="numeric";function _re(t,e,r){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(a,u){const h=Ir(a),c=Ir(u),m=h?i:a,p=c?i:u,v=m===i||m===n,y=p===i||p===n;if(s===!1){if(h&&c===!1)return xr;if(h===!1&&c)return Tr}return v===!1&&y?t==="asc"?Tr:xr:v&&y===!1?t==="asc"?xr:Tr:v===!1&&y===!1?mV(t,e,r)(a,u):m===i&&p===n?t==="asc"?Tr:xr:m===n&&p===i?t==="asc"?xr:Tr:Oo}}const Tre="checkbox";function xre(t,e,r){return SV(t,e.dateFormat,r)}const Mre="date";function Ire(t,e,r){return SV(t,e.timeFormat,r)}const Ore="time",{register:gm,getItem:BD,hasItem:Pre}=zs("sorting.compareFunctionFactory"),{register:vV,getItem:Are}=zs("sorting.mainSortComparator");function wV(t){return Pre(t)?BD(t):BD(pV)}gm(Tre,_re);gm(Mre,xre);gm(pV,mV);gm(Ere,Rre);gm(Ore,Ire);const Oo=0,Tr=-1,xr=1;function Hre(t,e){const r=Are(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(r(...i))}const Iw="asc",Ow="desc",yV="colHeader";function Nre(t){if(vt(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[Iw,Ow].includes(r)}function kre(t){if(t.some(r=>Nre(r)===!1))return!1;const e=t.map(r=>{let{column:n}=r;return n});return new Set(e).size===e.length}function $D(t){if(t!==Ow)return t===Iw?Ow:Iw}function CV(t){return t.querySelector(`.${yV}`)}function bV(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function AM(t,e,r){return t===-1&&e>=0&&Al(r)===!1}function SV(t,e,r){return function(n,i){const{sortEmptyCells:s}=r;if(n===i)return Oo;if(Ir(n))return Ir(i)?Oo:s&&t==="asc"?Tr:xr;if(Ir(i))return s&&t==="asc"?xr:Tr;const a=Ee(n,e),u=Ee(i,e);return a.isValid()?u.isValid()?u.isAfter(a)?t==="asc"?Tr:xr:u.isBefore(a)?t==="asc"?xr:Tr:Oo:Tr:xr}}const Dre="ascending",Lre="descending",RV="indicatorDisabled",EV="columnSorting",_V="sortAction",TV=new Map([[Iw,Dre],[Ow,Lre]]);function Fre(t,e,r,n){const i=[EV];if(n&&i.push(_V),r===!1)return i.push(RV),i;const s=t.getSortOrderOfColumn(e);return Ue(s)&&i.push(TV.get(s)),i}function Wre(){return Array.from(TV.values()).concat(_V,RV,EV)}function Bre(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function(u){const h=t[u],c=e[u],m=i[u],p=s[u],v=c.columnSorting;return(v.compareFunctionFactory?v.compareFunctionFactory:wV(c.type))(h,c,v)(m,p)}(0)}}function $re(t,e){Vre(t,e),e.add(t)}function Vre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Up(t,e,r){return(e=zre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zre(t){var e=Ure(t,"string");return typeof e=="symbol"?e:e+""}function Ure(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Pw="columnSorting",jre=50,Aw="append",Yre="replace",VD=Pw;vV(Pw,Bre);ze.getSingleton().register("beforeColumnSort");ze.getSingleton().register("afterColumnSort");var Fu=new WeakSet;class xV extends Pt{constructor(){super(...arguments),$re(this,Fu),Up(this,"columnStatesManager",null),Up(this,"columnMetaCache",null),Up(this,"pluginKey",Pw),Up(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Pw}static get PLUGIN_PRIORITY(){return jre}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new Sre(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Fl(r=>{let n=this.hot.toVisualColumn(r);return n===null&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>Tc(Fu,this,Gre).call(this,r,n)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Tc(Fu,e,Kre).call(e,...n)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>Tc(Fu,this,A_).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Tc(Fu,e,qre).call(e,...n)}),this.hot.view&&Tc(Fu,this,A_).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,n)=>{const i=CV(n);bV(r,n)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:Wl,position:"before",group:VD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VD)}sort(e){const r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",r,n,i)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new v$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",r,i?n:r,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return kre(e)&&e.every(n=>{let{column:i}=n;return i<=r&&i>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),n=i=>{let{column:s,...a}=i;return{column:this.hot.toPhysicalColumn(s),...a}};r.initialConfig=St(e,n),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,n=i=>{let{column:s,...a}=i;return{column:this.hot.toVisualColumn(s),...a}};return Ue(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=St(r.initialConfig,n)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(Ue(r)){const i=$D(r);return Ue(i)?{column:e,sortOrder:i}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:$D()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Aw;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=n!==-1,s=this.getSortConfig(),a=this.getColumnNextConfig(e);if(i){if(fr(a))return[...s.slice(0,n),...s.slice(n+1)];if(r===Aw)return[...s.slice(0,n),...s.slice(n+1),a];if(r===Yre)return[...s.slice(0,n),a,...s.slice(n+1)]}return Ue(a)?s.concat(a):s}getPluginColumnConfig(e){if(vt(e)){const r=e[this.pluginKey];if(vt(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns[e])):nr(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(n,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),n=Object.create(r);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],n=this.hot.countRows(),i=c=>St(e,m=>this.hot.getDataAtCell(c,m.column));for(let c=0;c<this.getNumberOfRowsToSort(n);c+=1)r.push([this.hot.toPhysicalRow(c)].concat(i(c)));const s=St(r,c=>c[0]);Hre(r,this.pluginKey,St(e,c=>c.sortOrder),St(e,c=>this.getFirstCellSettings(c.column)));for(let c=r.length;c<n;c+=1)r.push([c].concat(i(c)));const a=St(r,c=>c[0]),u=new Map(St(s,(c,m)=>[c,a[m]])),h=St(this.hot.rowIndexMapper.getIndexesSequence(),c=>u.has(c)?u.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(h)}sortBySettings(e){if(vt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||vt(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(tt(e,Wre()),this.enabled!==!1){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];Re(e,Fre(...n))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&nt(e.target,yV)}onAfterOnCellMouseDown(e,r){if(AM(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const n=this.hot.getActiveEditor(),i=this.getColumnNextConfig(r.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function A_(){const t=this.getAllSavedSortSettings();if(vt(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Gre(t,e){const r=CV(e);if(bV(t,e)===!1||r===null)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,s=n.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const a=this.columnStatesManager.getSortOrderOfColumn(t);it(e,...pK(a?`${a}ending`:"none"))}}function qre(t){t===!0&&this.hot.view&&Tc(Fu,this,A_).call(this)}function Kre(t,e,r,n){AM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function gu(t,e,r){return(e=Xre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xre(t){var e=Zre(t,"string");return typeof e=="symbol"?e:e+""}function Zre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qre{constructor(e,r){gu(this,"plugin",void 0),gu(this,"hot",void 0),gu(this,"endpoints",[]),gu(this,"settings",void 0),gu(this,"settingsType","array"),gu(this,"currentEndpoint",null),gu(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),te(n,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,n,i){if(n==="ranges"&&e[n]===void 0){r[n]=i;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(i instanceof Error)throw i;r[n]=i}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}resetSetupBeforeStructureAlteration(e,r,n){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();te(s,a=>{i==="row"&&a.destinationRow>=r&&(e==="insert_row"?a.alterRowOffset=n:e==="remove_row"&&(a.alterRowOffset=-1*n)),i==="col"&&a.destinationColumn>=r&&(e==="insert_col"?a.alterColumnOffset=n:e==="remove_col"&&(a.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,n,i,s){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const v=()=>(this.hot.removeHook("beforeViewRender",v),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",v);return}const u=e.indexOf("row")>-1?"row":"col",h=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),m=e.indexOf("move_row")===0,p=r;te(c,v=>{u==="row"&&v.destinationRow>=p&&(v.alterRowOffset=h*n),u==="col"&&v.destinationColumn>=p&&(v.alterColumnOffset=h*n)}),this.resetAllEndpoints(c,!m),m?te(c,v=>{this.extendEndpointRanges(v,p,i[0],i.length),this.recreatePhysicalRanges(v),this.clearOffsetInformation(v)}):te(c,v=>{this.shiftEndpointCoordinates(v,p)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,n,i){te(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?n>s[1]?s[1]+=i:n<s[0]&&(s[0]-=i):n>=s[0]&&n<=s[1]&&(s[1]-=i,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,n=[],i=[];te(r,s=>{const a=[];if(s[1])for(let u=s[0];u<=s[1];u++)a.push(this.hot.toPhysicalRow(u));else a.push(this.hot.toPhysicalRow(s[0]));i.push(a)}),te(i,s=>{let a=[];te(s,(u,h)=>{h===0?a.push(u):s[h]!==s[h-1]+1&&(a.push(s[h-1]),n.push(a),a=[],a.push(u)),h===s.length-1&&(a.push(u),n.push(a))})}),e.ranges=n}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,te(e.ranges,n=>{te(n,(i,s)=>{i>=r&&(n[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,a=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],te(e,i=>{this.resetEndpointValue(i,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],te(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],te(e,(n,i,s)=>{`${n[2]||""}`!=`${n[3]}`&&te(this.getAllEndpoints(),(a,u)=>{this.hot.propToCol(s[i][1])===a.sourceColumn&&r.indexOf(u)===-1&&r.push(u)})}),te(r,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const n=this.hot.getCellMeta(r,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?i:0)),""])}setEndpointValue(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const a=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const a=e.roundFloat;let u=0;Number.isInteger(a)&&(u=Math.min(Math.max(0,a),100)),e.result=e.result.toFixed(u)}n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Vt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function AR(t){return t==null||isNaN(t)}function Jre(t,e){ene(t,e),e.add(t)}function ene(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tne(t,e,r){return(e=rne(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rne(t){var e=nne(t,"string");return typeof e=="symbol"?e:e+""}function nne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const HR="columnSummary",ine=220;var Sf=new WeakSet;class sne extends Pt{constructor(){super(...arguments),Jre(this,Sf),tne(this,"endpoints",null)}static get PLUGIN_KEY(){return HR}static get PLUGIN_PRIORITY(){return ine}isEnabled(){return!!this.hot.getSettings()[HR]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[HR],this.endpoints=new Qre(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return jp(Sf,e,one).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return jp(Sf,e,lne).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return jp(Sf,e,ane).call(e,...n)}),this.addHook("beforeCreateRow",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,i)),this.addHook("beforeCreateCol",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,i)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,i)),this.addHook("afterCreateCol",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,i)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return jp(Sf,e,une).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return wt(e.ranges,n=>{r+=this.getPartialSum(n,e.sourceColumn)}),r}getPartialSum(e,r){let n=0,i=e[1]||e[0],s=null,a=0;do{if(s=this.getCellValue(i,r),s=AR(s)?null:s,s!==null){const u=(`${s}`.split(".")[1]||[]).length||1;u>a&&(a=u)}n+=s||0,i-=1}while(i>=e[0]);return Math.round(n*10**a)/10**a}calculateMinMax(e,r){let n=null;return wt(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,r);if(n===null&&s!==null&&(n=s),s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break}}),n===null?"Not enough data":n}getPartialMinMax(e,r,n){let i=null,s=e[1]||e[0],a;do{if(a=this.getCellValue(s,r),a=AR(a)?null:a,i===null)i=a;else if(a!==null)switch(n){case"min":i=Math.min(i,a);break;case"max":i=Math.max(i,a);break}s-=1}while(s>=e[0]);return i}countEmpty(e,r){let n,i=0,s=e[1]||e[0];do n=this.getCellValue(s,r),n=AR(n)?null:n,n===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let r=0;const n=e.ranges;return wt(n,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,a=this.countEmpty(i,e.sourceColumn);r+=s,r-=a}),r}calculateAverage(e){const r=this.calculateSum(e),n=this.countEntries(e);return r/n}getCellValue(e,r){const n=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),a="";if(n!==null&&i!==null&&(a=this.hot.getCellMeta(n,i).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Gt`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function one(){this.endpoints.initEndpoints()}function ane(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function lne(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function une(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function hne(t,e){MV(t,e),e.add(t)}function NR(t,e,r){MV(t,e),e.set(t,r)}function MV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xc(t,e){return t.get(HM(t,e))}function H_(t,e,r){return t.set(HM(t,e),r),r}function HM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hw=new WeakMap,Yp=new WeakMap,Gp=new WeakMap,zD=new WeakSet;class IV{constructor(){hne(this,zD),NR(this,Hw,!0),NR(this,Yp,null),NR(this,Gp,new ResizeObserver(e=>HM(zD,this,cne).call(this,e)))}setObservedElement(e){H_(Yp,this,e)}unobserve(){xc(Gp,this).unobserve(xc(Yp,this))}observe(){H_(Hw,this,!0),xc(Gp,this).observe(xc(Yp,this))}destroy(){xc(Gp,this).disconnect()}}function cne(t){if(xc(Hw,this)||!Array.isArray(t)||!t.length){H_(Hw,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:n,blockSize:i}=r[0];this.runLocalHooks("resize",n,i)})}qt(IV,Mn);function mu(t,e,r){dne(t,e),e.set(t,r)}function dne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kt(t,e){return t.get(OV(t,e))}function Jo(t,e,r){return t.set(OV(t,e),r),r}function OV(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pu=new WeakMap,kR=new WeakMap,ea=new WeakMap,Ka=new WeakMap,Xa=new WeakMap,qp=new WeakMap,rc=new WeakMap;class ju{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r){var n=this;mu(this,pu,void 0),mu(this,kR,!1),mu(this,ea,null),mu(this,Ka,void 0),mu(this,Xa,void 0),mu(this,qp,!0),mu(this,rc,new IV),Jo(pu,this,e),Jo(kR,this,r),Jo(Ka,this,this.createEditor()),Jo(Xa,this,Kt(Ka,this).style),Kt(rc,this).setObservedElement(this.getInputElement()),Kt(rc,this).addLocalHook("resize",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,r){Kt(Xa,this).left=`${e}px`,Kt(Xa,this).top=`${r}px`}setSize(e,r){if(e&&r){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${r}px`}}getSize(){return{width:Fr(this.getInputElement()),height:Or(this.getInputElement())}}observeSize(){Kt(rc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){Kt(Xa,this).display="block",Jo(qp,this,!1)}hide(){Kt(rc,this).unobserve(),Kt(qp,this)||(Kt(Xa,this).display="none"),Jo(qp,this,!0)}isVisible(){return Kt(Xa,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return Kt(pu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Kt(pu,this).createElement("div"),r=Kt(pu,this).createElement("textarea");return e.style.display="none",Jo(ea,this,Kt(pu,this).createElement("div")),Kt(ea,this).setAttribute("dir",Kt(kR,this)?"rtl":"ltr"),Re(Kt(ea,this),ju.CLASS_EDITOR_CONTAINER),Kt(pu,this).body.appendChild(Kt(ea,this)),Re(e,ju.CLASS_EDITOR),Re(r,ju.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),Kt(ea,this).appendChild(e),e}getInputElement(){return Kt(Ka,this).querySelector(`.${ju.CLASS_INPUT}`)}getEditorElement(){return Kt(Ka,this)}destroy(){const e=Kt(ea,this)?Kt(ea,this).parentNode:null;Kt(Ka,this).parentNode.removeChild(Kt(Ka,this)),Jo(Ka,this,null),Jo(Xa,this,null),Kt(rc,this).destroy(),e&&e.removeChild(Kt(ea,this))}}qt(ju,Mn);function DR(t,e,r){return(e=fne(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fne(t){var e=gne(t,"string");return typeof e=="symbol"?e:e+""}function gne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mne=250,pne=250;class PV{constructor(e){DR(this,"wasLastActionShow",!0),DR(this,"showDebounced",null),DR(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},pne)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mne;this.showDebounced=Iy(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}qt(PV,Mn);function vne(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function wne(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function vu(t,e){const r={};return te(t,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&(r[i]||(r[i]=[]),r[i][s]=e(i,s))})}),r}function ul(t,e,r,n,i){te(t,s=>{s.forAll((a,u)=>{a>=0&&u>=0&&yne(a,u,e,r,n,i)})})}function yne(t,e,r,n,i,s){const a=i(t,e);let u=n;a.className&&(r==="vertical"?u=vne(a.className,n):u=wne(a.className,n)),s(t,e,"className",u)}function AV(t){return`<span class="selected">✓</span>${t}`}function Qv(t,e){let r=!1;return Array.isArray(t)&&te(t,n=>(n.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return r=!0,!1}),r)),r}function qy(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:s}=n.getBoundingClientRect();r.top=i,r.left=s}return r}const pt="---------";function Cne(){return{name:pt}}const Ki="alignment";function bne(){return{key:Ki,name(){return this.getTranslatedPhrase(ax)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ki}:left`,name(){return this.getTranslatedPhrase(lx)},callback(){const t=this.getSelectedRange(),e=vu(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),ul(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,u)=>this.setCellMeta(i,s,a,u)),this.render()},disabled:!1},{key:`${Ki}:center`,name(){return this.getTranslatedPhrase(ux)},callback(){const t=this.getSelectedRange(),e=vu(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),ul(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,u)=>this.setCellMeta(i,s,a,u)),this.render()},disabled:!1},{key:`${Ki}:right`,name(){return this.getTranslatedPhrase(hx)},callback(){const t=this.getSelectedRange(),e=vu(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),ul(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,u)=>this.setCellMeta(i,s,a,u)),this.render()},disabled:!1},{key:`${Ki}:justify`,name(){return this.getTranslatedPhrase(cx)},callback(){const t=this.getSelectedRange(),e=vu(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),ul(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,u)=>this.setCellMeta(i,s,a,u)),this.render()},disabled:!1},{name:pt},{key:`${Ki}:top`,name(){return this.getTranslatedPhrase(dx)},callback(){const t=this.getSelectedRange(),e=vu(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),ul(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,u)=>this.setCellMeta(i,s,a,u)),this.render()},disabled:!1},{key:`${Ki}:middle`,name(){return this.getTranslatedPhrase(fx)},callback(){const t=this.getSelectedRange(),e=vu(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),ul(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,u)=>this.setCellMeta(i,s,a,u)),this.render()},disabled:!1},{key:`${Ki}:bottom`,name(){return this.getTranslatedPhrase(gx)},callback(){const t=this.getSelectedRange(),e=vu(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),ul(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,u)=>this.setCellMeta(i,s,a,u)),this.render()},disabled:!1}]}}}const Ky="clear_column";function Sne(){return{key:Ky,name(){return this.getTranslatedPhrase(G1)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const mm="col_left";function Rne(){return{key:mm,name(){return this.getTranslatedPhrase($1)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const pm="col_right";function Ene(){return{key:pm,name(){return this.getTranslatedPhrase(V1)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const vm="make_read_only";function _ne(){return{key:vm,checkable:!0,ariaChecked(){return Qv(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Ew)},name(){let t=this.getTranslatedPhrase(Ew);return Qv(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=AV(t)),t},callback(){const t=this.getSelectedRange(),e=Qv(t,(r,n)=>this.getCellMeta(r,n).readOnly);te(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Xy="redo";function Tne(){return{key:Xy,name(){return this.getTranslatedPhrase(Y1)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const wm="remove_col";function xne(){return{key:wm,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(U1,e)},callback(){this.alter("remove_col",h7(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Zy="remove_row";function Mne(){return{key:Zy,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(z1,e)},callback(){this.alter("remove_row",c7(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Qy="row_above";function Ine(){return{key:Qy,name(){return this.getTranslatedPhrase(W1)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Jy="row_below";function One(){return{key:Jy,name(){return this.getTranslatedPhrase(B1)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Lg="no_items";function Pne(){return{key:Lg,name(){return this.getTranslatedPhrase(F1)},disabled:!0,isCommand:!1}}const eC="undo";function Ane(){return{key:eC,name(){return this.getTranslatedPhrase(j1)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Hne=[Qy,Jy,mm,pm,Ky,Zy,wm,eC,Xy,vm,Ki,pt,Lg],Nne={[pt]:Cne,[Lg]:Pne,[Qy]:Ine,[Jy]:One,[mm]:Rne,[pm]:Ene,[Ky]:Sne,[Zy]:Mne,[wm]:xne,[eC]:Ane,[Xy]:Tne,[vm]:_ne,[Ki]:bne};function HV(){const t={};return wt(Nne,(e,r)=>{t[r]=e()}),t}function kne(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(ix):this.getTranslatedPhrase(nx)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Dne(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(sx)},callback(){this.getSelectedRangeLast().forAll((r,n)=>{r>=0&&n>=0&&t.removeCommentAtCell(r,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Lne(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(ox);return Qv(this.getSelectedRange(),(n,i)=>t.getCommentMeta(n,i,Jv))?AV(e):e},callback(){this.getSelectedRangeLast().forAll((r,n)=>{if(r>=0&&n>=0){const i=!!t.getCommentMeta(r,n,Jv);t.updateCommentMeta(r,n,{[Jv]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Fne(t,e){NV(t,e),e.add(t)}function nc(t,e,r){NV(t,e),e.set(t,r)}function NV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wne(t,e,r){return(e=Bne(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bne(t){var e=$ne(t,"string");return typeof e=="symbol"?e:e+""}function $ne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sl(t,e,r){return t.set(Yi(t,e),r),r}function bt(t,e){return t.get(Yi(t,e))}function Yi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Nw="comments",Vne=60,ha="comment",eg="value",kV="style",Jv="readOnly",Kp=Nw,N_=`plugin:${Nw}`;var er=new WeakMap,yo=new WeakMap,tC=new WeakMap,ew=new WeakMap,k_=new WeakMap,kw=new WeakMap,ws=new WeakSet;class zne extends Pt{constructor(){super(...arguments),Fne(this,ws),Wne(this,"range",{}),nc(this,er,null),nc(this,yo,null),nc(this,tC,!1),nc(this,ew,!1),nc(this,k_,null),nc(this,kw,"")}static get PLUGIN_KEY(){return Nw}static get PLUGIN_PRIORITY(){return Vne}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Nw]}enablePlugin(){var e=this;this.enabled||(bt(er,this)||(Sl(er,this,new ju(this.hot.rootDocument,this.hot.isRtl())),bt(er,this).addLocalHook("resize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yi(ws,e,Xne).call(e,...n)})),bt(yo,this)||Sl(yo,this,new PV(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,n,i,s,a,u)=>Yi(ws,this,Gne).call(this,r,u)),this.addHook("afterScroll",()=>Yi(ws,this,Qne).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>Yi(ws,this,Zne).call(this,r)),this.addHook("afterSetTheme",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yi(ws,e,Jne).call(e,...n)}),bt(yo,this).addLocalHook("hide",()=>this.hide()),bt(yo,this).addLocalHook("show",(r,n)=>this.showAtCell(r,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){bt(yo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),n=e.addContext(N_);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Sl(ew,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(N_),this.hot._registerTimeout(()=>{Sl(ew,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:Kp}),n.addShortcut({keys:[["Escape"]],callback:()=>{bt(er,this).setValue(bt(kw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>bt(er,this).isVisible()&&bt(er,this).isFocused(),group:Kp}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>bt(er,this).isVisible()&&bt(er,this).isFocused(),group:Kp})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Kp)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>Yi(ws,this,jne).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>Yi(ws,this,Une).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Yi(ws,this,Yne).call(this)),this.eventManager.addEventListener(r,"focus",()=>Yi(ws,this,Kne).call(this)),this.eventManager.addEventListener(r,"blur",()=>Yi(ws,this,qne).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=Ol(e.target,"TD","TBODY");return!!(r&&nt(r,"htCommentCell")&&Ol(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=bt(er,this).getValue();let n="";e!=null?n=e:r!=null&&(n=r);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[eg]:n}),this.hot.render()}setCommentAtCell(e,r,n){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ha),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(n)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,eg)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,eg)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:n}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return bt(yo,this).cancelHiding(),bt(er,this).setValue((e=i[ha]?i[ha][eg]:null)!==null&&e!==void 0?e:""),bt(er,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){bt(er,this).hide()}refreshEditor(){var e,r;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!bt(er,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:a,col:u}=this.range.from;let h=i.getRenderableFromVisualIndex(a),c=s.getRenderableFromVisualIndex(u);const m=h===null;bt(er,this).setPosition(0,0),h===null&&(h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1))),c===null&&(c=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(u,-1)));const p=h===null,v=c===null;h=(e=h)!==null&&e!==void 0?e:0,c=(r=c)!==null&&r!==void 0?r:0;const{rootWindow:y,view:{_wt:C}}=this.hot,{wtTable:R}=C,_=C.getCell({row:h,col:c},!0),x=this.getCommentMeta(a,u,kV);x?bt(er,this).setSize(x.width,x.height):bt(er,this).resetSize();const I=v?0:R.getColumnWidth(c),k=m&&!p?Or(_):0,{left:W,top:B,width:z,height:U}=_.getBoundingClientRect(),{width:J,height:se}=bt(er,this).getSize(),{innerWidth:ne,innerHeight:fe}=this.hot.rootWindow,j=this.hot.rootDocument.documentElement;let ae=W+y.scrollX+I,P=B+y.scrollY+k;this.hot.isRtl()&&(ae-=J+I),this.hot.isLtr()&&W+z+J>ne?ae=W+y.scrollX-J-1:this.hot.isRtl()&&ae<-(j.scrollWidth-j.clientWidth)&&(ae=W+y.scrollX+I+1),B+se>fe&&(P-=se-U+1),bt(er,this).setPosition(ae,P),bt(er,this).setReadOnlyState(this.getCommentMeta(a,u,Jv)),bt(er,this).observeSize()}focusEditor(){bt(er,this).focus()}updateCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r)[ha];let s;i?(s=$n(i),sm(s,n)):s=n,this.hot.setCellMeta(e,r,ha,s)}getCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r);if(i[ha])return i[ha][n]}addToContextMenu(e){e.items.push({name:pt},kne(this),Dne(this),Lne(this))}getEditorInputElement(){return bt(er,this).getInputElement()}destroy(){var e,r;(e=bt(er,this))===null||e===void 0||e.destroy(),(r=bt(yo,this))===null||r===void 0||r.destroy(),super.destroy()}}function Une(t){if(!(!this.hot.view||!this.hot.view._wt)&&!bt(tC,this)&&!this.targetIsCommentTextArea(t)){const e=Ol(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function jne(t){const{rootDocument:e}=this.hot;if(!(bt(tC,this)||bt(er,this).isFocused()||nt(t.target,"wtBorder")||bt(k_,this)===t.target||!bt(er,this)))if(Sl(k_,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));bt(yo,this).show(r)}else Tl(t.target,e)&&!this.targetIsCommentTextArea(t)&&bt(yo,this).hide()}function Yne(){Sl(tC,this,!1)}function Gne(t,e){e[ha]&&e[ha][eg]&&Re(t,e.commentedCellClassName)}function qne(){Sl(kw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Kne(){Sl(kw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(N_)}function Xne(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[kV]:{width:t,height:e}})}function Zne(t){bt(er,this).isFocused()&&ls(t)}function Qne(){bt(ew,this)||this.hide()}function Jne(){const t=bt(er,this).getEditorElement();tt(t,/ht-theme-.*/g),Re(t,this.hot.getCurrentThemeName())}var UD={},LR,jD;function eie(){if(jD)return LR;jD=1;var t=uy(),e=TypeError;return LR=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},LR}var YD;function tie(){if(YD)return UD;YD=1;var t=sr(),e=ed(),r=rd(),n=$F(),i=eie(),s=VF(),a=[].unshift(0)!==1,u=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(c){return c instanceof TypeError}},h=a||!u();return t({target:"Array",proto:!0,arity:1,forced:h},{unshift:function(m){var p=e(this),v=r(p),y=arguments.length;if(y){s(v+y);for(var C=v;C--;){var R=C+y;C in p?p[R]=p[C]:i(p,R)}for(var _=0;_<y;_++)p[_]=arguments[_]}return n(p,v+y)}}),UD}tie();function FR(t,e,r){return(e=rie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rie(t){var e=nie(t,"string");return typeof e=="symbol"?e:e+""}function nie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DV{constructor(e){FR(this,"hot",void 0),FR(this,"commands",{}),FR(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.split(":"),a=s[0],u=s.length===2?s[1]:null;let h=this.commands[a];if(!h)throw new Error(`Menu command '${a}' not exists.`);if(u&&h.submenu&&(h=iie(u,h.submenu.items)),h.disabled===!0||typeof h.disabled=="function"&&h.disabled.call(this.hot)===!0||Ur(h,"submenu"))return;const c=[];typeof h.callback=="function"&&c.push(h.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),n.unshift(s.join(":")),te(c,m=>m.apply(this.hot,n))}}function iie(t,e){let r;return te(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function WR(t,e,r){return(e=sie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sie(t){var e=oie(t,"string");return typeof e=="symbol"?e:e+""}function oie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LV{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;WR(this,"hot",void 0),WR(this,"predefinedItems",HV()),WR(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,wt(e,(n,i)=>{let s="";n.name===pt?(r[pt]=n,s=pt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,s=n.key):(r[n.key]=n,s=n.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return aie(e,this.defaultOrderPattern,this.predefinedItems)}}function aie(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),vt(i)?wt(i,(s,a)=>{let u=r[typeof s=="string"?s:a];u||(u=s),vt(s)?jr(u,s):typeof u=="string"&&(u={name:u}),u.key===void 0&&(u.key=a),n.push(u)}):te(i,(s,a)=>{let u=r[s];!u&&Hne.indexOf(s)>=0||(u||(u={name:s,key:`${a}`}),vt(s)&&jr(u,s),u.key===void 0&&(u.key=a),n.push(u))}),n}function Za(t,e,r){return(e=lie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lie(t){var e=uie(t,"string");return typeof e=="symbol"?e:e+""}function uie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hie{constructor(e,r){Za(this,"top",void 0),Za(this,"topRelative",void 0),Za(this,"left",void 0),Za(this,"leftRelative",void 0),Za(this,"scrollTop",void 0),Za(this,"scrollLeft",void 0),Za(this,"cellHeight",void 0),Za(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let s,a,u,h,c,m;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),u=parseInt(e.left,10),c=e.height||0,m=e.width||0,a=s,h=u,s+=n,u+=i):this.type==="event"&&(s=parseInt(e.pageY,10),u=parseInt(e.pageX,10),c=e.target.clientHeight,m=e.target.clientWidth,a=s-n,h=u-i),this.top=s,this.topRelative=a,this.left=u,this.leftRelative=h,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=c,this.cellWidth=m}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Rf(t,e,r){cie(t,e),e.set(t,r)}function cie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(t,e){return t.get(FV(t,e))}function Xp(t,e,r){return t.set(FV(t,e),r),r}function FV(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xn=new WeakMap,io=new WeakMap,hi=new WeakMap,BR=new WeakMap,ic=new WeakMap;class die{constructor(e){Rf(this,Xn,void 0),Rf(this,io,void 0),Rf(this,hi,void 0),Rf(this,BR,!1),Rf(this,ic,{above:0,below:0,left:0,right:0}),Xp(BR,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ct(ic,this)[e]=r,this}setElement(e){return Xp(Xn,this,e),this}setParentElement(e){return Xp(io,this,e),this}updatePosition(e){Xp(hi,this,new hie(e,Ct(Xn,this).ownerDocument.defaultView)),Ct(BR,this)?(Ct(hi,this).fitsBelow(Ct(Xn,this))?this.setPositionBelowCursor():Ct(hi,this).fitsAbove(Ct(Xn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ct(Xn,this).dir==="rtl"?Ct(hi,this).fitsOnLeft(Ct(Xn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ct(hi,this).fitsOnRight(Ct(Xn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ct(ic,this).above+Ct(hi,this).top-Ct(Xn,this).offsetHeight;Ct(io,this)&&(e=Ct(hi,this).top+Ct(hi,this).cellHeight-Ct(Xn,this).offsetHeight+3),Ct(Xn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Ct(ic,this).below+Ct(hi,this).top+1;Ct(io,this)&&(e=Ct(hi,this).top-1),Ct(Xn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ct(hi,this).left;if(Ct(io,this)){const r=Ct(io,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(Ct(io,this).querySelector(".htCore")).borderRightWidth,10);e+=Ct(hi,this).cellWidth+n}else e+=Ct(ic,this).right;Ct(Xn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ct(ic,this).left+Ct(hi,this).left-Ct(Xn,this).offsetWidth;if(Ct(io,this)){const r=Ct(io,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(Ct(io,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}Ct(Xn,this).style.left=`${e}px`}}function WV(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const s=new Set;let a=_t(e,-1,C()-1);function u(_,x){const I=C()-1;return _<0&&(_=I),_>I&&(_=0),s.has(_)?-1:(s.add(_),n(_,!1)===!1&&(_=u(x===1?++_:--_,x)),_)}function h(_){_>-1&&_<C()&&n(_,!0)!==!1&&(a=_)}function c(){return a}function m(){C()>0&&(s.clear(),a=u(0,1))}function p(){C()>0&&(s.clear(),a=u(C()-1,-1))}function v(){C()>0&&(s.clear(),a=u(++a,1))}function y(){C()>0&&(s.clear(),a=u(--a,-1))}function C(){return Math.max(r(),0)}function R(){s.clear(),a=e,i()}return{setCurrentPage:h,getCurrentPage:c,toFirstItem:m,toLastItem:p,toNextItem:v,toPreviousItem:y,getSize:C,clear:R}}function fie(t){return St(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function D_(t){return Ur(t,"submenu")}function L_(t){return new RegExp(pt,"i").test(t.name)}function tw(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function GD(t){return Ur(t,"disableSelection")}function gie(t){return nt(t,"htSeparator")}function mie(t){return nt(t,"htSubmenu")}function pie(t){return nt(t,"htDisabled")}function vie(t){return nt(t,"htSelectionDisabled")}function wie(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function BV(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function yie(t,e){let r=t.slice(0);return r.reverse(),r=BV(r,e),r.reverse(),r}function Cie(t){const e=[];return te(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function bie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pt,r=t.slice(0);return r=BV(r,e),r=yie(r,e),r=Cie(r),r}function Sie(t){return t.checkable===!0}function Rie(t){return WV({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||gie(n)||pie(n)||vie(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Eie(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const s=e.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(n):s.tabMoves;i.includes("shift")?e.selection.transformStart(-a.row,-a.col):e.selection.transformStart(a.row,a.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const $V="menu",qD=$V;function _ie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Eie(t)),e.forEach(c=>{let{shortcuts:m,contextName:p}=c;i(m,p)});function n(c,m){u(m).addShortcuts(c,{group:$V})}function i(c,m){const p=u(m);c.forEach(v=>{let{keys:y}=v;y.forEach(C=>p.removeShortcutsByKeys(C))}),r.push({shortcuts:c,contextName:m}),n(c,m)}function s(){return[...r]}function a(c){return c?`${qD}:${c}`:qD}function u(c){var m;const p=t.hotMenu.getShortcutManager(),v=a(c);return(m=p.getContext(v))!==null&&m!==void 0?m:p.addContext(v)}function h(c){t.hotMenu.getShortcutManager().setActiveContextName(a(c))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:u,listen:h}}function Tie(t){return(e,r,n,i,s,a)=>{const u=e.getSourceDataAtRow(n),h=t.rootDocument.createElement("div"),c=typeof a=="function"?a.call(t):a,m=typeof u.ariaLabel=="function"?u.ariaLabel.call(t):u.ariaLabel,p=typeof u.ariaChecked=="function"?u.ariaChecked.call(t):u.ariaChecked;if(Ls(r),Re(h,"htItemWrapper"),t.getSettings().ariaTags){const v=!tw(u,t)&&!GD(u)&&!L_(u);it(r,[...Sie(u)?[aK(),mw(m),sB(p)]:[oK(),mw(c)],...v?[ld(-1)]:[],...tw(u,t)?[gK()]:[],...D_(u)?[ts(!1)]:[]])}r.className="",r.appendChild(h),L_(u)?Re(r,"htSeparator"):typeof u.renderer=="function"?(Re(r,"htCustomMenuRenderer"),r.appendChild(u.renderer(e,h,n,i,s,c))):dh(h,c),tw(u,t)?Re(r,"htDisabled"):GD(u)?Re(r,"htSelectionDisabled"):D_(u)&&Re(r,"htSubmenu")}}function $R(t,e,r){xie(t,e),e.set(t,r)}function xie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function so(t,e,r){return(e=Mie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mie(t){var e=Iie(t,"string");return typeof e=="symbol"?e:e+""}function Iie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VR(t,e,r){return t.set(VV(t,e),r),r}function wu(t,e){return t.get(VV(t,e))}function VV(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const KD=215;var Ef=new WeakMap,Zp=new WeakMap,Qp=new WeakMap;class gd{get tableBorderWidth(){return wu(Qp,this)===void 0&&this.hotMenu&&VR(Qp,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),wu(Qp,this)}constructor(e,r){var n=this;so(this,"hot",void 0),so(this,"options",void 0),so(this,"eventManager",new ns(this)),so(this,"container",void 0),so(this,"positioner",void 0),so(this,"hotMenu",null),so(this,"hotSubMenus",{}),so(this,"parentMenu",void 0),so(this,"menuItems",null),so(this,"origOutsideClickDeselects",null),$R(this,Ef,void 0),$R(this,Zp,void 0),$R(this,Qp,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:KD,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new die(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(i,s)=>{if(!s){var a;(a=this.hotMenu)===null||a===void 0||a.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Xu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return wu(Ef,this)}getKeyboardShortcutsCtrl(){return wu(Zp,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Iy(u=>this.openSubMenu(u),300),r=this.options.minWidth||KD;let n=!1,i=Ta(this.menuItems,u=>(u.key===Lg&&(n=!0),wie(u,this.hot)));if(i.length<1&&!n)i.push(HV()[Lg]);else if(i.length===0)return;i=bie(i,pt);let s=!1;const a={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(u){return Ue(u)&&u<r?r:u},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Tie(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(u,h)=>{wu(Ef,this).setCurrentPage(h.row)},afterOnCellMouseOver:(u,h)=>{this.isAllSubMenusClosed()?e(h.row):this.openSubMenu(h.row)},rowHeights:u=>i[u].name===pt?1:void 0,afterOnCellContextMenu:u=>{u.preventDefault(),g_()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(u,h,c,m,p)=>{this.hotMenu.view.isMouseDown()&&(p.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:u=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(u))},afterOnCellMouseUp:u=>{(!g_()||!Al(u))&&s&&this.hasSelectedItem()&&(wa()||s1()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),VR(Ef,this,Rie(this.hotMenu)),VR(Zp,this,_ie(this)),wu(Zp,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(wu(Ef,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);it(n,[ts(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!mie(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new gd(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&it(r,[ts(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&it(i,[ts(!1)])}}closeAllSubMenus(){te(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?fie(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||L_(e)||tw(e,this.hot)||D_(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,s=parseInt(n.width,10),a=Gr(r,(u,h,c)=>{const p=this.hotMenu.getCell(c,0)?Or(this.hotMenu.getCell(c,0)):0;return u+(h.name===pt?1:p)},0);i.width=`${s}px`,i.height=`${a}px`,n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(nr(n)&&(n=n.call(this.hot),n===null||fr(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),Re(i,`htMenu ${this.options.className}`),n&&Re(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&it(this.hotMenu.rootElement,[sK(),ld(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Tl(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Tl(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&nt(e.target,"htCore")&&Tl(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}qt(gd,Mn);function Oie(t,e){Pie(t,e),e.add(t)}function Pie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zR(t,e,r){return(e=Aie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Aie(t){var e=Hie(t,"string");return typeof e=="symbol"?e:e+""}function Hie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tg="contextMenu",Nie=70,XD=tg;ze.getSingleton().register("afterContextMenuDefaultOptions");ze.getSingleton().register("beforeContextMenuShow");ze.getSingleton().register("afterContextMenuShow");ze.getSingleton().register("afterContextMenuHide");ze.getSingleton().register("afterContextMenuExecute");var _f=new WeakSet;class rC extends Pt{constructor(){super(...arguments),Oie(this,_f),zR(this,"commandExecutor",new DV(this.hot)),zR(this,"itemsFactory",null),zR(this,"menu",null)}static get PLUGIN_KEY(){return tg}static get PLUGIN_PRIORITY(){return Nie}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Qy,Jy,pt,mm,pm,pt,Zy,wm,pt,eC,Xy,pt,vm,pt,Ki]}isEnabled(){return!!this.hot.getSettings()[tg]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[tg];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new gd(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Jp(_f,this,Die).call(this)),this.menu.addLocalHook("afterOpen",()=>Jp(_f,this,Lie).call(this)),this.menu.addLocalHook("afterClose",()=>Jp(_f,this,Fie).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>Jp(_f,this,kie).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=qy(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:XD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(XD)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(n.below+=1,n.right+=1,n.above-=1,n.left-=1),wt(n,(s,a)=>{this.menu.setOffset(a,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new LV(this.hot,rC.DEFAULT_ITEMS);const e=this.hot.getSettings()[tg],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),te(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function kie(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),nt(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(s)&&!(nt(s,"current")&&nt(s,"wtBorder"))))return;const a=qy(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+a.top,left:t.clientX+a.left})}function Die(){this.hot.runHooks("beforeContextMenuShow",this)}function Lie(){this.hot.runHooks("afterContextMenuShow",this)}function Fie(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}rC.SEPARATOR={name:pt};function Wie(t){return{key:"copy",name(){return this.getTranslatedPhrase(q1)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Bie(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?_t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Z1,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function $ie(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?_t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(X1,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Vie(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?_t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(K1,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function zie(t){return{key:"cut",name(){return this.getTranslatedPhrase(Q1)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class Uie{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class jie{constructor(){this.clipboardData=new Uie}preventDefault(){}}function Yie(t,e){zV(t,e),e.add(t)}function sc(t,e,r){zV(t,e),e.set(t,r)}function zV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jn(t,e){return t.get(Nc(t,e))}function oc(t,e,r){return t.set(Nc(t,e),r),r}function Nc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qa=new WeakMap,UR=new WeakMap,Tf=new WeakMap,F_=new WeakMap,W_=new WeakMap,xf=new WeakMap,Mf=new WeakSet;class Gie{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:s,countColumnHeaders:a}=e;Yie(this,Mf),sc(this,Qa,void 0),sc(this,UR,void 0),sc(this,Tf,void 0),sc(this,F_,void 0),sc(this,W_,void 0),sc(this,xf,void 0),oc(UR,this,r),oc(Tf,this,n),oc(F_,this,i),oc(W_,this,s),oc(xf,this,a)}setSelectedRange(e){oc(Qa,this,e)}getCellsRange(){if(Jn(UR,this).call(this)===0||Jn(Tf,this).call(this)===0)return null;const{row:e,col:r}=Jn(Qa,this).getTopStartCorner(),{row:n,col:i}=Jn(Qa,this).getBottomEndCorner(),s=Nc(Mf,this,qie).call(this,e,n),a=Nc(Mf,this,jR).call(this,r,i);return{isRangeTrimmed:n!==s||i!==a,startRow:e,startCol:r,endRow:s,endCol:a}}getMostBottomColumnHeadersRange(){if(Jn(Tf,this).call(this)===0||Jn(xf,this).call(this)===0)return null;const{col:e}=Jn(Qa,this).getTopStartCorner(),{col:r}=Jn(Qa,this).getBottomEndCorner(),n=Nc(Mf,this,jR).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Jn(Tf,this).call(this)===0||Jn(xf,this).call(this)===0)return null;const{col:e}=Jn(Qa,this).getTopStartCorner(),{col:r}=Jn(Qa,this).getBottomEndCorner(),n=Nc(Mf,this,jR).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Jn(xf,this).call(this),startCol:e,endRow:-1,endCol:n}}}function jR(t,e){return Math.min(e,Math.max(t+Jn(W_,this).call(this)-1,t))}function qie(t,e){return Math.min(e,Math.max(t+Jn(F_,this).call(this)-1,t))}function UV(t){const e=[],r=[];return te(t,n=>{const i=Math.min(n.startRow,n.endRow),s=Math.max(n.startRow,n.endRow);Xe(i,s,h=>{e.indexOf(h)===-1&&e.push(h)});const a=Math.min(n.startCol,n.endCol),u=Math.max(n.startCol,n.endCol);Xe(a,u,h=>{r.indexOf(h)===-1&&r.push(h)})}),{rows:e,columns:r}}function Kie(t,e){jV(t,e),e.add(t)}function Ja(t,e,r){jV(t,e),e.set(t,r)}function jV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function If(t,e,r){return(e=Xie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xie(t){var e=Zie(t,"string");return typeof e=="symbol"?e:e+""}function Zie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vi(t,e){return t.get(wi(t,e))}function Rs(t,e,r){return t.set(wi(t,e),r),r}function wi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("afterCopyLimit");ze.getSingleton().register("modifyCopyableRange");ze.getSingleton().register("beforeCut");ze.getSingleton().register("afterCut");ze.getSingleton().register("beforePaste");ze.getSingleton().register("afterPaste");ze.getSingleton().register("beforeCopy");ze.getSingleton().register("afterCopy");const YR="copyPaste",Qie=80,Jie=["fragmentSelection"],ZD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var B_=new WeakMap,$_=new WeakMap,V_=new WeakMap,ac=new WeakMap,ev=new WeakMap,tv=new WeakMap,lc=new WeakMap,Dw=new WeakMap,Ai=new WeakSet;class ese extends Pt{constructor(){super(...arguments),Kie(this,Ai),If(this,"columnsLimit",1/0),If(this,"rowsLimit",1/0),If(this,"pasteMode","overwrite"),If(this,"uiContainer",this.hot.rootDocument.body),Ja(this,B_,!1),Ja(this,$_,!1),Ja(this,V_,!1),Ja(this,ac,"cells-only"),Ja(this,ev,!1),Ja(this,tv,!1),Ja(this,lc,new Gie({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ja(this,Dw,!1),If(this,"copyableRanges",[])}static get PLUGIN_KEY(){return YR}static get SETTING_KEYS(){return[YR,...Jie]}static get PLUGIN_PRIORITY(){return Qie}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[YR]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Rs(B_,this,this.getSetting("copyColumnHeaders")),Rs($_,this,this.getSetting("copyColumnGroupHeaders")),Rs(V_,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>wi(Ai,this,nse).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return wi(Ai,n,ise).call(n,...s)}),this.addHook("afterSelectionEnd",()=>wi(Ai,this,sse).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),n1()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return wi(Ai,n,ose).call(n,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return wi(Ai,n,ase).call(n,...s)}),this.addHook("afterSelection",()=>wi(Ai,this,lse).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Rs(ac,this,e),Rs(ev,this,!0),wi(Ai,this,QD).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Rs(tv,this,!0),wi(Ai,this,QD).call(this,"cut")}getRangedCopyableData(e){return ug(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=UV(e);return te(n,s=>{const a=[];te(i,u=>{s<0?a.push(this.hot.getColHeader(u,s)):a.push(this.hot.getCopyableData(s,u))}),r.push(a)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new jie;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}vi(lc,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);vi(ac,this)==="column-headers-only"?r.set("headers",vi(lc,this).getMostBottomColumnHeadersRange()):(vi(ac,this)==="with-column-headers"?r.set("headers",vi(lc,this).getMostBottomColumnHeadersRange()):vi(ac,this)==="with-column-group-headers"&&r.set("headers",vi(lc,this).getAllColumnHeadersRange()),r.set("cells",vi(lc,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:a,endRow:u,endCol:h}=i;return{startRow:s,startCol:a,endRow:u,endCol:h}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:s,endRow:a,endCol:u}=n;this.hot.runHooks("afterCopyLimit",a-i+1,u-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,s=[],{row:a,col:u}=r.getTopStartCorner(),{row:h,col:c}=r.getBottomEndCorner();let m=a,p=u,v=a,y=u;for(;s.length<n||m<=h;){const{skipRowOnPaste:C,visualRow:R}=this.hot.getCellMeta(m,u);if(m=R+1,C===!0)continue;v=R,p=u;const _=[],x=s.length%n;for(;_.length<i||p<=c;){const{skipColumnOnPaste:I,visualCol:k}=this.hot.getCellMeta(a,p);if(p=k+1,I===!0)continue;y=k;const W=_.length%i;_.push(e[x][W])}s.push(_)}return Rs(Dw,this,!0),this.hot.populateFromArray(a,u,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,u,v,y]}onCopy(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!vi(ev,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),Rs(ev,this,!1);const s=this.getRangedData(this.copyableRanges),a=wi(Ai,this,tse).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,a)){const h=ug(s);if(e&&e.clipboardData){const c=w_(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",h),e.clipboardData.setData("text/html",[ZD,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.runHooks("afterCopy",s,this.copyableRanges,a)}Rs(ac,this,"cells-only")}onCut(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!vi(tv,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),Rs(tv,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const u=ug(s);if(e&&e.clipboardData){const h=w_(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",u),e.clipboardData.setData("text/html",[ZD,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const m=Ry(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});m&&/(<table)|(<TABLE)/g.test(m)?s=$B(m,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=p7(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[a,u,h,c]=this.populateValues(s);this.hot.selectCell(a,u,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function QD(t){if(n1()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&CB(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function tse(t){const{rows:e}=UV(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function rse(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&QT(n)}}}function YV(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&JT(n)}}}function nse(t){t.items.push({name:"---------"},Wie(this)),vi(B_,this)&&t.items.push(Vie(this)),vi($_,this)&&t.items.push($ie(this)),vi(V_,this)&&t.items.push(Bie(this)),t.items.push(zie(this))}function ise(t,e,r,n,i){vi(Dw,this)&&(i.value=!0),Rs(Dw,this,!1)}function sse(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function ose(){wi(Ai,this,YV).call(this)}function ase(){wi(Ai,this,rse).call(this)}function lse(){wi(Ai,this,YV).call(this)}function GV(t,e){return`border_row${t}col${e}`}function rg(){return{width:1,color:"#000"}}function ya(){return{hide:!0}}function use(){return{width:1,color:"#000",cornerVisible:!1}}function GR(t){if(Ue(t.start)||Ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Ue(t.end)||Ue(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function Of(t){return Ue(t.start)&&(t.left=t.start),Ue(t.end)&&(t.right=t.end),t}function qR(t,e){return{id:GV(t,e),border:use(),row:t,col:e,top:ya(),bottom:ya(),start:ya(),end:ya()}}function hse(t,e){return Ur(e,"border")&&e.border&&(t.border=e.border),Ur(e,"top")&&Ue(e.top)&&(e.top?(vt(e.top)||(e.top=rg()),t.top=e.top):(e.top=ya(),t.top=e.top)),Ur(e,"bottom")&&Ue(e.bottom)&&(e.bottom?(vt(e.bottom)||(e.bottom=rg()),t.bottom=e.bottom):(e.bottom=ya(),t.bottom=e.bottom)),Ur(e,"start")&&Ue(e.start)&&(e.start?(vt(e.start)||(e.start=rg()),t.start=e.start):(e.start=ya(),t.start=e.start)),Ur(e,"end")&&Ue(e.end)&&(e.end?(vt(e.end)||(e.end=rg()),t.end=e.end):(e.end=ya(),t.end=e.end)),t}function Ma(t,e){let r=!1;return te(t.getSelectedRange(),n=>{n.forAll((i,s)=>{if(i<0||s<0)return;const a=t.getCellMeta(i,s).borders;if(a)if(e){if(!Ur(a[e],"hide")||a[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function nC(t){return`<span class="selected">✓</span>${t}`}function cse(t){return t.some(e=>Ue(e.left)||Ue(e.right))}function dse(t){return t.some(e=>Ue(e.start)||Ue(e.end))}const fse=new Map([["left","start"],["right","end"]]);function gse(t){var e;return(e=fse.get(t))!==null&&e!==void 0?e:t}function mse(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(wx);return Ma(this,"bottom")&&(e=nC(e)),e},callback(e,r){const n=Ma(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function pse(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(yx);return Ma(this,e)&&(r=nC(r)),r},callback(r,n){const i=Ma(this,e);t.prepareBorder(n,e,i)}}}function vse(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Cx)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!Ma(this)}}}function wse(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(vx);return Ma(this,e)&&(r=nC(r)),r},callback(r,n){const i=Ma(this,e);t.prepareBorder(n,e,i)}}}function yse(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(px);return Ma(this,"top")&&(e=nC(e)),e},callback(e,r){const n=Ma(this,"top");t.prepareBorder(r,"top",n)}}}function Cse(t,e){bse(t,e),e.add(t)}function bse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sse(t,e,r){return(e=Rse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rse(t){var e=Ese(t,"string");return typeof e=="symbol"?e:e+""}function Ese(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JD(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const rw="customBorders",_se=90;var KR=new WeakSet;class Tse extends Pt{constructor(){super(...arguments),Cse(this,KR),Sse(this,"savedBorders",[])}static get PLUGIN_KEY(){return rw}static get PLUGIN_PRIORITY(){return _se}isEnabled(){return!!this.hot.getSettings()[rw]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>JD(KR,this,xse).call(this,e)),this.addHook("init",()=>JD(KR,this,Mse).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let n=["top","bottom","start","end"],i=null;r&&(this.checkSettingsCohesion([r]),n=Object.keys(r),i=GR(r));const s=Kc(e),a=kg(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});te(e,u=>{a(u).forAll((h,c)=>{te(n,m=>{this.prepareBorderFromCustomAdded(h,c,i,gse(m))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=Kc(e),n=kg(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return te(e,s=>{n(s).forAll((a,u)=>{te(this.savedBorders,h=>{h.row===a&&h.col===u&&i.push(Of(h))})})}),i}clearBorders(e){e?this.setBorders(e):(te(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,r,n,i){const s=this.hot.countRows(),a=this.hot.countCols();if(e>=s||r>=a)return;let u=qR(e,r);n&&(u=hse(u,n),te(this.hot.selection.highlight.customSelections,h=>{if(u.id===h.settings.id)return Object.assign(h.settings,n),u.id=h.settings.id,u.top=h.settings.top,u.bottom=h.settings.bottom,u.start=h.settings.start,u.end=h.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",Of(u)),this.insertBorderIntoSettings(u,i)}prepareBorderFromCustomAddedRange(e,r){const n=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Xe(e.from.row,n,s=>{Xe(e.from.col,i,a=>{const u=qR(s,a);let h=0;s===e.from.row&&Ur(r,"top")&&(h+=1,u.top=r.top),s===e.to.row&&Ur(r,"bottom")&&(h+=1,u.bottom=r.bottom),a===e.from.col&&Ur(r,"start")&&(h+=1,u.start=r.start),a===e.to.col&&Ur(r,"end")&&(h+=1,u.end=r.end),h>0&&(this.hot.setCellMeta(s,a,"borders",Of(u)),this.insertBorderIntoSettings(u))})})}removeAllBorders(e,r){const n=GV(e,r);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,n,i){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=qR(e,r):s=GR(s),i?(s[n]=ya(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",Of(s)))):(s[n]=rg(),this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",Of(s)))}prepareBorder(e,r,n){te(e,i=>{let{start:s,end:a}=i;if(s.row===a.row&&s.col===a.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,n);else switch(r){case"noBorders":Xe(s.col,a.col,u=>{Xe(s.row,a.row,h=>{this.removeAllBorders(h,u)})});break;case"top":Xe(s.col,a.col,u=>{this.setBorder(s.row,u,r,n)});break;case"bottom":Xe(s.col,a.col,u=>{this.setBorder(a.row,u,r,n)});break;case"start":Xe(s.row,a.row,u=>{this.setBorder(u,s.col,r,n)});break;case"end":Xe(s.row,a.row,u=>{this.setBorder(u,a.col,r,n)});break}})}createCustomBorders(e){te(e,r=>{const n=GR(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(e){const{top:r,bottom:n,start:i,end:s}=e;return Gr([r,n,i,s],(u,h)=>{let c=u;return h&&h.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const r=St(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){te(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){te(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=St(this.savedBorders,n=>n.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):te(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,n){let i=!1;return te(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);return te(a,u=>{u.toggleHiddenClass(r,n)}),i=!0,!1}}),i}checkCustomSelections(e,r,n){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):te(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=r,a.commit(),n){const u=this.hot.view._wt.selectionManager.getBorderInstances(a);te(u,h=>{h.changeBorderStyle(n,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[rw];if(Array.isArray(e)){const r=$n(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=cse(e),n=dse(e);if(r&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function xse(t){this.hot.getSettings()[rw]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(mx)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[yse(this),wse(this),mse(this),pse(this),vse(this)]}})}function Mse(){this.changeBorderSettings()}function Ise(t,e){Ose(t,e),e.add(t)}function Ose(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XR(t,e,r){return(e=Pse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pse(t){var e=Ase(t,"string");return typeof e=="symbol"?e:e+""}function Ase(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eL(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tL="dragToScroll",Hse=100;var ZR=new WeakSet;class Nse extends Pt{constructor(){super(...arguments),Ise(this,ZR),XR(this,"boundaries",null),XR(this,"callback",null),XR(this,"listening",!1)}static get PLUGIN_KEY(){return tL}static get PLUGIN_PRIORITY(){return Hse}isEnabled(){return!!this.hot.getSettings()[tL]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>eL(ZR,this,rL).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>eL(ZR,this,rL).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let n=0,i=0;r<this.boundaries.top?i=r-this.boundaries.top:r>this.boundaries.bottom&&(i=r-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",n=>this.onMouseMove(n)),r=Xu(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function rL(t){if(Al(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,n)=>{var i,s;const a=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,u=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(a+Math.sign(r)*50,u+Math.sign(n)*20)}),this.listen()}function kse(t,e){qV(t,e),e.add(t)}function Dse(t,e,r){qV(t,e),e.set(t,r)}function qV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QR(t,e,r){return(e=Lse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lse(t){var e=Fse(t,"string");return typeof e=="symbol"?e:e+""}function Fse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wse(t,e){return t.get(Xi(t,e))}function KV(t,e,r){return t.set(Xi(t,e),r),r}function Xi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("afterDropdownMenuDefaultOptions");ze.getSingleton().register("beforeDropdownMenuShow");ze.getSingleton().register("afterDropdownMenuShow");ze.getSingleton().register("afterDropdownMenuHide");ze.getSingleton().register("afterDropdownMenuExecute");const nw="dropdownMenu",Bse=230,Fg="changeType",JR=nw;var iC=new WeakMap,Ts=new WeakSet;class sC extends Pt{static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return Bse}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[mm,pm,pt,wm,pt,Ky,pt,vm,pt,Ki]}constructor(e){super(e),kse(this,Ts),QR(this,"commandExecutor",new DV(this.hot)),QR(this,"itemsFactory",null),QR(this,"menu",null),Dse(this,iC,!1),this.hot.addHook("afterGetColHeader",(r,n)=>Xi(Ts,this,Vse).call(this,r,n))}isEnabled(){return this.hot.getSettings()[nw]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new LV(this.hot,sC.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Xi(Ts,e,qse).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Xi(Ts,e,Gse).call(e,...s)});const r=this.hot.getSettings()[nw],n={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new gd(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Xi(Ts,this,zse).call(this)),this.menu.addLocalHook("afterOpen",()=>Xi(Ts,this,Use).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>Xi(Ts,this,jse).call(this,s)),this.menu.addLocalHook("afterClose",()=>Xi(Ts,this,Yse).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return e.executeCommand.call(e,...a)}),te(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:n}=this.hot.getSelectedRangeLast();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=qy(this.menu.container,this.hot.rootDocument),a=this.hot.getCell(-1,i.col,!0).querySelector(`.${Fg}`),u=a.getBoundingClientRect();this.open({left:u.left+s.left,top:u.top+a.offsetHeight+s.top},{left:u.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:JR},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:JR}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JR)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Xi(Ts,this,$se).call(this,e))}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),wt(n,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function XV(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function $se(t){if(nt(t.target,Fg)){const e=qy(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),KV(iC,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function Vse(t,e){const r=e.parentNode;if(!r)return;const n=r.parentNode.childNodes,i=Array.prototype.indexOf.call(n,r);if(t<0||i!==n.length-1)return;const s=e.querySelector(`.${Fg}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const a=this.hot.rootDocument.createElement("button");a.className=Fg,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(it(a,[Ll(),mw(" ")]),it(e,[rB("menu")])),a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}function zse(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Use(){this.hot.runHooks("afterDropdownMenuShow",this),Xi(Ts,this,XV).call(this,this.menu)}function jse(t){Xi(Ts,this,XV).call(this,t)}function Yse(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Gse(t){return Wse(iC,this)?null:t}function qse(t){nt(t.target,Fg)&&KV(iC,this,!0)}sC.SEPARATOR={name:pt};function nL(t,e,r){return(e=Kse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kse(t){var e=Xse(t,"string");return typeof e=="symbol"?e:e+""}function Xse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zse{constructor(e){nL(this,"hot",void 0),nL(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:n,endCol:i}=this._getDataRange(),s=this.options,a=[];return Xe(e,n,u=>{const h=[];!s.exportHiddenRows&&this._isHiddenRow(u)||(Xe(r,i,c=>{!s.exportHiddenColumns&&this._isHiddenColumn(c)||h.push(this.hot.getDataAtCell(u,c))}),a.push(h))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();Xe(r,n,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();Xe(r,n,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[n=0,i=0,s=r,a=e]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),s=Math.min(s,r),a=Math.min(a,e),{startRow:n,startCol:i,endRow:s,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function iL(t,e,r){return(e=Qse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qse(t){var e=Jse(t,"string");return typeof e=="symbol"?e:e+""}function Jse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){iL(this,"dataProvider",void 0),iL(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=Fs(this.constructor.DEFAULT_OPTIONS);const n=new Date;return r=jr(Fs(NM.DEFAULT_OPTIONS),r),r=jr(r,e),r.filename=zT(r.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),r}}const eoe="\r",toe='"',roe=`
`;class noe extends NM{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,r=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,s=this.dataProvider.getRowHeaders(),a=s.length>0;let u=e.bom?"\uFEFF":"";return i&&(n=St(n,h=>this._escapeCell(h,!0)),a&&(u+=e.columnDelimiter),u+=n.join(e.columnDelimiter),u+=e.rowDelimiter),te(r,(h,c)=>{c>0&&(u+=e.rowDelimiter),a&&(u+=this._escapeCell(s[c])+e.columnDelimiter),u+=h.map(m=>this._escapeCell(m)).join(e.columnDelimiter)}),u}_escapeCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Mr(e);return n!==""&&(r||n.indexOf(eoe)>=0||n.indexOf(toe)>=0||n.indexOf(roe)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}const ioe="csv",z_={[ioe]:noe};function soe(t,e,r){return typeof z_[t]=="function"?new z_[t](e,r):null}const ooe="exportFile",aoe=240;class loe extends Pt{static get PLUGIN_KEY(){return ooe}static get PLUGIN_PRIORITY(){return aoe}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,r),a=this._createBlob(s),u=i.URL||i.webkitURL,h=n.createElement("a"),c=`${s.options.filename}.${s.options.fileExtension}`;if(h.download!==void 0){const m=u.createObjectURL(a);h.style.display="none",h.setAttribute("href",m),h.setAttribute("download",c),n.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),n.body.removeChild(h),setTimeout(()=>{u.revokeObjectURL(m)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,c)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!z_[e])throw new Error(`Export format type "${e}" is not supported.`);return soe(e,new Zse(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function uc(t,e,r){return(e=uoe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uoe(t){var e=hoe(t,"string");return typeof e=="symbol"?e:e+""}function hoe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ym{constructor(e,r){let{id:n,stateless:i=!0}=r;uc(this,"hot",void 0),uc(this,"id",void 0),uc(this,"elements",[]),uc(this,"hidden",!1),uc(this,"stateId",""),uc(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Wy)}getElements(){return this.elements}reset(){te(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),te(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}qt(ym,Mn);const Wg={};function Hl(t,e){if(!Wg[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:n}=Wg[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(s){return r.apply(s.meta.instance,[].concat([s],[i]))}}function Yu(t){if(!Wg[t])throw Error(`Filter condition "${t}" does not exist.`);return Wg[t].descriptor}function qr(t,e,r){r.key=t,Wg[t]={condition:e,descriptor:r}}const Cn="none";function coe(){return!0}qr(Cn,coe,{name:By,inputsCount:0,showOperators:!1});const dg="empty";function doe(t){return Ir(t.value)}qr(dg,doe,{name:xx,inputsCount:0,showOperators:!0});const iw="not_empty";function foe(t,e){return!Hl(dg,e)(t)}qr(iw,foe,{name:Mx,inputsCount:0,showOperators:!0});const fg="eq";function goe(t,e){let[r]=e;return Mr(t.value).toLocaleLowerCase(t.meta.locale)===Mr(r)}qr(fg,goe,{name:Ix,inputsCount:1,showOperators:!0});const sw="neq";function moe(t,e){return!Hl(fg,e)(t)}qr(sw,moe,{name:Ox,inputsCount:1,showOperators:!0});const ZV="gt";function poe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>n}qr(ZV,poe,{name:kx,inputsCount:1,showOperators:!0});const QV="gte";function voe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>=n}qr(QV,voe,{name:Dx,inputsCount:1,showOperators:!0});const JV="lt";function woe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<n}qr(JV,woe,{name:Lx,inputsCount:1,showOperators:!0});const e2="lte";function yoe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<=n}qr(e2,yoe,{name:Fx,inputsCount:1,showOperators:!0});const kM="date_after";function Coe(t,e){let[r]=e;const n=Ee(t.value,t.meta.dateFormat),i=Ee(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)>=0}qr(kM,Coe,{name:$x,inputsCount:1,showOperators:!0});const DM="date_before";function boe(t,e){let[r]=e;const n=Ee(t.value,t.meta.dateFormat),i=Ee(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)<=0}qr(DM,boe,{name:Vx,inputsCount:1,showOperators:!0});const Lw="between";function Soe(t,e){let[r,n]=e,i=r,s=n;if(t.meta.type==="numeric"){const a=parseFloat(i,10),u=parseFloat(s,10);i=Math.min(a,u),s=Math.max(a,u)}else if(t.meta.type==="date"){const a=Hl(DM,[s]),u=Hl(kM,[i]);return a(t)&&u(t)}return t.value>=i&&t.value<=s}qr(Lw,Soe,{name:Wx,inputsCount:2,showOperators:!0});const t2="not_between";function Roe(t,e){return!Hl(Lw,e)(t)}qr(t2,Roe,{name:Bx,inputsCount:2,showOperators:!0});const r2="begins_with";function Eoe(t,e){let[r]=e;return Mr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Mr(r))}qr(r2,Eoe,{name:Px,inputsCount:1,showOperators:!0});const n2="ends_with";function _oe(t,e){let[r]=e;return Mr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Mr(r))}qr(n2,_oe,{name:Ax,inputsCount:1,showOperators:!0});const LM="contains";function Toe(t,e){let[r]=e;return Mr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Mr(r))>=0}qr(LM,Toe,{name:Hx,inputsCount:1,showOperators:!0});const i2="not_contains";function xoe(t,e){return!Hl(LM,e)(t)}qr(i2,xoe,{name:Nx,inputsCount:1,showOperators:!0});const s2="date_tomorrow";function Moe(t){const e=Ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ee().subtract(-1,"days").startOf("day"),"d"):!1}qr(s2,Moe,{name:Ux,inputsCount:0});const o2="date_today";function Ioe(t){const e=Ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ee().startOf("day"),"d"):!1}qr(o2,Ioe,{name:zx,inputsCount:0});const a2="date_yesterday";function Ooe(t){const e=Ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ee().subtract(1,"days").startOf("day"),"d"):!1}qr(a2,Ooe,{name:jx,inputsCount:0});_B();function Poe(t,e){let r=t;return r===""&&(r=`(${e})`),r}const U_=new Set([1]).has(1),Aoe=U_&&typeof Array.from=="function";function Cm(t){let e=t;return U_&&(e=new Set(e)),function(r){let n;return U_?n=e.has(r):n=!!~e.indexOf(r),n}}function l2(t){return t??""}function j_(t){let e=t;return Aoe?e=Array.from(new Set(e)):e=BT(e),e=e.sort((r,n)=>typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1),e}function sL(t,e,r,n){const i=[],s=t===e;let a;return s||(a=Cm(e)),te(t,u=>{let h=!1;(s||a(u))&&(h=!0);const c={checked:h,value:u,visualValue:Poe(u,r)};n&&n(c),i.push(c)}),i}const Gu="by_value";function Hoe(t,e){let[r]=e;return r(t.value)}qr(Gu,Hoe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Cm(e)]},showOperators:!1});const Bg={};function Noe(t){if(!Bg[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Bg[t].func;return function(r,n){return e(r,n)}}function koe(t){return Bg[t].name}function FM(t,e,r){Bg[t]={name:e,func:r}}const Ml="conjunction",Doe=qx;function Loe(t,e){return t.every(r=>r.func(e))}FM(Ml,Doe,Loe);const Fw="disjunction",Foe=$y;function Woe(t,e){return t.some(r=>r.func(e))}FM(Fw,Foe,Woe);const WM="disjunctionWithExtraCondition",Boe=$y;function $oe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}FM(WM,Boe,$oe);const Voe="numeric",u2="text",zoe="date",oL={[Voe]:[Cn,pt,dg,iw,pt,fg,sw,pt,ZV,QV,JV,e2,Lw,t2],[u2]:[Cn,pt,dg,iw,pt,fg,sw,pt,r2,n2,pt,LM,i2],[zoe]:[Cn,pt,dg,iw,pt,fg,sw,pt,DM,kM,Lw,pt,s2,o2,a2]};function Uoe(t){const e=[];let r=t;return oL[r]||(r=u2),te(oL[r],n=>{let i;n===pt?i={name:pt}:i=Fs(Yu(n)),e.push(i)}),e}function Pf(t,e,r){return(e=joe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function joe(t){var e=Yoe(t,"string");return typeof e=="symbol"?e:e+""}function Yoe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eE="built",tE="building",aL=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ns=class h2{static get DEFAULTS(){return Fs({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){Pf(this,"hot",void 0),Pf(this,"eventManager",new ns(this)),Pf(this,"options",void 0),Pf(this,"_element",void 0),Pf(this,"buildState",void 0),this.hot=e,this.options=jr(h2.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===tE?this._element:this.buildState===eE?(this.update(),this._element):(this.buildState=tE,this.build(),this.buildState=eE,this._element)}isBuilt(){return this.buildState===eE}translateIfPossible(e){return typeof e=="string"&&e.startsWith(si)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,n)=>{this.eventManager.addEventListener(r,n,i=>this.runLocalHooks(n,i,this))};if(this.buildState||(this.buildState=tE),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Re(this._element,this.options.className),this.options.children.length)te(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),wt(this.options,(n,i)=>{r[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(r[i]=this.translateIfPossible(n))}),this._element.appendChild(r),te(aL,n=>e(r,n))}else te(aL,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};qt(Ns,Mn);function Goe(t,e){c2(t,e),e.add(t)}function qoe(t,e,r){c2(t,e),e.set(t,r)}function c2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rv(t,e){return t.get(BM(t,e))}function Koe(t,e,r){return t.set(BM(t,e),r),r}function BM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hc=new WeakMap,lL=new WeakSet;class Il extends Ns{static get DEFAULTS(){return Fs({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,jr(Il.DEFAULTS,r)),Goe(this,lL),qoe(this,hc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>BM(lL,this,Xoe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Koe(hc,this,this._element.firstChild),Re(this._element,"htUIInput"),Re(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(rv(hc,this).type=this.options.type,rv(hc,this).placeholder=this.translateIfPossible(this.options.placeholder),rv(hc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&rv(hc,this).focus()}}function Xoe(t){this.options.value=t.target.value}function Zoe(t,e){d2(t,e),e.add(t)}function Af(t,e,r){d2(t,e),e.set(t,r)}function d2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cc(t,e,r){return t.set(gg(t,e),r),r}function br(t,e){return t.get(gg(t,e))}function gg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var on=new WeakMap,nv=new WeakMap,iv=new WeakMap,rE=new WeakMap,sv=new WeakMap,ov=new WeakSet;class $g extends Ns{static get DEFAULTS(){return Fs({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,jr($g.DEFAULTS,r)),Zoe(this,ov),Af(this,on,null),Af(this,nv,[]),Af(this,iv,void 0),Af(this,rE,void 0),Af(this,sv,void 0),this.registerHooks()}getMenu(){return br(on,this)}registerHooks(){this.addLocalHook("click",()=>gg(ov,this,eae).call(this))}setItems(e){cc(nv,this,this.translateNames(e)),br(on,this)&&br(on,this).setMenuItems(br(nv,this))}translateNames(e){return te(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),cc(on,this,new gd(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),br(on,this).setMenuItems(br(nv,this));const e=new Ns(this.hot,{className:"htUISelectCaption"}),r=new Ns(this.hot,{className:"htUISelectDropdown"});cc(iv,this,e),cc(rE,this,e.element),cc(sv,this,r),this.hot.getSettings().ariaTags&&(it(r.element,[Ll()]),it(this._element,[tB()])),te([e,r],n=>this._element.appendChild(n.element)),br(on,this).addLocalHook("select",n=>gg(ov,this,Qoe).call(this,n)),br(on,this).addLocalHook("afterClose",()=>gg(ov,this,Joe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=br(on,this).hot.getTranslatedPhrase(By),br(rE,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();br(on,this)&&(br(on,this).open(),br(on,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),br(on,this).getNavigator().toFirstItem(),br(on,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){br(on,this)&&br(on,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){br(on,this)&&(br(on,this).destroy(),cc(on,this,null)),br(iv,this)&&br(iv,this).destroy(),br(sv,this)&&br(sv,this).destroy(),super.destroy()}}function Qoe(t){t.name!==pt&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Joe(){this.runLocalHooks("afterClose")}function eae(){this.openOptions()}function tae(t,e){rae(t,e),e.add(t)}function rae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uL(t,e,r){return(e=nae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nae(t){var e=iae(t,"string");return typeof e=="symbol"?e:e+""}function iae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hL(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var nE=new WeakSet;class Y_ extends ym{constructor(e,r){super(e,{id:r.id,stateless:!1}),tae(this,nE),uL(this,"name",""),uL(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new $g(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new Il(this.hot,{placeholder:eM})),this.elements.push(new Il(this.hot,{placeholder:tM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>hL(nE,this,sae).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),te(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>hL(nE,this,oae).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=Fs(e.command);r.name.startsWith(Pr)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),te(e.args,(n,i)=>{if(i>r.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(n),s[r.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Yu(Cn),r=[];return te(this.getInputElements(),(n,i)=>{e.inputsCount>i&&r.push(n.getValue())}),{command:e,args:r}}updateState(e,r){const n=Yu(e?e.name:Cn);this.state.setValueAtIndex(r,{command:n,args:e?e.args:[]}),e||te(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof $g)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Il)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,a)=>{Re(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Re(r.parentNode,"border");const u=this.hot.rootDocument.createElement("div");return Re(u,"htFiltersMenuLabel"),u.textContent=a,r.appendChild(u),r.parentElement.hasAttribute("ghost-table")||te(this.elements,h=>r.appendChild(h.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[Yu(Cn)];if(e!==null){const{visualIndex:n}=e;r=Uoe(this.hot.getDataType(0,n,this.hot.countRows(),n))}te(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function sae(t){te(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function oae(t){hd(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ls(t))}function cL(t,e,r){aae(t,e),e.set(t,r)}function aae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hf(t,e){return t.get(f2(t,e))}function dL(t,e,r){return t.set(f2(t,e),r),r}function f2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var dc=new WeakMap,iE=new WeakMap;class Ww extends Ns{static get DEFAULTS(){return Fs({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,jr(Ww.DEFAULTS,r)),cL(this,dc,void 0),cL(this,iE,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),dL(iE,this,e),dL(dc,this,this._element.firstChild),Hf(dc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Hf(iE,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Hf(dc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Hf(dc,this).checked=e)}focus(){this.isBuilt()&&Hf(dc,this).focus()}}function lae(t,e){uae(t,e),e.add(t)}function uae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hae(t,e,r){return(e=cae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cae(t){var e=dae(t,"string");return typeof e=="symbol"?e:e+""}function dae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fae(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const fL=0;var gL=new WeakSet;class gae extends ym{constructor(e,r){super(e,{id:r.id,stateless:!1}),lae(this,gL),hae(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(Re(r.parentNode,"htFiltersMenuOperators"),te(this.elements,n=>r.appendChild(n.element)),r)}}buildOperatorsElement(){const e=[Ml,Fw];te(e,r=>{const n=new Ww(this.hot,{name:"operator",label:{htmlFor:r,textContent:koe(r)},value:r,checked:r===e[fL],id:r});n.addLocalHook("change",i=>fae(gL,this,mae).call(this,i)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Gt`Radio button with index ${e} doesn't exist.`);te(this.elements,(r,n)=>{r.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof Ww&&r.isChecked());return e?e.getValue():Ml}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&te(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ml,r=arguments.length>1?arguments[1]:void 0,n=e;n===WM&&(n=Fw),this.state.setValueAtIndex(r,n)}reset(){this.setChecked(fL)}}function mae(t){this.setState(t.target.value)}function pae(t,e,r){vae(t,e),e.set(t,r)}function vae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sE(t,e){return t.get(g2(t,e))}function wae(t,e,r){return t.set(g2(t,e),r),r}function g2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Nf=new WeakMap;class Vg extends Ns{static get DEFAULTS(){return Fs({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,jr(Vg.DEFAULTS,r)),pae(this,Nf,void 0)}build(){super.build(),wae(Nf,this,this._element.firstChild)}update(){this.isBuilt()&&(sE(Nf,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&sE(Nf,this).focus()}activate(){sE(Nf,this).click()}}function yae(t,e){m2(t,e),e.add(t)}function fc(t,e,r){m2(t,e),e.set(t,r)}function m2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ct(t,e){return t.get(kc(t,e))}function ys(t,e,r){return t.set(kc(t,e),r),r}function kc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const mL="multipleSelect.itemBox";var xs=new WeakMap,kr=new WeakMap,oE=new WeakMap,ta=new WeakMap,el=new WeakMap,tl=new WeakMap,kf=new WeakSet;class zg extends Ns{static get DEFAULTS(){return Fs({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,jr(zg.DEFAULTS,r)),yae(this,kf),fc(this,xs,[]),fc(this,kr,void 0),fc(this,oE,void 0),fc(this,ta,void 0),fc(this,el,void 0),fc(this,tl,void 0),ys(ta,this,new Il(this.hot,{placeholder:Jx,className:"htUIMultipleSelectSearch"})),ys(el,this,new Vg(this.hot,{textContent:Kx,className:"htUISelectAll"})),ys(tl,this,new Vg(this.hot,{textContent:Xx,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ct(kr,this)}registerHooks(){ct(ta,this).addLocalHook("keydown",e=>kc(kf,this,bae).call(this,e)),ct(ta,this).addLocalHook("input",e=>kc(kf,this,Cae).call(this,e)),ct(el,this).addLocalHook("click",e=>kc(kf,this,Sae).call(this,e)),ct(tl,this).addLocalHook("click",e=>kc(kf,this,Rae).call(this,e))}setItems(e){var r;ys(xs,this,e),(r=ct(kr,this))===null||r===void 0||r.loadData(ct(xs,this))}setLocale(e){ys(oE,this,e)}getLocale(){return ct(oE,this)}getItems(){return[...ct(xs,this)]}getValue(){return _ae(ct(xs,this))}getSearchInputElement(){return ct(ta,this)}getSelectAllElement(){return ct(el,this)}getClearAllElement(){return ct(tl,this)}isSelectedAllValues(){return ct(xs,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),n=new Ns(this.hot,{className:"htUISelectionControls",children:[ct(el,this),ct(tl,this)]});this._element.appendChild(ct(ta,this).element),this._element.appendChild(n.element),this._element.appendChild(r);const i=s=>{var a;if(!this._element)return;(a=ct(kr,this))===null||a===void 0||a.destroy(),Re(s,"htUIMultipleSelectHot"),ys(kr,this,new this.hot.constructor(s,{data:ct(xs,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,m,p,v,y,C)=>{c.title=C.instance.getDataAtRowProp(m,C.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ct(kr,this).listen()},colWidths:()=>ct(kr,this).container.scrollWidth-bn(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ct(kr,this).init(),this.hot.addHook("afterSetTheme",(c,m)=>{m||ct(kr,this).useTheme(c)});const h=ct(kr,this).getShortcutManager().getContext("grid");h.removeShortcutsByKeys(["Tab"]),h.removeShortcutsByKeys(["Shift","Tab"]),h.addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:mL}),h.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:c=>{ct(kr,this).deselectCell(),this.runLocalHooks("keydown",c,this),this.runLocalHooks("listTabKeydown",c,this)},group:mL})};i(r),this.hot._registerTimeout(()=>i(r),100)}focus(){this.isBuilt()&&ct(kr,this).listen()}reset(){ct(ta,this).reset(),ct(el,this).reset(),ct(tl,this).reset()}update(){this.isBuilt()&&(ct(kr,this).loadData(Eae(ct(xs,this),this.options.value)),super.update())}destroy(){var e;(e=ct(kr,this))===null||e===void 0||e.destroy(),ct(ta,this).destroy(),ct(tl,this).destroy(),ct(el,this).destroy(),ys(ta,this,null),ys(tl,this,null),ys(el,this,null),ys(kr,this,null),ys(xs,this,null),super.destroy()}}function Cae(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[...ct(xs,this)]:r=ct(xs,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),ct(kr,this).loadData(r)}function bae(t){this.runLocalHooks("keydown",t,this),e1(hd,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),ls(t),ct(kr,this).listen(),ct(kr,this).selectCell(0,0))}function Sae(t){const e=[];t.preventDefault(),ct(kr,this).getSourceData().forEach((r,n)=>{r.checked=!0,e.push(O1(r,n)[0])}),ct(kr,this).setSourceDataAtCell(e)}function Rae(t){const e=[];t.preventDefault(),ct(kr,this).getSourceData().forEach((r,n)=>{r.checked=!1,e.push(O1(r,n)[0])}),ct(kr,this).setSourceDataAtCell(e)}function Eae(t,e){const r=Cm(e);return t.map(n=>(n.checked=r(n.value),n))}function _ae(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function Tae(t,e){xae(t,e),e.add(t)}function xae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mae(t,e,r){return(e=Iae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iae(t){var e=Oae(t,"string");return typeof e=="symbol"?e:e+""}function Oae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function av(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Df=new WeakSet;class Pae extends ym{constructor(e,r){super(e,{id:r.id,stateless:!1}),Tae(this,Df),Mae(this,"name",""),this.name=r.name,this.elements.push(new zg(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>av(Df,this,Aae).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>av(Df,this,Hae).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Gu){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?Cn:Gu},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(n,i,s,a,u)=>{const[h]=Ta(i,p=>p.name===Gu),c={},m=this.hot.getTranslatedPhrase(_w);if(h){const p=a(n,u),v=St(p,I=>I.value),y=new Map(p.map(I=>[I.value,this.hot.getCellMeta(I.meta.visualRow,I.meta.visualCol)])),C=j_(v);s&&(h.args[0]=s);const R=[],_=sL(C,h.args[0],m,I=>{I.checked&&R.push(I.value),av(Df,this,pL).call(this,I,y)}),x=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,x).locale,c.args=[R],c.command=Yu(Gu),c.itemsSnapshot=_}else c.args=[],c.command=Yu(Cn);this.state.setValueAtIndex(n,c)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof zg)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,a)=>{Re(r.parentNode,"htFiltersMenuValue");const u=this.hot.rootDocument.createElement("div");return Re(u,"htFiltersMenuLabel"),u.textContent=a,r.appendChild(u),r.parentElement.hasAttribute("ghost-table")||te(this.elements,h=>r.appendChild(h.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(_w),r=this._getColumnVisibleValues(),n=r.map(h=>h.value),i=new Map(r.map(h=>[h.value,h.meta])),s=j_(n),a=sL(s,s,e,h=>{av(Df,this,pL).call(this,h,i)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(s);const u=this.hot.getPlugin("filters").getSelectedColumn();u!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,u.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:St(this.hot.getDataAtCol(e.visualIndex),(r,n)=>({value:l2(r),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function Aae(t){hd(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ls(t))}function pL(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Hae(t,e){switch(e.type){case"numeric":return oV(t,e);default:return t}}var p2;function Nae(t,e){kae(t,e),e.add(t)}function kae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dae(t,e,r){return(e=Lae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lae(t){var e=Fae(t,"string");return typeof e=="symbol"?e:e+""}function Fae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wae(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var vL=new WeakSet;class Ug extends ym{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),Nae(this,vL),Dae(this,"name",""),this.name=r.name,this.elements.push(new Il(this.hot,{type:"button",value:Zx,className:"htUIButton htUIButtonOK",identifier:Ug.BUTTON_OK})),this.elements.push(new Il(this.hot,{type:"button",value:Qx,className:"htUIButton htUIButtonCancel",identifier:Ug.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){te(this.elements,e=>{e.addLocalHook("click",(r,n)=>Wae(vL,this,Bae).call(this,r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(Re(r.parentNode,"htFiltersMenuActionBar"),te(this.elements,n=>r.appendChild(n.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}p2=Ug;function Bae(t,e){e.options.identifier===p2.BUTTON_OK?this.accept():this.cancel()}function lv(t,e,r){return(e=$ae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $ae(t){var e=Vae(t,"string");return typeof e=="symbol"?e:e+""}function Vae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wL="ConditionCollection.filteringStates";class $M{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;lv(this,"hot",void 0),lv(this,"isMapRegistrable",void 0),lv(this,"filteringStates",new Wy),lv(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(wL,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var n;const i=this.filteringStates.getValueAtIndex(r),s=(n=i==null?void 0:i.conditions)!==null&&n!==void 0?n:[],a=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,a)}isMatchInConditions(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ml;return e.length?Noe(n)(e,r):!0}addCondition(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ml,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,a=St(r.args,m=>typeof m=="string"?m.toLocaleLowerCase(s):m),u=r.name||r.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const h=this.getOperation(e);if(h){if(h!==n)throw Error(Gt`The column of index ${e} has been already applied with a \`${h}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(fr(Bg[n]))throw new Error(Gt`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:u,args:a,func:Hl(u,a)}]},i):c.push({name:u,args:a,func:Hl(u,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Gr(this.filteringStates.getEntries(),(e,r)=>{let[n,{operation:i,conditions:s}]=r;return e.push({column:n,operation:i,conditions:St(s,a=>{let{name:u,args:h}=a;return{name:u,args:h}})}),e},[])}importAllConditions(e){this.clean(),te(e,r=>{te(r.conditions,n=>this.addCondition(r.column,n))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const n=this.getConditions(e);return r?n.some(i=>i.name===r):n.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(wL),this.filteringStates=null,this.clearLocalHooks()}}qt($M,Mn);function yL(t,e,r){return(e=zae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zae(t){var e=Uae(t,"string");return typeof e=="symbol"?e:e+""}function Uae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v2{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];yL(this,"conditionCollection",void 0),yL(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return te(this.conditionCollection.getFilteredColumns(),(r,n)=>{let i=this.columnDataFactory(r);n&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(r,i)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return te(r,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&n.push(i)}),n}_getIntersectData(e,r){const n=[];return te(r,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(n[s]=e[s])}),n}}function jae(t,e){Yae(t,e),e.add(t)}function Yae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e,r){return(e=Gae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gae(t){var e=qae(t,"string");return typeof e=="symbol"?e:e+""}function qae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var uv=new WeakSet;class w2{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];jae(this,uv),yu(this,"hot",void 0),yu(this,"conditionCollection",void 0),yu(this,"columnDataFactory",void 0),yu(this,"changes",[]),yu(this,"grouping",!1),yu(this,"latestEditedColumnPosition",-1),yu(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",i=>aE(uv,this,Kae).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>aE(uv,this,Xae).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>aE(uv,this,Zae).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,te(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const a=i.slice(0,s),u=i.slice(s);u.length&&u[0].column===e&&u.shift();const h=SB(function(m,p){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const y=new $M(n.hot,!1),C=[].concat(m,v);y.importAllConditions(C);const R=n.columnDataFactory(p);let _;y.isEmpty()?_=R:_=new v2(y,I=>n.columnDataFactory(I)).filter(),_=St(_,I=>I.meta.visualRow);const x=Cm(_);return y.destroy(),Ta(R,I=>x(I.meta.visualRow))})(a),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:u,filteredRowsFactory:h,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),wt(this,(e,r)=>{this[r]=null})}}function Kae(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Xae(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Zae(){te(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}qt(w2,Mn);function Qae(t){return WV({initialPage:0,size:()=>t.length,onItemSelect:(r,n)=>{const i=t[r];if(i instanceof zg)return n;if(i.element&&!Zu(i.element))return!1;i.focus()}})}const Lf="filters";function Jae(t,e){let r=-1,n;const i=Qae(e),s=p=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(Lf),i.setCurrentPage(e.indexOf(p))};e.forEach(p=>{p instanceof Ns&&(p.addLocalHook("click",s(p)),p.addLocalHook("focus",s(p)),p.addLocalHook("afterClose",s(p)))}),h(t);function a(p){const v=n.getKeyboardShortcutsCtrl(),y=p.getKeyboardShortcutsCtrl();i.clear(),y.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:v.getContext(Lf),callback:()=>{p.isSubMenu()&&p.close(),v.listen(Lf)}}]),!p.isSubMenu()&&v.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:C=>{const R=n.getNavigator();R.getCurrentPage()>-1&&(r=R.getCurrentPage()),R.clear(),C.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:C=>{const R=e[i.getCurrentPage()];R instanceof $g&&(R.openOptions(),C.preventDefault()),R instanceof Vg&&(R.activate(),C.preventDefault()),R instanceof Ns||C.preventDefault()}}],Lf)}function u(){n.focus(),n.getKeyboardShortcutsCtrl().listen(Lf)}function h(p){p.addLocalHook("afterSelectionChange",v=>{v.key.startsWith("filter_")||i.clear()}),p.addLocalHook("afterSubmenuOpen",a),p.addLocalHook("afterOpen",a),n=p}function c(){return n}function m(){return r}return{...i,listen:u,setMenu:h,getMenu:c,getLastMenuPage:m}}function ele(t,e){y2(t,e),e.add(t)}function CL(t,e,r){y2(t,e),e.set(t,r)}function y2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ff(t,e,r){return(e=tle(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tle(t){var e=rle(t,"string");return typeof e=="symbol"?e:e+""}function rle(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nle(t,e,r){return t.set(fi(t,e),r),r}function fa(t,e){return t.get(fi(t,e))}function fi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const G_="filters",ile=250,bL=G_;var oa=new WeakMap,q_=new WeakMap,Ti=new WeakSet;class sle extends Pt{static get PLUGIN_KEY(){return G_}static get PLUGIN_PRIORITY(){return ile}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),ele(this,Ti),Ff(this,"dropdownMenuPlugin",null),Ff(this,"conditionCollection",null),Ff(this,"conditionUpdateObserver",null),Ff(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Ff(this,"filtersRowsMap",null),CL(this,oa,void 0),CL(this,q_,new WeakSet),this.hot.addHook("afterGetColHeader",(r,n)=>fi(Ti,this,dle).call(this,r,n))}isEnabled(){return!!this.hot.getSettings()[G_]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new hm),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const r=this.hot.getSettings().dropdownMenu,n=r&&r.uiContainer||this.hot.rootDocument.body,i=u=>(u.addLocalHook("accept",()=>fi(Ti,this,SL).call(this,"accept")),u.addLocalHook("cancel",()=>fi(Ti,this,SL).call(this,"cancel")),u.addLocalHook("change",h=>fi(Ti,this,cle).call(this,u,h)),u),s=()=>`${this.hot.getTranslatedPhrase(Yx)}:`,a=()=>`${this.hot.getTranslatedPhrase(Gx)}:`;if(!this.components.get("filter_by_condition")){const u=new Y_(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:n});u.addLocalHook("afterClose",()=>fi(Ti,this,RL).call(this)),this.components.set("filter_by_condition",i(u))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new gae(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const u=new Y_(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});u.addLocalHook("afterClose",()=>fi(Ti,this,RL).call(this)),this.components.set("filter_by_condition2",i(u))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Pae(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Ug(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new $M(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new w2(this.hot,this.conditionCollection,u=>this.getDataMapAtColumn(u)),this.conditionUpdateObserver.addLocalHook("update",u=>fi(Ti,this,fle).call(this,u))),this.components.forEach(u=>u.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var u=arguments.length,h=new Array(u),c=0;c<u;c++)h[c]=arguments[c];return fi(Ti,e,hle).call(e,...h)}),this.addHook("beforeDropdownMenuShow",()=>fi(Ti,this,ule).call(this)),this.addHook("afterDropdownMenuShow",()=>fi(Ti,this,ale).call(this)),this.addHook("afterDropdownMenuHide",()=>fi(Ti,this,lle).call(this)),this.addHook("afterChange",u=>fi(Ti,this,ole).call(this,u)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!fa(oa,this)&&this.dropdownMenuPlugin.enabled){const u=[{focus:()=>{const c=fa(oa,this).getMenu(),m=c.getNavigator(),p=fa(oa,this).getLastMenuPage();c.focus(),p>0?m.setCurrentPage(p):m.toFirstItem()}},...Array.from(this.components).map(c=>{let[,m]=c;return m.getElements()}).flat()];nle(oa,this,Jae(this.dropdownMenuPlugin.menu,u));const h=c=>{fa(oa,this).listen(),c.preventDefault(),hd(c.keyCode,"TAB")&&(c.shiftKey?fa(oa,this).toPreviousItem():fa(oa,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",h),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",h)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:bL})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bL)}addCondition(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ml;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:n},i)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let i=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(n){const u=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=St(r.filter(),c=>c.meta.visualRow);const h=Cm(i);Xe(this.hot.countSourceRows()-1,c=>{h(c)||u.push(c)}),te(u,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),n=[];return te(this.hot.getSourceDataAtCol(r),(i,s)=>{var a;const{row:u,col:h,visualCol:c,visualRow:m,type:p,instance:v,dateFormat:y,locale:C}=this.hot.getCellMeta(s,r),R=(a=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&a!==void 0?a:i;n.push({meta:{row:u,col:h,visualCol:c,visualRow:m,type:p,instance:v,dateFormat:y,locale:C},value:l2(R)})}),n}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),n=j_(r);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var r;const n=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,n,i){let s=e;return s===Fw&&r.command.key!==Cn&&n.command.key!==Cn&&i.command.key!==Cn?s=WM:i.command.key!==Cn&&(r.command.key===Cn||n.command.key===Cn)&&(s=Ml),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new v2(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return te(i,a=>{te(r.menuItems,(u,h)=>{u.key===a.getMenuItemDescriptor().key&&e.push(h)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,i=n.getPlugin("hiddenRows");for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];const h=this.getIndexesOfComponents(...a);e?i.showRows(h):i.hideRows(h),n.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function ole(t){t&&te(t,e=>{const[,r]=e,n=this.hot.propToCol(r);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function ale(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function lle(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ule(){const t=this.dropdownMenuPlugin.menu;fa(q_,this).has(t)||fa(oa,this).setMenu(t),fa(q_,this).add(t)}function hle(t){t.items.push({name:pt}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function SL(t){var e;if(t==="accept"){const n=this.getSelectedColumn();if(n===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:i}=n,s=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),u=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,a,u);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(i);c===-1&&(c=void 0),this.conditionCollection.removeConditions(i),s.command.key!==Cn&&(this.conditionCollection.addCondition(i,s,h,c),a.command.key!==Cn&&this.conditionCollection.addCondition(i,a,h,c)),u.command.key!==Cn&&this.conditionCollection.addCondition(i,u,h,c),this.conditionUpdateObserver.flush(),this.components.forEach(m=>m.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function cle(t,e){const r=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===Y_&&!e.inputsCount&&this.setListeningDropdownMenu(),r.updateMenuDimensions()}function RL(){this.setListeningDropdownMenu()}function dle(t,e){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)?Re(e,"htFiltersActive"):tt(e,"htFiltersActive")}function fle(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:n}}=t,i=r.filter(a=>a.name===Gu),s=r.filter(a=>a.name!==Gu);if(i.length>=2||s.length>=3)Vt(Gt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(s[0],n),this.components.get("filter_by_condition2").updateState(s[1],n),this.components.get("filter_operators").updateState(a,n),this.components.get("filter_by_value").updateState(t)}}const C2="internal-use-in-handsontable",K_={licenseKey:C2,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function b2(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Fn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function S2(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function gle(t){var e;const r=t[Fn],n=S2(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=b2(t);return{...K_,...n,...i}}function mle(t){var e;const r=t[Fn],n=S2(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=b2(t);return{...n,...i}}function ple(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function oC(){const t="engine_relationship",e=zs(Fn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function VM(){const t="shared_engine_usage",e=zs(Fn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function vle(t){const e=t.getSettings(),r=e[Fn],n=r==null?void 0:r.engine;if(r===!0||fr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return wle((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(typeof n=="object"&&fr(n.hyperformula)){const s=oC(),a=VM().get(n);return s.has(n)||s.set(n,[]),s.get(n).push(t),a&&a.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:C2}),(n.getConfig().leapYear1900!==K_.leapYear1900||Oy(n.getConfig().nullDate,K_.nullDate)===!1)&&Vt(Gt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function wle(t,e,r){const n=e[Fn],i=gle(e),s=oC(),a=VM();yle(t,n.functions),Cle(t,n.language);const u=t.buildEmpty(i);return s.set(u,[r]),a.set(u,[r.guid]),ble(u,n.namedExpressions),u.on("sheetAdded",()=>{u.rebuildAndRecalculate()}),u.on("sheetRemoved",()=>{u.rebuildAndRecalculate()}),u}function EL(t){var e;const r=oC(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(i=>[i.getPlugin("formulas").sheetId,i]))}function _L(t,e){if(t){const r=oC(),n=r.get(t),i=VM(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function yle(t,e){e&&e.forEach(r=>{const{name:n,plugin:i,translations:s}=r;try{t.registerFunction(n,i,s)}catch(a){Vt(a.message)}})}function Cle(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(n){Vt(n.message)}}}function ble(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:n,expression:i,scope:s,options:a}=r;try{t.addNamedExpression(n,i,s,a)}catch(u){Vt(u.message)}}),t.resumeEvaluation())}function Sle(t,e){return(fr(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const R2="DD/MM/YYYY";function E2(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Rle(t){return E2(t)?t.substr(1):t}function Ele(t){return typeof t=="string"&&t.startsWith("=")}function zM(t,e){return typeof t=="string"&&e==="date"}function _2(t,e){return Ee(t,e,!0).isValid()}function T2(t,e){return Ee(t,e,!0).format(R2)}function _le(t,e){return Ee(t,R2,!0).format(e)}function x2(t,e){const n=new Date(Date.UTC(0,0,t+-1));return Ee(n).format(e)}function Tle(t,e,r){const n=Array.from(Array(r).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function xle(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(s=>{const a=s.from>s.to,u=s.to<=i.from;s.from>i.from&&u&&a&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function Mle(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function UM(t,e,r){const n=xle(t,Tle(t,e,r));return Mle(n)}function Cu(t,e,r){Ile(t,e),e.set(t,r)}function Ile(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cr(t,e){return t.get(M2(t,e))}function rl(t,e,r){return t.set(M2(t,e),r),r}function M2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Wf=new WeakMap,nl=new WeakMap,xi=new WeakMap,hv=new WeakMap,lE=new WeakMap,uE=new WeakMap,cv=new WeakMap;class TL{constructor(e,r,n){Cu(this,Wf,void 0),Cu(this,nl,void 0),Cu(this,xi,void 0),Cu(this,hv,[]),Cu(this,lE,[]),Cu(this,uE,void 0),Cu(this,cv,[]),rl(Wf,this,e),rl(nl,this,r),rl(xi,this,n)}setRemovedHfIndexes(e){return rl(cv,this,e.map(r=>{const n=cr(nl,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),cr(cv,this)}getRemovedHfIndexes(){return cr(cv,this)}getHfIndexFromVisualIndex(e){const r=cr(nl,this).getIndexesSequence(),n=cr(nl,this).getNotTrimmedIndexes();return r.indexOf(n[e])}syncMoves(e){const n=`move${Bn(cr(Wf,this))}s`;cr(xi,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,a=i.from+1!==i.to;s&&a&&cr(xi,this).getEngine()[n](cr(xi,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,r,n){n!==!1&&(rl(lE,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),rl(uE,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(cr(xi,this).isPerformingUndoRedo()||e===!1||r===!1)return;const n=UM(cr(lE,this),cr(uE,this),cr(nl,this).getNumberOfIndexes());cr(xi,this).getSheetId()===null?cr(xi,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${Bn(cr(Wf,this))}Order`;return r=>{if(cr(xi,this).isPerformingUndoRedo())return;const n=cr(nl,this).getIndexesSequence();if(r==="update"&&n.length>0){const i=cr(hv,this).map(h=>n.indexOf(h)),s=cr(xi,this).getEngine().getSheetDimensions(cr(xi,this).getSheetId());let a;cr(Wf,this)==="row"?a=s.height:a=s.width;const u=i.length;for(let h=u;h<a;h+=1)i.push(h);cr(xi,this).getEngine()[e](cr(xi,this).getSheetId(),i)}rl(hv,this,n)}}init(){rl(hv,this,cr(nl,this).getIndexesSequence())}}function bu(t,e,r){Ole(t,e),e.set(t,r)}function Ole(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ra(t,e){return t.get(I2(t,e))}function Su(t,e,r){return t.set(I2(t,e),r),r}function I2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var dv=new WeakMap,fv=new WeakMap,hE=new WeakMap,cE=new WeakMap,dE=new WeakMap,fE=new WeakMap,gE=new WeakMap;class Ple{constructor(e,r,n){bu(this,dv,void 0),bu(this,fv,void 0),bu(this,hE,void 0),bu(this,cE,!1),bu(this,dE,!1),bu(this,fE,null),bu(this,gE,null),Su(dv,this,new TL("row",e,this)),Su(fv,this,new TL("column",r,this)),Su(hE,this,n)}getForAxis(e){return e==="row"?ra(dv,this):ra(fv,this)}setPerformUndo(e){Su(cE,this,e)}setPerformRedo(e){Su(dE,this,e)}isPerformingUndoRedo(){return ra(cE,this)||ra(dE,this)}getSheetId(){return ra(gE,this)}getEngine(){return ra(fE,this)}getPostponeAction(){return ra(hE,this)}setupSyncEndpoint(e,r){Su(fE,this,e),Su(gE,this,r),ra(dv,this).init(),ra(fv,this).init()}}function Ale(t,e){O2(t,e),e.add(t)}function gc(t,e,r){return(e=Hle(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hle(t){var e=Nle(t,"string");return typeof e=="symbol"?e:e+""}function Nle(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mE(t,e,r){O2(t,e),e.set(t,r)}function O2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nl(t,e,r){return t.set(Xt(t,e),r),r}function Uc(t,e){return t.get(Xt(t,e))}function Xt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Fn="formulas",kle=["maxRows","maxColumns","language"],Dle=260;ze.getSingleton().register("afterNamedExpressionAdded");ze.getSingleton().register("afterNamedExpressionRemoved");ze.getSingleton().register("afterSheetAdded");ze.getSingleton().register("afterSheetRemoved");ze.getSingleton().register("afterSheetRenamed");ze.getSingleton().register("afterFormulasValuesUpdate");const md=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Ia=new WeakMap,jM=new WeakMap,Bf=new WeakMap,Jt=new WeakSet;class Lle extends Pt{constructor(){var e;super(...arguments),e=this,Ale(this,Jt),mE(this,Ia,!1),mE(this,jM,!1),mE(this,Bf,[["valuesUpdated",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xt(Jt,e,Jle).call(e,...n)}],["namedExpressionAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xt(Jt,e,eue).call(e,...n)}],["namedExpressionRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xt(Jt,e,tue).call(e,...n)}],["sheetAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xt(Jt,e,rue).call(e,...n)}],["sheetRenamed",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xt(Jt,e,nue).call(e,...n)}],["sheetRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xt(Jt,e,iue).call(e,...n)}]]),gc(this,"staticRegister",zs("formulas")),gc(this,"engine",null),gc(this,"sheetName",null),gc(this,"indexSyncer",null),gc(this,"rowAxisSyncer",null),gc(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Fn}static get PLUGIN_PRIORITY(){return Dle}static get SETTING_KEYS(){return[Fn,...kle]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Fn]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=vle(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Vt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&(this.sheetName=n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,xL).call(r,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,ML).call(r,...i)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,xL).call(r,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,ML).call(r,...i)}),this.addHook("modifyData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,$le).call(r,...i)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Vle).call(r,...i)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Fle).call(r,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,zle).call(r,...i)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,IL).call(r,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,IL).call(r,...i)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Ule).call(r,...i)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,jle).call(r,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,qle).call(r,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Kle).call(r,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Yle).call(r,...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Gle).call(r,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Xle).call(r,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Zle).call(r,...i)}),this.indexSyncer=new Ple(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,i,s,a)=>{this.rowAxisSyncer.storeMovesInformation(n,i,a)}),this.hot.addHook("beforeColumnMove",(n,i,s,a)=>{this.columnAxisSyncer.storeMovesInformation(n,i,a)}),this.hot.addHook("afterRowMove",(n,i,s,a,u)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,u)}),this.hot.addHook("afterColumnMove",(n,i,s,a,u)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,u)}),this.hot.addHook("beforeColumnFreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Ble).call(r,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Qle).call(r,...i)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Xt(Jt,r,Wle).call(r,...i)}),Uc(Bf,this).forEach(n=>{let[i,s]=n;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){Uc(Bf,this).forEach(e=>{let[r,n]=e;return this.engine.off(r,n)}),_L(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=mle(this.hot.getSettings());ple(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const n=this.hot.getSettings()[Fn];if(Ue(n)&&Ue(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Fn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Uc(Bf,this).forEach(e=>{var r;let[n,i]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(n,i)}),Nl(Bf,this,null),_L(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(Ue(r)&&!g$(r))return Vt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Vt("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(n),r),n}catch(n){return Vt(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){a1(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${Bn(Fn)}.switchSheet`)}getCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return i!==null&&s!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(i=>{var s;const a=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;a!==void 0&&(n.has(a)||n.add(a))}),EL(this.engine).forEach((i,s)=>{if((r||s!==this.sheetId)&&n.has(s)){var a;i.render(),(a=i.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=s=>{var a;const{row:u,col:h,sheet:c}=(a=s==null?void 0:s.address)!==null&&a!==void 0?a:{};return Ue(c)?`${c}:${u}x${h}`:""},i=new Set(r.map(s=>n(s)));e.forEach(s=>{var a,u;const{row:h,col:c}=(a=s.address)!==null&&a!==void 0?a:{};if(Ue(h)===!1||Ue(c)===!1||h>=this.hot.countRows()||c>=this.hot.countCols())return;const m=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet,p=n(s);if(m!==void 0&&!i.has(p)){const v=EL(this.engine).get(m);if(!v)return;v.validateCell(v.getDataAtCell(h,c),v.getCellMeta(h,c),()=>{})}})}syncChangeWithEngine(e,r,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Vt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,r);return zM(n,s.type)&&(_2(n,s.dateFormat)?n=T2(n,s.dateFormat):Ele(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(i,n)}}function Fle(t,e,r){const n=this.hot.propToCol(r);if(this.isFormulaCellType(e,n)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},s=this.hot.getCellMeta(e,n);let a=this.engine.getCellValue(i);return s.type==="date"&&Ln(a)&&(a=x2(a,s.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return t}function Wle(t,e,r){const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:a}=e.getBottomEndCorner(),{row:u,col:h}=r.getTopStartCorner(),{row:c,col:m}=r.getBottomEndCorner(),p={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},v={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(m),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(v)===!1)return!1;const y=this.engine.getFillRangeData(p,v),{row:C,col:R}=p.start,{row:_,col:x}=p.end,I=_-C+1,k=x-R+1;for(let W=0;W<y.length;W+=1)for(let B=0;B<y[W].length;B+=1){const z=y[W][B],U=C+W%I,J=R+B%k,se=this.hot.getCellMeta(U,J);zM(z,se.type)&&(z.startsWith("'")?y[W][B]=z.slice(1):this.isFormulaCellType(U,J,this.sheetId)===!1&&(y[W][B]=_le(z,se.dateFormat)))}return y}function xL(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Bn(Fn))||Nl(jM,this,fr(this.hot.getSettings().data))}function Ble(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((r,n)=>{r.forEach((i,s)=>{const a=this.hot.getCellMeta(n,s),u=a.dateFormat;zM(i,a.type)&&(e=!0,_2(i,u)?t[n][s]=T2(i,u):this.isFormulaCellType(n,s)===!1&&(t[n][s]=`'${i}`))})}),e===!0&&(Nl(Ia,this,!0),this.engine.setSheetContent(this.sheetId,t),Nl(Ia,this,!1))}function ML(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Bn(Fn)))if(this.sheetName=Sle(this.engine,this.hot.getSettings()[Fn].sheetName),Uc(jM,this))this.switchSheet(this.sheetName);else{const n=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,n)){Nl(Ia,this,!0);const i=this.engine.setSheetContent(this.sheetId,n);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Nl(Ia,this,!1)}}}function $le(t,e,r,n){if(n!=="get"||Uc(Ia,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){E2(r.value)&&(r.value=Rle(r.value));return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let u=this.engine.getCellValue(a),h=this.hot.getCellsMeta().find(m=>m.visualRow===i&&m.visualCol===e);h===void 0&&(h={}),h.type==="date"&&Ln(u)&&(u=x2(u,h.dateFormat));const c=typeof u=="object"&&u!==null?u.value:u;r.value=c}function Vle(t,e,r,n){if(n!=="get"||Uc(Ia,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const u=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(u.width===0&&u.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(h)}function IL(t,e){if(md(e))return;const r=[],n=[],i=this.engine.batch(()=>{t.forEach(s=>{let[a,u,,h]=s;const c=this.hot.propToCol(u),m=this.hot.toPhysicalRow(a),p=this.hot.toPhysicalColumn(c),v={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};m!==null&&p!==null?this.syncChangeWithEngine(a,c,h):r.push([a,c,h]),n.push({address:v})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(a=>{let[u,h,c]=a;this.syncChangeWithEngine(u,h,c)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function zle(t,e){if(md(e))return;const r=[],n=[];t.forEach(i=>{let[s,a,,u]=i;const h=this.hot.propToCol(a);if(!Ln(h))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){Vt(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}n.push({address:c}),r.push(...this.engine.setCellContents(c,u))}),this.renderDependentSheets(r),this.validateDependentCells(r,n)}function Ule(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function jle(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function Yle(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function Gle(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function qle(t,e,r){if(md(r))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function Kle(t,e,r){if(md(r))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function Xle(t,e,r,n){if(md(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((a,u)=>u-a),s=this.engine.batch(()=>{i.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(s)}function Zle(t,e,r,n){if(md(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((a,u)=>u-a),s=this.engine.batch(()=>{i.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(s)}function Qle(t,e,r){var n;Nl(Ia,this,!0);const i=this.hot.getSourceDataArray(r,0,r+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());Nl(Ia,this,!1),i.forEach((s,a)=>{s.forEach((u,h)=>{this.engine.setCellContents({col:h,row:r+a,sheet:this.sheetId},[[u]])})})}function Jle(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function eue(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function tue(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function rue(t){this.hot.runHooks("afterSheetAdded",t)}function nue(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function iue(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function sue(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(Rx,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),s=[];for(let h=n;h<=i;h+=1)s.push(h);t.hideColumns(s);const a=s[s.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function oue(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(Ex,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const r=St(t.getHiddenColumns(),p=>this.toPhysicalColumn(p));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,a=this.columnIndexMapper,u=a.getRenderableFromVisualIndex(i),h=a.getRenderableFromVisualIndex(s),c=a.getNotTrimmedIndexes(),m=[];if(i!==s){const p=s-i+1,v=h-u+1;if(p>v){const y=c.slice(i,s+1);m.push(...y.filter(C=>r.includes(C)))}}else if(u===0&&u<i)m.push(...c.slice(0,i));else if(u===null)m.push(...c.slice(0,this.countCols()));else{const p=this.countCols()-1,v=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(p,-1));h===v&&p>s&&m.push(...c.slice(s+1))}return te(m,p=>{e.push(this.toVisualColumn(p))}),e.length===0}}}function aue(t,e){P2(t,e),e.add(t)}function lue(t,e,r){P2(t,e),e.set(t,r)}function P2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ru(t,e){return t.get(cl(t,e))}function OL(t,e,r){return t.set(cl(t,e),r),r}function cl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("beforeHideColumns");ze.getSingleton().register("afterHideColumns");ze.getSingleton().register("beforeUnhideColumns");ze.getSingleton().register("afterUnhideColumns");const PL="hiddenColumns",uue=310;var oo=new WeakMap,Eu=new WeakSet;class hue extends Pt{constructor(){super(...arguments),aue(this,Eu),lue(this,oo,null)}static get PLUGIN_KEY(){return PL}static get PLUGIN_PRIORITY(){return uue}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[PL]}enablePlugin(){var e=this;this.enabled||(OL(oo,this,new Fy),Ru(oo,this).addLocalHook("init",()=>cl(Eu,this,pue).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ru(oo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return cl(Eu,e,mue).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>cl(Eu,this,due).call(this,r,n,i)),this.addHook("modifyColWidth",(r,n)=>cl(Eu,this,cue).call(this,r,n),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return cl(Eu,e,gue).call(e,...n)}),this.addHook("modifyCopyableRange",r=>cl(Eu,this,fue).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;const s=Ru(oo,this).getValues().slice(),a=e.length>0;if(n&&a){const h=e.map(c=>this.hot.toPhysicalColumn(c));te(h,c=>{s[c]=!1}),i=Gr(s,(c,m,p)=>(m&&c.push(this.hot.toVisualColumn(p)),c),[])}this.hot.runHooks("beforeUnhideColumns",r,i,n&&a)!==!1&&(n&&a&&Ru(oo,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,i,n&&a,n&&i.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{te(e,a=>{Ru(oo,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideColumns(r)}getHiddenColumns(){return St(Ru(oo,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ru(oo,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){te(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){OL(oo,this,null),super.destroy()}}function cue(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function due(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenColumn");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function fue(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,a)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:a})};return te(t,n=>{let i=!0,s=0;Xe(n.startCol,n.endCol,a=>{this.isHidden(a)?(i||r(n.startRow,n.endRow,s,a-1),i=!0):(i&&(s=a),a===n.endCol&&r(n.startRow,n.endRow,s,a),i=!1)})}),e}function gue(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),Re(e,r)}function mue(t){t.items.push({name:pt},sue(this),oue(this))}function pue(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function vue(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(_x,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),s=[];for(let h=n;h<=i;h+=1)s.push(h);t.hideRows(s);const a=s[s.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function wue(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(Tx,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const r=St(t.getHiddenRows(),p=>this.toPhysicalRow(p));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,a=this.rowIndexMapper,u=a.getRenderableFromVisualIndex(i),h=a.getRenderableFromVisualIndex(s),c=a.getNotTrimmedIndexes(),m=[];if(i!==s){const p=s-i+1,v=h-u+1;if(p>v){const y=c.slice(i,s+1);m.push(...y.filter(C=>r.includes(C)))}}else if(u===0&&u<i)m.push(...c.slice(0,i));else if(u===null)m.push(...c.slice(0,this.countRows()));else{const p=this.countRows()-1,v=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(p,-1));h===v&&p>s&&m.push(...c.slice(s+1))}return te(m,p=>{e.push(this.toVisualRow(p))}),e.length===0}}}function yue(t,e){A2(t,e),e.add(t)}function Cue(t,e,r){A2(t,e),e.set(t,r)}function A2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _u(t,e){return t.get(dl(t,e))}function AL(t,e,r){return t.set(dl(t,e),r),r}function dl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("beforeHideRows");ze.getSingleton().register("afterHideRows");ze.getSingleton().register("beforeUnhideRows");ze.getSingleton().register("afterUnhideRows");const HL="hiddenRows",bue=320;var ao=new WeakMap,Tu=new WeakSet;class Sue extends Pt{constructor(){super(...arguments),yue(this,Tu),Cue(this,ao,null)}static get PLUGIN_KEY(){return HL}static get PLUGIN_PRIORITY(){return bue}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[HL]}enablePlugin(){var e=this;this.enabled||(AL(ao,this,new Fy),_u(ao,this).addLocalHook("init",()=>dl(Tu,this,Mue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_u(ao,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return dl(Tu,e,xue).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>dl(Tu,this,Eue).call(this,r,n,i)),this.addHook("modifyRowHeight",(r,n)=>dl(Tu,this,Rue).call(this,r,n)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return dl(Tu,e,Tue).call(e,...n)}),this.addHook("modifyCopyableRange",r=>dl(Tu,this,_ue).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;const s=_u(ao,this).getValues().slice(),a=e.length>0;if(n&&a){const h=e.map(c=>this.hot.toPhysicalRow(c));te(h,c=>{s[c]=!1}),i=Gr(s,(c,m,p)=>(m&&c.push(this.hot.toVisualRow(p)),c),[])}this.hot.runHooks("beforeUnhideRows",r,i,n&&a)!==!1&&(n&&a&&_u(ao,this).setValues(s),this.hot.runHooks("afterUnhideRows",r,i,n&&a,n&&i.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{te(e,a=>{_u(ao,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",r,i,n,n&&i.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideRows(r)}getHiddenRows(){return St(_u(ao,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _u(ao,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){te(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){AL(ao,this,null),super.destroy()}}function Rue(t,e){return this.isHidden(e)?0:t}function Eue(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenRow");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function _ue(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,a)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:a})};return te(t,n=>{let i=!0,s=0;Xe(n.startRow,n.endRow,a=>{this.isHidden(a)?(i||r(s,a-1,n.startCol,n.endCol),i=!0):(i&&(s=a),a===n.endRow&&r(s,a,n.startCol,n.endCol),i=!1)})}),e}function Tue(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),Re(e,r)}function xue(t){t.items.push({name:pt},vue(this),wue(this))}function Mue(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Iue(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(J1)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function Oue(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(ex)},callback(e,r){const[{start:{col:n}}]=r;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function Pue(t,e){H2(t,e),e.add(t)}function Aue(t,e,r){H2(t,e),e.set(t,r)}function H2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X_(t,e){return t.get(Bw(t,e))}function pE(t,e,r){return t.set(Bw(t,e),r),r}function Bw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("beforeColumnFreeze");ze.getSingleton().register("afterColumnFreeze");ze.getSingleton().register("beforeColumnUnfreeze");ze.getSingleton().register("afterColumnUnfreeze");const NL="manualColumnFreeze",Hue=110;var Wu=new WeakMap,vE=new WeakSet;class Nue extends Pt{constructor(){super(...arguments),Pue(this,vE),Aue(this,Wu,!1)}static get PLUGIN_KEY(){return NL}static get PLUGIN_PRIORITY(){return Hue}isEnabled(){return!!this.hot.getSettings()[NL]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Bw(vE,this,kue).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>Bw(vE,this,Due).call(this,e,r)),super.enablePlugin())}disablePlugin(){pE(Wu,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;X_(Wu,this)||pE(Wu,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;X_(Wu,this)||pE(Wu,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function kue(t){t.items.push({name:"---------"},Iue(this),Oue(this))}function Due(t,e){if(X_(Wu,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(n=>n<r))return!1}}function gv(t,e,r){return(e=Lue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lue(t){var e=Fue(t,"string");return typeof e=="symbol"?e:e+""}function Fue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wE=0,kL=1,DL=2,mc="px";let N2=class{constructor(e){gv(this,"hot",void 0),gv(this,"_element",null),gv(this,"state",wE),gv(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=DL}build(){this.state===wE&&(this._element=this.hot.rootDocument.createElement("div"),this.state=kL)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=wE}isAppended(){return this.state===DL}isBuilt(){return this.state>=kL}setPosition(e,r){Ln(e)&&(this._element.style.top=e+mc),Ln(r)&&(this._element.style[this.inlineProperty]=r+mc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){Ln(e)&&(this._element.style.width=e+mc),Ln(r)&&(this._element.style.height=r+mc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){Ln(e)&&(this._element.style.marginTop=e+mc),Ln(r)&&(this._element.style[`margin${Bn(this.inlineProperty)}`]=r+mc)}getOffset(){const e=this._element.style,r=`margin${Bn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const Wue="ht__manualColumnMove--backlight";let Bue=class extends N2{build(){super.build(),Re(this._element,Wue)}};const $ue="ht__manualColumnMove--guideline";let Vue=class extends N2{build(){super.build(),Re(this._element,$ue)}};function zue(t,e){k2(t,e),e.add(t)}function Cs(t,e,r){k2(t,e),e.set(t,r)}function k2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yi(t,e,r){return t.set(fl(t,e),r),r}function Ye(t,e){return t.get(fl(t,e))}function fl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("beforeColumnMove");ze.getSingleton().register("afterColumnMove");const yE="manualColumnMove",Uue=120,LL="ht__manualColumnMove",$w="show-ui",Z_="on-moving--columns",Q_="after-selection--columns";var ti=new WeakMap,pl=new WeakMap,Ca=new WeakMap,ow=new WeakMap,Rl=new WeakMap,ei=new WeakMap,mv=new WeakMap,Gi=new WeakMap,Mc=new WeakMap,Vw=new WeakMap,mg=new WeakMap,xu=new WeakSet;class jue extends Pt{constructor(){super(...arguments),zue(this,xu),Cs(this,ti,new Bue(this.hot)),Cs(this,pl,new Vue(this.hot)),Cs(this,Ca,[]),Cs(this,ow,0),Cs(this,Rl,!1),Cs(this,ei,{}),Cs(this,mv,void 0),Cs(this,Gi,void 0),Cs(this,Mc,void 0),Cs(this,Vw,void 0),Cs(this,mg,void 0)}static get PLUGIN_KEY(){return yE}static get PLUGIN_PRIORITY(){return Uue}isEnabled(){return!!this.hot.getSettings()[yE]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fl(xu,e,Yue).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fl(xu,e,que).call(e,...n)}),this.addHook("afterScrollVertically",()=>fl(xu,this,Xue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fl(xu,e,Zue).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),Re(this.hot.rootElement,LL),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){tt(this.hot.rootElement,LL),this.unregisterEvents(),Ye(ti,this).destroy(),Ye(pl,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const n=Ye(mv,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeColumnMove",e,r,n,i);if(yi(mv,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,r);const a=i&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,n,i,a),a}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const n=this.countFinalIndex(e,r);return yi(mv,this,r),this.moveColumns(e,n)}isMovePossible(e,r){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,a=e.some(h=>h<0),u=e.some(h=>h>=n);return!(i||s||a||u)}isColumnOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Gr(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getColumnsWidth(e,r){const n=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=r;s+=1){const a=n.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(a)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[yE];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const n=[];return Xe(e,r,i=>{n.push(i)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Ye(Gi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Ye(Gi,this)-1);const a=r.hider.offsetWidth,u=r.TBODY.offsetLeft,h=Ye(ti,this).getOffset().start,c=Ye(ti,this).getSize().width;let m=0,p=0;if(this.hot.isRtl()){const C=this.hot.rootWindow,R=Fr(this.hot.rootElement),_=C.innerWidth-Ye(Mc,this)-R;p=C.innerWidth-Ye(ei,this).eventPageX-_-(n.scrollX===void 0?i:0)}else p=Ye(ei,this).eventPageX-(Ye(Mc,this)-(n.scrollX===void 0?i:0));if(Ye(Vw,this)&&(m=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Ye(Gi,this))&&(s+=i),s+=m,Ye(Gi,this)<0)Ye(mg,this)>0?Ye(ei,this).col=0:Ye(ei,this).col=e>0?e-1:e;else if(Ye(ei,this).TD.offsetWidth/2+s<=p){const C=Ye(Gi,this)>=Ye(ow,this)?Ye(ow,this)-1:Ye(Gi,this);Ye(ei,this).col=C+1,s+=Ye(ei,this).TD.offsetWidth}else Ye(ei,this).col=Ye(Gi,this);let v=p,y=s;p+c+h>=a?v=a-c-h:p+h<u+m&&(v=u+m+Math.abs(h)),s>=a-1?y=a-1:y===0?y=1:n.scrollX!==void 0&&Ye(Gi,this)<Ye(mg,this)&&(y-=Ye(Mc,this)<=n.scrollX?Ye(Mc,this):0),Ye(ti,this).setPosition(null,v),Ye(pl,this).setPosition(null,y)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>fl(xu,this,Gue).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>fl(xu,this,Kue).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ye(ti,this).build(),Ye(pl,this).build()}destroy(){Ye(ti,this).destroy(),Ye(pl,this).destroy(),super.destroy()}}function Yue(t,e,r,n){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),u=nt(t.target,"sortAction");if(!a||!s||Ye(Rl,this)||t.button!==0||u){yi(Rl,this,!1),Ye(Ca,this).length=0,tt(this.hot.rootElement,[Z_,$w]);return}const h=Ye(pl,this).isBuilt()&&!Ye(pl,this).isAppended(),c=Ye(ti,this).isBuilt()&&!Ye(ti,this).isAppended();h&&c&&(Ye(pl,this).appendTo(i.hider),Ye(ti,this).appendTo(i.hider));const{from:m,to:p}=a,v=Math.min(m.col,p.col),y=Math.max(m.col,p.col);if(e.row<0&&e.col>=v&&e.col<=y){n.column=!0,yi(Rl,this,!0);const C=r.firstChild?NB(t,r.firstChild).x:t.offsetX;Ye(ei,this).eventPageX=t.pageX,yi(Gi,this,e.col),Ye(ei,this).TD=r,Ye(ei,this).col=e.col,yi(Ca,this,this.prepareColumnsToMoving(v,y)),yi(Vw,this,!!this.hot.getSettings().rowHeaders),yi(ow,this,this.hot.countCols()),yi(mg,this,this.hot.getSettings().fixedColumnsStart),yi(Mc,this,un(this.hot.rootElement).left);const R=Ye(Vw,this)?-1:0,_=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,x=e.col<Ye(mg,this),I=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),k=Math.abs(C-(this.hot.isRtl()?r.offsetWidth:0)),W=this.getColumnsWidth(v,e.col-1)+k,B=this.getColumnsWidth(R,v-1)+(x?I:0)+W;Ye(ti,this).setPosition(_,B),Ye(ti,this).setSize(this.getColumnsWidth(v,y),i.hider.offsetHeight-_),Ye(ti,this).setOffset(null,-W),Re(this.hot.rootElement,Z_)}else tt(this.hot.rootElement,Q_),yi(Rl,this,!1),Ye(Ca,this).length=0}function Gue(t){Ye(Rl,this)&&(Ye(ei,this).eventPageX=t.pageX,this.refreshPositions())}function que(t,e,r,n){!this.hot.getSelectedRangeLast()||!Ye(Rl,this)||(Ye(Ca,this).indexOf(e.col)>-1?tt(this.hot.rootElement,$w):Re(this.hot.rootElement,$w),n.row=!0,n.column=!0,n.cell=!0,yi(Gi,this,e.col),Ye(ei,this).TD=r)}function Kue(){const t=Ye(ei,this).col,e=Ye(Ca,this).length;if(yi(Gi,this,void 0),yi(Rl,this,!1),tt(this.hot.rootElement,[Z_,$w,Q_]),this.hot.selection.isSelectedByColumnHeader()&&Re(this.hot.rootElement,Q_),e<1||t===void 0)return;const r=Ye(Ca,this)[0],n=this.hot.toPhysicalColumn(r),i=this.dragColumns(Ye(Ca,this),t);if(Ye(Ca,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(n),a=s+e-1;this.hot.selectColumns(s,a)}}function Xue(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,n=e+r;Ye(ti,this).setPosition(n),Ye(ti,this).setSize(null,t.hider.offsetHeight-n)}function Zue(){this.moveBySettingsOrLoad()}function Que(t,e){D2(t,e),e.add(t)}function An(t,e,r){D2(t,e),e.set(t,r)}function D2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lr(t,e,r){return t.set(Ms(t,e),r),r}function $e(t,e){return t.get(Ms(t,e))}function Ms(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const zw="manualColumnResize",Jue=130,FL="manualColumnWidths";var ca=new WeakMap,pv=new WeakMap,Ni=new WeakMap,Uw=new WeakMap,xo=new WeakMap,ehe=new WeakMap,jc=new WeakMap,vv=new WeakMap,di=new WeakMap,aa=new WeakMap,nh=new WeakMap,jw=new WeakMap,pg=new WeakMap,vg=new WeakMap,Di=new WeakMap,wg=new WeakMap,lo=new WeakSet;class the extends Pt{static get PLUGIN_KEY(){return zw}static get PLUGIN_PRIORITY(){return Jue}constructor(e){super(e),Que(this,lo),An(this,ca,null),An(this,pv,null),An(this,Ni,[]),An(this,Uw,null),An(this,xo,null),An(this,ehe,null),An(this,jc,null),An(this,vv,null),An(this,di,this.hot.rootDocument.createElement("DIV")),An(this,aa,this.hot.rootDocument.createElement("DIV")),An(this,nh,null),An(this,jw,!1),An(this,pg,0),An(this,vg,null),An(this,Di,void 0),An(this,wg,void 0),Re($e(di,this),"manualColumnResizer"),Re($e(aa,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[zw]}enablePlugin(){var e=this;this.enabled||(Lr(Di,this,new Fl),$e(Di,this).addLocalHook("init",()=>Ms(lo,this,rhe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,$e(Di,this)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ms(lo,e,lhe).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ms(lo,e,uhe).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ms(lo,e,hhe).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Lr(wg,this,$e(Di,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",FL,$e(Di,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",FL,e),e.value}setManualSize(e,r){const n=Math.max(r,20),i=this.hot.toPhysicalColumn(e);return $e(Di,this).setValueAtIndex(i,n),n}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);$e(Di,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;Lr(ca,this,e);const{_wt:r}=this.hot.view,n=r.wtTable.getCoords($e(ca,this)),i=n.col;if(i<0)return;const s=Or($e(ca,this)),a=$e(ca,this).getBoundingClientRect(),u=i<r.getSetting("fixedColumnsStart");let h;u&&(h=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition($e(ca,this),n.row,n.col)),h||(h=r.wtOverlays.topOverlay.getRelativeCellPosition($e(ca,this),n.row,n.col)),Lr(pv,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Lr(Ni,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const m=this.hot.getSelectedRange();te(m,p=>{const v=p.getTopStartCorner().col,y=p.getBottomEndCorner().col;Xe(v,y,C=>{$e(Ni,this).includes(C)||$e(Ni,this).push(C)})})}$e(Ni,this).includes($e(pv,this))||Lr(Ni,this,[$e(pv,this)]),Lr(vv,this,h.start-6),Lr(jc,this,parseInt(a.width,10)),$e(di,this).style.top=`${h.top}px`,$e(di,this).style[this.inlineDir]=`${$e(vv,this)+$e(jc,this)}px`,$e(di,this).style.height=`${s}px`,this.hot.rootElement.appendChild($e(di,this))}refreshHandlePosition(){$e(di,this).style[this.inlineDir]=`${$e(vv,this)+$e(Uw,this)}px`}setupGuidePosition(){const e=parseInt(Or($e(di,this)),10),r=parseInt($e(di,this).style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Re($e(di,this),"active"),Re($e(aa,this),"active"),$e(aa,this).style.top=`${r}px`,this.refreshGuidePosition(),$e(aa,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild($e(aa,this))}refreshGuidePosition(){$e(aa,this).style[this.inlineDir]=$e(di,this).style[this.inlineDir]}hideHandleAndGuide(){tt($e(di,this),"active"),tt($e(aa,this),"active")}checkIfColumnHeader(e){const r=Ol(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeColumnResize",$e(xo,this),n,!0);s!==void 0&&Lr(xo,this,s),this.setManualSize(n,$e(xo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",$e(xo,this),n,!0),i&&e()};$e(pg,this)>=2&&($e(Ni,this).length>1?(te($e(Ni,this),i=>{r(i)}),e()):te($e(Ni,this),i=>{r(i,!0)})),Lr(pg,this,0),Lr(vg,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",n=>Ms(lo,this,nhe).call(this,n)),this.eventManager.addEventListener(r,"mousedown",n=>Ms(lo,this,ihe).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>Ms(lo,this,she).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ms(lo,this,ohe).call(this)),this.eventManager.addEventListener($e(di,this),"contextmenu",()=>Ms(lo,this,ahe).call(this))}destroy(){super.destroy()}}function rhe(){const t=this.hot.getSettings()[zw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,n)=>{$e(Di,this).setValueAtIndex(n,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,n)=>{$e(Di,this).setValueAtIndex(n,r)})},!0),Lr(wg,this,t)):t===!0&&Array.isArray($e(wg,this))&&this.hot.batchExecution(()=>{$e(wg,this).forEach((r,n)=>{$e(Di,this).setValueAtIndex(n,r)})},!0)}function nhe(t){if(!ZT(t.target)&&$e(jw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&($e(nh,this)||this.setupHandlePosition(e))}}function ihe(t){t.target.parentNode===this.hot.rootElement&&nt(t.target,"manualColumnResizer")&&(this.setupHandlePosition($e(ca,this)),this.setupGuidePosition(),Lr(nh,this,!0),$e(vg,this)===null&&(Lr(vg,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout($e(vg,this))),Lr(pg,this,$e(pg,this)+1),this.startX=t.pageX,Lr(xo,this,$e(jc,this)))}function she(t){if($e(nh,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Lr(Uw,this,$e(jc,this)+e),te($e(Ni,this),r=>{Lr(xo,this,this.setManualSize(r,$e(Uw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function ohe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeColumnResize",$e(xo,this),r,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",$e(xo,this),r,!1)};$e(nh,this)&&(this.hideHandleAndGuide(),Lr(nh,this,!1),$e(xo,this)!==$e(jc,this)&&($e(Ni,this).length>1?(te($e(Ni,this),n=>{e(n)}),t()):te($e(Ni,this),n=>{e(n,!0)})),this.setupHandlePosition($e(ca,this)))}function ahe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild($e(di,this)),this.hot.rootElement.removeChild($e(aa,this)),Lr(nh,this,!1),Lr(jw,this,!0),this.hot._registerImmediate(()=>{Lr(jw,this,!1)})}function lhe(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalColumn(e),i=$e(Di,this).getValueAtIndex(n);this.hot.getSettings()[zw]&&i&&(r=i)}return r}function uhe(t,e){const r=$e(Di,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof r=="number"?r:t}function hhe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function CE(t,e,r){return(e=che(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function che(t){var e=dhe(t,"string");return typeof e=="symbol"?e:e+""}function dhe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bE=0,WL=1,BL=2,pc="px";let L2=class{constructor(e){CE(this,"hot",void 0),CE(this,"_element",null),CE(this,"state",bE),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=BL}build(){this.state===bE&&(this._element=this.hot.rootDocument.createElement("div"),this.state=WL)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=bE}isAppended(){return this.state===BL}isBuilt(){return this.state>=WL}setPosition(e,r){e!==void 0&&(this._element.style.top=e+pc),r!==void 0&&(this._element.style.left=r+pc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+pc),r&&(this._element.style.height=r+pc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+pc),r&&(this._element.style.marginLeft=r+pc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const fhe="ht__manualRowMove--backlight";class ghe extends L2{build(){super.build(),Re(this._element,fhe)}}const mhe="ht__manualRowMove--guideline";class phe extends L2{build(){super.build(),Re(this._element,mhe)}}function vhe(t,e){F2(t,e),e.add(t)}function vc(t,e,r){F2(t,e),e.set(t,r)}function F2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qu(t,e,r){return t.set(gl(t,e),r),r}function ut(t,e){return t.get(gl(t,e))}function gl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("beforeRowMove");ze.getSingleton().register("afterRowMove");const SE="manualRowMove",whe=140,$L="ht__manualRowMove",Yw="show-ui",J_="on-moving--rows",eT="after-selection--rows";var ri=new WeakMap,vl=new WeakMap,ba=new WeakMap,El=new WeakMap,Ci=new WeakMap,wv=new WeakMap,Mu=new WeakSet;class yhe extends Pt{constructor(){super(...arguments),vhe(this,Mu),vc(this,ri,new ghe(this.hot)),vc(this,vl,new phe(this.hot)),vc(this,ba,[]),vc(this,El,void 0),vc(this,Ci,{}),vc(this,wv,void 0)}static get PLUGIN_KEY(){return SE}static get PLUGIN_PRIORITY(){return whe}isEnabled(){return!!this.hot.getSettings()[SE]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return gl(Mu,e,Che).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return gl(Mu,e,She).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>gl(Mu,this,Ehe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return gl(Mu,e,_he).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),Re(this.hot.rootElement,$L),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){tt(this.hot.rootElement,$L),this.unregisterEvents(),ut(ri,this).destroy(),ut(vl,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const n=ut(wv,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeRowMove",e,r,n,i);if(qu(wv,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,r);const a=i&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,n,i,a),a}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const n=this.countFinalIndex(e,r);return qu(wv,this,r),this.moveRows(e,n)}isMovePossible(e,r){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,a=e.some(h=>h<0),u=e.some(h=>h>=n);return!(i||s||a||u)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Gr(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getRowsHeight(e,r){const n=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=r;s++){const a=n.getRenderableFromVisualIndex(s);a!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(a)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[SE];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:n,to:i}=e,s=Math.min(n.row,i.row),a=Math.max(n.row,i.row);return Xe(s,a,u=>{r.push(u)}),r}refreshPositions(){const e=ut(Ci,this).coords,r=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,a=ut(Ci,this).TD,u=this.hot.rootElement,h=un(u),c=Qu(u),m=s.holder.scrollTop,p=this.hot.rootWindow!==c?c.scrollTop:0,v=h.top-p,y=ut(Ci,this).eventPageY-v+m,C=s.hider.offsetHeight,R=s.TBODY.offsetTop,_=ut(ri,this).getOffset().top,x=ut(ri,this).getSize().height,I=a.offsetHeight/2,k=a.offsetHeight;let W=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const B=y>=W+I;this.isFixedRowTop(e.row)&&(W+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?ut(Ci,this).row=r>0?r-1:r:B?(ut(Ci,this).row=e.row+1,W+=e.row===0?k-1:k):ut(Ci,this).row=e.row;let z=y,U=W;y+x+_>=C?z=C-x-_:y+_<R&&(z=R+Math.abs(_)),W>=C-1&&(U=C-1),ut(ri,this).setPosition(z),ut(vl,this).setPosition(U)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>gl(Mu,this,bhe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>gl(Mu,this,Rhe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ut(ri,this).build(),ut(vl,this).build()}destroy(){ut(ri,this).destroy(),ut(vl,this).destroy(),super.destroy()}}function Che(t,e,r,n){const{wtTable:i,wtViewport:s}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),u=this.hot.getSelectedRangeLast();if(!u||!a||ut(El,this)||t.button!==0){qu(El,this,!1),ut(ba,this).length=0,tt(this.hot.rootElement,[J_,Yw]);return}const h=ut(vl,this).isBuilt()&&!ut(vl,this).isAppended(),c=ut(ri,this).isBuilt()&&!ut(ri,this).isAppended();h&&c&&(ut(vl,this).appendTo(i.hider),ut(ri,this).appendTo(i.hider));const{from:m,to:p}=u,v=Math.min(m.row,p.row),y=Math.max(m.row,p.row);if(e.col<0&&e.row>=v&&e.row<=y){n.row=!0,qu(El,this,!0),ut(Ci,this).eventPageY=t.pageY,ut(Ci,this).coords=e,ut(Ci,this).TD=r,qu(ba,this,this.prepareRowsToMoving());const C=i.holder.scrollLeft+s.getRowHeaderWidth(),R=this.getRowsHeight(v,e.row-1)+t.offsetY;ut(ri,this).setPosition(null,C),ut(ri,this).setSize(i.hider.offsetWidth-C,this.getRowsHeight(v,y)),ut(ri,this).setOffset(-R,null),Re(this.hot.rootElement,J_),this.refreshPositions()}else tt(this.hot.rootElement,eT),qu(El,this,!1),ut(ba,this).length=0}function bhe(t){ut(El,this)&&(ut(Ci,this).eventPageY=t.pageY,this.refreshPositions())}function She(t,e,r,n){!this.hot.getSelectedRangeLast()||!ut(El,this)||(ut(ba,this).indexOf(e.row)>-1?tt(this.hot.rootElement,Yw):Re(this.hot.rootElement,Yw),n.row=!0,n.column=!0,n.cell=!0,ut(Ci,this).coords=e,ut(Ci,this).TD=r)}function Rhe(){const t=ut(Ci,this).row,e=ut(ba,this).length;if(qu(El,this,!1),tt(this.hot.rootElement,[J_,Yw,eT]),this.hot.selection.isSelectedByRowHeader()&&Re(this.hot.rootElement,eT),e<1||t===void 0)return;const r=ut(ba,this)[0],n=this.hot.toPhysicalRow(r),i=this.dragRows(ut(ba,this),t);if(ut(ba,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(n),a=s+e-1;this.hot.selectRows(s,a)}}function Ehe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,n=e+r;ut(ri,this).setPosition(null,n),ut(ri,this).setSize(t.hider.offsetWidth-n)}function _he(){this.moveBySettingsOrLoad()}function The(t,e){W2(t,e),e.add(t)}function Hn(t,e,r){W2(t,e),e.set(t,r)}function W2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _r(t,e,r){return t.set(da(t,e),r),r}function We(t,e){return t.get(da(t,e))}function da(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Gw="manualRowResize",xhe=30,VL="manualRowHeights";var Co=new WeakMap,yv=new WeakMap,ki=new WeakMap,yg=new WeakMap,wl=new WeakMap,YM=new WeakMap,Yc=new WeakMap,Cv=new WeakMap,Qn=new WeakMap,vo=new WeakMap,ih=new WeakMap,qw=new WeakMap,Cg=new WeakMap,bg=new WeakMap,Ps=new WeakMap,Sg=new WeakMap,il=new WeakSet;class Mhe extends Pt{static get PLUGIN_KEY(){return Gw}static get PLUGIN_PRIORITY(){return xhe}constructor(e){super(e),The(this,il),Hn(this,Co,null),Hn(this,yv,null),Hn(this,ki,[]),Hn(this,yg,null),Hn(this,wl,null),Hn(this,YM,null),Hn(this,Yc,null),Hn(this,Cv,null),Hn(this,Qn,this.hot.rootDocument.createElement("DIV")),Hn(this,vo,this.hot.rootDocument.createElement("DIV")),Hn(this,ih,!1),Hn(this,qw,!1),Hn(this,Cg,0),Hn(this,bg,null),Hn(this,Ps,void 0),Hn(this,Sg,void 0),Re(We(Qn,this),"manualRowResizer"),Re(We(vo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Gw]}enablePlugin(){this.enabled||(_r(Ps,this,new Fl),We(Ps,this).addLocalHook("init",()=>da(il,this,khe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,We(Ps,this)),this.addHook("modifyRowHeight",(e,r)=>da(il,this,Nhe).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_r(Sg,this,We(Ps,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",VL,We(Ps,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",VL,e),e.value}setManualSize(e,r){const n=this.hot.toPhysicalRow(e),i=Math.max(r,this.hot.view.getDefaultRowHeight());return We(Ps,this).setValueAtIndex(n,i),i}getLastDesiredRowHeight(){return We(yg,this)}setupHandlePosition(e){_r(Co,this,e);const{view:r}=this.hot,{_wt:n}=r,i=n.wtTable.getCoords(We(Co,this)),s=i.row;if(s<0)return;const a=Fr(We(Co,this)),u=We(Co,this).getBoundingClientRect(),h=s<n.getSetting("fixedRowsTop"),c=s>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let m;h?m=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(We(Co,this),i.row,i.col):c&&(m=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(We(Co,this),i.row,i.col)),m||(m=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(We(Co,this),i.row,i.col)),_r(yv,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),_r(ki,this,[]);const p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&p){const v=this.hot.getSelectedRange();te(v,y=>{const C=y.getTopStartCorner().row,R=y.getBottomStartCorner().row;Xe(C,R,_=>{We(ki,this).includes(_)||We(ki,this).push(_)})})}We(ki,this).includes(We(yv,this))||_r(ki,this,[We(yv,this)]),_r(Cv,this,m.top-6),_r(Yc,this,parseInt(u.height,10)),We(Qn,this).style.top=`${We(Cv,this)+We(Yc,this)}px`,We(Qn,this).style[this.inlineDir]=`${m.start}px`,We(Qn,this).style.width=`${a}px`,this.hot.rootElement.appendChild(We(Qn,this))}refreshHandlePosition(){We(Qn,this).style.top=`${We(Cv,this)+We(yg,this)}px`}setupGuidePosition(){const e=parseInt(Fr(We(Qn,this)),10),r=parseInt(We(Qn,this).style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Re(We(Qn,this),"active"),Re(We(vo,this),"active"),We(vo,this).style.top=We(Qn,this).style.top,We(vo,this).style[this.inlineDir]=`${r}px`,We(vo,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(We(vo,this))}refreshGuidePosition(){We(vo,this).style.top=We(Qn,this).style.top}hideHandleAndGuide(){tt(We(Qn,this),"active"),tt(We(vo,this),"active")}checkIfRowHeader(e){const r=Ol(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&We(wl,this)<r?r:We(wl,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);s!==void 0&&_r(wl,this,s),this.setManualSize(n,We(wl,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),i&&e()};We(Cg,this)>=2&&(We(ki,this).length>1?(te(We(ki,this),i=>{r(i)}),e()):te(We(ki,this),i=>{r(i,!0)})),_r(Cg,this,0),_r(bg,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>da(il,this,Ihe).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>da(il,this,Ohe).call(this,n)),this.eventManager.addEventListener(r,"mousemove",n=>da(il,this,Phe).call(this,n)),this.eventManager.addEventListener(r,"mouseup",()=>da(il,this,Ahe).call(this)),this.eventManager.addEventListener(We(Qn,this),"contextmenu",()=>da(il,this,Hhe).call(this))}destroy(){super.destroy()}}function Ihe(t){if(!ZT(t.target)&&We(qw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(We(ih,this)||this.setupHandlePosition(e))}}function Ohe(t){nt(t.target,"manualRowResizer")&&(this.setupHandlePosition(We(Co,this)),this.setupGuidePosition(),_r(ih,this,!0),We(bg,this)===null&&(_r(bg,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(We(bg,this))),_r(Cg,this,We(Cg,this)+1),_r(YM,this,t.pageY),_r(wl,this,We(Yc,this)))}function Phe(t){We(ih,this)&&(_r(yg,this,We(Yc,this)+(t.pageY-We(YM,this))),te(We(ki,this),e=>{_r(wl,this,this.setManualSize(e,We(yg,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Ahe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};We(ih,this)&&(this.hideHandleAndGuide(),_r(ih,this,!1),We(wl,this)!==We(Yc,this)&&(We(ki,this).length>1?(te(We(ki,this),n=>{e(n)}),t()):te(We(ki,this),n=>{e(n,!0)})),this.setupHandlePosition(We(Co,this)))}function Hhe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(We(Qn,this)),this.hot.rootElement.removeChild(We(vo,this)),_r(ih,this,!1),_r(qw,this,!0),this.hot._registerImmediate(()=>{_r(qw,this,!1)})}function Nhe(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalRow(e),i=We(Ps,this).getValueAtIndex(n);this.hot.getSettings()[Gw]&&i&&(r=i)}return r}function khe(){const t=this.hot.getSettings()[Gw],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,n)=>{We(Ps,this).setValueAtIndex(n,r)}):Array.isArray(t)?(t.forEach((r,n)=>{We(Ps,this).setValueAtIndex(n,r)}),_r(Sg,this,t)):t===!0&&Array.isArray(We(Sg,this))&&We(Sg,this).forEach((r,n)=>{We(Ps,this).setValueAtIndex(n,r)})},!0)}var zL={},UL;function Dhe(){if(UL)return zL;UL=1;var t=Hy();return t("flatMap"),zL}Dhe();var jL={},YL={},RE,GL;function Lhe(){if(GL)return RE;GL=1;var t=Vn(),e=Jr(),r=Ho(),n=pT();return RE=function(i,s){(!s||typeof i!="string")&&e(i);var a=n(i);return r(e(a!==void 0?t(a,i):i))},RE}var qL;function Fhe(){if(qL)return YL;qL=1;var t=sr(),e=Vn(),r=Si(),n=Jr(),i=Ho(),s=Lhe(),a=mT(),u=nd(),h=kl(),c=a(function(){for(var m=this.iterator,p=this.mapper,v,y;;){if(y=this.inner)try{if(v=n(e(y.next,y.iterator)),!v.done)return v.value;this.inner=null}catch(C){u(m,"throw",C)}if(v=n(e(this.next,m)),this.done=!!v.done)return;try{this.inner=s(p(v.value,this.counter++),!1)}catch(C){u(m,"throw",C)}}});return t({target:"Iterator",proto:!0,real:!0,forced:h},{flatMap:function(p){return n(this),r(p),new c(i(this),{mapper:p,inner:null})}}),YL}var KL;function Whe(){return KL||(KL=1,Fhe()),jL}Whe();function Bhe(t,e,r){$he(t,e),e.set(t,r)}function $he(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iu(t,e,r){return(e=Vhe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vhe(t){var e=zhe(t,"string");return typeof e=="symbol"?e:e+""}function zhe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XL(t,e){return t.get(B2(t,e))}function bv(t,e,r){return t.set(B2(t,e),r),r}function B2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ou=new WeakMap;class bo{constructor(e,r,n,i,s,a){Iu(this,"row",void 0),Iu(this,"col",void 0),Iu(this,"rowspan",void 0),Iu(this,"colspan",void 0),Iu(this,"removed",!1),Iu(this,"cellCoordsFactory",void 0),Iu(this,"cellRangeFactory",void 0),Bhe(this,Ou,null),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return Gt`The merged cell declared with {row: ${r}, col: ${n},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:n}=e;return Gt`The merged cell declared at [${r}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:n}=e;return Gt`The merged cell declared at [${r}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:n}=e;return Gt`The merged cell declared at [${r}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return r<0||n<0||i<0||s<0}static isSingleCell(e){let{rowspan:r,colspan:n}=e;return n===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:n}=e;return n===0||r===0}static isOutOfBounds(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),bv(Ou,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const n=e[0]||e[1],i=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",u=Math.min(r,i),h=Math.max(r,i),c=this[a],m=this[a]+this[s]-1;if(c>=r&&(this[a]+=n),n>0)r<=m&&r>c&&(this[s]+=n);else if(n<0){if(u<=c&&h>=m)return this.removed=!0,bv(Ou,this,null),!1;if(c>=u&&c<=h){const p=h-c+1,v=Math.abs(n)-p;this[a]-=v+n,this[s]-=p}else if(c<=u&&m>=h)this[s]+=n;else if(c<=u&&m>=u&&m<h){const p=m-u+1;this[s]-=p}}return bv(Ou,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return XL(Ou,this)||bv(Ou,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),XL(Ou,this)}}function Uhe(t,e){jhe(t,e),e.add(t)}function jhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sv(t,e,r){return(e=Yhe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yhe(t){var e=Ghe(t,"string");return typeof e=="symbol"?e:e+""}function Ghe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var sl=new WeakSet;class Kw{constructor(e){Uhe(this,sl),Sv(this,"plugin",void 0),Sv(this,"mergedCells",[]),Sv(this,"mergedCellsMatrix",new Map),Sv(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:n}=e;return Gt`The merged cell declared at [${r}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(r))!==null&&n!==void 0?n:!1}getByRange(e){let r=!1;return te(this.mergedCells,n=>n.row<=e.from.row&&n.row+n.rowspan-1>=e.to.row&&n.col<=e.from.col&&n.col+n.colspan-1>=e.to.col?(r=n,r):!0),r}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:a,colspan:u,rowspan:h}=i;for(let c=s;c<s+h;c++)for(let m=a;m<a+u;m++)r.add(`r${c},c${m}`)}),e.filter(i=>{const{row:s,col:a,colspan:u,rowspan:h}=i,c=new Set;let m=!1;for(let p=s;p<s+h;p++){for(let v=a;v<a+u;v++){const y=`r${p},c${v}`;if(r.has(y)){Vt(Kw.IS_OVERLAPPING_WARNING(i)),m=!0;break}c.add(y)}if(m)break}return m||r.add(...c),!m})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:a}=e.getBottomEndCorner(),u=[];for(let h=n;h<=s;h++)for(let c=i;c<=a;c++){const m=this.get(h,c);m&&(r||!r&&m.row===h&&m.col===c)&&u.push(m)}return u}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,i=e.col,s=e.rowspan,a=e.colspan,u=new bo(n,i,s,a,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(n,i),c=r?!1:this.isOverlapping(u);return!h&&!c?(this.hot&&u.normalize(this.hot),this.mergedCells.push(u),Pu(sl,this,ZL).call(this,u),u):(Vt(Kw.IS_OVERLAPPING_WARNING(u)),!1)}remove(e,r){const n=this.get(e,r),i=n?this.mergedCells.indexOf(n):-1;return n&&i!==-1?(this.mergedCells.splice(i,1),Pu(sl,this,qhe).call(this,n),n):!1}clear(){te(this.mergedCells,e=>{let{row:r,col:n,rowspan:i,colspan:s}=e;Xe(r,r+i,a=>{Xe(n,n+s,u=>{const h=this.hot.getCell(a,u);h&&(h.removeAttribute("rowspan"),h.removeAttribute("colspan"),h.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const n=this.get(e,r);if(!n)return!1;const{row:i,col:s,rowspan:a,colspan:u}=n,h=this.hot.view.getActiveOverlayName(),c=["top","top_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleRow(),m=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleColumn(),p=_t(c,i,i+a-1),v=_t(m,s,s+u-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(p,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(v,1)===r}getFirstRenderableCoords(e,r){const n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,r){const n=Pu(sl,this,Rv).call(this,e,"col",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getEndMostColumnIndex(e,r){const n=Pu(sl,this,Rv).call(this,e,"col",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}getTopMostRowIndex(e,r){const n=Pu(sl,this,Rv).call(this,e,"row",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getBottomMostRowIndex(e,r){const n=Pu(sl,this,Rv).call(this,e,"row",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}shiftCollections(e,r,n){const i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}const s=[];this.mergedCells.forEach(a=>{a.shift(i,r),a.removed&&s.push(a)}),s.forEach(a=>{this.mergedCells.splice(this.mergedCells.indexOf(a),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(a=>{Pu(sl,this,ZL).call(this,a)})}}function Rv(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,i=r===1?t.getTopStartCorner():t.getBottomEndCorner(),s=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let a=i.row;r===1?a<=s.row:a>=s.row;a+=r)for(let u=i.col;r===1?u<=s.col:u>=s.col;u+=r){const h=e==="row"?a:u,c=this.get(a,u);let m=h;c&&(m=r===1?c[e]+c[`${e}span`]-1:c[e]),n.has(h)||n.set(h,new Set),n.get(h).add(m)}return Array.from(new Set(Array.from(n.entries()).filter(a=>{let[,u]=a;return u.size===1}).flatMap(a=>{let[,u]=a;return Array.from(u)})))}function ZL(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function qhe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function EE(t,e,r){return(e=Khe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Khe(t){var e=Xhe(t,"string");return typeof e=="symbol"?e:e+""}function Xhe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zhe{constructor(e){EE(this,"plugin",void 0),EE(this,"mergedCellsCollection",void 0),EE(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const r=this.mergedCellsCollection.get(e[0],e[1]);r&&(e[2]=e[0]+r.rowspan-1,e[3]=e[1]+r.colspan-1)}}getDirection(e,r){let n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}snapDragArea(e,r,n,i){const s=r.slice(0),a=this.getAutofillSize(e,r,n),[u,h,c,m]=e,v=["up","down"].indexOf(n)>-1?c-u+1:m-h+1,y=Math.floor(a/v)*v,C=a-y,R=this.getFarthestCollection(e,r,n,i);if(R){if(n==="down"){const _=R.row+R.rowspan-u-C;s[2]+_>=this.plugin.hot.countRows()?s[2]-=C:s[2]+=C?_:0}else if(n==="right"){const _=R.col+R.colspan-h-C;s[3]+_>=this.plugin.hot.countCols()?s[3]-=C:s[3]+=C?_:0}else if(n==="up"){const _=c-C-R.row+1;s[0]+_<0?s[0]+=C:s[0]-=C?_:0}else if(n==="left"){const _=m-C-R.col+1;s[1]+_<0?s[1]+=C:s[1]-=C?_:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:i,fillSize:a,dragArea:s,cycleLength:v}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),jr(this.currentFillData,e)}getAutofillSize(e,r,n){const[i,s,a,u]=e,[h,c,m,p]=r;switch(n){case"up":return i-h;case"down":return m-a;case"left":return s-c;case"right":return p-u;default:return null}}getDragArea(e,r,n){const[i,s,a,u]=e,[h,c,m,p]=r;switch(n){case"up":return[h,c,i-1,u];case"down":return[a+1,s,m,u];case"left":return[h,c,a,s-1];case"right":return[i,u+1,m,p];default:return null}}getFarthestCollection(e,r,n,i){const[s,a,u,h]=e,c=["up","down"].indexOf(n)>-1,m=c?u:h,p=c?s:a,v=this.getAutofillSize(e,r,n),y=c?u-s+1:h-a+1,C=Math.floor(v/y)*y,R=v-C;let _=null,x=null,I=null;switch(n){case"up":_="includesVertically",I=m-R+1;break;case"left":_="includesHorizontally",I=m-R+1;break;case"down":_="includesVertically",I=p+R-1;break;case"right":_="includesHorizontally",I=p+R-1;break}return te(i,k=>{k[_](I)&&k.isFarther(x,n)&&(x=k)}),x}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(c,m)=>{switch(i){case"up":return c.row-m>=r.from.row;case"down":return c.row+c.rowspan-1+m<=r.to.row;case"left":return c.col-m>=r.from.column;case"right":return c.col+c.colspan-1+m<=r.to.column;default:return null}};let a=0,u=null,h=1;do for(let c=0;c<n.length;c+=1){if(u=n[c],a=h*this.currentFillData.cycleLength,s(u,a))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:u.row-a,rowspan:u.rowspan,col:u.col,colspan:u.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:u.row+a,rowspan:u.rowspan,col:u.col,colspan:u.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:u.row,rowspan:u.rowspan,col:u.col-a,colspan:u.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:u.row,rowspan:u.rowspan,col:u.col+a,colspan:u.colspan});break}c===n.length-1&&(h+=1)}while(s(u,a));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return te(e,i=>{const s=i[0],a=this.plugin.hot.propToCol(i[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(n.min===null||a<n.min)&&(n.min=a),(n.max===null||a>n.max)&&(n.max=a)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,r,n){const i=this.getDragArea(e,r,n),[s,a,u,h]=i,c=this.plugin.hot._createCellCoords(s,a),m=this.plugin.hot._createCellCoords(u,h),p=this.plugin.hot._createCellRange(c,c,m);return this.mergedCellsCollection.getWithinRange(p,!0).length>0}}function _E(t,e,r){return(e=Qhe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qhe(t){var e=Jhe(t,"string");return typeof e=="symbol"?e:e+""}function Jhe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ece{constructor(e){_E(this,"plugin",void 0),_E(this,"hot",void 0),_E(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,n,i){const s=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),u=Math.max(n[0],n[2]),h=Math.max(n[1],n[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const m=this.plugin.mergedCellsCollection.get(e,r);if(!m)return;const p=m.getLastRow(),v=m.getLastColumn();if(s<=m.row&&a<=m.col&&u>=p&&h>=v)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(m,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const n=[];if(!r||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)n.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<n.length;i+=1){const s=[];for(let a=0;a<r.length;a+=1)s[a]=r[a].includes(n[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function tce(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(rx)}return this.getTranslatedPhrase(tx)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return e?bo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Rg(t,e,r){return(e=rce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rce(t){var e=nce(t,"string");return typeof e=="symbol"?e:e+""}function nce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QL{constructor(e){Rg(this,"data",void 0),Rg(this,"next",null),Rg(this,"prev",null),this.data=e}}class Ev{constructor(){Rg(this,"first",null),Rg(this,"last",null)}push(e){const r=new QL(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.last;this.last=r,r.prev=n,n.next=r}return r}unshift(e){const r=new QL(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.first;this.first=r,r.next=n,n.prev=r}}inorder(e){let r=this.first;for(;r;){const n=e(r);if(r===this.last||n===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,n,i;for(;r;){if(r.data===e)return n=r.next,i=r.prev,n&&(n.prev=i),i&&(i.next=n),r===this.first&&(this.first=n),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,i){i&&(e(i,i.next),i.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,n;for(;e;)n=e.next,e.next=r,r.prev=e,r=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=r,this.last=n}}function ice(t,e){$2(t,e),e.add(t)}function Au(t,e,r){$2(t,e),e.set(t,r)}function $2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e){return t.get(Xw(t,e))}function Mi(t,e,r){return t.set(Xw(t,e),r),r}function Xw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var uo=new WeakMap,ho=new WeakMap,co=new WeakMap,fo=new WeakMap,tT=new WeakMap,_v=new WeakMap,Tv=new WeakMap,TE=new WeakSet;class sce{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:n,columnIndexMapper:i}=e;ice(this,TE),Au(this,uo,new Ev),Au(this,ho,new Ev),Au(this,co,null),Au(this,fo,null),Au(this,tT,null),Au(this,_v,null),Au(this,Tv,null),Mi(tT,this,r),Mi(_v,this,n),Mi(Tv,this,i)}getCurrentVerticalNode(){return Bt(fo,this).data}getFirstVerticalNode(){return Bt(ho,this).first.data}getNextVerticalNode(){return Bt(fo,this).next.data}getPrevVerticalNode(){return Bt(fo,this).prev.data}getCurrentHorizontalNode(){return Bt(co,this).data}getFirstHorizontalNode(){return Bt(uo,this).first.data}getNextHorizontalNode(){return Bt(co,this).next.data}getPrevHorizontalNode(){return Bt(co,this).prev.data}setPrevNodeAsActive(){Mi(fo,this,Bt(fo,this).prev),Mi(co,this,Bt(co,this).prev)}setNextNodeAsActive(){Mi(fo,this,Bt(fo,this).next),Mi(co,this,Bt(co,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),n=e.getBottomEndCorner(),i=new WeakSet;Mi(uo,this,new Ev);for(let a=r.row;a<=n.row;a++)if(!Bt(_v,this).isHidden(a))for(let u=r.col;u<=n.col;u++){if(Bt(Tv,this).isHidden(u))continue;const h=Xw(TE,this,JL).call(this,e,Bt(uo,this),i,a,u);h&&Mi(co,this,h)}Bt(uo,this).first&&(Bt(uo,this).first.prev=Bt(uo,this).last,Bt(uo,this).last.next=Bt(uo,this).first);const s=new WeakSet;Mi(ho,this,new Ev);for(let a=r.col;a<=n.col;a++)if(!Bt(Tv,this).isHidden(a))for(let u=r.row;u<=n.row;u++){if(Bt(_v,this).isHidden(u))continue;const h=Xw(TE,this,JL).call(this,e,Bt(ho,this),s,u,a);h&&Mi(fo,this,h)}Bt(ho,this).first&&(Bt(ho,this).first.prev=Bt(ho,this).last,Bt(ho,this).last.next=Bt(ho,this).first)}setActiveNode(e,r){return Bt(uo,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:a,colEnd:u}=n.data;if(e>=i&&e<=s&&r>=a&&r<=u)return Mi(co,this,n),!1}),Bt(ho,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:a,colEnd:u}=n.data;if(e>=i&&e<=s&&r>=a&&r<=u)return Mi(fo,this,n),!1}),this}}function JL(t,e,r,n,i){const s=t.getTopStartCorner(),a=t.getBottomEndCorner(),u=t.highlight.clone().normalize(),h=Bt(tT,this).call(this,n,i);if(h&&r.has(h))return null;const c={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(h){if(r.add(h),h.row<s.row||h.row+h.rowspan-1>a.row||h.col<s.col||h.col+h.colspan-1>a.col)return null;c.colStart=h.col,c.colEnd=h.col+h.colspan-1,c.rowStart=h.row,c.rowEnd=h.row+h.rowspan-1}const m=e.push(c);return n===u.row&&i===u.col||h&&u.row>=h.row&&u.row<=h.row+h.rowspan-1&&u.col>=h.col&&u.col<=h.col+h.colspan-1?m:null}function oce(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:n}=e;function i(){}function s(a,u,h){const c=t.mergedCellsCollection.get(u,h);if(!vt(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="";return}const{row:m,col:p,colspan:v,rowspan:y}=c,[C,R]=t.translateMergedCellToRenderable(m,y,p,v),_=t.getSetting("virtualized"),x=r.getRenderableFromVisualIndex(u),I=n.getRenderableFromVisualIndex(h),k=C-x+1,W=R-I+1;let B=r.getNearestNotHiddenIndex(m,1),z=n.getNearestNotHiddenIndex(p,1);if(_){const se=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(se)||(B=Math.max(B,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(se)||(z=Math.max(z,e.getFirstRenderedVisibleColumn()))}const U=Math.min(y,k),J=Math.min(v,W);B===u&&z===h?(a.setAttribute("rowspan",U),a.setAttribute("colspan",J)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:i,after:s}}function ace(t,e){V2(t,e),e.add(t)}function xv(t,e,r){V2(t,e),e.set(t,r)}function V2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xE(t,e,r){return(e=lce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lce(t){var e=uce(t,"string");return typeof e=="symbol"?e:e+""}function uce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jg(t,e,r){return t.set($t(t,e),r),r}function ir(t,e){return t.get($t(t,e))}function $t(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ze.getSingleton().register("beforeMergeCells");ze.getSingleton().register("afterMergeCells");ze.getSingleton().register("beforeUnmergeCells");ze.getSingleton().register("afterUnmergeCells");const rT="mergeCells",hce=150,eF=rT;var Ji=new WeakMap,es=new WeakMap,Mo=new WeakMap,tF=new WeakMap,Yt=new WeakSet;class cce extends Pt{constructor(){super(...arguments),ace(this,Yt),xE(this,"mergedCellsCollection",null),xE(this,"autofillCalculations",null),xE(this,"selectionCalculations",null),xv(this,Ji,null),xv(this,es,{row:0,col:0}),xv(this,Mo,new sce({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),xv(this,tF,oce(this))}static get PLUGIN_KEY(){return rT}static get PLUGIN_PRIORITY(){return hce}static get DEFAULT_SETTINGS(){return{[cV]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[rT]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Kw(this),this.autofillCalculations=new Zhe(this),this.selectionCalculations=new ece(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,dce).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,gce).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,mce).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,pce).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,vce).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,nF).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,nF).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,yce).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Cce).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,bce).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,rF).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,rF).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,fce).call(e,...n)}),this.addHook("afterRenderer",function(){return ir(tF,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,wce).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Sce).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Rce).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Ece).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,_ce).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Tce).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,xce).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Mce).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Ice).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Oce).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Pce).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Ace).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Hce).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,Nce).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $t(Yt,e,kce).call(e,...n)}),this.addHook("beforeUndoStackChange",(r,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!r1())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:i,rowspan:s}=n;for(let a=i+1;a<i+s;a++)r.push(a)}),r=[...new Set(r)],r.forEach(n=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const a=s.getRow(i);a&&(a.style.background=Og(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{n.style.background=Og(n,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?bo.containsNegativeValues(e)?(Vt(bo.NEGATIVE_VALUES_WARNING(e)),!1):bo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Vt(bo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):bo.isSingleCell(e)?(Vt(bo.IS_SINGLE_CELL(e)),!1):bo.containsZeroSpan(e)?(Vt(bo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),r=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];r.forEach(i=>{const{row:s,col:a,rowspan:u,colspan:h}=i,c=this.hot._createCellCoords(s,a),m=this.hot._createCellCoords(s+u-1,a+h-1),p=this.hot._createCellRange(c,c,m);this.mergeRange(p,!0,!0);for(let v=s;v<s+u;v++)for(let y=a;y<a+h;y++)(v!==s||y!==a)&&n.push([v,y,null])}),n.length!==0&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),a={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},u=[];let h=null;return this.canMergeRange(a,r)?(this.hot.runHooks("beforeMergeCells",e,r),Xe(0,a.rowspan-1,m=>{Xe(0,a.colspan-1,p=>{let v=null;u[m]||(u[m]=[]),m===0&&p===0?v=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+m,a.col+p,"hidden",!0),u[m][p]=v})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,r)?(n?h=[a.row,a.col,u]:this.hot.populateFromArray(a.row,a.col,u,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,r),h):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),te(n,i=>{this.mergedCellsCollection.remove(i.row,i.col),Xe(0,i.rowspan-1,s=>{Xe(0,i.colspan-1,a=>{this.hot.removeCellMeta(i.row+s,i.col+a,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+a,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const r=this.mergedCellsCollection.get(e.from.row,e.from.col);r.row===e.from.row&&r.col===e.from.col&&r.row+r.rowspan-1===e.to.row&&r.col+r.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,n,i){const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(s,s,a))}unmerge(e,r,n,i){const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(s,s,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeLast();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:eF})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eF)}modifyViewportRowStart(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const a=this.mergedCellsCollection.get(i,s);if(vt(a)){const u=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a.row,1));if(u<e.startRow){e.startRow=u,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const a=this.mergedCellsCollection.get(i,s);if(vt(a)){const u=a.row+a.rowspan-1,h=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(u,-1));if(h>e.endRow){e.endRow=h,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const a=this.mergedCellsCollection.get(s,i);if(vt(a)){const u=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a.col,1));if(u<e.startColumn){e.startColumn=u,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const a=this.mergedCellsCollection.get(s,i);if(vt(a)){const u=a.col+a.colspan-1,h=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(u,-1));if(h>e.endColumn){e.endColumn=h,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,n,i){const{rowIndexMapper:s,columnIndexMapper:a}=this.hot;let u,h;r===0?u=s.getNearestNotHiddenIndex(e,1):u=s.getNearestNotHiddenIndex(e+r-1,-1),i===0?h=a.getNearestNotHiddenIndex(n,1):h=a.getNearestNotHiddenIndex(n+i-1,-1);const c=e>=0?s.getRenderableFromVisualIndex(u):e,m=n>=0?a.getRenderableFromVisualIndex(h):n;return[c,m]}}function dce(){this.generateFromSettings(),this.hot.render()}function fce(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),n=r.getTopStartCorner(),i=r.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(n.row===e[s].row&&n.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function gce(t){ir(es,this).row=t.row,ir(es,this).col=t.col}function mce(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;ir(Ji,this)&&(i.getRenderableFromVisualIndex(ir(Ji,this).row)!==null&&(r.row=ir(Ji,this).row),n.getRenderableFromVisualIndex(ir(Ji,this).col)!==null&&(r.col=ir(Ji,this).col),jg(Ji,this,null));const s=this.mergedCellsCollection.get(r.row,r.col);if(!s)return;const a=s.col,u=s.col+s.colspan-1;if(t.col<0){const m=r.col>=a&&r.col<=u?a-1:u,p=n.getNearestNotHiddenIndex(m,-1);p===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(p,r.col)-1,1)}else if(t.col>0){const m=r.col>=a&&r.col<=u?u+1:a,p=n.getNearestNotHiddenIndex(m,1);p===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,p)-1,1)}const h=s.row,c=s.row+s.rowspan-1;if(t.row<0){const m=r.row>=h&&r.row<=c?h-1:c,p=i.getNearestNotHiddenIndex(m,-1);p===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(p,r.row)-1,1)}else if(t.row>0){const m=r.row>=h&&r.row<=c?c+1:h,p=i.getNearestNotHiddenIndex(m,1);p===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,p)-1,1)}}function pce(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:n}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,a=(u,h)=>{r.expand(this.hot._createCellCoords(u,h));for(let c=0;c<this.mergedCellsCollection.mergedCells.length;c+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[c].getRange())};if(t.col<0){let u=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+t.col;a(n.row,u),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(u=r.getTopStartCorner().col);const h=i.getNearestNotHiddenIndex(u,1);h!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1))}else if(t.col>0){let u=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+t.col;a(n.row,u),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(u=r.getBottomEndCorner().col);const h=i.getNearestNotHiddenIndex(u,-1);h!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1))}if(t.row<0){let u=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+t.row;a(u,n.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(u=r.getTopStartCorner().row);const h=s.getNearestNotHiddenIndex(u,1);h!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1))}else if(t.row>0){let u=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+t.row;a(u,n.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(u=r.getBottomStartCorner().row);const h=s.getNearestNotHiddenIndex(u,-1);h!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1))}}function vce(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){jg(Ji,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);jg(Ji,this,e.clone()),r&&e.assign(r)}function rF(t,e,r,n){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:s,col:a,colspan:u,rowspan:h}=i,c=s,m=a,p=s+h-1,v=a+u-1;if(n==="render"&&this.getSetting("virtualized")){const y=this.hot.view.getActiveOverlayName(),C=["top","top_inline_start_corner"].includes(y)?0:this.hot.getFirstRenderedVisibleRow(),R=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(y)?0:this.hot.getFirstRenderedVisibleColumn();return[_t(C,c,p),_t(R,m,v),_t(this.hot.getLastRenderedVisibleRow(),c,p),_t(this.hot.getLastRenderedVisibleColumn(),m,v)]}return[c,m,p,v]}function wce(t){t.items.push({name:"---------"},tce(this))}function nF(){jg(Ji,this,null)}function yce(){if(ir(Ji,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),n=ir(Ji,this).clone().normalize();ir(Mo,this).setActiveNode(n.row,n.col),ir(es,this).row>0||ir(es,this).col>0?ir(Mo,this).setPrevNodeAsActive():(r==="E-W"&&ir(es,this).col<0||e==="S-N"&&ir(es,this).row<0)&&ir(Mo,this).setNextNodeAsActive()}function Cce(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let s=null,a=null;if(ir(es,this).col<0){const{rowEnd:u,colEnd:h}=ir(Mo,this).getPrevHorizontalNode();a=n.getNearestNotHiddenIndex(h,-1),s=i.getNearestNotHiddenIndex(u,-1)}else if(ir(es,this).col>0){const{rowStart:u,colStart:h}=ir(Mo,this).getNextHorizontalNode();a=n.getNearestNotHiddenIndex(h,1),s=i.getNearestNotHiddenIndex(u,1)}else if(ir(es,this).row<0){const{rowEnd:u,colEnd:h}=ir(Mo,this).getPrevVerticalNode();a=n.getNearestNotHiddenIndex(h,-1),s=i.getNearestNotHiddenIndex(u,-1)}else if(ir(es,this).row>0){const{rowStart:u,colStart:h}=ir(Mo,this).getNextVerticalNode();a=n.getNearestNotHiddenIndex(h,1),s=i.getNearestNotHiddenIndex(u,1)}if(s!==null||a!==null){const u=this.hot._createCellCoords(s,a),h=this.mergedCellsCollection.get(u.row,u.col),c=this.hot.selection.highlight.getFocus();t=u.row,e=u.col,h?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(h.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(h.col,1)}):r.highlight.assign(u),c.clear(),c.add(u).commit()}ir(Mo,this).setActiveNode(t,e),jg(es,this,{row:0,col:0})}function bce(){this.hot.getSelectedRangeLast().isHeader()||ir(Mo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Sce(t,e,r){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function Rce(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Ece(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function _ce(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const r=this.autofillCalculations.getDirection(e,t);let n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,r))return n=e,n;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),a=this.hot._createCellRange(i,i,s),u=this.mergedCellsCollection.getWithinRange(a);return u.length===0||(n=this.autofillCalculations.snapDragArea(e,n,r,u)),n}function Tce(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function xce(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Mce(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Ice(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Oce(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Pce(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(r);te(n,i=>{r.getBottomEndCorner().row===i.getLastRow()&&r.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Ace(t,e,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,n)}function Hce(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Nce(t,e,r,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const a=this.hot._createCellCoords(s.row,s.col),u=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(a,a,u))}function kce(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let n,i;if(r==="master")n=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const v=this.hot.view.getOverlayByName(r);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(v.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(v.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return t;const a=this.hot._createCellCoords(e,n),u=this.hot._createCellCoords(e,i),h=this.hot._createCellRange(a,a,u),c=this.mergedCellsCollection.getWithinRange(h,!0),m=c.reduce((v,y)=>{let{rowspan:C}=y;return Math.max(v,C)},1);let p=0;return c.length>1&&c[0].rowspan<m&&(p=m-c[0].rowspan),c.forEach(v=>{var y;let{rowspan:C}=v,R=0;r==="top"||r==="top_inline_start_corner"?R=Math.min(m,this.hot.view.countNotHiddenFixedRowsTop()-e):R=C-p,t=Math.max((y=t)!==null&&y!==void 0?y:0,$t(Yt,this,Dce).call(this,e,R))}),t}function Dce(t,e){const r=this.hot.view.getDefaultRowHeight(),n=this.hot.getPlugin("autoRowSize");let i=0;for(let a=t;a<t+e;a++)if(!this.hot.rowIndexMapper.isHidden(a)){var s;i+=(s=n==null?void 0:n.getRowHeight(a))!==null&&s!==void 0?s:r}return i}function Lce(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function a(u){const h=t[u],c=e[u],m=i[u],p=s[u],v=c.multiColumnSorting,C=(v.compareFunctionFactory?v.compareFunctionFactory:wV(c.type))(h,c,v)(m,p);if(C===Oo){const R=u+1;if(typeof e[R]<"u")return a(R)}return C}(0)}}function iF(){Vt(Gt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const z2="sort";function Fce(t,e,r){const n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${z2}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function Wce(t){const e=t.className.split(" "),r=new RegExp(`^${z2}-[0-9]{1,2}$`);return e.filter(n=>r.test(n))}function Bce(t,e,r){return(e=$ce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $ce(t){var e=Vce(t,"string");return typeof e=="symbol"?e:e+""}function Vce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zw="multiColumnSorting",zce=170,ME="columnSorting",sF=Zw;vV(Zw,Lce);class Uce extends xV{constructor(){super(...arguments),Bce(this,"pluginKey",Zw)}static get PLUGIN_KEY(){return Zw}static get PLUGIN_PRIORITY(){return zce}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ME]&&(iF(),this.hot.getPlugin(ME).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Aw)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:Wl,position:"before",group:sF})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sF)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];super.updateHeaderClasses(e,...n),tt(e,Wce(e)),this.enabled!==!1&&Re(e,Fce(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ME]&&iF(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,r){AM(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,Aw))):this.sort(this.getColumnNextConfig(r.col)))}}function oF(t,e,r){return(e=jce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jce(t){var e=Yce(t,"string");return typeof e=="symbol"?e:e+""}function Yce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gce="multipleSelectionHandles",qce=160;class Kce extends Pt{constructor(){super(...arguments),oF(this,"dragged",[]),oF(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Gce}static get PLUGIN_PRIORITY(){return qce}isEnabled(){return wa()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function n(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",i=>{let s;if(nt(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(nt(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",i=>{if(nt(i.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(nt(i.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",i=>{const{rootDocument:s}=this.hot;let a,u,h,c,m,p;if(e.dragged.length===0)return;const v=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!v||v===e.lastSetCell||((v.nodeName==="TD"||v.nodeName==="TH")&&(a=e.hot.getCoords(v),a.col===-1&&(a.col=0),u=e.hot.getSelectedRangeLast(),h=u.getWidth(),c=u.getHeight(),m=u.getDirection(),h===1&&c===1&&e.hot.selection.setRangeEnd(a),p=e.getCurrentRangeCoords(u,a,e.touchStartRange.direction,m,e.dragged[0]),p.start!==null&&e.hot.selection.setRangeStart(p.start),e.hot.selection.setRangeEnd(p.end),e.lastSetCell=v),i.preventDefault())})}getCurrentRangeCoords(e,r,n,i,s){const a=e.getTopStartCorner(),u=e.getBottomEndCorner(),h=e.getBottomStartCorner(),c=e.getTopEndCorner();let m={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?m={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(h.row,r.col)}:m={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SE-NW":s==="bottom"&&(m={start:this.hot._createCellCoords(u.row,r.col),end:this.hot._createCellCoords(r.row,a.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?m={start:r,end:h}:m.end=r;break;case"NW-SE":s==="top"?m={start:r,end:u}:m.end=r;break;case"SE-NW":s==="top"?m={start:r,end:a}:m.end=r;break;case"SW-NE":s==="top"?m={start:r,end:c}:m.end=r;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?m={start:this.hot._createCellCoords(r.row,a.col),end:this.hot._createCellCoords(h.row,r.col)}:m={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,u.col)};break;case"SW-NE":s==="top"?m={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,u.col)}:m={start:this.hot._createCellCoords(r.row,a.col),end:this.hot._createCellCoords(a.row,r.col)};break;case"SE-NW":s==="bottom"?m={start:this.hot._createCellCoords(r.row,c.col),end:this.hot._createCellCoords(a.row,r.col)}:s==="top"&&(m={start:h,end:r});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(m.end=r);break;case"SE-NW":s==="top"?m.end=r:m={start:r,end:a};break}break}return m}isDragged(){return this.dragged.length>0}}function nT(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:a=!1,isRoot:u=!1,isPlaceholder:h=!1,headerClassNames:c=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:a,isRoot:u,isPlaceholder:h,headerClassNames:c}}function U2(){return{label:"",isPlaceholder:!0}}function Xce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;te(t,i=>{const s=[];let a=0;r.push(s),te(i,u=>{const h=nT();if(vt(u)){const{label:m,colspan:p,headerClassName:v}=u;h.label=Mr(m),typeof p=="number"&&p>1&&(h.colspan=p,h.origColspan=p),typeof v=="string"&&(h.headerClassNames=[...v.split(" ")])}else h.label=Mr(u);a+=h.origColspan;let c=!1;if(a>=e&&(h.colspan=h.origColspan-(a-e),h.origColspan=h.colspan,c=!0),s.push(h),h.colspan>1)for(let m=0;m<h.colspan-1;m++)s.push(U2());return!c})});const n=Math.max(...St(r,i=>i.length));return te(r,i=>{if(i.length<n){const s=St(new Array(n-i.length),()=>nT());i.splice(i.length,0,...s)}}),r}function IE(t,e,r){Zce(t,e),e.set(t,r)}function Zce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bs(t,e){return t.get(j2(t,e))}function $f(t,e,r){return t.set(j2(t,e),r),r}function j2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const aF=["label","collapsible"];var na=new WeakMap,Hu=new WeakMap,OE=new WeakMap;class Qce{constructor(){IE(this,na,[]),IE(this,Hu,0),IE(this,OE,1/0)}setColumnsLimit(e){$f(OE,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];$f(na,this,Xce(e,bs(OE,this))),$f(Hu,this,bs(na,this).length)}getData(){return bs(na,this)}mergeWith(e){te(e,r=>{let{row:n,col:i,...s}=r;const a=this.getHeaderSettings(n,i);a!==null&&jr(a,s,aF)})}map(e){te(bs(na,this),r=>{te(r,n=>{const i=e({...n});vt(i)&&jr(n,i,aF)})})}getHeaderSettings(e,r){var n;if(e>=bs(Hu,this)||e<0)return null;const i=bs(na,this)[e];return Array.isArray(i)===!1||r>=i.length?null:(n=i[r])!==null&&n!==void 0?n:null}getHeadersSettings(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=bs(Hu,this)||e<0)return i;const s=bs(na,this)[e];let a=0;for(let u=r;u<s.length;u++){const h=s[u];if(h.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=h.colspan,i.push(h),h.colspan>1&&(u+=h.colspan-1),a===n)break;if(a>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return bs(Hu,this)}getColumnsCount(){return bs(Hu,this)>0?bs(na,this)[0].length:0}clear(){$f(na,this,[]),$f(Hu,this,0)}}function PE(t,e,r){return(e=Jce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jce(t){var e=ede(t,"string");return typeof e=="symbol"?e:e+""}function ede(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Y2="DF-pre-order";function G2(t,e){let r=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(r===!1)return!1;r=G2.call(this.childs[n],t,e)}return r}const tde="DF-post-order";function q2(t,e){for(let r=0;r<this.childs.length;r++)if(q2.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const K2="BF";function rde(t,e){const r=[this];function n(){if(r.length===0)return;const i=r.shift();r.push(...i.childs),t.call(e,i)!==!1&&n()}n()}const nde=K2,lF=new Map([[Y2,G2],[tde,q2],[K2,rde]]);class Qw{constructor(e){PE(this,"data",{}),PE(this,"parent",null),PE(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new Qw({...e.data});for(let n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:nde;if(!lF.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);lF.get(r).call(this,e,this)}walkUp(e){const r=this,n=i=>{e.call(r,i)!==!1&&i.parent!==null&&n(i.parent)};n(this)}}function AE(t,e,r){ide(t,e),e.set(t,r)}function ide(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zn(t,e){return t.get(X2(t,e))}function sde(t,e,r){return t.set(X2(t,e),r),r}function X2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var wc=new WeakMap,Nu=new WeakMap,yc=new WeakMap;class ode{constructor(e){AE(this,wc,new Map),AE(this,Nu,new Map),AE(this,yc,null),sde(yc,this,e)}getRoots(){return Array.from(Zn(wc,this).values())}getRootByColumn(e){let r;return Zn(Nu,this).has(e)&&(r=Zn(wc,this).get(Zn(Nu,this).get(e))),r}getNode(e,r){const n=this.getRootByColumn(r);if(!n)return;const i=r-Zn(Nu,this).get(r);let s=0,a;return n.walkDown(u=>{const{data:{origColspan:h,headerLevel:c}}=u;if(e===c){if(i>=s&&i<=s+h-1)return a=u,a.data.isRoot=r===a.data.columnIndex,!1;s+=h}}),a}rebuildTreeIndex(){let e=0;Zn(Nu,this).clear(),te(Zn(wc,this),r=>{let[,{data:{colspan:n}}]=r;for(let i=e;i<e+n;i++)Zn(Nu,this).set(i,e);e+=n})}buildTree(){this.clear();const e=Zn(yc,this).getColumnsCount();let r=0;for(;r<e;){const n=Zn(yc,this).getHeaderSettings(0,r),i=new Qw;Zn(wc,this).set(r,i),this.buildLeaves(i,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Zn(yc,this).getHeadersSettings(n,r,i);n+=1,te(s,a=>{const u={...a,headerLevel:n-1,columnIndex:r};let h;n===1?(e.data=u,h=e):(h=new Qw(u),e.addChild(h)),n<Zn(yc,this).getLayersCount()&&this.buildLeaves(h,r,n,a.origColspan),r+=a.origColspan})}clear(){Zn(wc,this).clear(),Zn(Nu,this).clear()}}function Z2(t,e){t.walkDown(r=>{let{data:n,childs:i}=r;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(let s=1;s<n.colspan;s++)e(n.columnIndex+s)})}function Jw(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function ey(t){return Jw(t,"origColspan")===t.data.origColspan}function GM(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ey(t))return GM(r[0]);e.isCollapsed=!1;const i=r.slice(1),s=new Set;let a=0;if(i.length>0)te(i,u=>{u.replaceTreeWith(u.data.clonedTree),u.data.clonedTree=null;const h=u.data;a+=h.colspan,Z2(u,c=>{s.add(c)})});else{const{colspan:u,origColspan:h,columnIndex:c}=e;a=h-u;for(let m=1;m<h;m++)s.add(c+m)}return t.walkUp(u=>{const{data:h}=u;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):ey(u)&&(h.isCollapsed=Jw(u,"isCollapsed"))}),{rollbackModification:()=>qM(t),affectedColumns:Array.from(s),colspanCompensation:a}}function qM(t){var e;const{data:r,childs:n}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ey(t))return qM(n[0]);r.isCollapsed=!0;const s=n.slice(1),a=new Set;if(s.length>0)te(s,h=>{Z2(h,c=>{a.add(c)}),h.data.clonedTree=h.cloneTree(),h.walkDown(c=>{let{data:m}=c;m.isHidden=!0})});else{const{origColspan:h,columnIndex:c}=r;for(let m=1;m<h;m++){const p=c+m;a.add(p)}}const u=r.colspan-((e=Jw(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(h=>{const{data:c}=h;c.colspan-=u,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):ey(h)&&(c.isCollapsed=Jw(h,"isCollapsed"))}),{rollbackModification:()=>GM(t),affectedColumns:Array.from(a),colspanCompensation:u}}function ade(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Gt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function lde(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Gt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const uF=new Map([["collapse",qM],["expand",GM],["hide-column",ade],["show-column",lde]]);function ude(t,e,r){if(!uF.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return uF.get(t)(e,r)}function Mv(t){const e=[];return te(t,r=>{r.walkDown(n=>{const i=n.data,{origColspan:s,columnIndex:a,headerLevel:u,crossHiddenColumns:h}=i,c=cde(e,u);let m=!1;for(let p=a;p<a+s;p++)if(h.includes(p)||m)c.push(U2());else{const y=hde(i);y.isRoot=!0,c.push(y),m=!0}})}),e}function hde(t){const{crossHiddenColumns:e,...r}=nT(t);return r}function cde(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function HE(t,e,r){dde(t,e),e.set(t,r)}function dde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vf(t,e,r){return t.set(Q2(t,e),r),r}function Sr(t,e){return t.get(Q2(t,e))}function Q2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var go=new WeakMap,ci=new WeakMap,ku=new WeakMap;class fde{constructor(){HE(this,go,new Qce),HE(this,ci,new ode(Sr(go,this))),HE(this,ku,[[]])}setState(e){Sr(go,this).setData(e);let r=!1;try{Sr(ci,this).buildTree()}catch{Sr(ci,this).clear(),Sr(go,this).clear(),r=!0}return Vf(ku,this,Mv(Sr(ci,this).getRoots())),r}setColumnsLimit(e){Sr(go,this).setColumnsLimit(e)}mergeStateWith(e){const r=St(e,n=>{let{row:i,...s}=n;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});Sr(go,this).mergeWith(r),Sr(ci,this).buildTree(),Vf(ku,this,Mv(Sr(ci,this).getRoots()))}mapState(e){Sr(go,this).map(e),Sr(ci,this).buildTree(),Vf(ku,this,Mv(Sr(ci,this).getRoots()))}mapNodes(e){return Gr(Sr(ci,this).getRoots(),(r,n)=>(n.walkDown(i=>{const s=e(i.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));const i=Sr(ci,this).getNode(r,n);let s;return i&&(s=ude(e,i,n),Vf(ku,this,Mv(Sr(ci,this).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var n,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(i=Sr(ku,this)[e])===null||i===void 0?void 0:i[r])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,r){const n=this.getHeaderTreeNode(e,r);return n?{...n.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=Sr(ci,this).getNode(e,r);return n||null}findTopMostEntireHeaderLevel(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let s=!1,a=null;for(let u=e;u<=n;u++){const h=Sr(ci,this).getRootByColumn(u);if(!h)break;s=!0,h.walkDown(c=>{const{columnIndex:m,headerLevel:p,origColspan:v,isHidden:y}=c.data;y||v<=i&&m>=e&&m+v-1<=n&&(a===null||p<a)&&(a=p)},Y2)}return s&&a===null?-1:this.levelToRowCoords((r=a)!==null&&r!==void 0?r:0)}findLeftMostColumnIndex(e,r){var n;const{isRoot:i}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(i)return r;let s=r-1;for(;s>=0;){var a;const{isRoot:u}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(u)break;s-=1}return s}findRightMostColumnIndex(e,r){var n;const{isRoot:i,origColspan:s}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(i)return r+s-1;let a=r+1;for(;a<this.getColumnsCount();){var u;const{isRoot:h}=(u=this.getHeaderSettings(e,a))!==null&&u!==void 0?u:{isRoot:!0};if(h)break;a+=1}return a-1}getLayersCount(){return Sr(go,this).getLayersCount()}getColumnsCount(){return Sr(go,this).getColumnsCount()}clear(){Vf(ku,this,[]),Sr(go,this).clear(),Sr(ci,this).clear()}}function zf(t,e,r){return(e=gde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gde(t){var e=mde(t,"string");return typeof e=="symbol"?e:e+""}function mde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pde{constructor(e,r){zf(this,"hot",void 0),zf(this,"nestedHeaderSettingsGetter",void 0),zf(this,"layersCount",0),zf(this,"container",void 0),zf(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),r=e.length;this.widthsMap.clear();for(let n=0;n<r;n++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:n}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,u=n.getRenderableIndexesLength();for(let h=0;h<this.layersCount;h++){const c=r.createElement("tr");for(let m=0;m<u;m++){let p=n.getVisualFromRenderableIndex(m);p===null&&(p=m);const v=r.createElement("th"),y=this.nestedHeaderSettingsGetter(h,p);if(y&&(!y.isPlaceholder||y.isHidden)){let C=y.label;a&&(C+='<button class="changeType"></button>'),dh(v,C),v.colSpan=y.colspan,c.appendChild(v)}}s.appendChild(c)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function vde(t,e){J2(t,e),e.add(t)}function hF(t,e,r){return(e=wde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wde(t){var e=yde(t,"string");return typeof e=="symbol"?e:e+""}function yde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uf(t,e,r){J2(t,e),e.set(t,r)}function J2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sa(t,e,r){return t.set(Rr(t,e),r),r}function Tt(t,e){return t.get(Rr(t,e))}function Rr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const cF="nestedHeaders",Cde=280;var Zt=new WeakMap,ol=new WeakMap,Eg=new WeakMap,aC=new WeakMap,ty=new WeakMap,Hr=new WeakSet;class bde extends Pt{constructor(){super(...arguments),vde(this,Hr),Uf(this,Zt,new fde),Uf(this,ol,null),Uf(this,Eg,null),Uf(this,aC,!1),Uf(this,ty,null),hF(this,"ghostTable",new pde(this.hot,(e,r)=>this.getHeaderSettings(e,r))),hF(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return cF}static get PLUGIN_PRIORITY(){return Cde}isEnabled(){return!!this.hot.getSettings()[cF]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&Vt(Gt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Rr(Hr,this,Lde).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Fde).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,_de).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Tde).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,xde).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Mde).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Ide).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Ode).call(e,...i)}),this.addHook("afterSelection",()=>Rr(Hr,this,Iv).call(this)),this.addHook("afterSelectionFocusSet",()=>Rr(Hr,this,Iv).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Sde).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",n=>Rr(Hr,this,Ade).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Nde).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,kde).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Rde).call(e,...i)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Ede).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Pde).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Hde).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rr(Hr,e,Dde).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Rr(Hr,this,Iv).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Rr(Hr,this,Iv).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Tt(Zt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Tt(Zt,this).setState(e)),this.detectedOverlappedHeaders&&Vt(Gt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{const i=r===!0?"hide-column":"show-column";Tt(Zt,this).triggerColumnModification(i,n)}),!Tt(ol,this)&&this.enabled&&Sa(ol,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(n=>{let{op:i,index:s,newValue:a}=n;if(i==="replace"){const u=a===!0?"hide-column":"show-column";Tt(Zt,this).triggerColumnModification(u,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Tt(Zt,this).clear(),Tt(ol,this).unsubscribe(),Sa(ol,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Tt(Zt,this)}getLayersCount(){return Tt(Zt,this).getLayersCount()}getHeaderSettings(e,r){return Tt(Zt,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<r;a++){const u=n.childNodes[a];if(!u)break;const h=i.childNodes[a],c=s?s.childNodes[a]:null;for(let m=0,p=u.childNodes.length;m<p;m++)u.childNodes[m].removeAttribute("colspan"),tt(u.childNodes[m],"hiddenHeader"),h&&h.childNodes[m]&&(h.childNodes[m].removeAttribute("colspan"),tt(h.childNodes[m],"hiddenHeader")),s&&c&&c.childNodes[m]&&(c.childNodes[m].removeAttribute("colspan"),tt(c.childNodes[m],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var a;const{columnIndexMapper:u,view:h}=this.hot;let c=u.getVisualFromRenderableIndex(i);c===null&&(c=i),s.removeAttribute("colspan"),tt(s,"hiddenHeader");const{colspan:m,isHidden:p,isPlaceholder:v,headerClassNames:y}=(a=Tt(Zt,this).getHeaderSettings(e,c))!==null&&a!==void 0?a:{};if(v||p)Re(s,"hiddenHeader");else if(m>1){var C,R;const{wtOverlays:_}=h._wt,x=(C=_.topInlineStartCornerOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),I=(R=_.inlineStartOverlay)===null||R===void 0?void 0:R.clone.wtTable.THEAD.contains(s),k=x||I?Math.min(m,n-i):m;k>1&&s.setAttribute("colspan",k)}if(this.hot.view.appendColHeader(c,s,function(){return r.getColumnHeaderValue(...arguments)},e),!v&&!p){const _=s.querySelector("div.relative");_&&y&&y.length>0&&(tt(_,this.hot.getColumnMeta(c).headerClassName),Re(_,y))}}}getColumnHeaderValue(e,r){var n;const{isHidden:i,isPlaceholder:s}=(n=Tt(Zt,this).getHeaderSettings(r,e))!==null&&n!==void 0?n:{};return s||i?"":this.hot.getColHeader(e,r)}destroy(){Sa(Zt,this,null),Tt(ol,this)!==null&&(Tt(ol,this).unsubscribe(),Sa(ol,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Tt(Zt,this).getHeaderTreeNodeData(e.row,e.col)}}function Iv(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const i=Tt(Zt,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function Sde(t,e){var r;const n=this.hot.getSelectedRangeLast();if(!n)return t;const{highlight:i}=n,{navigableHeaders:s}=this.hot.getSettings(),a=this.hot.selection.isSelectedByColumnHeader(),u=s?i.row:(r=Tt(ty,this))===null||r===void 0?void 0:r.row,h=a?t:i.col,c=u<0&&h>=0;if(Sa(ty,this,null),!c)return t;const m=this.hot.getFirstFullyVisibleColumn(),p=this.hot.getLastFullyVisibleColumn(),v=p-m+1,y=Tt(Zt,this).findLeftMostColumnIndex(u,h),C=Tt(Zt,this).findRightMostColumnIndex(u,h),R=C-y+1;if(y<m&&C>p)return y;if(a){let _=null;return y>=m&&C>p?R>v?(e.value="start",_=y):(e.value="end",_=C):y<m&&C<=p&&(R>v?(e.value="end",_=C):(e.value="start",_=y)),_}return y<=m?y:C}function Rde(t,e,r){const n=Tt(Zt,this).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:s,selectionWidth:a}=r,{isRoot:u,colspan:h}=Tt(Zt,this).getHeaderSettings(e,t);if(s===y1){if(!u)return n.columnIndex}else if(s===i$&&(h>a-i||!u))return null;return t}function Ede(t,e,r){let{columnHeadersCount:n}=r;if(n!==0)for(let s=0;s<e.length;s++){const{startRow:a,startCol:u,endRow:h,endCol:c}=e[s],m=h-a+1,p=u-c+1;if(a>=0||p===1)break;for(let v=u;v<=c;v++)for(let y=a;y<=h;y++){var i;const C=m+y,R=v-u;if(R===0)continue;((i=Tt(Zt,this).getHeaderTreeNodeData(y,v))===null||i===void 0?void 0:i.isRoot)===!1&&(t[C][R]="")}}}function _de(t,e,r,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function Tde(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;Sa(Eg,this,e.clone()),Sa(aC,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,s=[],{columnIndex:a,origColspan:u}=r,h=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,a,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,a+u-1,e.row):s.push(a,a+u-1,e.row):(Ay(t)||Al(t)&&h||HB(t))&&s.push(a,a+u-1,e.row),n.selectColumns(...s)}function xde(t,e,r,n){if(!this.hot.view.isMouseDown()||n.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:a}=i,u=this.hot.getSelectedRangeLast(),h=u.getTopStartCorner(),c=u.getBottomEndCorner(),{from:m}=u;n.column=!0,n.cell=!0;const p=[],v=_t(e.row,-1/0,-1);e.col<m.col?p.push(c.col,s,v):e.col>m.col?p.push(h.col,s+a-1,v):p.push(s,s+a-1,v),this.hot.selection.selectColumns(...p)}function Mde(){Sa(aC,this,!1)}function Ide(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Tt(aC,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Tt(Zt,this).getHeaderTreeNodeData(Tt(Eg,this).row,Tt(Eg,this).col);if(e.setHighlight(Tt(Eg,this)),s>e.getWidth()||i<r||i+s-1>n){const a=Tt(Zt,this).findTopMostEntireHeaderLevel(_t(r,i,i+s-1),_t(n,i,i+s-1));e.highlight.row=a,e.highlight.col=e.from.col}}function Ode(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const i=Tt(Zt,this).findLeftMostColumnIndex(r.row,r.col),s=Tt(Zt,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const a=e.col>=i&&e.col<=s?i-1:s,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,-1);u===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,e.col)-1,1)}else if(t.col>0){const a=e.col>=i&&e.col<=s?s+1:i,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,1);u===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,u)-1,1)}}function Pde(t,e,r){const n=t.row,i=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});Sa(ty,this,r.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function Ade(t){t.length=0;for(let e=0;e<Tt(Zt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Hde(t){const e=Tt(Zt,this).getLayersCount();let r=t.startColumn,n=!!e;for(let i=0;i<e;i++){const s=Tt(Zt,this).findLeftMostColumnIndex(i,t.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(n=!1),Ln(a)&&a<t.startColumn){r=a;break}}t.startColumn=n?Tt(Zt,this).getHeaderTreeNodeData(0,r).columnIndex:r}function Nde(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function kde(t,e,r){var n;const{label:i}=(n=Tt(Zt,this).getHeaderTreeNodeData(r,e))!==null&&n!==void 0?n:{label:""};return i}function Dde(t,e){if(t<0)return this.hot.getCell(t,Tt(Zt,this).findLeftMostColumnIndex(t,e),!0)}function Lde(){this.updatePlugin()}function Fde(t,e){e||this.updatePlugin()}function jf(t,e,r){return(e=Wde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wde(t){var e=Bde(t,"string");return typeof e=="symbol"?e:e+""}function Bde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $de{constructor(e,r){jf(this,"hot",void 0),jf(this,"data",null),jf(this,"plugin",void 0),jf(this,"parentReference",new WeakMap),jf(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Xe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,n){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&te(e.__children,i=>{this.cacheNode(i,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,n,i){let s=!1,a=r;if(isNaN(a)&&a.end)return a;let u=e;return u||(u={__children:this.data},s=!0,a-=1),n!=null&&a===n?{result:u,end:!0}:i!=null&&u===i?{result:a,end:!0}:(a+=1,u.__children&&te(u.__children,h=>{if(this.parentReference.set(h,s?null:u),a=this.readTreeNodes(h,a,n,i),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return wt(this.data[0],(r,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(te(n.__children,i=>{r+=1,i.__children&&(r+=this.countChildren(i))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let n=r;this.hot.runHooks("beforeAddChild",e,n);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),n||(n=this.mockNode()),s.__children.push(n),this.rewriteCache();const a=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,r,n){let i=n,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,r),e){const u=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",u,1),e.__children.splice(r,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(u,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",u,1),s=u}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),i=this.getRowParent(n),s=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const i=[];Array.isArray(e)?(Xe(e[0],e[2],v=>{const y=this.translateTrimmedRow(v);i.push(this.getDataObject(y))}),Xe(0,i.length-2,v=>{this.detachFromParent(i[v],!1)}),n=i[i.length-1]):n=e;const s=this.getRowIndex(n),a=this.countChildren(n),u=this.getRowIndexWithinParent(n),h=this.getRowParent(n),c=this.getRowParent(h),m=this.getRowIndex(c);let p=null;if(this.hot.runHooks("beforeDetachChild",h,n),u!=null){const v=Array.from(new Array(s+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",s,a+1,v,this.plugin.pluginName),h.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,a+1,v,this.plugin.pluginName),c){p=m+this.countChildren(c);const y=this.getChild(c,this.countChildren(c)-1),C=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",C+1,a+1,this.plugin.pluginName),c.__children.push(n)}else p=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",p-2,a+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",p-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",h,n,this.getRowIndex(n)),r&&this.hot.render()}filterData(e,r,n){const i=[];te(n,s=>{i.push(this.getDataObject(s))}),te(i,s=>{const a=this.getRowIndexWithinParent(s),u=this.getRowParent(s);u===null?this.data.splice(a,1):u.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,r,n){const i=this.getDataObject(e-1);let s=null,a=e;i&&i.__children&&i.__children.length===0?(s=i,a=0):e<this.countAllRows()&&(s=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),s?n?s.__children.splice(a,r,...n):s.__children.splice(a,r):n?this.data.splice(a,r,...n):this.data.splice(a,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,n=null;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,n,i){const s=r===this.hot.countRows(),a=this.getRowParent(e),u=this.getRowIndexWithinParent(e),h=a.__children.slice(u,u+1),c=e>r;let m=s?this.getRowParent(r-1):this.getRowParent(r);m==null&&(m=this.getRowParent(r-1)),m==null&&(m=this.getDataObject(r-1)),m?m.__children||(m.__children=[]):(m=this.getDataObject(r),m.__children=[]);const p=s||n||i?m.__children.length:this.getRowIndexWithinParent(r),v=a===m;m.__children.splice(p,0,h[0]),a.__children.splice(u+(c&&v?1:0),1),this.syncRowWithRawSource(a),v||this.syncRowWithRawSource(m)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function dF(t,e,r){return(e=Vde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vde(t){var e=zde(t,"string");return typeof e=="symbol"?e:e+""}function zde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KM{constructor(e,r){dF(this,"hot",void 0),dF(this,"plugin",void 0),this.hot=r,this.plugin=e}}class Eo extends KM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const n=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(n),s=this.dataManager.getDataObject(n),a=r.getElementsByTagName("DIV")[0],u=a.querySelector("span.rowHeader"),h=a.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(te(h,m=>{m&&a.removeChild(m)}),Re(r,Eo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:m}=this.hot,p=u.cloneNode(!0);a.innerHTML="",Xe(0,i-1,()=>{const v=m.createElement("SPAN");Re(v,Eo.CSS_CLASSES.emptyIndicator),a.appendChild(v)}),a.appendChild(p)}if(this.dataManager.hasChildren(s)){const m=this.hot.rootDocument.createElement("DIV");c&&it(m,[Ll()]),Re(r,Eo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Re(m,`${Eo.CSS_CLASSES.button} ${Eo.CSS_CLASSES.expandButton}`),c&&it(r,[ts(!1)])):(Re(m,`${Eo.CSS_CLASSES.button} ${Eo.CSS_CLASSES.collapseButton}`),c&&it(r,[ts(!0)])),a.appendChild(m)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount);const n=this.hot.view.getStylesHandler();let i=11;n.isClassicTheme()||(i=n.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*r+25),this.hot.render()}}class Ude extends KM{constructor(e,r){var n;super(e,r),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,i)},shiftStash:function(i,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),te(n.lastCollapsedRows,(u,h)=>{u>=i&&u<s&&(n.lastCollapsedRows[h]=u+a)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,i),n.lastCollapsedRows=void 0},trimStash:(i,s)=>{Xe(i,i+s-1,a=>{const u=this.lastCollapsedRows.indexOf(a);u>-1&&this.lastCollapsedRows.splice(u,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,a=null,u=null;return isNaN(e)?(s=e,a=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(s)&&te(s.__children,h=>{i.push(this.dataManager.getRowIndex(h))}),u=this.collapseRows(i,!0,!1),n&&this.trimRows(u),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),u}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];te(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),n&&this.trimRows(i),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return te(e,s=>{i.push(s),r&&this.collapseChildRows(s,i)}),n&&this.trimRows(i),i}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);te(i.__children,s=>{const a=this.dataManager.getRowIndex(s);r.push(a),this.collapseChildRows(a,r)})}n&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return te(e,s=>{i.push(s),r&&this.expandChildRows(s,i)}),n&&this.untrimRows(i),i}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);te(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const a=this.dataManager.getRowIndex(s);r.push(a),this.expandChildRows(a,r)}})}n&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,a=null,u=null;return isNaN(e)?(s=e,a=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(s)&&te(s.__children,h=>{const c=this.dataManager.getRowIndex(h);i.push(c)}),u=this.expandRows(i,!0,!1),n&&this.untrimRows(u),r&&this.renderAndAdjust(),u}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];te(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),n&&this.untrimRows(i),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];te(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];te(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{te(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{te(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&te(r.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return n=!1,!1}),n}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const n=this.translateTrimmedRow(r.row);nt(e.target,Eo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),ls(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function jde(t,e,r){Yde(t,e),e.set(t,r)}function Yde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gde(t,e,r){return(e=qde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qde(t){var e=Kde(t,"string");return typeof e=="symbol"?e:e+""}function Kde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xde(t,e){return t.get(Zde(t,e))}function Zde(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fF=new WeakMap;class Qde extends KM{constructor(){super(...arguments),Gde(this,"dataManager",this.plugin.dataManager),jde(this,fF,{row_above:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(bx)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(n);this.dataManager.addChild(i)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Sx)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(i)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Xe(0,e.items.length-1,n=>{if(n===0)return te(r,(i,s)=>{e.items.splice(n+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Xe(0,e.items.length-1,r=>{const n=Xde(fF,this)[e.items[r].key];n!=null&&(e.items[r].callback=n)}),e}}function Ov(t,e,r){return(e=Jde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jde(t){var e=efe(t,"string");return typeof e=="symbol"?e:e+""}function efe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tfe{constructor(e){Ov(this,"plugin",void 0),Ov(this,"hot",void 0),Ov(this,"dataManager",void 0),Ov(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const a=n===this.hot.countRows(),u=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let h=!0;const c=e.map(C=>{if(!h)return!1;const R=this.dataManager.translateTrimmedRow(C);return h=this.shouldAllowMoving(R,u),R}),m=c.indexOf(u)===-1;if(!h||!m)return!1;const p=this.getBaseParent(c),v=this.getTargetParent(a,u),y=p===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,y),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:n,dropIndex:i,movePossible:s}=e;let a=!1;return fr(i)&&(Vt(Gt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,n,i,s,!1),a=!0),a}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}shiftCollapsibleParentsLocations(e,r,n){n||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,n){const i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,i)})})}moveCellsMeta(e,r){const n=[],i=Math.max(...e)<r;e.forEach(s=>{n.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(i?n.length:0),0,...n)}selectCells(e,r){const n=e.length;let i=0,s=0,a=null,u=null;if(this.movedToCollapsed){let h=null;e[n-1]<r?h=this.dataManager.translateTrimmedRow(r-n):h=this.dataManager.translateTrimmedRow(r);const c=this.dataManager.getRowParent(h===null?this.hot.countSourceRows()-1:h-1),m=this.dataManager.getRowIndex(c);i=this.dataManager.untranslateTrimmedRow(m),s=i}else e[n-1]<r?(s=r-1,i=s-n+1):(i=r,s=i+n-1);a=this.hot.selection,u=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(i,0)),a.setRangeEnd(this.hot._createCellCoords(s,u),!0)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}}function rfe(t,e){ez(t,e),e.add(t)}function gF(t,e,r){ez(t,e),e.set(t,r)}function ez(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NE(t,e,r){return(e=nfe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nfe(t){var e=ife(t,"string");return typeof e=="symbol"?e:e+""}function ife(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aw(t,e){return t.get(ln(t,e))}function ry(t,e,r){return t.set(ln(t,e),r),r}function ln(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ny="nestedRows",sfe=300,mF=ny,ofe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var lC=new WeakMap,Cc=new WeakMap,wn=new WeakSet;class afe extends Pt{constructor(){super(...arguments),rfe(this,wn),NE(this,"dataManager",null),NE(this,"headersUI",null),NE(this,"collapsedRowsMap",null),gF(this,lC,!1),gF(this,Cc,!1)}static get PLUGIN_KEY(){return ny}static get PLUGIN_PRIORITY(){return sfe}isEnabled(){return!!this.hot.getSettings()[ny]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new hm),this.dataManager=new $de(this,this.hot),this.collapsingUI=new Ude(this,this.hot),this.headersUI=new Eo(this,this.hot),this.contextMenuUI=new Qde(this,this.hot),this.rowMoveController=new tfe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,bfe).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,Sfe).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,hfe).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,cfe).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,dfe).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,ufe).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,mfe).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,gfe).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,pfe).call(e,...n)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,vfe).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,wfe).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,yfe).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,ffe).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,Cfe).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ln(wn,e,lfe).call(e,...n)}),this.addHook("beforeLoadData",r=>ln(wn,this,pF).call(this,r)),this.addHook("beforeUpdateData",r=>ln(wn,this,pF).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:mF,relativeToGroup:Wl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mF)}disableCoreAPIModifiers(){ry(Cc,this,!0)}enableCoreAPIModifiers(){ry(Cc,this,!1)}onModifyRowData(e){if(!aw(Cc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!aw(Cc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,n){return aw(Cc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,n),!1)}destroy(){super.destroy()}}function lfe(t,e,r,n){return this.rowMoveController.onBeforeRowMove(t,e,r,n)}function ufe(t,e,r){this.collapsingUI.toggleState(t,e,r)}function hfe(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),ry(lC,this,!0),this.dataManager.getData().slice()}function cfe(t){return this.contextMenuUI.appendOptions(t)}function dfe(t,e){this.headersUI.appendLevelIndicators(t,e)}function ffe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function gfe(t,e,r,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{ry(lC,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function mfe(t,e,r){const n=Array.from(r.reduce((i,s)=>{if(this.dataManager.isParent(s)){const a=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(a)&&a.forEach(u=>i.add(this.dataManager.getRowIndex(u))),i}return i.add(s)},new Set));r.length=0,r.push(...n)}function pfe(){this.collapsingUI.collapsedRowsStash.stash()}function vfe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function wfe(){this.collapsingUI.collapsedRowsStash.stash()}function yfe(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Cfe(){this.dataManager.rewriteCache()}function bfe(){this.headersUI.updateRowHeaderWidth()}function Sfe(t,e){aw(lC,this)&&(e.skipRender=!0)}function pF(t){if(!m$(t)){a1(ofe),this.hot.getSettings()[ny]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function kE(t,e,r){return(e=Rfe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rfe(t){var e=Efe(t,"string");return typeof e=="symbol"?e:e+""}function Efe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _fe{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;kE(this,"rootWindow",void 0),kE(this,"prefix",void 0),kE(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const n=typeof e>"u"?r:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){te(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Tfe(t,e,r){return(e=xfe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xfe(t){var e=Mfe(t,"string");return typeof e=="symbol"?e:e+""}function Mfe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ze.getSingleton().register("persistentStateSave");ze.getSingleton().register("persistentStateLoad");ze.getSingleton().register("persistentStateReset");const vF="persistentState",Ife=0;class Ofe extends Pt{constructor(){super(...arguments),Tfe(this,"storage",void 0)}static get PLUGIN_KEY(){return vF}static get PLUGIN_PRIORITY(){return Ife}isEnabled(){return!!this.hot.getSettings()[vF]}enablePlugin(){this.enabled||(this.storage||(this.storage=new _fe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Pfe(t,e){Afe(t,e),e.add(t)}function Afe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DE(t,e,r){return(e=Hfe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hfe(t){var e=Nfe(t,"string");return typeof e=="symbol"?e:e+""}function Nfe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wF(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const LE="search",kfe=190,Dfe="htSearchResult",Lfe=function(t,e,r,n,i){t.getCellMeta(e,r).isSearchResult=i},Ffe=function(t,e,r){return fr(t)||t===null||!t.toLocaleLowerCase||t.length===0||fr(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var FE=new WeakSet;class Wfe extends Pt{constructor(){super(...arguments),Pfe(this,FE),DE(this,"callback",Lfe),DE(this,"queryMethod",Ffe),DE(this,"searchResultClass",Dfe)}static get PLUGIN_KEY(){return LE}static get PLUGIN_PRIORITY(){return kfe}isEnabled(){return this.hot.getSettings()[LE]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[LE];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wF(FE,e,yF).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wF(FE,e,yF).call(e,...i)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),a=[],u=this.hot;return Xe(0,i-1,h=>{Xe(0,s-1,c=>{const m=this.hot.getDataAtCell(h,c),p=this.hot.getCellMeta(h,c),v=p.search.callback||r,C=(p.search.queryMethod||n)(e,m,p);if(C){const R={row:h,col:c,data:m};a.push(R)}v&&v(u,h,c,m,C)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){vt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function yF(t,e,r,n,i,s){const a=s.className||[];let u=[];typeof a=="string"?u=a.split(" "):u.push(...a),this.isEnabled()&&s.isSearchResult?u.includes(this.searchResultClass)||u.push(`${this.searchResultClass}`):u.includes(this.searchResultClass)&&u.splice(u.indexOf(this.searchResultClass),1),s.className=u.join(" ")}function Pv(t,e,r){return(e=Bfe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bfe(t){var e=$fe(t,"string");return typeof e=="symbol"?e:e+""}function $fe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tz{constructor(e){Pv(this,"viewportWidth",void 0),Pv(this,"overwriteColumnWidthFn",void 0),Pv(this,"baseWidths",new Map),Pv(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:r}=e;this.viewportWidth=r,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,r){this.baseWidths.set(e,r)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Vfe extends tz{calculate(){const e=Array.from(this.baseWidths).reduce((p,v)=>{let[,y]=v;return p+y},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const n=this.viewportWidth/e,i=[],s=[];let a=this.viewportWidth,u=0;if(this.baseWidths.forEach((p,v)=>{const y=Math.round(p*n),C=this.overwriteColumnWidthFn(y,v);y===C&&y>=qc?(i.push([v,C]),u+=C):y!==C&&(i.push([v,C]),s.push(v),a-=C)}),a<=qc){this.stretchedWidths.clear();return}const h=a/u;let c=-1,m=0;i.forEach((p,v)=>{let[y,C]=p,R=C;s.includes(y)||(R=Math.round(C*h)),this.stretchedWidths.set(y,R),c=y,v<i.length-1&&(m+=R)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(c,Math.round(this.viewportWidth-m))}}function CF(t,e,r){zfe(t,e),e.set(t,r)}function zfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WE(t,e){return t.get(rz(t,e))}function Av(t,e,r){return t.set(rz(t,e),r),r}function rz(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hv=new WeakMap,Yf=new WeakMap;class Ufe extends tz{constructor(){super(...arguments),CF(this,Hv,0),CF(this,Yf,-1)}prepare(e){super.prepare(e),Av(Hv,this,0),Av(Yf,this,-1)}setColumnBaseWidth(e,r){super.setColumnBaseWidth(e,r),Av(Yf,this,e),Av(Hv,this,r)}calculate(){if(WE(Yf,this)===-1)return;const e=Array.from(this.baseWidths).reduce((n,i)=>{let[,s]=i;return n+s},0),r=Math.max(this.viewportWidth-e+WE(Hv,this),0);this.stretchedWidths.set(WE(Yf,this),r)}}function jfe(t,e){nz(t,e),e.add(t)}function Nv(t,e,r){nz(t,e),e.set(t,r)}function nz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nr(t,e){return t.get(Dc(t,e))}function BE(t,e,r){return t.set(Dc(t,e),r),r}function Dc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Yfe="stretchColumns";var Dn=new WeakMap,bc=new WeakMap,$E=new WeakMap,kv=new WeakMap,Gf=new WeakSet;class Gfe{constructor(e){jfe(this,Gf),Nv(this,Dn,void 0),Nv(this,bc,void 0),Nv(this,$E,new Map([["all",new Vfe(Dc(Gf,this,bF).bind(this))],["last",new Ufe(Dc(Gf,this,bF).bind(this))]])),Nv(this,kv,"none"),BE(Dn,this,e),BE(bc,this,Nr(Dn,this).columnIndexMapper.createAndRegisterIndexMap(Yfe,"physicalIndexToValue"))}useStrategy(e){BE(kv,this,Nr($E,this).has(e)?e:"none")}refreshStretching(){if(Nr(kv,this)==="none"){Nr(bc,this).clear();return}Nr(Dn,this).batchExecution(()=>{Nr(bc,this).clear();const e=Nr($E,this).get(Nr(kv,this));let n=Nr(Dn,this).view.getViewportWidth();Dc(Gf,this,qfe).call(this)&&(n-=bn(Nr(Dn,this).rootDocument)),e.prepare({viewportWidth:n});for(let i=0;i<Nr(Dn,this).countCols();i++)Nr(Dn,this).columnIndexMapper.isHidden(Nr(Dn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Dc(Gf,this,Kfe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[s,a]=i;Nr(bc,this).setValueAtIndex(Nr(Dn,this).toPhysicalColumn(s),a)})},!0)}getStretchedWidth(e){return Nr(bc,this).getValueAtIndex(Nr(Dn,this).toPhysicalColumn(e))}}function qfe(){const{view:t}=Nr(Dn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),r=Nr(Dn,this).countRows(),n=t.getStylesHandler().getDefaultRowHeight();let i=0,s=!1;for(let u=0;u<r;u++){var a;if(i+=((a=Nr(Dn,this).getRowHeight(u))!==null&&a!==void 0?a:n)+(u===0?1:0),i>e){s=!0;break}}return s}function Kfe(t){var e;return(e=Nr(Dn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:qc}function bF(t,e){return Nr(Dn,this).runHooks("beforeStretchingColumnWidth",t,e)}function Xfe(t,e){iz(t,e),e.add(t)}function VE(t,e,r){iz(t,e),e.set(t,r)}function iz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zE(t,e,r){return t.set(iy(t,e),r),r}function la(t,e){return t.get(iy(t,e))}function iy(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Zfe="stretchColumns",Qfe=155;var Ic=new WeakMap,Dv=new WeakMap,qf=new WeakMap,UE=new WeakSet;class Jfe extends Pt{constructor(){super(...arguments),Xfe(this,UE),VE(this,Ic,new Gfe(this.hot)),VE(this,Dv,null),VE(this,qf,new ResizeObserver(e=>{requestAnimationFrame(()=>{var r;(r=this.hot)!==null&&r!==void 0&&r.view.isHorizontallyScrollableByWindow()&&e.forEach(n=>{let{contentRect:i}=n;la(Dv,this)!==null&&la(Dv,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),zE(Dv,this,i.width)})})}))}static get PLUGIN_KEY(){return Zfe}static get PLUGIN_PRIORITY(){return Qfe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(la(Ic,this).useStrategy(this.hot.getSettings().stretchH),la(qf,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return iy(UE,e,tge).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return iy(UE,e,ege).call(e,...n)},10),super.enablePlugin())}updatePlugin(){la(Ic,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),la(qf,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return la(Ic,this).getStretchedWidth(e)}destroy(){la(qf,this).disconnect(),zE(qf,this,null),zE(Ic,this,null),super.destroy()}}function ege(t,e,r){if(r===this.pluginName)return;const n=this.getColumnWidth(e);return typeof n=="number"?n:t}function tge(t){t&&la(Ic,this).refreshStretching()}function rge(t,e){nge(t,e),e.add(t)}function nge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lv(t,e,r){return(e=ige(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ige(t){var e=sge(t,"string");return typeof e=="symbol"?e:e+""}function sge(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oge="touchScroll",age=200;var Fv=new WeakSet;class lge extends Pt{constructor(){super(...arguments),rge(this,Fv),Lv(this,"scrollbars",[]),Lv(this,"clones",[]),Lv(this,"lockedCollection",!1),Lv(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return oge}static get PLUGIN_PRIORITY(){return age}static get SETTING_KEYS(){return!0}isEnabled(){return t1()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>jE(Fv,this,uge).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>jE(Fv,this,hge).call(this)),this.addHook("afterMomentumScroll",()=>jE(Fv,this,cge).call(this))}}function uge(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function hge(){this.freezeOverlays=!0,te(this.clones,t=>{Re(t,"hide-tween")})}function cge(){this.freezeOverlays=!1,te(this.clones,t=>{tt(t,"hide-tween"),Re(t,"show-tween")}),this.hot._registerTimeout(()=>{te(this.clones,t=>{tt(t,"show-tween")})},400),te(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function dge(t,e){fge(t,e),e.add(t)}function fge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gge(t,e,r){return(e=mge(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mge(t){var e=pge(t,"string");return typeof e=="symbol"?e:e+""}function pge(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vge(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const lw="trimRows",wge=330;var SF=new WeakSet;class yge extends Pt{constructor(){super(...arguments),dge(this,SF),gge(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return lw}static get PLUGIN_PRIORITY(){return wge}isEnabled(){return!!this.hot.getSettings()[lw]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new hm),this.trimmedRowsMap.addLocalHook("init",()=>vge(SF,this,Cge).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[lw];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),te(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{te(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;const s=this.trimmedRowsMap.getValues().slice(),a=e.length>0;n&&a&&(te(e,h=>{s[h]=!1}),i=Gr(s,(h,c,m)=>(c&&h.push(m),h),[])),this.hot.runHooks("beforeUntrimRow",r,i,n&&a)!==!1&&(n&&a&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,i,n&&a,n&&i.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<r)}destroy(){super.destroy()}}function Cge(){const t=this.hot.getSettings()[lw];Array.isArray(t)&&this.hot.batchExecution(()=>{te(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var RF={},EF;function bge(){if(EF)return RF;EF=1;var t=sr(),e=id(),r=UF();return t({target:"Object",stat:!0},{fromEntries:function(i){var s={};return e(i,function(a,u){r(s,a,u)},{AS_ENTRIES:!0}),s}}),RF}bge();const sz="undoRedo",Sge="undoRedo";function He(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,i){const s=n&&n.length;if(!s||!n.find(h=>{const[,,c,m]=h;return c!==m}))return;const u=()=>{const h=n.reduce((m,p)=>(m.push([...p]),m),[]);te(h,m=>{m[1]=t.propToCol(m[1])});const c=s>1?this.getSelected():[[h[0][0],h[0][1]]];return new He.ChangeAction(h,c)};e.done(u,i)}),t.addHook("afterCreateRow",(n,i,s)=>{e.done(()=>new He.CreateRowAction(n,i),s)});const r=(n,i,s,a)=>{const u=["visualRow","visualCol","row","col","prop"],h=u.length,c=[];return Xe(s,a,m=>{Xe(n,i,p=>{const v=t.getCellMeta(p,m);if(Object.keys(v).length!==h){const y=Object.fromEntries(Object.entries(v).filter(C=>{let[R]=C;return u.includes(R)===!1}));c.push([v.visualRow,v.visualCol,y])}})}),c};t.addHook("beforeRemoveRow",(n,i,s,a)=>{const u=()=>{const h=t.toPhysicalRow(n),c=h+i-1,m=$n(e.instance.getSourceData(h,0,h+i-1,e.instance.countSourceCols()-1));return new He.RemoveRowAction(h,m,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),r(h,c,0,t.countCols()-1))};e.done(u,a)}),t.addHook("afterCreateCol",(n,i,s)=>{e.done(()=>new He.CreateColumnAction(n,i),s)}),t.addHook("beforeRemoveCol",(n,i,s,a)=>{const u=()=>{const h=e.instance.getSourceDataArray(),c=(e.instance.countCols()+n)%e.instance.countCols(),m=c+i-1,p=[],v=[],y=[];Xe(h.length-1,_=>{const x=[],I=h[_];Xe(c,m,k=>{x.push(I[t.toPhysicalColumn(k)])}),p.push(x)}),Xe(i-1,_=>{y.push(t.toPhysicalColumn(c+_))}),Array.isArray(t.getSettings().colHeaders)&&Xe(i-1,_=>{v.push(t.getSettings().colHeaders[t.toPhysicalColumn(c+_)]||null)});const C=t.columnIndexMapper.getIndexesSequence(),R=t.rowIndexMapper.getIndexesSequence();return new He.RemoveColumnAction(c,y,p,v,C,R,t.getSettings().fixedColumnsStart,r(0,t.countRows(),c,m))};e.done(u,a)}),t.addHook("beforeCellAlignment",(n,i,s,a)=>{e.done(()=>new He.CellAlignmentAction(n,i,s,a))}),t.addHook("beforeFilter",(n,i)=>{e.done(()=>new He.FiltersAction(n,i))}),t.addHook("beforeRowMove",(n,i)=>{n!==!1&&e.done(()=>new He.RowMoveAction(n,i))}),t.addHook("beforeColumnMove",(n,i)=>{n!==!1&&e.done(()=>new He.ColumnMoveAction(n,i))}),t.addHook("beforeMergeCells",(n,i)=>{i||e.done(()=>new He.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,i)=>{i||e.done(()=>new He.UnmergeCellsAction(t,n))}),t.addHook("beforeColumnSort",(n,i,s)=>{s&&e.done(()=>new He.ColumnSortAction(n,i))}),t.addHook("afterInit",()=>{e.init()})}He.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const n=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",n,e)===!1)return;const s=t(),a=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())};He.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const r=$n(e);if(this.instance.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};He.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const r=$n(e);if(this.instance.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};He.prototype.isUndoAvailable=function(){return this.doneActions.length>0};He.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};He.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};He.prototype.isEnabled=function(){return this.enabled};He.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,_ge(t),this.registerShortcuts(),t.addHook("afterChange",oz)};He.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,Tge(t),this.unregisterShortcuts(),t.removeHook("afterChange",oz)};He.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};He.Action=function(){};He.Action.prototype.undo=function(){};He.Action.prototype.redo=function(){};He.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Vs(He.ChangeAction,He.Action);He.ChangeAction.prototype.undo=function(t,e){const r=$n(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let a=0,u=r.length;a<u;a++)r[a].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(let a=0,u=r.length;a<u;a++){const[h,c]=r[a];t.getSettings().minSpareRows&&h+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(h+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&c+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(c+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const s=t.getSelectedLast();if(s!==void 0){const[a,u]=r[0],[h,c]=s,m=t.getFirstFullyVisibleRow(),p=t.getFirstFullyVisibleColumn(),v=a>=m,y=u>=p;if((v&&y)===!1&&(h!==a||c!==u)===!0){const _={row:a,col:u};v===!1&&(_.verticalSnap="top"),y===!1&&(_.horizontalSnap="start"),t.scrollViewportTo(_)}}t.selectCells(this.selected,!1,!1)};He.ChangeAction.prototype.redo=function(t,e){const r=$n(this.changes);for(let n=0,i=r.length;n<i;n++)r[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};He.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Vs(He.CreateRowAction,He.Action);He.CreateRowAction.prototype.undo=function(t,e){const r=t.countRows(),n=t.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};He.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};He.RemoveRowAction=function(t,e,r,n,i,s){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i,this.removedCellMetas=s};Vs(He.RemoveRowAction,He.Action);He.RemoveRowAction.prototype.undo=function(t,e){const r=t.getSettings(),n=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(a=>{const u=parseInt(a,10);n.push([this.index+s,isNaN(u)?a:u,i[a]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[s,a,u]=i;t.setCellMetaObject(s,a,u)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};He.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};He.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Vs(He.CreateColumnAction,He.Action);He.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};He.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};He.RemoveColumnAction=function(t,e,r,n,i,s,a,u){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a,this.removedCellMetas=u};Vs(He.RemoveColumnAction,He.Action);He.RemoveColumnAction.prototype.undo=function(t,e){const r=t.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),i=(c,m,p)=>p[this.indexes.indexOf(n[m])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(St(this.data[c],i));const u=St(this.headers,i),h=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),te(t.getSourceDataArray(),(c,m)=>{te(n,(p,v)=>{c[p]=a[m][v],h.push([m,p,c[p]])})}),t.setSourceDataAtCell(h,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&te(u,(c,m)=>{t.getSettings().colHeaders[n[m]]=c}),this.removedCellMetas.forEach(c=>{let[m,p,v]=c;t.setCellMetaObject(m,p,v)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};He.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};He.CellAlignmentAction=function(t,e,r,n){this.stateBefore=t,this.range=e,this.type=r,this.alignment=n};He.CellAlignmentAction.prototype.undo=function(t,e){te(this.range,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&t.setCellMeta(n,i,"className",this.stateBefore[n][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};He.CellAlignmentAction.prototype.redo=function(t,e){ul(this.range,this.type,this.alignment,(r,n)=>t.getCellMeta(r,n),(r,n,i,s)=>t.setCellMeta(r,n,i,s)),t.addHookOnce("afterViewRender",e),t.render()};He.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"};Vs(He.FiltersAction,He.Action);He.FiltersAction.prototype.undo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&r.conditionCollection.importAllConditions(this.previousConditionsStack),r.filter()};He.FiltersAction.prototype.redo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};class Rge extends He.Action{constructor(e,r){super(),this.cellRange=r;const n=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(n.row,n.col,i.row,i.col)}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}He.MergeCellsAction=Rge;class Ege extends He.Action{constructor(e,r){super(),this.cellRange=r}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}He.UnmergeCellsAction=Ege;He.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Vs(He.RowMoveAction,He.Action);He.RowMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),UM(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:a}=i;s<a&&(a-=1),r.moveRow(a,s)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};He.RowMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};He.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Vs(He.ColumnMoveAction,He.Action);He.ColumnMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),UM(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:a}=i;s<a&&(a-=1),r.moveColumn(a,s)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};He.ColumnMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),r.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};He.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};Vs(He.ColumnSortAction,He.Action);He.ColumnSortAction.prototype.undo=function(t,e){const r=t.getPlugin("columnSorting"),n=t.getPlugin("multiColumnSorting"),i=n.isEnabled()?n:r;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()};He.ColumnSortAction.prototype.redo=function(t,e){const r=t.getPlugin("columnSorting"),n=t.getPlugin("multiColumnSorting");(n.isEnabled()?n:r).sort(this.nextSortState),e()};He.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};He.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:i=>!i.altKey,group:sz};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)};He.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(sz)};function oz(t,e){const r=this;if(e==="loadData")return r.undoRedo.clear()}function _ge(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Tge(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const bm=ze.getSingleton();bm.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});bm.register("beforeUndo");bm.register("afterUndo");bm.register("beforeRedo");bm.register("afterRedo");He.PLUGIN_KEY=Sge;He.SETTING_KEYS=!0;function xge(){It(hg),It(Ete),It(cg),It(nre),It(cre),It(xV),It(sne),It(zne),It(rC),It(ese),It(Tse),It(Nse),It(sC),It(loe),It(sle),It(Lle),It(hue),It(Sue),It(Nue),It(jue),It(the),It(yhe),It(Mhe),It(cce),It(Uce),It(Kce),It(bde),It(afe),It(Ofe),It(Wfe),It(Jfe),It(lge),It(yge),It(He)}function Mge(){qQ(),vee(),Tee(),Yee(),xge()}function Ige(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(r){const n=this.first();let i=n.data("handsontable");if(typeof r!="string"){const c=r||{};return i?i.updateSettings(c):(i=new t.Core(n[0],c),n.data("handsontable",i),i.init()),n}let s;if(i)if(typeof i[r]<"u"){for(var a=arguments.length,u=new Array(a>1?a-1:0),h=1;h<a;h++)u[h-1]=arguments[h];s=i[r].call(i,...u),r==="destroy"&&n.removeData()}else throw new Error(`Handsontable do not provide action: ${r}`);return s})}var YE,GE,qE,KE,XE;Mge();Ige(lt);lt.__GhostTable=IM;lt._getListenersCounter=g6;lt._getRegisteredMapsCounter=pX;lt.EventManager=ns;const Oge=[qq,zK,tX,yee,BK,DK,Qq,k6,WK,eK,YK,N6],Pge=[AK,GK];lt.helper={};lt.dom={};te(Oge,t=>{te(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(lt.helper[e]=t[e])})});te(Pge,t=>{te(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(lt.dom[e]=t[e])})});lt.cellTypes=(YE=lt.cellTypes)!==null&&YE!==void 0?YE:{};te(b7(),t=>{lt.cellTypes[t]=aM(t)});lt.cellTypes.registerCellType=ji;lt.cellTypes.getCellType=aM;lt.editors=(GE=lt.editors)!==null&&GE!==void 0?GE:{};te(l6(),t=>{lt.editors[`${Bn(t)}Editor`]=yw(t)});lt.editors.registerEditor=mi;lt.editors.getEditor=yw;lt.renderers=(qE=lt.renderers)!==null&&qE!==void 0?qE:{};te(X6(),t=>{const e=Cw(t);t==="base"&&(lt.renderers.cellDecorator=e),lt.renderers[`${Bn(t)}Renderer`]=e});lt.renderers.registerRenderer=Pi;lt.renderers.getRenderer=Cw;lt.validators=(KE=lt.validators)!==null&&KE!==void 0?KE:{};te(J6(),t=>{lt.validators[`${Bn(t)}Validator`]=d1(t)});lt.validators.registerValidator=$u;lt.validators.getValidator=d1;lt.plugins=(XE=lt.plugins)!==null&&XE!==void 0?XE:{};te(c1(),t=>{lt.plugins[t]=om(t)});lt.plugins[`${Bn(Pt.PLUGIN_KEY)}Plugin`]=Pt;lt.plugins.registerPlugin=It;lt.plugins.getPlugin=om;function Wv(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ZE={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var _F;function Gge(){return _F||(_F=1,function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,s){function a(c,m){if(!i[c]){if(!n[c]){var p=typeof Wv=="function"&&Wv;if(!m&&p)return p(c,!0);if(u)return u(c,!0);var v=new Error("Cannot find module '"+c+"'");throw v.code="MODULE_NOT_FOUND",v}var y=i[c]={exports:{}};n[c][0].call(y.exports,function(C){var R=n[c][1][C];return a(R||C)},y,y.exports,r,n,i,s)}return i[c].exports}for(var u=typeof Wv=="function"&&Wv,h=0;h<s.length;h++)a(s[h]);return a}({1:[function(r,n,i){var s=r("./utils"),a=r("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(h){for(var c,m,p,v,y,C,R,_=[],x=0,I=h.length,k=I,W=s.getTypeOf(h)!=="string";x<h.length;)k=I-x,p=W?(c=h[x++],m=x<I?h[x++]:0,x<I?h[x++]:0):(c=h.charCodeAt(x++),m=x<I?h.charCodeAt(x++):0,x<I?h.charCodeAt(x++):0),v=c>>2,y=(3&c)<<4|m>>4,C=1<k?(15&m)<<2|p>>6:64,R=2<k?63&p:64,_.push(u.charAt(v)+u.charAt(y)+u.charAt(C)+u.charAt(R));return _.join("")},i.decode=function(h){var c,m,p,v,y,C,R=0,_=0,x="data:";if(h.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var I,k=3*(h=h.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(h.charAt(h.length-1)===u.charAt(64)&&k--,h.charAt(h.length-2)===u.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(I=a.uint8array?new Uint8Array(0|k):new Array(0|k);R<h.length;)c=u.indexOf(h.charAt(R++))<<2|(v=u.indexOf(h.charAt(R++)))>>4,m=(15&v)<<4|(y=u.indexOf(h.charAt(R++)))>>2,p=(3&y)<<6|(C=u.indexOf(h.charAt(R++))),I[_++]=c,y!==64&&(I[_++]=m),C!==64&&(I[_++]=p);return I}},{"./support":30,"./utils":32}],2:[function(r,n,i){var s=r("./external"),a=r("./stream/DataWorker"),u=r("./stream/Crc32Probe"),h=r("./stream/DataLengthProbe");function c(m,p,v,y,C){this.compressedSize=m,this.uncompressedSize=p,this.crc32=v,this.compression=y,this.compressedContent=C}c.prototype={getContentWorker:function(){var m=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new h("data_length")),p=this;return m.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(m,p,v){return m.pipe(new u).pipe(new h("uncompressedSize")).pipe(p.compressWorker(v)).pipe(new h("compressedSize")).withStreamInfo("compression",p)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var s=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var s=r("./utils"),a=function(){for(var u,h=[],c=0;c<256;c++){u=c;for(var m=0;m<8;m++)u=1&u?3988292384^u>>>1:u>>>1;h[c]=u}return h}();n.exports=function(u,h){return u!==void 0&&u.length?s.getTypeOf(u)!=="string"?function(c,m,p,v){var y=a,C=v+p;c^=-1;for(var R=v;R<C;R++)c=c>>>8^y[255&(c^m[R])];return-1^c}(0|h,u,u.length,0):function(c,m,p,v){var y=a,C=v+p;c^=-1;for(var R=v;R<C;R++)c=c>>>8^y[255&(c^m.charCodeAt(R))];return-1^c}(0|h,u,u.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var s=null;s=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:s}},{lie:37}],7:[function(r,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=r("pako"),u=r("./utils"),h=r("./stream/GenericWorker"),c=s?"uint8array":"array";function m(p,v){h.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=v,this.meta={}}i.magic="\b\0",u.inherits(m,h),m.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(c,p.data),!1)},m.prototype.flush=function(){h.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(v){p.push({data:v,meta:p.meta})}},i.compressWorker=function(p){return new m("Deflate",p)},i.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function s(y,C){var R,_="";for(R=0;R<C;R++)_+=String.fromCharCode(255&y),y>>>=8;return _}function a(y,C,R,_,x,I){var k,W,B=y.file,z=y.compression,U=I!==c.utf8encode,J=u.transformTo("string",I(B.name)),se=u.transformTo("string",c.utf8encode(B.name)),ne=B.comment,fe=u.transformTo("string",I(ne)),j=u.transformTo("string",c.utf8encode(ne)),ae=se.length!==B.name.length,P=j.length!==ne.length,ie="",Le="",me="",Ae=B.dir,ve=B.date,Be={crc32:0,compressedSize:0,uncompressedSize:0};C&&!R||(Be.crc32=y.crc32,Be.compressedSize=y.compressedSize,Be.uncompressedSize=y.uncompressedSize);var E=0;C&&(E|=8),U||!ae&&!P||(E|=2048);var M=0,D=0;Ae&&(M|=16),x==="UNIX"?(D=798,M|=function(X,ce){var we=X;return X||(we=ce?16893:33204),(65535&we)<<16}(B.unixPermissions,Ae)):(D=20,M|=function(X){return 63&(X||0)}(B.dosPermissions)),k=ve.getUTCHours(),k<<=6,k|=ve.getUTCMinutes(),k<<=5,k|=ve.getUTCSeconds()/2,W=ve.getUTCFullYear()-1980,W<<=4,W|=ve.getUTCMonth()+1,W<<=5,W|=ve.getUTCDate(),ae&&(Le=s(1,1)+s(m(J),4)+se,ie+="up"+s(Le.length,2)+Le),P&&(me=s(1,1)+s(m(fe),4)+j,ie+="uc"+s(me.length,2)+me);var $="";return $+=`
\0`,$+=s(E,2),$+=z.magic,$+=s(k,2),$+=s(W,2),$+=s(Be.crc32,4),$+=s(Be.compressedSize,4),$+=s(Be.uncompressedSize,4),$+=s(J.length,2),$+=s(ie.length,2),{fileRecord:p.LOCAL_FILE_HEADER+$+J+ie,dirRecord:p.CENTRAL_FILE_HEADER+s(D,2)+$+s(fe.length,2)+"\0\0\0\0"+s(M,4)+s(_,4)+J+ie+fe}}var u=r("../utils"),h=r("../stream/GenericWorker"),c=r("../utf8"),m=r("../crc32"),p=r("../signature");function v(y,C,R,_){h.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=C,this.zipPlatform=R,this.encodeFileName=_,this.streamFiles=y,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(v,h),v.prototype.push=function(y){var C=y.meta.percent||0,R=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(y):(this.bytesWritten+=y.data.length,h.prototype.push.call(this,{data:y.data,meta:{currentFile:this.currentFile,percent:R?(C+100*(R-_-1))/R:100}}))},v.prototype.openedSource=function(y){this.currentSourceOffset=this.bytesWritten,this.currentFile=y.file.name;var C=this.streamFiles&&!y.file.dir;if(C){var R=a(y,C,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:R.fileRecord,meta:{percent:0}})}else this.accumulate=!0},v.prototype.closedSource=function(y){this.accumulate=!1;var C=this.streamFiles&&!y.file.dir,R=a(y,C,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(R.dirRecord),C)this.push({data:function(_){return p.DATA_DESCRIPTOR+s(_.crc32,4)+s(_.compressedSize,4)+s(_.uncompressedSize,4)}(y),meta:{percent:100}});else for(this.push({data:R.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},v.prototype.flush=function(){for(var y=this.bytesWritten,C=0;C<this.dirRecords.length;C++)this.push({data:this.dirRecords[C],meta:{percent:100}});var R=this.bytesWritten-y,_=function(x,I,k,W,B){var z=u.transformTo("string",B(W));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(x,2)+s(x,2)+s(I,4)+s(k,4)+s(z.length,2)+z}(this.dirRecords.length,R,y,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},v.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},v.prototype.registerPrevious=function(y){this._sources.push(y);var C=this;return y.on("data",function(R){C.processChunk(R)}),y.on("end",function(){C.closedSource(C.previous.streamInfo),C._sources.length?C.prepareNextSource():C.end()}),y.on("error",function(R){C.error(R)}),this},v.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},v.prototype.error=function(y){var C=this._sources;if(!h.prototype.error.call(this,y))return!1;for(var R=0;R<C.length;R++)try{C[R].error(y)}catch{}return!0},v.prototype.lock=function(){h.prototype.lock.call(this);for(var y=this._sources,C=0;C<y.length;C++)y[C].lock()},n.exports=v},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var s=r("../compressions"),a=r("./ZipFileWorker");i.generateWorker=function(u,h,c){var m=new a(h.streamFiles,c,h.platform,h.encodeFileName),p=0;try{u.forEach(function(v,y){p++;var C=function(I,k){var W=I||k,B=s[W];if(!B)throw new Error(W+" is not a valid compression method !");return B}(y.options.compression,h.compression),R=y.options.compressionOptions||h.compressionOptions||{},_=y.dir,x=y.date;y._compressWorker(C,R).withStreamInfo("file",{name:v,dir:_,date:x,comment:y.comment||"",unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions}).pipe(m)}),m.entriesCount=p}catch(v){m.error(v)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var u in this)typeof this[u]!="function"&&(a[u]=this[u]);return a}}(s.prototype=r("./object")).loadAsync=r("./load"),s.support=r("./support"),s.defaults=r("./defaults"),s.version="3.10.1",s.loadAsync=function(a,u){return new s().loadAsync(a,u)},s.external=r("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var s=r("./utils"),a=r("./external"),u=r("./utf8"),h=r("./zipEntries"),c=r("./stream/Crc32Probe"),m=r("./nodejsUtils");function p(v){return new a.Promise(function(y,C){var R=v.decompressed.getContentWorker().pipe(new c);R.on("error",function(_){C(_)}).on("end",function(){R.streamInfo.crc32!==v.decompressed.crc32?C(new Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}n.exports=function(v,y){var C=this;return y=s.extend(y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),m.isNode&&m.isStream(v)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",v,!0,y.optimizedBinaryString,y.base64).then(function(R){var _=new h(y);return _.load(R),_}).then(function(R){var _=[a.Promise.resolve(R)],x=R.files;if(y.checkCRC32)for(var I=0;I<x.length;I++)_.push(p(x[I]));return a.Promise.all(_)}).then(function(R){for(var _=R.shift(),x=_.files,I=0;I<x.length;I++){var k=x[I],W=k.fileNameStr,B=s.resolve(k.fileNameStr);C.file(B,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:y.createFolders}),k.dir||(C.file(B).unsafeOriginalName=W)}return _.zipComment.length&&(C.comment=_.zipComment),C})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var s=r("../utils"),a=r("../stream/GenericWorker");function u(h,c){a.call(this,"Nodejs stream input adapter for "+h),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(u,a),u.prototype._bindStream=function(h){var c=this;(this._stream=h).pause(),h.on("data",function(m){c.push({data:m,meta:{percent:0}})}).on("error",function(m){c.isPaused?this.generatedError=m:c.error(m)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},u.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var s=r("readable-stream").Readable;function a(u,h,c){s.call(this,h),this._helper=u;var m=this;u.on("data",function(p,v){m.push(p)||m._helper.pause(),c&&c(v)}).on("error",function(p){m.emit("error",p)}).on("end",function(){m.push(null)})}r("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(r,n,i){function s(B,z,U){var J,se=u.getTypeOf(z),ne=u.extend(U||{},m);ne.date=ne.date||new Date,ne.compression!==null&&(ne.compression=ne.compression.toUpperCase()),typeof ne.unixPermissions=="string"&&(ne.unixPermissions=parseInt(ne.unixPermissions,8)),ne.unixPermissions&&16384&ne.unixPermissions&&(ne.dir=!0),ne.dosPermissions&&16&ne.dosPermissions&&(ne.dir=!0),ne.dir&&(B=x(B)),ne.createFolders&&(J=_(B))&&I.call(this,J,!0);var fe=se==="string"&&ne.binary===!1&&ne.base64===!1;U&&U.binary!==void 0||(ne.binary=!fe),(z instanceof p&&z.uncompressedSize===0||ne.dir||!z||z.length===0)&&(ne.base64=!1,ne.binary=!0,z="",ne.compression="STORE",se="string");var j=null;j=z instanceof p||z instanceof h?z:C.isNode&&C.isStream(z)?new R(B,z):u.prepareContent(B,z,ne.binary,ne.optimizedBinaryString,ne.base64);var ae=new v(B,j,ne);this.files[B]=ae}var a=r("./utf8"),u=r("./utils"),h=r("./stream/GenericWorker"),c=r("./stream/StreamHelper"),m=r("./defaults"),p=r("./compressedObject"),v=r("./zipObject"),y=r("./generate"),C=r("./nodejsUtils"),R=r("./nodejs/NodejsStreamInputAdapter"),_=function(B){B.slice(-1)==="/"&&(B=B.substring(0,B.length-1));var z=B.lastIndexOf("/");return 0<z?B.substring(0,z):""},x=function(B){return B.slice(-1)!=="/"&&(B+="/"),B},I=function(B,z){return z=z!==void 0?z:m.createFolders,B=x(B),this.files[B]||s.call(this,B,null,{dir:!0,createFolders:z}),this.files[B]};function k(B){return Object.prototype.toString.call(B)==="[object RegExp]"}var W={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(B){var z,U,J;for(z in this.files)J=this.files[z],(U=z.slice(this.root.length,z.length))&&z.slice(0,this.root.length)===this.root&&B(U,J)},filter:function(B){var z=[];return this.forEach(function(U,J){B(U,J)&&z.push(J)}),z},file:function(B,z,U){if(arguments.length!==1)return B=this.root+B,s.call(this,B,z,U),this;if(k(B)){var J=B;return this.filter(function(ne,fe){return!fe.dir&&J.test(ne)})}var se=this.files[this.root+B];return se&&!se.dir?se:null},folder:function(B){if(!B)return this;if(k(B))return this.filter(function(se,ne){return ne.dir&&B.test(se)});var z=this.root+B,U=I.call(this,z),J=this.clone();return J.root=U.name,J},remove:function(B){B=this.root+B;var z=this.files[B];if(z||(B.slice(-1)!=="/"&&(B+="/"),z=this.files[B]),z&&!z.dir)delete this.files[B];else for(var U=this.filter(function(se,ne){return ne.name.slice(0,B.length)===B}),J=0;J<U.length;J++)delete this.files[U[J].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(B){var z,U={};try{if((U=u.extend(B||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=U.type.toLowerCase(),U.compression=U.compression.toUpperCase(),U.type==="binarystring"&&(U.type="string"),!U.type)throw new Error("No output type specified.");u.checkSupport(U.type),U.platform!=="darwin"&&U.platform!=="freebsd"&&U.platform!=="linux"&&U.platform!=="sunos"||(U.platform="UNIX"),U.platform==="win32"&&(U.platform="DOS");var J=U.comment||this.comment||"";z=y.generateWorker(this,U,J)}catch(se){(z=new h("error")).error(se)}return new c(z,U.type||"string",U.mimeType)},generateAsync:function(B,z){return this.generateInternalStream(B).accumulate(z)},generateNodeStream:function(B,z){return(B=B||{}).type||(B.type="nodebuffer"),this.generateInternalStream(B).toNodejsStream(z)}};n.exports=W},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var s=r("./DataReader");function a(u){s.call(this,u);for(var h=0;h<this.data.length;h++)u[h]=255&u[h]}r("../utils").inherits(a,s),a.prototype.byteAt=function(u){return this.data[this.zero+u]},a.prototype.lastIndexOfSignature=function(u){for(var h=u.charCodeAt(0),c=u.charCodeAt(1),m=u.charCodeAt(2),p=u.charCodeAt(3),v=this.length-4;0<=v;--v)if(this.data[v]===h&&this.data[v+1]===c&&this.data[v+2]===m&&this.data[v+3]===p)return v-this.zero;return-1},a.prototype.readAndCheckSignature=function(u){var h=u.charCodeAt(0),c=u.charCodeAt(1),m=u.charCodeAt(2),p=u.charCodeAt(3),v=this.readData(4);return h===v[0]&&c===v[1]&&m===v[2]&&p===v[3]},a.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var h=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,h},n.exports=a},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var s=r("../utils");function a(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var h,c=0;for(this.checkOffset(u),h=this.index+u-1;h>=this.index;h--)c=(c<<8)+this.byteAt(h);return this.index+=u,c},readString:function(u){return s.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},n.exports=a},{"../utils":32}],19:[function(r,n,i){var s=r("./Uint8ArrayReader");function a(u){s.call(this,u)}r("../utils").inherits(a,s),a.prototype.readData=function(u){this.checkOffset(u);var h=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,h},n.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var s=r("./DataReader");function a(u){s.call(this,u)}r("../utils").inherits(a,s),a.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},a.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},a.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},a.prototype.readData=function(u){this.checkOffset(u);var h=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,h},n.exports=a},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var s=r("./ArrayReader");function a(u){s.call(this,u)}r("../utils").inherits(a,s),a.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var h=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,h},n.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var s=r("../utils"),a=r("../support"),u=r("./ArrayReader"),h=r("./StringReader"),c=r("./NodeBufferReader"),m=r("./Uint8ArrayReader");n.exports=function(p){var v=s.getTypeOf(p);return s.checkSupport(v),v!=="string"||a.uint8array?v==="nodebuffer"?new c(p):a.uint8array?new m(s.transformTo("uint8array",p)):new u(s.transformTo("array",p)):new h(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var s=r("./GenericWorker"),a=r("../utils");function u(h){s.call(this,"ConvertWorker to "+h),this.destType=h}a.inherits(u,s),u.prototype.processChunk=function(h){this.push({data:a.transformTo(this.destType,h.data),meta:h.meta})},n.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var s=r("./GenericWorker"),a=r("../crc32");function u(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(u,s),u.prototype.processChunk=function(h){this.streamInfo.crc32=a(h.data,this.streamInfo.crc32||0),this.push(h)},n.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var s=r("../utils"),a=r("./GenericWorker");function u(h){a.call(this,"DataLengthProbe for "+h),this.propName=h,this.withStreamInfo(h,0)}s.inherits(u,a),u.prototype.processChunk=function(h){if(h){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+h.data.length}a.prototype.processChunk.call(this,h)},n.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var s=r("../utils"),a=r("./GenericWorker");function u(h){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,h.then(function(m){c.dataIsReady=!0,c.data=m,c.max=m&&m.length||0,c.type=s.getTypeOf(m),c.isPaused||c._tickAndRepeat()},function(m){c.error(m)})}s.inherits(u,a),u.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var h=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":h=this.data.substring(this.index,c);break;case"uint8array":h=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":h=this.data.slice(this.index,c)}return this.index=c,this.push({data:h,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,u){return this._listeners[a].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,u){if(this._listeners[a])for(var h=0;h<this._listeners[a].length;h++)this._listeners[a][h].call(this,u)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var u=this;return a.on("data",function(h){u.processChunk(h)}),a.on("end",function(){u.end()}),a.on("error",function(h){u.error(h)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,u){return this.extraStreamInfo[a]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=s},{}],29:[function(r,n,i){var s=r("../utils"),a=r("./ConvertWorker"),u=r("./GenericWorker"),h=r("../base64"),c=r("../support"),m=r("../external"),p=null;if(c.nodestream)try{p=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(C,R){return new m.Promise(function(_,x){var I=[],k=C._internalType,W=C._outputType,B=C._mimeType;C.on("data",function(z,U){I.push(z),R&&R(U)}).on("error",function(z){I=[],x(z)}).on("end",function(){try{var z=function(U,J,se){switch(U){case"blob":return s.newBlob(s.transformTo("arraybuffer",J),se);case"base64":return h.encode(J);default:return s.transformTo(U,J)}}(W,function(U,J){var se,ne=0,fe=null,j=0;for(se=0;se<J.length;se++)j+=J[se].length;switch(U){case"string":return J.join("");case"array":return Array.prototype.concat.apply([],J);case"uint8array":for(fe=new Uint8Array(j),se=0;se<J.length;se++)fe.set(J[se],ne),ne+=J[se].length;return fe;case"nodebuffer":return Buffer.concat(J);default:throw new Error("concat : unsupported type '"+U+"'")}}(k,I),B);_(z)}catch(U){x(U)}I=[]}).resume()})}function y(C,R,_){var x=R;switch(R){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=R,this._mimeType=_,s.checkSupport(x),this._worker=C.pipe(new a(x)),C.lock()}catch(I){this._worker=new u("error"),this._worker.error(I)}}y.prototype={accumulate:function(C){return v(this,C)},on:function(C,R){var _=this;return C==="data"?this._worker.on(C,function(x){R.call(_,x.data,x.meta)}):this._worker.on(C,function(){s.delay(R,arguments,_)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(C){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},C)}},n.exports=y},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var s=r("./utils"),a=r("./support"),u=r("./nodejsUtils"),h=r("./stream/GenericWorker"),c=new Array(256),m=0;m<256;m++)c[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;c[254]=c[254]=1;function p(){h.call(this,"utf-8 decode"),this.leftOver=null}function v(){h.call(this,"utf-8 encode")}i.utf8encode=function(y){return a.nodebuffer?u.newBufferFrom(y,"utf-8"):function(C){var R,_,x,I,k,W=C.length,B=0;for(I=0;I<W;I++)(64512&(_=C.charCodeAt(I)))==55296&&I+1<W&&(64512&(x=C.charCodeAt(I+1)))==56320&&(_=65536+(_-55296<<10)+(x-56320),I++),B+=_<128?1:_<2048?2:_<65536?3:4;for(R=a.uint8array?new Uint8Array(B):new Array(B),I=k=0;k<B;I++)(64512&(_=C.charCodeAt(I)))==55296&&I+1<W&&(64512&(x=C.charCodeAt(I+1)))==56320&&(_=65536+(_-55296<<10)+(x-56320),I++),_<128?R[k++]=_:(_<2048?R[k++]=192|_>>>6:(_<65536?R[k++]=224|_>>>12:(R[k++]=240|_>>>18,R[k++]=128|_>>>12&63),R[k++]=128|_>>>6&63),R[k++]=128|63&_);return R}(y)},i.utf8decode=function(y){return a.nodebuffer?s.transformTo("nodebuffer",y).toString("utf-8"):function(C){var R,_,x,I,k=C.length,W=new Array(2*k);for(R=_=0;R<k;)if((x=C[R++])<128)W[_++]=x;else if(4<(I=c[x]))W[_++]=65533,R+=I-1;else{for(x&=I===2?31:I===3?15:7;1<I&&R<k;)x=x<<6|63&C[R++],I--;1<I?W[_++]=65533:x<65536?W[_++]=x:(x-=65536,W[_++]=55296|x>>10&1023,W[_++]=56320|1023&x)}return W.length!==_&&(W.subarray?W=W.subarray(0,_):W.length=_),s.applyFromCharCode(W)}(y=s.transformTo(a.uint8array?"uint8array":"array",y))},s.inherits(p,h),p.prototype.processChunk=function(y){var C=s.transformTo(a.uint8array?"uint8array":"array",y.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var R=C;(C=new Uint8Array(R.length+this.leftOver.length)).set(this.leftOver,0),C.set(R,this.leftOver.length)}else C=this.leftOver.concat(C);this.leftOver=null}var _=function(I,k){var W;for((k=k||I.length)>I.length&&(k=I.length),W=k-1;0<=W&&(192&I[W])==128;)W--;return W<0||W===0?k:W+c[I[W]]>k?W:k}(C),x=C;_!==C.length&&(a.uint8array?(x=C.subarray(0,_),this.leftOver=C.subarray(_,C.length)):(x=C.slice(0,_),this.leftOver=C.slice(_,C.length))),this.push({data:i.utf8decode(x),meta:y.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=p,s.inherits(v,h),v.prototype.processChunk=function(y){this.push({data:i.utf8encode(y.data),meta:y.meta})},i.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var s=r("./support"),a=r("./base64"),u=r("./nodejsUtils"),h=r("./external");function c(R){return R}function m(R,_){for(var x=0;x<R.length;++x)_[x]=255&R.charCodeAt(x);return _}r("setimmediate"),i.newBlob=function(R,_){i.checkSupport("blob");try{return new Blob([R],{type:_})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(R),x.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(R,_,x){var I=[],k=0,W=R.length;if(W<=x)return String.fromCharCode.apply(null,R);for(;k<W;)_==="array"||_==="nodebuffer"?I.push(String.fromCharCode.apply(null,R.slice(k,Math.min(k+x,W)))):I.push(String.fromCharCode.apply(null,R.subarray(k,Math.min(k+x,W)))),k+=x;return I.join("")},stringifyByChar:function(R){for(var _="",x=0;x<R.length;x++)_+=String.fromCharCode(R[x]);return _},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}}()}};function v(R){var _=65536,x=i.getTypeOf(R),I=!0;if(x==="uint8array"?I=p.applyCanBeUsed.uint8array:x==="nodebuffer"&&(I=p.applyCanBeUsed.nodebuffer),I)for(;1<_;)try{return p.stringifyByChunk(R,x,_)}catch{_=Math.floor(_/2)}return p.stringifyByChar(R)}function y(R,_){for(var x=0;x<R.length;x++)_[x]=R[x];return _}i.applyFromCharCode=v;var C={};C.string={string:c,array:function(R){return m(R,new Array(R.length))},arraybuffer:function(R){return C.string.uint8array(R).buffer},uint8array:function(R){return m(R,new Uint8Array(R.length))},nodebuffer:function(R){return m(R,u.allocBuffer(R.length))}},C.array={string:v,array:c,arraybuffer:function(R){return new Uint8Array(R).buffer},uint8array:function(R){return new Uint8Array(R)},nodebuffer:function(R){return u.newBufferFrom(R)}},C.arraybuffer={string:function(R){return v(new Uint8Array(R))},array:function(R){return y(new Uint8Array(R),new Array(R.byteLength))},arraybuffer:c,uint8array:function(R){return new Uint8Array(R)},nodebuffer:function(R){return u.newBufferFrom(new Uint8Array(R))}},C.uint8array={string:v,array:function(R){return y(R,new Array(R.length))},arraybuffer:function(R){return R.buffer},uint8array:c,nodebuffer:function(R){return u.newBufferFrom(R)}},C.nodebuffer={string:v,array:function(R){return y(R,new Array(R.length))},arraybuffer:function(R){return C.nodebuffer.uint8array(R).buffer},uint8array:function(R){return y(R,new Uint8Array(R.length))},nodebuffer:c},i.transformTo=function(R,_){if(_=_||"",!R)return _;i.checkSupport(R);var x=i.getTypeOf(_);return C[x][R](_)},i.resolve=function(R){for(var _=R.split("/"),x=[],I=0;I<_.length;I++){var k=_[I];k==="."||k===""&&I!==0&&I!==_.length-1||(k===".."?x.pop():x.push(k))}return x.join("/")},i.getTypeOf=function(R){return typeof R=="string"?"string":Object.prototype.toString.call(R)==="[object Array]"?"array":s.nodebuffer&&u.isBuffer(R)?"nodebuffer":s.uint8array&&R instanceof Uint8Array?"uint8array":s.arraybuffer&&R instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(R){if(!s[R.toLowerCase()])throw new Error(R+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(R){var _,x,I="";for(x=0;x<(R||"").length;x++)I+="\\x"+((_=R.charCodeAt(x))<16?"0":"")+_.toString(16).toUpperCase();return I},i.delay=function(R,_,x){setImmediate(function(){R.apply(x||null,_||[])})},i.inherits=function(R,_){function x(){}x.prototype=_.prototype,R.prototype=new x},i.extend=function(){var R,_,x={};for(R=0;R<arguments.length;R++)for(_ in arguments[R])Object.prototype.hasOwnProperty.call(arguments[R],_)&&x[_]===void 0&&(x[_]=arguments[R][_]);return x},i.prepareContent=function(R,_,x,I,k){return h.Promise.resolve(_).then(function(W){return s.blob&&(W instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(W))!==-1)&&typeof FileReader<"u"?new h.Promise(function(B,z){var U=new FileReader;U.onload=function(J){B(J.target.result)},U.onerror=function(J){z(J.target.error)},U.readAsArrayBuffer(W)}):W}).then(function(W){var B=i.getTypeOf(W);return B?(B==="arraybuffer"?W=i.transformTo("uint8array",W):B==="string"&&(k?W=a.decode(W):x&&I!==!0&&(W=function(z){return m(z,s.uint8array?new Uint8Array(z.length):new Array(z.length))}(W))),W):h.Promise.reject(new Error("Can't read the data of '"+R+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,i){var s=r("./reader/readerFor"),a=r("./utils"),u=r("./signature"),h=r("./zipEntry"),c=r("./support");function m(p){this.files=[],this.loadOptions=p}m.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(v)+", expected "+a.pretty(p)+")")}},isSignature:function(p,v){var y=this.reader.index;this.reader.setIndex(p);var C=this.reader.readString(4)===v;return this.reader.setIndex(y),C},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),v=c.uint8array?"uint8array":"array",y=a.transformTo(v,p);this.zipComment=this.loadOptions.decodeFileName(y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,v,y,C=this.zip64EndOfCentralSize-44;0<C;)p=this.reader.readInt(2),v=this.reader.readInt(4),y=this.reader.readData(v),this.zip64ExtensibleData[p]={id:p,length:v,value:y}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,v;for(p=0;p<this.files.length;p++)v=this.files[p],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(p=new h({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var v=p;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var y=this.centralDirOffset+this.centralDirSize;this.zip64&&(y+=20,y+=12+this.zip64EndOfCentralSize);var C=v-y;if(0<C)this.isSignature(v,u.CENTRAL_FILE_HEADER)||(this.reader.zero=C);else if(C<0)throw new Error("Corrupted zip: missing "+Math.abs(C)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var s=r("./reader/readerFor"),a=r("./utils"),u=r("./compressedObject"),h=r("./crc32"),c=r("./utf8"),m=r("./compressions"),p=r("./support");function v(y,C){this.options=y,this.loadOptions=C}v.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(y){var C,R;if(y.skip(22),this.fileNameLength=y.readInt(2),R=y.readInt(2),this.fileName=y.readData(this.fileNameLength),y.skip(R),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((C=function(_){for(var x in m)if(Object.prototype.hasOwnProperty.call(m,x)&&m[x].magic===_)return m[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,C,y.readData(this.compressedSize))},readCentralPart:function(y){this.versionMadeBy=y.readInt(2),y.skip(2),this.bitFlag=y.readInt(2),this.compressionMethod=y.readString(2),this.date=y.readDate(),this.crc32=y.readInt(4),this.compressedSize=y.readInt(4),this.uncompressedSize=y.readInt(4);var C=y.readInt(2);if(this.extraFieldsLength=y.readInt(2),this.fileCommentLength=y.readInt(2),this.diskNumberStart=y.readInt(2),this.internalFileAttributes=y.readInt(2),this.externalFileAttributes=y.readInt(4),this.localHeaderOffset=y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");y.skip(C),this.readExtraFields(y),this.parseZIP64ExtraField(y),this.fileComment=y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var y=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),y==0&&(this.dosPermissions=63&this.externalFileAttributes),y==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var y=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(y){var C,R,_,x=y.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});y.index+4<x;)C=y.readInt(2),R=y.readInt(2),_=y.readData(R),this.extraFields[C]={id:C,length:R,value:_};y.setIndex(x)},handleUTF8:function(){var y=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var C=this.findExtraFieldUnicodePath();if(C!==null)this.fileNameStr=C;else{var R=a.transformTo(y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(R)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var x=a.transformTo(y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var y=this.extraFields[28789];if(y){var C=s(y.value);return C.readInt(1)!==1||h(this.fileName)!==C.readInt(4)?null:c.utf8decode(C.readData(y.length-5))}return null},findExtraFieldUnicodeComment:function(){var y=this.extraFields[25461];if(y){var C=s(y.value);return C.readInt(1)!==1||h(this.fileComment)!==C.readInt(4)?null:c.utf8decode(C.readData(y.length-5))}return null}},n.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function s(C,R,_){this.name=C,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=R,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var a=r("./stream/StreamHelper"),u=r("./stream/DataWorker"),h=r("./utf8"),c=r("./compressedObject"),m=r("./stream/GenericWorker");s.prototype={internalStream:function(C){var R=null,_="string";try{if(!C)throw new Error("No output type specified.");var x=(_=C.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),R=this._decompressWorker();var I=!this._dataBinary;I&&!x&&(R=R.pipe(new h.Utf8EncodeWorker)),!I&&x&&(R=R.pipe(new h.Utf8DecodeWorker))}catch(k){(R=new m("error")).error(k)}return new a(R,_,"")},async:function(C,R){return this.internalStream(C).accumulate(R)},nodeStream:function(C,R){return this.internalStream(C||"nodebuffer").toNodejsStream(R)},_compressWorker:function(C,R){if(this._data instanceof c&&this._data.compression.magic===C.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new h.Utf8EncodeWorker)),c.createWorkerFrom(_,C,R)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof m?this._data:new u(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},y=0;y<p.length;y++)s.prototype[p[y]]=v;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(s){var a,u,h=s.MutationObserver||s.WebKitMutationObserver;if(h){var c=0,m=new h(C),p=s.document.createTextNode("");m.observe(p,{characterData:!0}),a=function(){p.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var R=s.document.createElement("script");R.onreadystatechange=function(){C(),R.onreadystatechange=null,R.parentNode.removeChild(R),R=null},s.document.documentElement.appendChild(R)}:function(){setTimeout(C,0)};else{var v=new s.MessageChannel;v.port1.onmessage=C,a=function(){v.port2.postMessage(0)}}var y=[];function C(){var R,_;u=!0;for(var x=y.length;x;){for(_=y,y=[],R=-1;++R<x;)_[R]();x=y.length}u=!1}n.exports=function(R){y.push(R)!==1||u||a()}}).call(this,typeof Oc<"u"?Oc:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var s=r("immediate");function a(){}var u={},h=["REJECTED"],c=["FULFILLED"],m=["PENDING"];function p(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,x!==a&&R(this,x)}function v(x,I,k){this.promise=x,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function y(x,I,k){s(function(){var W;try{W=I(k)}catch(B){return u.reject(x,B)}W===x?u.reject(x,new TypeError("Cannot resolve promise with itself")):u.resolve(x,W)})}function C(x){var I=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof I=="function")return function(){I.apply(x,arguments)}}function R(x,I){var k=!1;function W(U){k||(k=!0,u.reject(x,U))}function B(U){k||(k=!0,u.resolve(x,U))}var z=_(function(){I(B,W)});z.status==="error"&&W(z.value)}function _(x,I){var k={};try{k.value=x(I),k.status="success"}catch(W){k.status="error",k.value=W}return k}(n.exports=p).prototype.finally=function(x){if(typeof x!="function")return this;var I=this.constructor;return this.then(function(k){return I.resolve(x()).then(function(){return k})},function(k){return I.resolve(x()).then(function(){throw k})})},p.prototype.catch=function(x){return this.then(null,x)},p.prototype.then=function(x,I){if(typeof x!="function"&&this.state===c||typeof I!="function"&&this.state===h)return this;var k=new this.constructor(a);return this.state!==m?y(k,this.state===c?x:I,this.outcome):this.queue.push(new v(k,x,I)),k},v.prototype.callFulfilled=function(x){u.resolve(this.promise,x)},v.prototype.otherCallFulfilled=function(x){y(this.promise,this.onFulfilled,x)},v.prototype.callRejected=function(x){u.reject(this.promise,x)},v.prototype.otherCallRejected=function(x){y(this.promise,this.onRejected,x)},u.resolve=function(x,I){var k=_(C,I);if(k.status==="error")return u.reject(x,k.value);var W=k.value;if(W)R(x,W);else{x.state=c,x.outcome=I;for(var B=-1,z=x.queue.length;++B<z;)x.queue[B].callFulfilled(I)}return x},u.reject=function(x,I){x.state=h,x.outcome=I;for(var k=-1,W=x.queue.length;++k<W;)x.queue[k].callRejected(I);return x},p.resolve=function(x){return x instanceof this?x:u.resolve(new this(a),x)},p.reject=function(x){var I=new this(a);return u.reject(I,x)},p.all=function(x){var I=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=x.length,W=!1;if(!k)return this.resolve([]);for(var B=new Array(k),z=0,U=-1,J=new this(a);++U<k;)se(x[U],U);return J;function se(ne,fe){I.resolve(ne).then(function(j){B[fe]=j,++z!==k||W||(W=!0,u.resolve(J,B))},function(j){W||(W=!0,u.reject(J,j))})}},p.race=function(x){var I=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=x.length,W=!1;if(!k)return this.resolve([]);for(var B=-1,z=new this(a);++B<k;)U=x[B],I.resolve(U).then(function(J){W||(W=!0,u.resolve(z,J))},function(J){W||(W=!0,u.reject(z,J))});var U;return z}},{immediate:36}],38:[function(r,n,i){var s={};(0,r("./lib/utils/common").assign)(s,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var s=r("./zlib/deflate"),a=r("./utils/common"),u=r("./utils/strings"),h=r("./zlib/messages"),c=r("./zlib/zstream"),m=Object.prototype.toString,p=0,v=-1,y=0,C=8;function R(x){if(!(this instanceof R))return new R(x);this.options=a.assign({level:v,method:C,chunkSize:16384,windowBits:15,memLevel:8,strategy:y,to:""},x||{});var I=this.options;I.raw&&0<I.windowBits?I.windowBits=-I.windowBits:I.gzip&&0<I.windowBits&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var k=s.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(k!==p)throw new Error(h[k]);if(I.header&&s.deflateSetHeader(this.strm,I.header),I.dictionary){var W;if(W=typeof I.dictionary=="string"?u.string2buf(I.dictionary):m.call(I.dictionary)==="[object ArrayBuffer]"?new Uint8Array(I.dictionary):I.dictionary,(k=s.deflateSetDictionary(this.strm,W))!==p)throw new Error(h[k]);this._dict_set=!0}}function _(x,I){var k=new R(I);if(k.push(x,!0),k.err)throw k.msg||h[k.err];return k.result}R.prototype.push=function(x,I){var k,W,B=this.strm,z=this.options.chunkSize;if(this.ended)return!1;W=I===~~I?I:I===!0?4:0,typeof x=="string"?B.input=u.string2buf(x):m.call(x)==="[object ArrayBuffer]"?B.input=new Uint8Array(x):B.input=x,B.next_in=0,B.avail_in=B.input.length;do{if(B.avail_out===0&&(B.output=new a.Buf8(z),B.next_out=0,B.avail_out=z),(k=s.deflate(B,W))!==1&&k!==p)return this.onEnd(k),!(this.ended=!0);B.avail_out!==0&&(B.avail_in!==0||W!==4&&W!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(a.shrinkBuf(B.output,B.next_out))):this.onData(a.shrinkBuf(B.output,B.next_out)))}while((0<B.avail_in||B.avail_out===0)&&k!==1);return W===4?(k=s.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===p):W!==2||(this.onEnd(p),!(B.avail_out=0))},R.prototype.onData=function(x){this.chunks.push(x)},R.prototype.onEnd=function(x){x===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},i.Deflate=R,i.deflate=_,i.deflateRaw=function(x,I){return(I=I||{}).raw=!0,_(x,I)},i.gzip=function(x,I){return(I=I||{}).gzip=!0,_(x,I)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var s=r("./zlib/inflate"),a=r("./utils/common"),u=r("./utils/strings"),h=r("./zlib/constants"),c=r("./zlib/messages"),m=r("./zlib/zstream"),p=r("./zlib/gzheader"),v=Object.prototype.toString;function y(R){if(!(this instanceof y))return new y(R);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},R||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||R&&R.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&!(15&_.windowBits)&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var x=s.inflateInit2(this.strm,_.windowBits);if(x!==h.Z_OK)throw new Error(c[x]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function C(R,_){var x=new y(_);if(x.push(R,!0),x.err)throw x.msg||c[x.err];return x.result}y.prototype.push=function(R,_){var x,I,k,W,B,z,U=this.strm,J=this.options.chunkSize,se=this.options.dictionary,ne=!1;if(this.ended)return!1;I=_===~~_?_:_===!0?h.Z_FINISH:h.Z_NO_FLUSH,typeof R=="string"?U.input=u.binstring2buf(R):v.call(R)==="[object ArrayBuffer]"?U.input=new Uint8Array(R):U.input=R,U.next_in=0,U.avail_in=U.input.length;do{if(U.avail_out===0&&(U.output=new a.Buf8(J),U.next_out=0,U.avail_out=J),(x=s.inflate(U,h.Z_NO_FLUSH))===h.Z_NEED_DICT&&se&&(z=typeof se=="string"?u.string2buf(se):v.call(se)==="[object ArrayBuffer]"?new Uint8Array(se):se,x=s.inflateSetDictionary(this.strm,z)),x===h.Z_BUF_ERROR&&ne===!0&&(x=h.Z_OK,ne=!1),x!==h.Z_STREAM_END&&x!==h.Z_OK)return this.onEnd(x),!(this.ended=!0);U.next_out&&(U.avail_out!==0&&x!==h.Z_STREAM_END&&(U.avail_in!==0||I!==h.Z_FINISH&&I!==h.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=u.utf8border(U.output,U.next_out),W=U.next_out-k,B=u.buf2string(U.output,k),U.next_out=W,U.avail_out=J-W,W&&a.arraySet(U.output,U.output,k,W,0),this.onData(B)):this.onData(a.shrinkBuf(U.output,U.next_out)))),U.avail_in===0&&U.avail_out===0&&(ne=!0)}while((0<U.avail_in||U.avail_out===0)&&x!==h.Z_STREAM_END);return x===h.Z_STREAM_END&&(I=h.Z_FINISH),I===h.Z_FINISH?(x=s.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===h.Z_OK):I!==h.Z_SYNC_FLUSH||(this.onEnd(h.Z_OK),!(U.avail_out=0))},y.prototype.onData=function(R){this.chunks.push(R)},y.prototype.onEnd=function(R){R===h.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=R,this.msg=this.strm.msg},i.Inflate=y,i.inflate=C,i.inflateRaw=function(R,_){return(_=_||{}).raw=!0,C(R,_)},i.ungzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(h){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var m=c.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var p in m)m.hasOwnProperty(p)&&(h[p]=m[p])}}return h},i.shrinkBuf=function(h,c){return h.length===c?h:h.subarray?h.subarray(0,c):(h.length=c,h)};var a={arraySet:function(h,c,m,p,v){if(c.subarray&&h.subarray)h.set(c.subarray(m,m+p),v);else for(var y=0;y<p;y++)h[v+y]=c[m+y]},flattenChunks:function(h){var c,m,p,v,y,C;for(c=p=0,m=h.length;c<m;c++)p+=h[c].length;for(C=new Uint8Array(p),c=v=0,m=h.length;c<m;c++)y=h[c],C.set(y,v),v+=y.length;return C}},u={arraySet:function(h,c,m,p,v){for(var y=0;y<p;y++)h[v+y]=c[m+y]},flattenChunks:function(h){return[].concat.apply([],h)}};i.setTyped=function(h){h?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,u))},i.setTyped(s)},{}],42:[function(r,n,i){var s=r("./common"),a=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var h=new s.Buf8(256),c=0;c<256;c++)h[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function m(p,v){if(v<65537&&(p.subarray&&u||!p.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(p,v));for(var y="",C=0;C<v;C++)y+=String.fromCharCode(p[C]);return y}h[254]=h[254]=1,i.string2buf=function(p){var v,y,C,R,_,x=p.length,I=0;for(R=0;R<x;R++)(64512&(y=p.charCodeAt(R)))==55296&&R+1<x&&(64512&(C=p.charCodeAt(R+1)))==56320&&(y=65536+(y-55296<<10)+(C-56320),R++),I+=y<128?1:y<2048?2:y<65536?3:4;for(v=new s.Buf8(I),R=_=0;_<I;R++)(64512&(y=p.charCodeAt(R)))==55296&&R+1<x&&(64512&(C=p.charCodeAt(R+1)))==56320&&(y=65536+(y-55296<<10)+(C-56320),R++),y<128?v[_++]=y:(y<2048?v[_++]=192|y>>>6:(y<65536?v[_++]=224|y>>>12:(v[_++]=240|y>>>18,v[_++]=128|y>>>12&63),v[_++]=128|y>>>6&63),v[_++]=128|63&y);return v},i.buf2binstring=function(p){return m(p,p.length)},i.binstring2buf=function(p){for(var v=new s.Buf8(p.length),y=0,C=v.length;y<C;y++)v[y]=p.charCodeAt(y);return v},i.buf2string=function(p,v){var y,C,R,_,x=v||p.length,I=new Array(2*x);for(y=C=0;y<x;)if((R=p[y++])<128)I[C++]=R;else if(4<(_=h[R]))I[C++]=65533,y+=_-1;else{for(R&=_===2?31:_===3?15:7;1<_&&y<x;)R=R<<6|63&p[y++],_--;1<_?I[C++]=65533:R<65536?I[C++]=R:(R-=65536,I[C++]=55296|R>>10&1023,I[C++]=56320|1023&R)}return m(I,C)},i.utf8border=function(p,v){var y;for((v=v||p.length)>p.length&&(v=p.length),y=v-1;0<=y&&(192&p[y])==128;)y--;return y<0||y===0?v:y+h[p[y]]>v?y:v}},{"./common":41}],43:[function(r,n,i){n.exports=function(s,a,u,h){for(var c=65535&s|0,m=s>>>16&65535|0,p=0;u!==0;){for(u-=p=2e3<u?2e3:u;m=m+(c=c+a[h++]|0)|0,--p;);c%=65521,m%=65521}return c|m<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var s=function(){for(var a,u=[],h=0;h<256;h++){a=h;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;u[h]=a}return u}();n.exports=function(a,u,h,c){var m=s,p=c+h;a^=-1;for(var v=c;v<p;v++)a=a>>>8^m[255&(a^u[v])];return-1^a}},{}],46:[function(r,n,i){var s,a=r("../utils/common"),u=r("./trees"),h=r("./adler32"),c=r("./crc32"),m=r("./messages"),p=0,v=4,y=0,C=-2,R=-1,_=4,x=2,I=8,k=9,W=286,B=30,z=19,U=2*W+1,J=15,se=3,ne=258,fe=ne+se+1,j=42,ae=113,P=1,ie=2,Le=3,me=4;function Ae(S,Y){return S.msg=m[Y],Y}function ve(S){return(S<<1)-(4<S?9:0)}function Be(S){for(var Y=S.length;0<=--Y;)S[Y]=0}function E(S){var Y=S.state,K=Y.pending;K>S.avail_out&&(K=S.avail_out),K!==0&&(a.arraySet(S.output,Y.pending_buf,Y.pending_out,K,S.next_out),S.next_out+=K,Y.pending_out+=K,S.total_out+=K,S.avail_out-=K,Y.pending-=K,Y.pending===0&&(Y.pending_out=0))}function M(S,Y){u._tr_flush_block(S,0<=S.block_start?S.block_start:-1,S.strstart-S.block_start,Y),S.block_start=S.strstart,E(S.strm)}function D(S,Y){S.pending_buf[S.pending++]=Y}function $(S,Y){S.pending_buf[S.pending++]=Y>>>8&255,S.pending_buf[S.pending++]=255&Y}function X(S,Y){var K,H,A=S.max_chain_length,V=S.strstart,G=S.prev_length,ee=S.nice_match,re=S.strstart>S.w_size-fe?S.strstart-(S.w_size-fe):0,de=S.window,be=S.w_mask,ye=S.prev,Ie=S.strstart+ne,Ne=de[V+G-1],ke=de[V+G];S.prev_length>=S.good_match&&(A>>=2),ee>S.lookahead&&(ee=S.lookahead);do if(de[(K=Y)+G]===ke&&de[K+G-1]===Ne&&de[K]===de[V]&&de[++K]===de[V+1]){V+=2,K++;do;while(de[++V]===de[++K]&&de[++V]===de[++K]&&de[++V]===de[++K]&&de[++V]===de[++K]&&de[++V]===de[++K]&&de[++V]===de[++K]&&de[++V]===de[++K]&&de[++V]===de[++K]&&V<Ie);if(H=ne-(Ie-V),V=Ie-ne,G<H){if(S.match_start=Y,ee<=(G=H))break;Ne=de[V+G-1],ke=de[V+G]}}while((Y=ye[Y&be])>re&&--A!=0);return G<=S.lookahead?G:S.lookahead}function ce(S){var Y,K,H,A,V,G,ee,re,de,be,ye=S.w_size;do{if(A=S.window_size-S.lookahead-S.strstart,S.strstart>=ye+(ye-fe)){for(a.arraySet(S.window,S.window,ye,ye,0),S.match_start-=ye,S.strstart-=ye,S.block_start-=ye,Y=K=S.hash_size;H=S.head[--Y],S.head[Y]=ye<=H?H-ye:0,--K;);for(Y=K=ye;H=S.prev[--Y],S.prev[Y]=ye<=H?H-ye:0,--K;);A+=ye}if(S.strm.avail_in===0)break;if(G=S.strm,ee=S.window,re=S.strstart+S.lookahead,de=A,be=void 0,be=G.avail_in,de<be&&(be=de),K=be===0?0:(G.avail_in-=be,a.arraySet(ee,G.input,G.next_in,be,re),G.state.wrap===1?G.adler=h(G.adler,ee,be,re):G.state.wrap===2&&(G.adler=c(G.adler,ee,be,re)),G.next_in+=be,G.total_in+=be,be),S.lookahead+=K,S.lookahead+S.insert>=se)for(V=S.strstart-S.insert,S.ins_h=S.window[V],S.ins_h=(S.ins_h<<S.hash_shift^S.window[V+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[V+se-1])&S.hash_mask,S.prev[V&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=V,V++,S.insert--,!(S.lookahead+S.insert<se)););}while(S.lookahead<fe&&S.strm.avail_in!==0)}function we(S,Y){for(var K,H;;){if(S.lookahead<fe){if(ce(S),S.lookahead<fe&&Y===p)return P;if(S.lookahead===0)break}if(K=0,S.lookahead>=se&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+se-1])&S.hash_mask,K=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),K!==0&&S.strstart-K<=S.w_size-fe&&(S.match_length=X(S,K)),S.match_length>=se)if(H=u._tr_tally(S,S.strstart-S.match_start,S.match_length-se),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=se){for(S.match_length--;S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+se-1])&S.hash_mask,K=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart,--S.match_length!=0;);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else H=u._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(H&&(M(S,!1),S.strm.avail_out===0))return P}return S.insert=S.strstart<se-1?S.strstart:se-1,Y===v?(M(S,!0),S.strm.avail_out===0?Le:me):S.last_lit&&(M(S,!1),S.strm.avail_out===0)?P:ie}function ge(S,Y){for(var K,H,A;;){if(S.lookahead<fe){if(ce(S),S.lookahead<fe&&Y===p)return P;if(S.lookahead===0)break}if(K=0,S.lookahead>=se&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+se-1])&S.hash_mask,K=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=se-1,K!==0&&S.prev_length<S.max_lazy_match&&S.strstart-K<=S.w_size-fe&&(S.match_length=X(S,K),S.match_length<=5&&(S.strategy===1||S.match_length===se&&4096<S.strstart-S.match_start)&&(S.match_length=se-1)),S.prev_length>=se&&S.match_length<=S.prev_length){for(A=S.strstart+S.lookahead-se,H=u._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-se),S.lookahead-=S.prev_length-1,S.prev_length-=2;++S.strstart<=A&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+se-1])&S.hash_mask,K=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),--S.prev_length!=0;);if(S.match_available=0,S.match_length=se-1,S.strstart++,H&&(M(S,!1),S.strm.avail_out===0))return P}else if(S.match_available){if((H=u._tr_tally(S,0,S.window[S.strstart-1]))&&M(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return P}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(H=u._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<se-1?S.strstart:se-1,Y===v?(M(S,!0),S.strm.avail_out===0?Le:me):S.last_lit&&(M(S,!1),S.strm.avail_out===0)?P:ie}function Se(S,Y,K,H,A){this.good_length=S,this.max_lazy=Y,this.nice_length=K,this.max_chain=H,this.func=A}function L(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*U),this.dyn_dtree=new a.Buf16(2*(2*B+1)),this.bl_tree=new a.Buf16(2*(2*z+1)),Be(this.dyn_ltree),Be(this.dyn_dtree),Be(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(J+1),this.heap=new a.Buf16(2*W+1),Be(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*W+1),Be(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function F(S){var Y;return S&&S.state?(S.total_in=S.total_out=0,S.data_type=x,(Y=S.state).pending=0,Y.pending_out=0,Y.wrap<0&&(Y.wrap=-Y.wrap),Y.status=Y.wrap?j:ae,S.adler=Y.wrap===2?0:1,Y.last_flush=p,u._tr_init(Y),y):Ae(S,C)}function Z(S){var Y=F(S);return Y===y&&function(K){K.window_size=2*K.w_size,Be(K.head),K.max_lazy_match=s[K.level].max_lazy,K.good_match=s[K.level].good_length,K.nice_match=s[K.level].nice_length,K.max_chain_length=s[K.level].max_chain,K.strstart=0,K.block_start=0,K.lookahead=0,K.insert=0,K.match_length=K.prev_length=se-1,K.match_available=0,K.ins_h=0}(S.state),Y}function le(S,Y,K,H,A,V){if(!S)return C;var G=1;if(Y===R&&(Y=6),H<0?(G=0,H=-H):15<H&&(G=2,H-=16),A<1||k<A||K!==I||H<8||15<H||Y<0||9<Y||V<0||_<V)return Ae(S,C);H===8&&(H=9);var ee=new L;return(S.state=ee).strm=S,ee.wrap=G,ee.gzhead=null,ee.w_bits=H,ee.w_size=1<<ee.w_bits,ee.w_mask=ee.w_size-1,ee.hash_bits=A+7,ee.hash_size=1<<ee.hash_bits,ee.hash_mask=ee.hash_size-1,ee.hash_shift=~~((ee.hash_bits+se-1)/se),ee.window=new a.Buf8(2*ee.w_size),ee.head=new a.Buf16(ee.hash_size),ee.prev=new a.Buf16(ee.w_size),ee.lit_bufsize=1<<A+6,ee.pending_buf_size=4*ee.lit_bufsize,ee.pending_buf=new a.Buf8(ee.pending_buf_size),ee.d_buf=1*ee.lit_bufsize,ee.l_buf=3*ee.lit_bufsize,ee.level=Y,ee.strategy=V,ee.method=K,Z(S)}s=[new Se(0,0,0,0,function(S,Y){var K=65535;for(K>S.pending_buf_size-5&&(K=S.pending_buf_size-5);;){if(S.lookahead<=1){if(ce(S),S.lookahead===0&&Y===p)return P;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var H=S.block_start+K;if((S.strstart===0||S.strstart>=H)&&(S.lookahead=S.strstart-H,S.strstart=H,M(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-fe&&(M(S,!1),S.strm.avail_out===0))return P}return S.insert=0,Y===v?(M(S,!0),S.strm.avail_out===0?Le:me):(S.strstart>S.block_start&&(M(S,!1),S.strm.avail_out),P)}),new Se(4,4,8,4,we),new Se(4,5,16,8,we),new Se(4,6,32,32,we),new Se(4,4,16,16,ge),new Se(8,16,32,32,ge),new Se(8,16,128,128,ge),new Se(8,32,128,256,ge),new Se(32,128,258,1024,ge),new Se(32,258,258,4096,ge)],i.deflateInit=function(S,Y){return le(S,Y,I,15,8,0)},i.deflateInit2=le,i.deflateReset=Z,i.deflateResetKeep=F,i.deflateSetHeader=function(S,Y){return S&&S.state?S.state.wrap!==2?C:(S.state.gzhead=Y,y):C},i.deflate=function(S,Y){var K,H,A,V;if(!S||!S.state||5<Y||Y<0)return S?Ae(S,C):C;if(H=S.state,!S.output||!S.input&&S.avail_in!==0||H.status===666&&Y!==v)return Ae(S,S.avail_out===0?-5:C);if(H.strm=S,K=H.last_flush,H.last_flush=Y,H.status===j)if(H.wrap===2)S.adler=0,D(H,31),D(H,139),D(H,8),H.gzhead?(D(H,(H.gzhead.text?1:0)+(H.gzhead.hcrc?2:0)+(H.gzhead.extra?4:0)+(H.gzhead.name?8:0)+(H.gzhead.comment?16:0)),D(H,255&H.gzhead.time),D(H,H.gzhead.time>>8&255),D(H,H.gzhead.time>>16&255),D(H,H.gzhead.time>>24&255),D(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),D(H,255&H.gzhead.os),H.gzhead.extra&&H.gzhead.extra.length&&(D(H,255&H.gzhead.extra.length),D(H,H.gzhead.extra.length>>8&255)),H.gzhead.hcrc&&(S.adler=c(S.adler,H.pending_buf,H.pending,0)),H.gzindex=0,H.status=69):(D(H,0),D(H,0),D(H,0),D(H,0),D(H,0),D(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),D(H,3),H.status=ae);else{var G=I+(H.w_bits-8<<4)<<8;G|=(2<=H.strategy||H.level<2?0:H.level<6?1:H.level===6?2:3)<<6,H.strstart!==0&&(G|=32),G+=31-G%31,H.status=ae,$(H,G),H.strstart!==0&&($(H,S.adler>>>16),$(H,65535&S.adler)),S.adler=1}if(H.status===69)if(H.gzhead.extra){for(A=H.pending;H.gzindex<(65535&H.gzhead.extra.length)&&(H.pending!==H.pending_buf_size||(H.gzhead.hcrc&&H.pending>A&&(S.adler=c(S.adler,H.pending_buf,H.pending-A,A)),E(S),A=H.pending,H.pending!==H.pending_buf_size));)D(H,255&H.gzhead.extra[H.gzindex]),H.gzindex++;H.gzhead.hcrc&&H.pending>A&&(S.adler=c(S.adler,H.pending_buf,H.pending-A,A)),H.gzindex===H.gzhead.extra.length&&(H.gzindex=0,H.status=73)}else H.status=73;if(H.status===73)if(H.gzhead.name){A=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>A&&(S.adler=c(S.adler,H.pending_buf,H.pending-A,A)),E(S),A=H.pending,H.pending===H.pending_buf_size)){V=1;break}V=H.gzindex<H.gzhead.name.length?255&H.gzhead.name.charCodeAt(H.gzindex++):0,D(H,V)}while(V!==0);H.gzhead.hcrc&&H.pending>A&&(S.adler=c(S.adler,H.pending_buf,H.pending-A,A)),V===0&&(H.gzindex=0,H.status=91)}else H.status=91;if(H.status===91)if(H.gzhead.comment){A=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>A&&(S.adler=c(S.adler,H.pending_buf,H.pending-A,A)),E(S),A=H.pending,H.pending===H.pending_buf_size)){V=1;break}V=H.gzindex<H.gzhead.comment.length?255&H.gzhead.comment.charCodeAt(H.gzindex++):0,D(H,V)}while(V!==0);H.gzhead.hcrc&&H.pending>A&&(S.adler=c(S.adler,H.pending_buf,H.pending-A,A)),V===0&&(H.status=103)}else H.status=103;if(H.status===103&&(H.gzhead.hcrc?(H.pending+2>H.pending_buf_size&&E(S),H.pending+2<=H.pending_buf_size&&(D(H,255&S.adler),D(H,S.adler>>8&255),S.adler=0,H.status=ae)):H.status=ae),H.pending!==0){if(E(S),S.avail_out===0)return H.last_flush=-1,y}else if(S.avail_in===0&&ve(Y)<=ve(K)&&Y!==v)return Ae(S,-5);if(H.status===666&&S.avail_in!==0)return Ae(S,-5);if(S.avail_in!==0||H.lookahead!==0||Y!==p&&H.status!==666){var ee=H.strategy===2?function(re,de){for(var be;;){if(re.lookahead===0&&(ce(re),re.lookahead===0)){if(de===p)return P;break}if(re.match_length=0,be=u._tr_tally(re,0,re.window[re.strstart]),re.lookahead--,re.strstart++,be&&(M(re,!1),re.strm.avail_out===0))return P}return re.insert=0,de===v?(M(re,!0),re.strm.avail_out===0?Le:me):re.last_lit&&(M(re,!1),re.strm.avail_out===0)?P:ie}(H,Y):H.strategy===3?function(re,de){for(var be,ye,Ie,Ne,ke=re.window;;){if(re.lookahead<=ne){if(ce(re),re.lookahead<=ne&&de===p)return P;if(re.lookahead===0)break}if(re.match_length=0,re.lookahead>=se&&0<re.strstart&&(ye=ke[Ie=re.strstart-1])===ke[++Ie]&&ye===ke[++Ie]&&ye===ke[++Ie]){Ne=re.strstart+ne;do;while(ye===ke[++Ie]&&ye===ke[++Ie]&&ye===ke[++Ie]&&ye===ke[++Ie]&&ye===ke[++Ie]&&ye===ke[++Ie]&&ye===ke[++Ie]&&ye===ke[++Ie]&&Ie<Ne);re.match_length=ne-(Ne-Ie),re.match_length>re.lookahead&&(re.match_length=re.lookahead)}if(re.match_length>=se?(be=u._tr_tally(re,1,re.match_length-se),re.lookahead-=re.match_length,re.strstart+=re.match_length,re.match_length=0):(be=u._tr_tally(re,0,re.window[re.strstart]),re.lookahead--,re.strstart++),be&&(M(re,!1),re.strm.avail_out===0))return P}return re.insert=0,de===v?(M(re,!0),re.strm.avail_out===0?Le:me):re.last_lit&&(M(re,!1),re.strm.avail_out===0)?P:ie}(H,Y):s[H.level].func(H,Y);if(ee!==Le&&ee!==me||(H.status=666),ee===P||ee===Le)return S.avail_out===0&&(H.last_flush=-1),y;if(ee===ie&&(Y===1?u._tr_align(H):Y!==5&&(u._tr_stored_block(H,0,0,!1),Y===3&&(Be(H.head),H.lookahead===0&&(H.strstart=0,H.block_start=0,H.insert=0))),E(S),S.avail_out===0))return H.last_flush=-1,y}return Y!==v?y:H.wrap<=0?1:(H.wrap===2?(D(H,255&S.adler),D(H,S.adler>>8&255),D(H,S.adler>>16&255),D(H,S.adler>>24&255),D(H,255&S.total_in),D(H,S.total_in>>8&255),D(H,S.total_in>>16&255),D(H,S.total_in>>24&255)):($(H,S.adler>>>16),$(H,65535&S.adler)),E(S),0<H.wrap&&(H.wrap=-H.wrap),H.pending!==0?y:1)},i.deflateEnd=function(S){var Y;return S&&S.state?(Y=S.state.status)!==j&&Y!==69&&Y!==73&&Y!==91&&Y!==103&&Y!==ae&&Y!==666?Ae(S,C):(S.state=null,Y===ae?Ae(S,-3):y):C},i.deflateSetDictionary=function(S,Y){var K,H,A,V,G,ee,re,de,be=Y.length;if(!S||!S.state||(V=(K=S.state).wrap)===2||V===1&&K.status!==j||K.lookahead)return C;for(V===1&&(S.adler=h(S.adler,Y,be,0)),K.wrap=0,be>=K.w_size&&(V===0&&(Be(K.head),K.strstart=0,K.block_start=0,K.insert=0),de=new a.Buf8(K.w_size),a.arraySet(de,Y,be-K.w_size,K.w_size,0),Y=de,be=K.w_size),G=S.avail_in,ee=S.next_in,re=S.input,S.avail_in=be,S.next_in=0,S.input=Y,ce(K);K.lookahead>=se;){for(H=K.strstart,A=K.lookahead-(se-1);K.ins_h=(K.ins_h<<K.hash_shift^K.window[H+se-1])&K.hash_mask,K.prev[H&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=H,H++,--A;);K.strstart=H,K.lookahead=se-1,ce(K)}return K.strstart+=K.lookahead,K.block_start=K.strstart,K.insert=K.lookahead,K.lookahead=0,K.match_length=K.prev_length=se-1,K.match_available=0,S.next_in=ee,S.input=re,S.avail_in=G,K.wrap=V,y},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(s,a){var u,h,c,m,p,v,y,C,R,_,x,I,k,W,B,z,U,J,se,ne,fe,j,ae,P,ie;u=s.state,h=s.next_in,P=s.input,c=h+(s.avail_in-5),m=s.next_out,ie=s.output,p=m-(a-s.avail_out),v=m+(s.avail_out-257),y=u.dmax,C=u.wsize,R=u.whave,_=u.wnext,x=u.window,I=u.hold,k=u.bits,W=u.lencode,B=u.distcode,z=(1<<u.lenbits)-1,U=(1<<u.distbits)-1;e:do{k<15&&(I+=P[h++]<<k,k+=8,I+=P[h++]<<k,k+=8),J=W[I&z];t:for(;;){if(I>>>=se=J>>>24,k-=se,(se=J>>>16&255)===0)ie[m++]=65535&J;else{if(!(16&se)){if(!(64&se)){J=W[(65535&J)+(I&(1<<se)-1)];continue t}if(32&se){u.mode=12;break e}s.msg="invalid literal/length code",u.mode=30;break e}ne=65535&J,(se&=15)&&(k<se&&(I+=P[h++]<<k,k+=8),ne+=I&(1<<se)-1,I>>>=se,k-=se),k<15&&(I+=P[h++]<<k,k+=8,I+=P[h++]<<k,k+=8),J=B[I&U];r:for(;;){if(I>>>=se=J>>>24,k-=se,!(16&(se=J>>>16&255))){if(!(64&se)){J=B[(65535&J)+(I&(1<<se)-1)];continue r}s.msg="invalid distance code",u.mode=30;break e}if(fe=65535&J,k<(se&=15)&&(I+=P[h++]<<k,(k+=8)<se&&(I+=P[h++]<<k,k+=8)),y<(fe+=I&(1<<se)-1)){s.msg="invalid distance too far back",u.mode=30;break e}if(I>>>=se,k-=se,(se=m-p)<fe){if(R<(se=fe-se)&&u.sane){s.msg="invalid distance too far back",u.mode=30;break e}if(ae=x,(j=0)===_){if(j+=C-se,se<ne){for(ne-=se;ie[m++]=x[j++],--se;);j=m-fe,ae=ie}}else if(_<se){if(j+=C+_-se,(se-=_)<ne){for(ne-=se;ie[m++]=x[j++],--se;);if(j=0,_<ne){for(ne-=se=_;ie[m++]=x[j++],--se;);j=m-fe,ae=ie}}}else if(j+=_-se,se<ne){for(ne-=se;ie[m++]=x[j++],--se;);j=m-fe,ae=ie}for(;2<ne;)ie[m++]=ae[j++],ie[m++]=ae[j++],ie[m++]=ae[j++],ne-=3;ne&&(ie[m++]=ae[j++],1<ne&&(ie[m++]=ae[j++]))}else{for(j=m-fe;ie[m++]=ie[j++],ie[m++]=ie[j++],ie[m++]=ie[j++],2<(ne-=3););ne&&(ie[m++]=ie[j++],1<ne&&(ie[m++]=ie[j++]))}break}}break}}while(h<c&&m<v);h-=ne=k>>3,I&=(1<<(k-=ne<<3))-1,s.next_in=h,s.next_out=m,s.avail_in=h<c?c-h+5:5-(h-c),s.avail_out=m<v?v-m+257:257-(m-v),u.hold=I,u.bits=k}},{}],49:[function(r,n,i){var s=r("../utils/common"),a=r("./adler32"),u=r("./crc32"),h=r("./inffast"),c=r("./inftrees"),m=1,p=2,v=0,y=-2,C=1,R=852,_=592;function x(j){return(j>>>24&255)+(j>>>8&65280)+((65280&j)<<8)+((255&j)<<24)}function I(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(j){var ae;return j&&j.state?(ae=j.state,j.total_in=j.total_out=ae.total=0,j.msg="",ae.wrap&&(j.adler=1&ae.wrap),ae.mode=C,ae.last=0,ae.havedict=0,ae.dmax=32768,ae.head=null,ae.hold=0,ae.bits=0,ae.lencode=ae.lendyn=new s.Buf32(R),ae.distcode=ae.distdyn=new s.Buf32(_),ae.sane=1,ae.back=-1,v):y}function W(j){var ae;return j&&j.state?((ae=j.state).wsize=0,ae.whave=0,ae.wnext=0,k(j)):y}function B(j,ae){var P,ie;return j&&j.state?(ie=j.state,ae<0?(P=0,ae=-ae):(P=1+(ae>>4),ae<48&&(ae&=15)),ae&&(ae<8||15<ae)?y:(ie.window!==null&&ie.wbits!==ae&&(ie.window=null),ie.wrap=P,ie.wbits=ae,W(j))):y}function z(j,ae){var P,ie;return j?(ie=new I,(j.state=ie).window=null,(P=B(j,ae))!==v&&(j.state=null),P):y}var U,J,se=!0;function ne(j){if(se){var ae;for(U=new s.Buf32(512),J=new s.Buf32(32),ae=0;ae<144;)j.lens[ae++]=8;for(;ae<256;)j.lens[ae++]=9;for(;ae<280;)j.lens[ae++]=7;for(;ae<288;)j.lens[ae++]=8;for(c(m,j.lens,0,288,U,0,j.work,{bits:9}),ae=0;ae<32;)j.lens[ae++]=5;c(p,j.lens,0,32,J,0,j.work,{bits:5}),se=!1}j.lencode=U,j.lenbits=9,j.distcode=J,j.distbits=5}function fe(j,ae,P,ie){var Le,me=j.state;return me.window===null&&(me.wsize=1<<me.wbits,me.wnext=0,me.whave=0,me.window=new s.Buf8(me.wsize)),ie>=me.wsize?(s.arraySet(me.window,ae,P-me.wsize,me.wsize,0),me.wnext=0,me.whave=me.wsize):(ie<(Le=me.wsize-me.wnext)&&(Le=ie),s.arraySet(me.window,ae,P-ie,Le,me.wnext),(ie-=Le)?(s.arraySet(me.window,ae,P-ie,ie,0),me.wnext=ie,me.whave=me.wsize):(me.wnext+=Le,me.wnext===me.wsize&&(me.wnext=0),me.whave<me.wsize&&(me.whave+=Le))),0}i.inflateReset=W,i.inflateReset2=B,i.inflateResetKeep=k,i.inflateInit=function(j){return z(j,15)},i.inflateInit2=z,i.inflate=function(j,ae){var P,ie,Le,me,Ae,ve,Be,E,M,D,$,X,ce,we,ge,Se,L,F,Z,le,S,Y,K,H,A=0,V=new s.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return y;(P=j.state).mode===12&&(P.mode=13),Ae=j.next_out,Le=j.output,Be=j.avail_out,me=j.next_in,ie=j.input,ve=j.avail_in,E=P.hold,M=P.bits,D=ve,$=Be,Y=v;e:for(;;)switch(P.mode){case C:if(P.wrap===0){P.mode=13;break}for(;M<16;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(2&P.wrap&&E===35615){V[P.check=0]=255&E,V[1]=E>>>8&255,P.check=u(P.check,V,2,0),M=E=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&E)<<8)+(E>>8))%31){j.msg="incorrect header check",P.mode=30;break}if((15&E)!=8){j.msg="unknown compression method",P.mode=30;break}if(M-=4,S=8+(15&(E>>>=4)),P.wbits===0)P.wbits=S;else if(S>P.wbits){j.msg="invalid window size",P.mode=30;break}P.dmax=1<<S,j.adler=P.check=1,P.mode=512&E?10:12,M=E=0;break;case 2:for(;M<16;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(P.flags=E,(255&P.flags)!=8){j.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){j.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=E>>8&1),512&P.flags&&(V[0]=255&E,V[1]=E>>>8&255,P.check=u(P.check,V,2,0)),M=E=0,P.mode=3;case 3:for(;M<32;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}P.head&&(P.head.time=E),512&P.flags&&(V[0]=255&E,V[1]=E>>>8&255,V[2]=E>>>16&255,V[3]=E>>>24&255,P.check=u(P.check,V,4,0)),M=E=0,P.mode=4;case 4:for(;M<16;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}P.head&&(P.head.xflags=255&E,P.head.os=E>>8),512&P.flags&&(V[0]=255&E,V[1]=E>>>8&255,P.check=u(P.check,V,2,0)),M=E=0,P.mode=5;case 5:if(1024&P.flags){for(;M<16;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}P.length=E,P.head&&(P.head.extra_len=E),512&P.flags&&(V[0]=255&E,V[1]=E>>>8&255,P.check=u(P.check,V,2,0)),M=E=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(ve<(X=P.length)&&(X=ve),X&&(P.head&&(S=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),s.arraySet(P.head.extra,ie,me,X,S)),512&P.flags&&(P.check=u(P.check,ie,X,me)),ve-=X,me+=X,P.length-=X),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(ve===0)break e;for(X=0;S=ie[me+X++],P.head&&S&&P.length<65536&&(P.head.name+=String.fromCharCode(S)),S&&X<ve;);if(512&P.flags&&(P.check=u(P.check,ie,X,me)),ve-=X,me+=X,S)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(ve===0)break e;for(X=0;S=ie[me+X++],P.head&&S&&P.length<65536&&(P.head.comment+=String.fromCharCode(S)),S&&X<ve;);if(512&P.flags&&(P.check=u(P.check,ie,X,me)),ve-=X,me+=X,S)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;M<16;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(E!==(65535&P.check)){j.msg="header crc mismatch",P.mode=30;break}M=E=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),j.adler=P.check=0,P.mode=12;break;case 10:for(;M<32;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}j.adler=P.check=x(E),M=E=0,P.mode=11;case 11:if(P.havedict===0)return j.next_out=Ae,j.avail_out=Be,j.next_in=me,j.avail_in=ve,P.hold=E,P.bits=M,2;j.adler=P.check=1,P.mode=12;case 12:if(ae===5||ae===6)break e;case 13:if(P.last){E>>>=7&M,M-=7&M,P.mode=27;break}for(;M<3;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}switch(P.last=1&E,M-=1,3&(E>>>=1)){case 0:P.mode=14;break;case 1:if(ne(P),P.mode=20,ae!==6)break;E>>>=2,M-=2;break e;case 2:P.mode=17;break;case 3:j.msg="invalid block type",P.mode=30}E>>>=2,M-=2;break;case 14:for(E>>>=7&M,M-=7&M;M<32;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if((65535&E)!=(E>>>16^65535)){j.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&E,M=E=0,P.mode=15,ae===6)break e;case 15:P.mode=16;case 16:if(X=P.length){if(ve<X&&(X=ve),Be<X&&(X=Be),X===0)break e;s.arraySet(Le,ie,me,X,Ae),ve-=X,me+=X,Be-=X,Ae+=X,P.length-=X;break}P.mode=12;break;case 17:for(;M<14;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(P.nlen=257+(31&E),E>>>=5,M-=5,P.ndist=1+(31&E),E>>>=5,M-=5,P.ncode=4+(15&E),E>>>=4,M-=4,286<P.nlen||30<P.ndist){j.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;M<3;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}P.lens[G[P.have++]]=7&E,E>>>=3,M-=3}for(;P.have<19;)P.lens[G[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,K={bits:P.lenbits},Y=c(0,P.lens,0,19,P.lencode,0,P.work,K),P.lenbits=K.bits,Y){j.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;Se=(A=P.lencode[E&(1<<P.lenbits)-1])>>>16&255,L=65535&A,!((ge=A>>>24)<=M);){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(L<16)E>>>=ge,M-=ge,P.lens[P.have++]=L;else{if(L===16){for(H=ge+2;M<H;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(E>>>=ge,M-=ge,P.have===0){j.msg="invalid bit length repeat",P.mode=30;break}S=P.lens[P.have-1],X=3+(3&E),E>>>=2,M-=2}else if(L===17){for(H=ge+3;M<H;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}M-=ge,S=0,X=3+(7&(E>>>=ge)),E>>>=3,M-=3}else{for(H=ge+7;M<H;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}M-=ge,S=0,X=11+(127&(E>>>=ge)),E>>>=7,M-=7}if(P.have+X>P.nlen+P.ndist){j.msg="invalid bit length repeat",P.mode=30;break}for(;X--;)P.lens[P.have++]=S}}if(P.mode===30)break;if(P.lens[256]===0){j.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,K={bits:P.lenbits},Y=c(m,P.lens,0,P.nlen,P.lencode,0,P.work,K),P.lenbits=K.bits,Y){j.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,K={bits:P.distbits},Y=c(p,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,K),P.distbits=K.bits,Y){j.msg="invalid distances set",P.mode=30;break}if(P.mode=20,ae===6)break e;case 20:P.mode=21;case 21:if(6<=ve&&258<=Be){j.next_out=Ae,j.avail_out=Be,j.next_in=me,j.avail_in=ve,P.hold=E,P.bits=M,h(j,$),Ae=j.next_out,Le=j.output,Be=j.avail_out,me=j.next_in,ie=j.input,ve=j.avail_in,E=P.hold,M=P.bits,P.mode===12&&(P.back=-1);break}for(P.back=0;Se=(A=P.lencode[E&(1<<P.lenbits)-1])>>>16&255,L=65535&A,!((ge=A>>>24)<=M);){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(Se&&!(240&Se)){for(F=ge,Z=Se,le=L;Se=(A=P.lencode[le+((E&(1<<F+Z)-1)>>F)])>>>16&255,L=65535&A,!(F+(ge=A>>>24)<=M);){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}E>>>=F,M-=F,P.back+=F}if(E>>>=ge,M-=ge,P.back+=ge,P.length=L,Se===0){P.mode=26;break}if(32&Se){P.back=-1,P.mode=12;break}if(64&Se){j.msg="invalid literal/length code",P.mode=30;break}P.extra=15&Se,P.mode=22;case 22:if(P.extra){for(H=P.extra;M<H;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}P.length+=E&(1<<P.extra)-1,E>>>=P.extra,M-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;Se=(A=P.distcode[E&(1<<P.distbits)-1])>>>16&255,L=65535&A,!((ge=A>>>24)<=M);){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(!(240&Se)){for(F=ge,Z=Se,le=L;Se=(A=P.distcode[le+((E&(1<<F+Z)-1)>>F)])>>>16&255,L=65535&A,!(F+(ge=A>>>24)<=M);){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}E>>>=F,M-=F,P.back+=F}if(E>>>=ge,M-=ge,P.back+=ge,64&Se){j.msg="invalid distance code",P.mode=30;break}P.offset=L,P.extra=15&Se,P.mode=24;case 24:if(P.extra){for(H=P.extra;M<H;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}P.offset+=E&(1<<P.extra)-1,E>>>=P.extra,M-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){j.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(Be===0)break e;if(X=$-Be,P.offset>X){if((X=P.offset-X)>P.whave&&P.sane){j.msg="invalid distance too far back",P.mode=30;break}ce=X>P.wnext?(X-=P.wnext,P.wsize-X):P.wnext-X,X>P.length&&(X=P.length),we=P.window}else we=Le,ce=Ae-P.offset,X=P.length;for(Be<X&&(X=Be),Be-=X,P.length-=X;Le[Ae++]=we[ce++],--X;);P.length===0&&(P.mode=21);break;case 26:if(Be===0)break e;Le[Ae++]=P.length,Be--,P.mode=21;break;case 27:if(P.wrap){for(;M<32;){if(ve===0)break e;ve--,E|=ie[me++]<<M,M+=8}if($-=Be,j.total_out+=$,P.total+=$,$&&(j.adler=P.check=P.flags?u(P.check,Le,$,Ae-$):a(P.check,Le,$,Ae-$)),$=Be,(P.flags?E:x(E))!==P.check){j.msg="incorrect data check",P.mode=30;break}M=E=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;M<32;){if(ve===0)break e;ve--,E+=ie[me++]<<M,M+=8}if(E!==(4294967295&P.total)){j.msg="incorrect length check",P.mode=30;break}M=E=0}P.mode=29;case 29:Y=1;break e;case 30:Y=-3;break e;case 31:return-4;case 32:default:return y}return j.next_out=Ae,j.avail_out=Be,j.next_in=me,j.avail_in=ve,P.hold=E,P.bits=M,(P.wsize||$!==j.avail_out&&P.mode<30&&(P.mode<27||ae!==4))&&fe(j,j.output,j.next_out,$-j.avail_out)?(P.mode=31,-4):(D-=j.avail_in,$-=j.avail_out,j.total_in+=D,j.total_out+=$,P.total+=$,P.wrap&&$&&(j.adler=P.check=P.flags?u(P.check,Le,$,j.next_out-$):a(P.check,Le,$,j.next_out-$)),j.data_type=P.bits+(P.last?64:0)+(P.mode===12?128:0)+(P.mode===20||P.mode===15?256:0),(D==0&&$===0||ae===4)&&Y===v&&(Y=-5),Y)},i.inflateEnd=function(j){if(!j||!j.state)return y;var ae=j.state;return ae.window&&(ae.window=null),j.state=null,v},i.inflateGetHeader=function(j,ae){var P;return j&&j.state&&2&(P=j.state).wrap?((P.head=ae).done=!1,v):y},i.inflateSetDictionary=function(j,ae){var P,ie=ae.length;return j&&j.state?(P=j.state).wrap!==0&&P.mode!==11?y:P.mode===11&&a(1,ae,ie,0)!==P.check?-3:fe(j,ae,ie,ie)?(P.mode=31,-4):(P.havedict=1,v):y},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var s=r("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(m,p,v,y,C,R,_,x){var I,k,W,B,z,U,J,se,ne,fe=x.bits,j=0,ae=0,P=0,ie=0,Le=0,me=0,Ae=0,ve=0,Be=0,E=0,M=null,D=0,$=new s.Buf16(16),X=new s.Buf16(16),ce=null,we=0;for(j=0;j<=15;j++)$[j]=0;for(ae=0;ae<y;ae++)$[p[v+ae]]++;for(Le=fe,ie=15;1<=ie&&$[ie]===0;ie--);if(ie<Le&&(Le=ie),ie===0)return C[R++]=20971520,C[R++]=20971520,x.bits=1,0;for(P=1;P<ie&&$[P]===0;P++);for(Le<P&&(Le=P),j=ve=1;j<=15;j++)if(ve<<=1,(ve-=$[j])<0)return-1;if(0<ve&&(m===0||ie!==1))return-1;for(X[1]=0,j=1;j<15;j++)X[j+1]=X[j]+$[j];for(ae=0;ae<y;ae++)p[v+ae]!==0&&(_[X[p[v+ae]]++]=ae);if(U=m===0?(M=ce=_,19):m===1?(M=a,D-=257,ce=u,we-=257,256):(M=h,ce=c,-1),j=P,z=R,Ae=ae=E=0,W=-1,B=(Be=1<<(me=Le))-1,m===1&&852<Be||m===2&&592<Be)return 1;for(;;){for(J=j-Ae,ne=_[ae]<U?(se=0,_[ae]):_[ae]>U?(se=ce[we+_[ae]],M[D+_[ae]]):(se=96,0),I=1<<j-Ae,P=k=1<<me;C[z+(E>>Ae)+(k-=I)]=J<<24|se<<16|ne|0,k!==0;);for(I=1<<j-1;E&I;)I>>=1;if(I!==0?(E&=I-1,E+=I):E=0,ae++,--$[j]==0){if(j===ie)break;j=p[v+_[ae]]}if(Le<j&&(E&B)!==W){for(Ae===0&&(Ae=Le),z+=P,ve=1<<(me=j-Ae);me+Ae<ie&&!((ve-=$[me+Ae])<=0);)me++,ve<<=1;if(Be+=1<<me,m===1&&852<Be||m===2&&592<Be)return 1;C[W=E&B]=Le<<24|me<<16|z-R|0}}return E!==0&&(C[z+E]=j-Ae<<24|64<<16|0),x.bits=Le,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var s=r("../utils/common"),a=0,u=1;function h(A){for(var V=A.length;0<=--V;)A[V]=0}var c=0,m=29,p=256,v=p+1+m,y=30,C=19,R=2*v+1,_=15,x=16,I=7,k=256,W=16,B=17,z=18,U=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],J=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fe=new Array(2*(v+2));h(fe);var j=new Array(2*y);h(j);var ae=new Array(512);h(ae);var P=new Array(256);h(P);var ie=new Array(m);h(ie);var Le,me,Ae,ve=new Array(y);function Be(A,V,G,ee,re){this.static_tree=A,this.extra_bits=V,this.extra_base=G,this.elems=ee,this.max_length=re,this.has_stree=A&&A.length}function E(A,V){this.dyn_tree=A,this.max_code=0,this.stat_desc=V}function M(A){return A<256?ae[A]:ae[256+(A>>>7)]}function D(A,V){A.pending_buf[A.pending++]=255&V,A.pending_buf[A.pending++]=V>>>8&255}function $(A,V,G){A.bi_valid>x-G?(A.bi_buf|=V<<A.bi_valid&65535,D(A,A.bi_buf),A.bi_buf=V>>x-A.bi_valid,A.bi_valid+=G-x):(A.bi_buf|=V<<A.bi_valid&65535,A.bi_valid+=G)}function X(A,V,G){$(A,G[2*V],G[2*V+1])}function ce(A,V){for(var G=0;G|=1&A,A>>>=1,G<<=1,0<--V;);return G>>>1}function we(A,V,G){var ee,re,de=new Array(_+1),be=0;for(ee=1;ee<=_;ee++)de[ee]=be=be+G[ee-1]<<1;for(re=0;re<=V;re++){var ye=A[2*re+1];ye!==0&&(A[2*re]=ce(de[ye]++,ye))}}function ge(A){var V;for(V=0;V<v;V++)A.dyn_ltree[2*V]=0;for(V=0;V<y;V++)A.dyn_dtree[2*V]=0;for(V=0;V<C;V++)A.bl_tree[2*V]=0;A.dyn_ltree[2*k]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function Se(A){8<A.bi_valid?D(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function L(A,V,G,ee){var re=2*V,de=2*G;return A[re]<A[de]||A[re]===A[de]&&ee[V]<=ee[G]}function F(A,V,G){for(var ee=A.heap[G],re=G<<1;re<=A.heap_len&&(re<A.heap_len&&L(V,A.heap[re+1],A.heap[re],A.depth)&&re++,!L(V,ee,A.heap[re],A.depth));)A.heap[G]=A.heap[re],G=re,re<<=1;A.heap[G]=ee}function Z(A,V,G){var ee,re,de,be,ye=0;if(A.last_lit!==0)for(;ee=A.pending_buf[A.d_buf+2*ye]<<8|A.pending_buf[A.d_buf+2*ye+1],re=A.pending_buf[A.l_buf+ye],ye++,ee===0?X(A,re,V):(X(A,(de=P[re])+p+1,V),(be=U[de])!==0&&$(A,re-=ie[de],be),X(A,de=M(--ee),G),(be=J[de])!==0&&$(A,ee-=ve[de],be)),ye<A.last_lit;);X(A,k,V)}function le(A,V){var G,ee,re,de=V.dyn_tree,be=V.stat_desc.static_tree,ye=V.stat_desc.has_stree,Ie=V.stat_desc.elems,Ne=-1;for(A.heap_len=0,A.heap_max=R,G=0;G<Ie;G++)de[2*G]!==0?(A.heap[++A.heap_len]=Ne=G,A.depth[G]=0):de[2*G+1]=0;for(;A.heap_len<2;)de[2*(re=A.heap[++A.heap_len]=Ne<2?++Ne:0)]=1,A.depth[re]=0,A.opt_len--,ye&&(A.static_len-=be[2*re+1]);for(V.max_code=Ne,G=A.heap_len>>1;1<=G;G--)F(A,de,G);for(re=Ie;G=A.heap[1],A.heap[1]=A.heap[A.heap_len--],F(A,de,1),ee=A.heap[1],A.heap[--A.heap_max]=G,A.heap[--A.heap_max]=ee,de[2*re]=de[2*G]+de[2*ee],A.depth[re]=(A.depth[G]>=A.depth[ee]?A.depth[G]:A.depth[ee])+1,de[2*G+1]=de[2*ee+1]=re,A.heap[1]=re++,F(A,de,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],function(ke,Rt){var Br,pr,zt,ht,Ht,Mt,ft=Rt.dyn_tree,st=Rt.max_code,Fo=Rt.stat_desc.static_tree,qe=Rt.stat_desc.has_stree,Us=Rt.stat_desc.extra_bits,dn=Rt.stat_desc.extra_base,Nt=Rt.stat_desc.max_length,or=0;for(ht=0;ht<=_;ht++)ke.bl_count[ht]=0;for(ft[2*ke.heap[ke.heap_max]+1]=0,Br=ke.heap_max+1;Br<R;Br++)Nt<(ht=ft[2*ft[2*(pr=ke.heap[Br])+1]+1]+1)&&(ht=Nt,or++),ft[2*pr+1]=ht,st<pr||(ke.bl_count[ht]++,Ht=0,dn<=pr&&(Ht=Us[pr-dn]),Mt=ft[2*pr],ke.opt_len+=Mt*(ht+Ht),qe&&(ke.static_len+=Mt*(Fo[2*pr+1]+Ht)));if(or!==0){do{for(ht=Nt-1;ke.bl_count[ht]===0;)ht--;ke.bl_count[ht]--,ke.bl_count[ht+1]+=2,ke.bl_count[Nt]--,or-=2}while(0<or);for(ht=Nt;ht!==0;ht--)for(pr=ke.bl_count[ht];pr!==0;)st<(zt=ke.heap[--Br])||(ft[2*zt+1]!==ht&&(ke.opt_len+=(ht-ft[2*zt+1])*ft[2*zt],ft[2*zt+1]=ht),pr--)}}(A,V),we(de,Ne,A.bl_count)}function S(A,V,G){var ee,re,de=-1,be=V[1],ye=0,Ie=7,Ne=4;for(be===0&&(Ie=138,Ne=3),V[2*(G+1)+1]=65535,ee=0;ee<=G;ee++)re=be,be=V[2*(ee+1)+1],++ye<Ie&&re===be||(ye<Ne?A.bl_tree[2*re]+=ye:re!==0?(re!==de&&A.bl_tree[2*re]++,A.bl_tree[2*W]++):ye<=10?A.bl_tree[2*B]++:A.bl_tree[2*z]++,de=re,Ne=(ye=0)===be?(Ie=138,3):re===be?(Ie=6,3):(Ie=7,4))}function Y(A,V,G){var ee,re,de=-1,be=V[1],ye=0,Ie=7,Ne=4;for(be===0&&(Ie=138,Ne=3),ee=0;ee<=G;ee++)if(re=be,be=V[2*(ee+1)+1],!(++ye<Ie&&re===be)){if(ye<Ne)for(;X(A,re,A.bl_tree),--ye!=0;);else re!==0?(re!==de&&(X(A,re,A.bl_tree),ye--),X(A,W,A.bl_tree),$(A,ye-3,2)):ye<=10?(X(A,B,A.bl_tree),$(A,ye-3,3)):(X(A,z,A.bl_tree),$(A,ye-11,7));de=re,Ne=(ye=0)===be?(Ie=138,3):re===be?(Ie=6,3):(Ie=7,4)}}h(ve);var K=!1;function H(A,V,G,ee){$(A,(c<<1)+(ee?1:0),3),function(re,de,be,ye){Se(re),D(re,be),D(re,~be),s.arraySet(re.pending_buf,re.window,de,be,re.pending),re.pending+=be}(A,V,G)}i._tr_init=function(A){K||(function(){var V,G,ee,re,de,be=new Array(_+1);for(re=ee=0;re<m-1;re++)for(ie[re]=ee,V=0;V<1<<U[re];V++)P[ee++]=re;for(P[ee-1]=re,re=de=0;re<16;re++)for(ve[re]=de,V=0;V<1<<J[re];V++)ae[de++]=re;for(de>>=7;re<y;re++)for(ve[re]=de<<7,V=0;V<1<<J[re]-7;V++)ae[256+de++]=re;for(G=0;G<=_;G++)be[G]=0;for(V=0;V<=143;)fe[2*V+1]=8,V++,be[8]++;for(;V<=255;)fe[2*V+1]=9,V++,be[9]++;for(;V<=279;)fe[2*V+1]=7,V++,be[7]++;for(;V<=287;)fe[2*V+1]=8,V++,be[8]++;for(we(fe,v+1,be),V=0;V<y;V++)j[2*V+1]=5,j[2*V]=ce(V,5);Le=new Be(fe,U,p+1,v,_),me=new Be(j,J,0,y,_),Ae=new Be(new Array(0),se,0,C,I)}(),K=!0),A.l_desc=new E(A.dyn_ltree,Le),A.d_desc=new E(A.dyn_dtree,me),A.bl_desc=new E(A.bl_tree,Ae),A.bi_buf=0,A.bi_valid=0,ge(A)},i._tr_stored_block=H,i._tr_flush_block=function(A,V,G,ee){var re,de,be=0;0<A.level?(A.strm.data_type===2&&(A.strm.data_type=function(ye){var Ie,Ne=4093624447;for(Ie=0;Ie<=31;Ie++,Ne>>>=1)if(1&Ne&&ye.dyn_ltree[2*Ie]!==0)return a;if(ye.dyn_ltree[18]!==0||ye.dyn_ltree[20]!==0||ye.dyn_ltree[26]!==0)return u;for(Ie=32;Ie<p;Ie++)if(ye.dyn_ltree[2*Ie]!==0)return u;return a}(A)),le(A,A.l_desc),le(A,A.d_desc),be=function(ye){var Ie;for(S(ye,ye.dyn_ltree,ye.l_desc.max_code),S(ye,ye.dyn_dtree,ye.d_desc.max_code),le(ye,ye.bl_desc),Ie=C-1;3<=Ie&&ye.bl_tree[2*ne[Ie]+1]===0;Ie--);return ye.opt_len+=3*(Ie+1)+5+5+4,Ie}(A),re=A.opt_len+3+7>>>3,(de=A.static_len+3+7>>>3)<=re&&(re=de)):re=de=G+5,G+4<=re&&V!==-1?H(A,V,G,ee):A.strategy===4||de===re?($(A,2+(ee?1:0),3),Z(A,fe,j)):($(A,4+(ee?1:0),3),function(ye,Ie,Ne,ke){var Rt;for($(ye,Ie-257,5),$(ye,Ne-1,5),$(ye,ke-4,4),Rt=0;Rt<ke;Rt++)$(ye,ye.bl_tree[2*ne[Rt]+1],3);Y(ye,ye.dyn_ltree,Ie-1),Y(ye,ye.dyn_dtree,Ne-1)}(A,A.l_desc.max_code+1,A.d_desc.max_code+1,be+1),Z(A,A.dyn_ltree,A.dyn_dtree)),ge(A),ee&&Se(A)},i._tr_tally=function(A,V,G){return A.pending_buf[A.d_buf+2*A.last_lit]=V>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&V,A.pending_buf[A.l_buf+A.last_lit]=255&G,A.last_lit++,V===0?A.dyn_ltree[2*G]++:(A.matches++,V--,A.dyn_ltree[2*(P[G]+p+1)]++,A.dyn_dtree[2*M(V)]++),A.last_lit===A.lit_bufsize-1},i._tr_align=function(A){$(A,2,3),X(A,k,fe),function(V){V.bi_valid===16?(D(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):8<=V.bi_valid&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)}(A)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){(function(s){(function(a,u){if(!a.setImmediate){var h,c,m,p,v=1,y={},C=!1,R=a.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(a);_=_&&_.setTimeout?_:a,h={}.toString.call(a.process)==="[object process]"?function(W){process.nextTick(function(){I(W)})}:function(){if(a.postMessage&&!a.importScripts){var W=!0,B=a.onmessage;return a.onmessage=function(){W=!1},a.postMessage("","*"),a.onmessage=B,W}}()?(p="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",k,!1):a.attachEvent("onmessage",k),function(W){a.postMessage(p+W,"*")}):a.MessageChannel?((m=new MessageChannel).port1.onmessage=function(W){I(W.data)},function(W){m.port2.postMessage(W)}):R&&"onreadystatechange"in R.createElement("script")?(c=R.documentElement,function(W){var B=R.createElement("script");B.onreadystatechange=function(){I(W),B.onreadystatechange=null,c.removeChild(B),B=null},c.appendChild(B)}):function(W){setTimeout(I,0,W)},_.setImmediate=function(W){typeof W!="function"&&(W=new Function(""+W));for(var B=new Array(arguments.length-1),z=0;z<B.length;z++)B[z]=arguments[z+1];var U={callback:W,args:B};return y[v]=U,h(v),v++},_.clearImmediate=x}function x(W){delete y[W]}function I(W){if(C)setTimeout(I,0,W);else{var B=y[W];if(B){C=!0;try{(function(z){var U=z.callback,J=z.args;switch(J.length){case 0:U();break;case 1:U(J[0]);break;case 2:U(J[0],J[1]);break;case 3:U(J[0],J[1],J[2]);break;default:U.apply(u,J)}})(B)}finally{x(W),C=!1}}}}function k(W){W.source===a&&typeof W.data=="string"&&W.data.indexOf(p)===0&&I(+W.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Oc<"u"?Oc:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(ZE)),ZE.exports}export{lt as H,Gge as a,Age as g,Ee as h,Hge as r};
//# sourceMappingURL=vendor-ItrcfzAD.js.map
